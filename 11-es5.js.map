{"version":3,"sources":["webpack:///src/app/+public/public.module.ts","webpack:///src/app/+public/public.component.ts","webpack:///src/app/+public/public.component.html","webpack:///src/app/+public/public.service.ts","webpack:///src/app/+public/public.routing.ts"],"names":["PublicModule","ngModule","providers","imports","declarations","exports","PublicComponent","route","authService","logoUrl","embedded","display","getCookie","refreshUser","then","_subscription","queryParams","subscribe","p","unsubscribe","selector","templateUrl","PublicService","logger","_hubMessages","asObservable","value","message","addUpdateNotification","messages","getHubMessages","push","next","newMessage","addHubMessage","error","context","stack","searchString","hubKeys","maxResults","reload","sharedItemsIndex","post","Promise","resolve","sharedItems","zipFiles","downloadFormat","cancelToken","reject","flags","i","length","hubKey","forEach","activeAgent","postRemote","clientId","getWebSocketConnectionId","filter","c","remoteAgentId","instanceId","task","addUpdateTask","reason","LogC","Error","objectKey","objectType","inputColumns","selectQuery","parameters","result","columns","constructDataTableColumns","parameterName","resetCache","dashboardKey","dashboard","routes","path","component","children","redirectTo","data","pageTitle","Routing","forChild"],"mappings":"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","file":"11-es5.js","sourcesContent":["import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { Routing } from './public.routing';\nimport { SharedModule } from '../shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\n\nimport { PublicService } from './public.service';\nimport { PublicComponent } from './public.component';\nimport { RibbonModule } from '../shared/layout/ribbon';\n\n@NgModule({\n    imports: [\n        SharedModule,\n        Routing,\n        ReactiveFormsModule,\n        RibbonModule\n    ],\n    declarations: [\n        PublicComponent,\n    ],\n    providers: [PublicService],\n    exports: []\n})\nexport class PublicModule {\n\n    static forRoot(): ModuleWithProviders<PublicModule> {\n        return {\n            ngModule: PublicModule,\n            providers: [PublicService]\n        };\n    }\n}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Subscription} from 'rxjs';\nimport { logoUrl } from '../+auth/auth.models';\nimport { ActivatedRoute } from '@angular/router';\nimport { Functions } from '../shared/utils/functions';\nimport { AuthService } from '../+auth/auth.service';\n\n@Component({\n    selector: 'dexih-public',\n    templateUrl: './public.component.html'\n})\nexport class PublicComponent implements OnInit, OnDestroy {\n    _subscription: Subscription;\n\n    logoUrl = logoUrl;\n    embedded = false;\n\n    display = false;\n\n    constructor(private route: ActivatedRoute, private authService: AuthService) {\n    }\n\n    ngOnInit() {\n        // if there is no cross scripting token, make a call to the api to get one.\n        if (!Functions.getCookie('XSRF-TOKEN')) {\n            this.authService.refreshUser(true).then(() => {\n                this.display = true;\n            });\n        } else {\n            this.display = true;\n        }\n\n        this._subscription = this.route.queryParams.subscribe(p => {\n            if (p['embed'] === 'true') {\n                this.embedded = true;\n            }\n        });\n    }\n\n    ngOnDestroy() {\n        if (this._subscription) { this._subscription.unsubscribe(); }\n    }\n\n}\n","<div *ngIf=\"!embedded\" id=\"content\">\n    <nav class=\"navbar navbar-expand-md navbar-dark bg-dark\">\n        <div id=\"logo-group\">\n            <span id=\"logo\">\n                <img [src]='logoUrl' alt=\"Data Experts Group\"> </span>\n        </div>\n    \n        <div class=\"collapse navbar-collapse mr-sm-2\">\n        </div>\n        <form class=\"form-inline\">\n            <div>\n                <span class=\"d-none d-md-inline text-white m-1\" >\n                    Need an account?\n                </span>\n                <a routerLink=\"/auth/register\" class=\"btn btn-success mr-1\">Sign Up</a>\n            </div>\n    \n            <div>\n                <span class=\"d-none d-md-inline text-white m-1\" >\n                    Already Registered?\n                </span>\n                <a routerLink=\"/auth/login\" class=\"btn btn-success mr-1\">Sign In</a>\n            </div>\n    \n            <a routerLink=\"/auth/help\" class=\"d-none d-md-inline btn btn-secondary text-white mr-1\">Help</a>\n    \n            <d-button-dropdown [pullRight]=\"true\" [hideCarrot]=\"true\" buttonClass=\"btn-primary\" iconClass=\"fa fa-navicon\">\n                <a class=\"dropdown-item\" routerLink=\"/auth/register\">Sign Up</a>\n                <a class=\"dropdown-item\" routerLink=\"/auth/login\">Sign In</a>\n                <div class=\"dropdown-divider\"></div>\t\n                <a class=\"dropdown-item\" routerLink=\"/auth/forgot-password\">Forgot password</a>\n                <a class=\"dropdown-item\" routerLink=\"/auth/verifyemail\">Verify password</a>\n                <div class=\"dropdown-divider\"></div>\t\n                <a class=\"dropdown-item\" routerLink=\"/auth/privacy\">Privacy Policy</a>\n                <a class=\"dropdown-item\" routerLink=\"/auth/terms\">Terms and Conditions</a>\n                <a class=\"dropdown-item\" routerLink=\"/auth/help\">Help</a>\n            </d-button-dropdown>\n        </form>\n    </nav>\n    \n    <dexih-ribbon></dexih-ribbon>\n\n    <router-outlet *ngIf=\"display\"></router-outlet>\n</div>\n\n<router-outlet *ngIf=\"display && embedded\"></router-outlet>\n","import { Message, CancelToken } from '../+auth/auth.models';\nimport { eLogLevel, LogFactory } from '../../logging';\nimport { Injectable, OnDestroy } from '@angular/core';\nimport { AuthService } from '../+auth/auth.service';\nimport { BehaviorSubject, Observable} from 'rxjs';\nimport { eDownloadFormat, DexihActiveAgent, InputColumn, SelectQuery,\n    SharedData, eDataObjectType, DexihDashboard, InputParameterBase, ManagedTask, ListOfValuesItem } from '../shared/shared.models';\nimport { PreviewResults } from '../+hub/hub.models';\n\n@Injectable()\nexport class PublicService implements OnDestroy {\n\n    private logger = new LogFactory('public.service');\n    private _hubMessages = new BehaviorSubject<Array<Message>>([]);\n\n\n    private sharedItemsIndex: SharedData[];\n\n    constructor(\n        private authService: AuthService\n        ) {\n    }\n\n    ngOnDestroy() {\n    }\n\n    getHubMessagesObservable(): Observable<Array<Message>> {\n        return this._hubMessages.asObservable();\n    }\n\n    getHubMessages(): Array<Message> {\n        return this._hubMessages.value;\n    }\n\n    addHubMessage(message: Message) {\n        this.authService.addUpdateNotification(message, false);\n        let messages = this.getHubMessages();\n        messages.push(message);\n        this._hubMessages.next(messages);\n    }\n\n    addHubErrorMessage(message: string) {\n        let newMessage = new Message(false, message, null, null);\n        this.addHubMessage(newMessage);\n    }\n\n    addHubClientErrorMessage(error: Error, context: string) {\n        let message = context + '.  The following error occurred on the client: ' + error.message;\n        let newMessage = new Message(false, message, error.stack, null);\n        this.addHubMessage(newMessage);\n    }\n\n    addHubSuccessMessage(message: string) {\n        let newMessage = new Message(true, message, null, null);\n        this.addHubMessage(newMessage);\n    }\n\n    // gets all shared data items\n    getSharedDataIndex(searchString: string, hubKeys: number[], maxResults: number, reload: boolean): Promise<SharedData[]> {\n        if (reload || !this.sharedItemsIndex) {\n            return this.authService.post<SharedData[]>('/api/SharedData/SharedDataIndex', {\n                searchString, hubKeys, maxResults\n            }, 'Getting shared data index...');\n        } else {\n            Promise.resolve(this.sharedItemsIndex);\n        }\n    }\n\n    downloadData(sharedItems: Array<SharedData>, zipFiles: boolean, downloadFormat: eDownloadFormat, cancelToken: CancelToken):\n        Promise<boolean> {\n        return new Promise<boolean>((resolve, reject) => {\n\n            // get distinct list of hubKeys\n            let flags = [], hubKeys = []\n            for (let i = 0; i < sharedItems.length; i++) {\n                if (flags[sharedItems[i].hubKey]) { continue };\n                flags[sharedItems[i].hubKey] = true;\n                hubKeys.push(sharedItems[i].hubKey);\n            }\n\n            hubKeys.forEach(hubKey => {\n                this.authService.post<DexihActiveAgent>('/api/SharedData/GetActiveAgent', { hubKey: hubKey}, 'Getting active remote agent...')\n                .then(activeAgent => {\n\n                    this.authService.postRemote<ManagedTask>('/api/SharedData/DownloadData', {\n                        hubKey: hubKey,\n                        clientId: this.authService.getWebSocketConnectionId(),\n                        downloadFormat: downloadFormat,\n                        zipFiles: zipFiles,\n                        sharedItems: sharedItems.filter(c => c.hubKey === hubKey),\n                        remoteAgentId: activeAgent.instanceId,\n                    }, activeAgent, 'Downloading data...', cancelToken)\n                        .then(task => {\n                        this.authService.addUpdateTask(task);\n                        resolve(true);\n                    }).catch(reason => {\n                        this.logger.LogC(() => `downloadData, error: ${reason.message}.`, eLogLevel.Error);\n                        reject(reason);\n                    });\n                });\n            });\n        });\n    }\n\n    // starts a preview, and returns the url to get the download stream.\n    previewData(hubKey: number, objectKey: number, objectType: eDataObjectType,\n        inputColumns: InputColumn[], selectQuery: SelectQuery, parameters: InputParameterBase[], cancelToken: CancelToken):\n        Promise<PreviewResults> {\n\n        return new Promise<PreviewResults>((resolve, reject) => {\n            this.authService.post<DexihActiveAgent>('/api/SharedData/GetActiveAgent', { hubKey: hubKey }, 'Getting active remote agent...')\n            .then(activeAgent => {\n                this.authService.postRemote<PreviewResults>('/api/SharedData/PreviewData', {\n                    hubKey: hubKey,\n                    objectType: objectType,\n                    objectKey: objectKey,\n                    selectQuery: selectQuery,\n                    remoteAgentId: activeAgent.instanceId,\n                    inputColumns: inputColumns,\n                    parameters: parameters\n                }, activeAgent, 'Previewing data...', cancelToken).then(result => {\n                    result.columns = this.authService.constructDataTableColumns(result.columns);\n                    resolve(result);\n                }).catch(reason => {\n                    reject(reason);\n                })\n            }).catch(reason => {\n                reject(reason);\n            });\n        });\n    }\n\n      // starts a preview, and returns the url to get the download stream.\n      previewListOfValues(hubKey: number, objectKey: number, objectType: eDataObjectType, parameterName,\n        resetCache: boolean, cancelToken: CancelToken):\n        Promise<ListOfValuesItem[]> {\n\n        return new Promise<ListOfValuesItem[]>((resolve, reject) => {\n            this.authService.post<DexihActiveAgent>('/api/SharedData/GetActiveAgent', { hubKey: hubKey }, 'Getting active remote agent...')\n            .then(activeAgent => {\n                this.authService.postRemote<ListOfValuesItem[]>('/api/SharedData/PreviewListOfValues', {\n                    hubKey: hubKey,\n                    objectType: objectType,\n                    objectKey: objectKey,\n                    parameterName: parameterName,\n                    resetCache: resetCache,\n                    remoteAgentId: activeAgent.instanceId,\n                }, activeAgent, 'Previewing list of values...', cancelToken).then(result => {\n                    resolve(result);\n                }).catch(reason => {\n                    reject(reason);\n                })\n            }).catch(reason => {\n                reject(reason);\n            });\n        });\n    }\n\n    getDashboard(hubKey: number, dashboardKey: number): Promise<DexihDashboard> {\n\n        return new Promise<DexihDashboard>((resolve, reject) => {\n            this.authService.post<DexihDashboard>('/api/SharedData/PreviewDashboard', {\n                hubKey: hubKey,\n                dashboardKey: dashboardKey,\n            }, 'Getting dashboard download locations...').then(dashboard => {\n                resolve(dashboard);\n            }).catch(reason => reject(reason));\n        });\n    }\n\n\n\n}\n\n\n\n\n","import { Routes, RouterModule } from '@angular/router';\nimport { PublicComponent } from './public.component';\nimport { SharedDataComponent, PreviewComponent, PreviewDashboardComponent } from '../shared/ui/sharedData';\n\n// insert the \"hubs\" routes once for the base, and once under the summary section to ensure the\n// breadcrumbs are accurate.\nexport const routes: Routes = [\n    {\n        path: '',\n        component: PublicComponent,\n        children: [\n            { path: '', redirectTo: 'index' },\n            { path: 'index', data: { pageTitle: 'Shared Data' }, children : [\n                { path: '', component: SharedDataComponent, data: { pageTitle: 'Shared Data' } },\n                { path: 'preview/:hubKey/:objectType/:objectKey', component: PreviewComponent, data: { pageTitle: 'Preview' } },\n                { path: 'previewDashboard/:hubKey/:dashboardKey', component: PreviewDashboardComponent, data: { pageTitle: 'Preview Dashboard' } },\n            ] },\n        ]\n    }\n];\n\nexport const Routing = RouterModule.forChild(routes);\n"]}