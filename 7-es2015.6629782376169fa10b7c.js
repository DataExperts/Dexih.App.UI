(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1wre":function(e,t,i){"use strict";i.d(t,"c",(function(){return N})),i.d(t,"b",(function(){return ue})),i.d(t,"a",(function(){return ye}));var a=i("itXk"),n=i("Kj3r"),s=i("3WyZ"),r=i("soiQ"),o=i("fXoL"),c=i("ElCs"),b=i("tyNb"),h=i("3Pt+"),l=i("24Dg"),u=i("Wumg"),d=i("ofXK"),m=i("H3K+"),f=i("79jk");const g=["DexihMessage"];function p(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",18),o.Vb("click",(function(){return o.vc(e),o.Zb(2).embedLink=null})),o.Ob(1,"span",19),o.Fc(2,"\xd7"),o.Nb(),o.Nb()}}function y(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-widget-section",13),o.Dc(1,p,3,0,"ng-template",null,14,o.Ec),o.Ob(3,"section"),o.Ob(4,"form-textarea",15),o.Vb("ngModelChange",(function(t){return o.vc(e),o.Zb().embedLink=t})),o.Ob(5,"a",16),o.Fc(6,"(Open)"),o.Nb(),o.Nb(),o.Nb(),o.Ob(7,"section"),o.Ob(8,"form-textarea",17),o.Vb("ngModelChange",(function(t){return o.vc(e),o.Zb().embedFrame=t})),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Zb();o.hc("showExpandButton",!1),o.yb(4),o.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.embedLink),o.yb(1),o.hc("href",e.embedLink,o.xc),o.yb(3),o.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.embedFrame)}}function v(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-button-edit",23),o.Vb("click",(function(){o.vc(e);const t=o.Zb().item;return o.Zb().edit(t)})),o.Nb()}}const w=function(e,t,i){return["preview",e,t,i]};function x(e,t){if(1&e){const e=o.Pb();o.Lb(0,"dexih-button-preview",20),o.Dc(1,v,1,0,"dexih-button-edit",21),o.Ob(2,"dexih-button",22),o.Vb("click",(function(){o.vc(e);const i=t.item;return o.Zb().embed(i)})),o.Nb()}if(2&e){const e=t.item,i=o.Zb();o.hc("routerLink",o.oc(2,w,e.hubKey,e.objectType,e.objectKey)),o.yb(1),o.hc("ngIf",(null==i.hubKeys?null:i.hubKeys.indexOf(e.hubKey))>=0)}}function C(e,t){if(1&e&&(o.Ob(0,"div",28),o.Lb(1,"form-tags-dropdown",29),o.Nb()),2&e){const e=o.Zb(2);o.yb(1),o.hc("items",e.hubs)("enableAddAll",!0)}}function O(e,t){if(1&e&&(o.Ob(0,"form",24),o.Dc(1,C,2,2,"div",25),o.Ob(2,"div",26),o.Lb(3,"form-input",27),o.Nb(),o.Nb()),2&e){const e=o.Zb();o.hc("formGroup",e.searchForm),o.yb(1),o.hc("ngIf",e.hubs)}}function D(e,t){}function K(e,t){if(1&e){const e=o.Pb();o.Ob(0,"download-button",30),o.Vb("download",(function(i){o.vc(e);const a=t.items;return o.Zb().downloadData(a,!0,i)})),o.Nb()}}let N=(()=>{class e{constructor(e,t,i,a){this.authService=e,this.route=t,this.router=i,this.fb=a,this.cancelToken=new s.a,this.eDownloadFormat=r.rb,this.columns=[{name:"logicalName",title:"Details",header:"hubName",footer:"description",format:"Md",tags:"tags"},{name:"objectType",title:"Type",format:"Enum",enum:r.lb},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this.dataIndex=null}ngOnInit(){try{this._subscription=Object(a.a)(this.route.params,this.authService.getHubsObservable()).subscribe(e=>{this.hubs=e[1],this.hubs&&(this.hubKeys=this.hubs.map(e=>e.hubKey)),this.searchForm=this.fb.group({searchString:["",[]],hubKeys:[[],[]]}),this.updateSearch(),this._searchSubscription&&this._searchSubscription.unsubscribe(),this._searchSubscription=this.searchForm.valueChanges.pipe(Object(n.a)(500)).subscribe(()=>{this.updateSearch()})})}catch(e){this.dexihMessage.addErrorMessage(e.message)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}updateSearch(){this.authService.getSharedDataIndex(this.searchForm.value.searchString,this.searchForm.value.hubKeys,50,!0).then(e=>{this.dataIndex=e.filter(e=>e.objectType!==r.lb.DashboardItem),this.tags=[],this.dataIndex.forEach(e=>{e.tags&&e.tags.length>0&&e.tags.forEach(e=>{this.tags.findIndex(t=>t.name===e.name)<0&&this.tags.push(e)})})}).catch(e=>this.dexihMessage.addMessage(e))}previewData(e){this.router.navigate(e.objectType===r.lb.Dashboard?["previewDashboard",e.hubKey,e.objectKey]:["preview",e.hubKey,e.objectType,e.objectKey],{relativeTo:this.route.parent})}embed(e){this.embedLink=e.objectType===r.lb.Dashboard?`${window.location.origin}/public/index/previewDashboard/${e.hubKey}/${e.objectType}/${e.objectKey}?embed=true`:`${window.location.origin}/public/index/preview/${e.hubKey}/${e.objectType}/${e.objectKey}?embed=true`,this.embedFrame=`<iframe width="560" height="315" src="${this.embedLink}" frameborder="0" ></iframe>`,document.body.scrollTop=0,document.documentElement.scrollTop=0}downloadData(e,t,i){this.authService.downloadData(e,t,i,this.cancelToken).then(()=>{this.dexihMessage.addSuccessMessage("The download task has started.")}).catch(e=>{this.dexihMessage.addMessage(e)})}edit(e){switch(e.objectType){case r.lb.Datalink:this.router.navigate(["hub",e.hubKey,"datalinks","datalink-edit","edit",e.objectKey]);break;case r.lb.Table:this.router.navigate(["hub",e.hubKey,"tables","table-edit",e.objectKey]);break;case r.lb.View:this.router.navigate(["hub",e.hubKey,"views","view-edit",e.objectKey]);break;case r.lb.Dashboard:this.router.navigate(["hub",e.hubKey,"dashboards","dashboard-edit",e.objectKey])}}}return e.\u0275fac=function(t){return new(t||e)(o.Kb(c.a),o.Kb(b.a),o.Kb(b.e),o.Kb(h.g))},e.\u0275cmp=o.Eb({type:e,selectors:[["sharedData"]],viewQuery:function(e,t){var i;1&e&&o.Bc(g,!0),2&e&&o.rc(i=o.Wb())&&(t.dexihMessage=i.first)},decls:15,vars:8,consts:[[1,"container-fluid"],[1,"m-1"],["DexihMessage",""],["title","Shared Data","iconClass","fa fa-lg fa-fw fa-life-saver"],["title","Embedded html",3,"showExpandButton",4,"ngIf"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","enableFilter","columns","data","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","filter"],["filter",""],["actions",""],["select","selectedItemsAction"],["selectedItemsAction",""],["title","Embedded html",3,"showExpandButton"],["header",""],["label","Link","rows","1",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["target","_blank",1,"ml-1",3,"href"],["label","Embedded IFrame","rows","1",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["type","button","aria-label","Close",1,"close","ml-2",3,"click"],["aria-hidden","true"],[3,"routerLink"],["class","ml-1",3,"click",4,"ngIf"],["iconClass","fa fa-code","title","Get embedded version","text","Embedded",1,"ml-1",3,"click"],[1,"ml-1",3,"click"],[1,"row",3,"formGroup"],["class","col-xs-12 col-sm mr-1",4,"ngIf"],[1,"col-xs-12","col-sm","mr-1","input-expand"],["formControlName","searchString","placeholder","Search...","iconClass","fa fa-search"],[1,"col-xs-12","col-sm","mr-1"],["labelLeft","Hubs","formControlName","hubKeys","itemKey","hubKey","itemName","name",3,"items","enableAddAll"],[1,"ml-1",3,"download"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Lb(2,"dexih-message",null,2),o.Nb(),o.Ob(4,"dexih-widget",3),o.Dc(5,y,9,12,"dexih-widget-section",4),o.Ob(6,"dexih-table",5),o.Vb("rowClick",(function(e){return t.previewData(e)})),o.Dc(7,x,3,6,"ng-template",6,7,o.Ec),o.Dc(9,O,4,2,"ng-template",8,9,o.Ec),o.Dc(11,D,0,0,"ng-template",null,10,o.Ec),o.Dc(13,K,1,0,"ng-template",11,12,o.Ec),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.yb(5),o.hc("ngIf",t.embedLink),o.yb(1),o.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("enableFilter",!1)("columns",t.columns)("data",t.dataIndex)("tags",t.tags))},directives:[l.a,u.P,d.t,m.a,u.T,u.H,h.s,h.v,u.q,u.f,u.j,h.I,h.t,h.l,u.D,h.j,u.G,f.a],encapsulation:2}),e})();var I=i("XNiG");function T(e,t){if(1&e){const e=o.Pb();o.Ob(0,"form-select",7),o.Vb("ngModelChange",(function(t){return o.vc(e),o.Zb().$implicit.value=t}))("ngModelChange",(function(){o.vc(e);const t=o.Zb().$implicit;return o.Zb(2).change(t)}))("onRefresh",(function(){o.vc(e);const t=o.Zb().$implicit;return o.Zb(2).refresh(t)})),o.Nb()}if(2&e){const e=o.Zb().$implicit,t=o.Zb(2);o.hc("labelLeft",e.name)("ngModel",e.value)("items",e.runTime.items)("enableTextEntry",!(e.listOfValuesKey>0))("textEntryItems",t.parentParams)("showRefresh",e.runTime.showRefresh)("isRefreshing",e.runTime.isRefreshing)("multiSelect",1===e.rank)}}function j(e,t){if(1&e){const e=o.Pb();o.Ob(0,"form-input",8),o.Vb("ngModelChange",(function(t){return o.vc(e),o.Zb().$implicit.value=t}))("ngModelChange",(function(){o.vc(e);const t=o.Zb().$implicit;return o.Zb(2).change(t)})),o.Nb()}if(2&e){const e=o.Zb().$implicit;o.hc("labelLeft",e.name)("ngModel",e.value)}}function M(e,t){if(1&e&&(o.Ob(0,"div",4),o.Dc(1,T,1,8,"form-select",5),o.Dc(2,j,1,2,"form-input",6),o.Nb()),2&e){const e=t.$implicit;o.yb(1),o.hc("ngIf",e.listOfValuesKey>0),o.yb(1),o.hc("ngIf",!(e.listOfValuesKey>0))}}function k(e,t){if(1&e&&(o.Ob(0,"div",2),o.Dc(1,M,3,2,"div",3),o.Nb()),2&e){const e=o.Zb();o.yb(1),o.hc("ngForOf",e.userParameters)}}function P(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",9),o.Ob(1,"a",10),o.Vb("click",(function(){return o.vc(e),o.Zb().refreshData()})),o.Fc(2,"The parameters have changed. Click to refresh."),o.Nb(),o.Nb()}}let S=(()=>{class e{constructor(e){this.authService=e,this.onChange=new o.n,this.onRefreshData=new o.n,this.parentParams=[],this.values=[],this.cancelToken=new s.a,this.requiresRefresh=!1,this.showRefresh=!1,this.isRefreshing=!1}ngOnInit(){this.userParameters=[],this.parameters.filter(e=>e.isValid&&e.allowUserSelect).forEach(e=>{e.runTime={showRefresh:e.listOfValuesKey>0,isRefreshing:!1,items:[]},e.value&&e.listOfValuesKey&&0===e.rank&&(e.runTime.items=[{key:e.value,name:e.valueDesc}]),this.userParameters.push(e)}),this._refreshSubscription=this.refreshEvent.subscribe(()=>{this.requiresRefresh=!1})}ngOnDestroy(){this._hubSubscription&&this._hubSubscription.unsubscribe(),this._refreshSubscription&&this._refreshSubscription.unsubscribe()}refresh(e){e.listOfValuesKey&&(e.runTime.isRefreshing=!0,this.authService.previewListOfValues(this.hubKey,this.objectKey,this.objectType,e.name,!1,this.cancelToken).then(t=>{e.runTime.items=t,e.runTime.showRefresh=!1}).catch(e=>{this.authService.addUpdateNotification(e,!1)}).finally(()=>{e.runTime.isRefreshing=!1}))}refreshData(){this.onRefreshData.emit()}change(e){e.listOfValuesKey>0?this.onChange.emit():this.requiresRefresh=!0}}return e.\u0275fac=function(t){return new(t||e)(o.Kb(c.a))},e.\u0275cmp=o.Eb({type:e,selectors:[["input-parameters-view"]],inputs:{hubKey:"hubKey",objectType:"objectType",objectKey:"objectKey",parameters:"parameters",refreshEvent:"refreshEvent"},outputs:{onChange:"onChange",onRefreshData:"onRefreshData"},decls:2,vars:2,consts:[["class","d-flex flex-wrap",4,"ngIf"],["class","alert alert-warning mt-2",4,"ngIf"],[1,"d-flex","flex-wrap"],["class","pr-1",4,"ngFor","ngForOf"],[1,"pr-1"],["itemKey","key","itemName","name","textEntryItemsTitle","Linked Parameters",3,"labelLeft","ngModel","items","enableTextEntry","textEntryItems","showRefresh","isRefreshing","multiSelect","ngModelChange","onRefresh",4,"ngIf"],[3,"labelLeft","ngModel","ngModelChange",4,"ngIf"],["itemKey","key","itemName","name","textEntryItemsTitle","Linked Parameters",3,"labelLeft","ngModel","items","enableTextEntry","textEntryItems","showRefresh","isRefreshing","multiSelect","ngModelChange","onRefresh"],[3,"labelLeft","ngModel","ngModelChange"],[1,"alert","alert-warning","mt-2"],["href","javascript:void(0)",1,"alert-link",3,"click"]],template:function(e,t){1&e&&(o.Dc(0,k,2,1,"div",0),o.Dc(1,P,3,0,"div",1)),2&e&&(o.hc("ngIf",t.parameters),o.yb(1),o.hc("ngIf",t.requiresRefresh))},directives:[d.t,d.s,u.E,h.s,h.v,u.D],encapsulation:2}),e})();var Z=i("PMKX"),z=i("g8Ys");const R=function(e){return{active:e}};function E(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",16),o.Ob(1,"label",17),o.Ob(2,"input",18),o.Vb("click",(function(){return o.vc(e),o.Zb(2).showChart=!1})),o.Nb(),o.Lb(3,"i",19),o.Nb(),o.Ob(4,"label",20),o.Ob(5,"input",21),o.Vb("click",(function(){return o.vc(e),o.Zb(2).showChart=!0})),o.Nb(),o.Lb(6,"i",22),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("ngClass",o.mc(2,R,!1===e.showChart)),o.yb(3),o.hc("ngClass",o.mc(4,R,!0===e.showChart))}}function V(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-button",23),o.Vb("click",(function(){return o.vc(e),o.Zb(2).maximize()})),o.Nb()}}function L(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-button",24),o.Vb("click",(function(){return o.vc(e),o.Zb(2).minimize()})),o.Nb()}}function F(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",25),o.Ob(1,"input-parameters-view",26),o.Vb("onRefreshData",(function(){return o.vc(e),o.Zb(2).refresh()}))("onChange",(function(){return o.vc(e),o.Zb(2).parameterChange()})),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("hubKey",e.hubKey)("objectType",e.objectType)("objectKey",e.objectKey)("parameters",e.userParameters)("refreshEvent",e.refreshDataSubject.asObservable())}}function _(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",25),o.Ob(1,"series-animate",27),o.Vb("hasChanged",(function(){return o.vc(e),o.Zb(2).hasChanged()}))("dataChange",(function(t){return o.vc(e),o.Zb(2).data=t})),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("showEdit",!1)("showFrame",!1)("animateConfig",e.viewConfig.animateConfig)("columns",e.columns)("baseData",e.baseData)("data",e.data)}}function $(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",4),o.Ob(1,"div",5),o.Ob(2,"div",6),o.Lb(3,"i",7),o.Nb(),o.Ob(4,"div",8),o.Ob(5,"div",9),o.Ob(6,"div"),o.Ob(7,"download-button",10),o.Vb("download",(function(t){return o.vc(e),o.Zb().downloadData(t)})),o.Nb(),o.Dc(8,E,7,6,"div",11),o.Ob(9,"dexih-button-refresh",12),o.Vb("click",(function(){return o.vc(e),o.Zb().refresh()})),o.Nb(),o.Dc(10,V,1,0,"dexih-button",13),o.Dc(11,L,1,0,"dexih-button",14),o.Nb(),o.Dc(12,F,2,5,"div",15),o.Dc(13,_,2,6,"div",15),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Zb();o.yb(8),o.hc("ngIf",(null==e.viewConfig?null:e.viewConfig.viewType)===e.eViewType.Chart),o.yb(1),o.hc("compact",!0),o.yb(1),o.hc("ngIf",!e.isMaximized),o.yb(1),o.hc("ngIf",e.isMaximized),o.yb(1),o.hc("ngIf",e.userParameters&&e.userParameters.length>0),o.yb(1),o.hc("ngIf",e.viewConfig&&e.baseData)}}function Q(e,t){1&e&&(o.Ob(0,"div",28),o.Lb(1,"div",29),o.Fc(2," \xa0 \xa0 Loading ...\n"),o.Nb())}function B(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",34),o.Ob(1,"label",17),o.Ob(2,"input",18),o.Vb("click",(function(){return o.vc(e),o.Zb(2).showChart=!1})),o.Nb(),o.Lb(3,"i",19),o.Nb(),o.Ob(4,"label",20),o.Ob(5,"input",21),o.Vb("click",(function(){return o.vc(e),o.Zb(2).showChart=!0})),o.Nb(),o.Lb(6,"i",22),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("ngClass",o.mc(2,R,!1===e.showChart)),o.yb(3),o.hc("ngClass",o.mc(4,R,!0===e.showChart))}}function U(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",35),o.Ob(1,"input-parameters-view",26),o.Vb("onRefreshData",(function(){return o.vc(e),o.Zb(2).refresh()}))("onChange",(function(){return o.vc(e),o.Zb(2).parameterChange()})),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("hubKey",e.hubKey)("objectType",e.objectType)("objectKey",e.objectKey)("parameters",e.userParameters)("refreshEvent",e.refreshDataSubject.asObservable())}}function q(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div"),o.Ob(1,"series-animate",27),o.Vb("hasChanged",(function(){return o.vc(e),o.Zb(2).hasChanged()}))("dataChange",(function(t){return o.vc(e),o.Zb(2).data=t})),o.Nb(),o.Nb()}if(2&e){const e=o.Zb(2);o.yb(1),o.hc("showEdit",!1)("showFrame",!1)("animateConfig",e.viewConfig.animateConfig)("columns",e.columns)("baseData",e.baseData)("data",e.data)}}function A(e,t){if(1&e&&(o.Ob(0,"div",30),o.Dc(1,B,7,6,"div",31),o.Dc(2,U,2,5,"div",32),o.Dc(3,q,2,6,"div",33),o.Nb()),2&e){const e=o.Zb();o.yb(1),o.hc("ngIf",null==e.viewConfig?null:e.viewConfig.chartConfig),o.yb(1),o.hc("ngIf",e.userParameters&&e.userParameters.length>0),o.yb(1),o.hc("ngIf",e.viewConfig&&e.baseData)}}function W(e,t){}function G(e,t){}function H(e,t){if(1&e&&(o.Ob(0,"dexih-table",40),o.Dc(1,W,0,0,"ng-template",null,41,o.Ec),o.Dc(3,G,0,0,"ng-template",null,42,o.Ec),o.Nb()),2&e){const e=o.Zb(2);o.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("csvFileName",e.name)("enableFilter",!1)("columns",e.columns)("data",e.data)}}function X(e,t){if(1&e&&o.Lb(0,"chart-view",43),2&e){const e=o.Zb(2);o.hc("responsive",!0)("columns",e.columns)("data",e.data)("config",e.viewConfig.chartConfig)}}function J(e,t){if(1&e&&(o.Ob(0,"div",36),o.Ob(1,"div",37),o.Dc(2,H,5,6,"dexih-table",38),o.Dc(3,X,1,4,"chart-view",39),o.Nb(),o.Nb()),2&e){const e=o.Zb();o.yb(2),o.hc("ngIf",!e.showChart),o.yb(1),o.hc("ngIf",e.showChart)}}let Y=(()=>{class e{constructor(e,t){this.authService=e,this.route=t,this.showToolbar=!1,this.updateQueryParameters=!0,this.isMaximized=!1,this.onMaximize=new o.n,this.refreshDataSubject=new I.a,this.name="loading...",this.selectQuery=new r.V,this.showChart=!1,this.eViewType=r.rc,this.cancelToken=new s.a}ngOnInit(){try{this._subscription=Object(a.a)(this.authService.getSharedDataObject(this.hubKey,this.objectType,this.objectKey),this.route.queryParams).subscribe(e=>{let t=e[0],i=e[1];if(null!=t){this.inputColumns=t.inputColumns,this.tableColumns=t.outputColumns,this.parameters=t.parameters,this.userParameters=this.parameters;let e=i.p;if(e){let t=JSON.parse(e);for(let e of this.userParameters){let i=t[e.name];void 0!==i&&(e.value=i,0===e.rank&&(e.valueDesc=i))}}}else this.parameters=[];this.refresh()})}catch(e){this.authService.addUpdateNotification(e,!1)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}parameterChange(){if(this.updateQueryParameters&&this.userParameters.length>0){let e={};for(let t of this.userParameters)e[t.name]=t.value;if("URLSearchParams"in window){let t=new URLSearchParams(window.location.search);t.set("p",JSON.stringify(e));let i=window.location.pathname+"?"+t.toString();history.pushState(null,"",i)}}this.refresh()}refresh(){this.authService.previewData(this.hubKey,this.objectKey,this.objectType,this.inputColumns,this.selectQuery,this.parameters,this.parentParameters,this.cancelToken).then(e=>{this.refreshDataSubject.next(),this.columns=e.columns,this.baseData=e.data,this.name=e.name,this.viewConfig=e.viewConfig,this.viewConfig||(this.data=this.baseData),this.showChart=!(!this.viewConfig||this.viewConfig.viewType!==r.rc.Chart),e.status&&this.authService.addUpdateNotification(e.status,!1)}).catch(e=>{this.authService.addUpdateNotification(e,!1),this.baseData=[],this.data=[],this.name="failed"})}downloadData(e){let t=new r.W;t.objectKey=this.objectKey,t.objectType=this.objectType,t.hubKey=this.hubKey,t.inputColumns=this.inputColumns,t.parameters=this.parameters,t.parentParameters=this.parentParameters,t.query=this.selectQuery,this.authService.downloadData([t],!0,e,this.cancelToken).then(()=>{let e=new s.e(!0,"The download task has started.",null,null);this.authService.addUpdateNotification(e,!1)}).catch(e=>{this.authService.addUpdateNotification(e,!1)})}maximize(){this.isMaximized=!0,this.onMaximize.emit(!0)}minimize(){this.isMaximized=!1,this.onMaximize.emit(!1)}}return e.\u0275fac=function(t){return new(t||e)(o.Kb(c.a),o.Kb(b.a))},e.\u0275cmp=o.Eb({type:e,selectors:[["preview-data"]],inputs:{objectType:"objectType",objectKey:"objectKey",hubKey:"hubKey",parentParameters:"parentParameters",showToolbar:"showToolbar",updateQueryParameters:"updateQueryParameters",isMaximized:"isMaximized"},outputs:{onMaximize:"onMaximize"},decls:4,vars:4,consts:[["class","side-menu",4,"ngIf"],["class","m-3",4,"ngIf"],["class","d-flex",4,"ngIf"],["class","h-100 box",4,"ngIf"],[1,"side-menu"],[1,"side-menu-content"],[1,"spin-icon"],[1,"fa","fa-cog","fa-spin"],[1,"side-menu-box"],[1,"bg-light","rounded","p-1"],[3,"download"],["class","btn-group btn-group-toggle ml-1","data-toggle","buttons","title","Table",4,"ngIf"],[1,"ml-1",3,"compact","click"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",3,"click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",3,"click",4,"ngIf"],["class","m-1",4,"ngIf"],["data-toggle","buttons","title","Table",1,"btn-group","btn-group-toggle","ml-1"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","table","autocomplete","off",3,"click"],[1,"fa","fa-table"],["title","Chart",1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","chart","autocomplete","off",3,"click"],[1,"fa","fa-bar-chart"],["buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",1,"ml-1",3,"click"],["buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",1,"ml-1",3,"click"],[1,"m-1"],[3,"hubKey","objectType","objectKey","parameters","refreshEvent","onRefreshData","onChange"],[3,"showEdit","showFrame","animateConfig","columns","baseData","data","hasChanged","dataChange"],[1,"m-3"],[1,"dexih-loader"],[1,"d-flex"],["class","align-self-start btn-group btn-sm btn-group-toggle","data-toggle","buttons","title","Table",4,"ngIf"],["class","mt-1",4,"ngIf"],[4,"ngIf"],["data-toggle","buttons","title","Table",1,"align-self-start","btn-group","btn-sm","btn-group-toggle"],[1,"mt-1"],[1,"h-100","box"],[1,"box-content",2,"height","90vh"],[3,"enableMultiSelect","enableSaveCsv","csvFileName","enableFilter","columns","data",4,"ngIf"],[3,"responsive","columns","data","config",4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","csvFileName","enableFilter","columns","data"],["actions",""],["tableHeader",""],[3,"responsive","columns","data","config"]],template:function(e,t){1&e&&(o.Dc(0,$,14,6,"div",0),o.Dc(1,Q,3,0,"div",1),o.Dc(2,A,4,3,"div",2),o.Dc(3,J,4,2,"div",3)),2&e&&(o.hc("ngIf",t.showToolbar),o.yb(1),o.hc("ngIf",!t.data),o.yb(1),o.hc("ngIf",!t.showToolbar&&t.baseData),o.yb(1),o.hc("ngIf",t.data))},directives:[d.t,f.a,u.s,d.q,u.f,S,Z.a,m.a,z.a],encapsulation:2}),e})();var ee=i("Ljk9"),te=i("l2bN");function ie(e,t){if(1&e&&(o.Ob(0,"div",5),o.Ob(1,"div",6),o.Ob(2,"b"),o.Fc(3),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Zb();o.yb(3),o.Gc(e.item.name)}}function ae(e,t){if(1&e&&(o.Ob(0,"div",5),o.Ob(1,"div",7),o.Lb(2,"ngx-md",8),o.Nb(),o.Nb()),2&e){const e=o.Zb();o.yb(2),o.hc("data",e.item.description)}}let ne=(()=>{class e{constructor(){this.isMaximized=!1,this.onMaximize=new o.n,this.eDataObjectType=r.lb}ngOnInit(){}maximize(e){this.onMaximize.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Eb({type:e,selectors:[["preview-dashboard-item"]],inputs:{hubKey:"hubKey",item:"item",refreshData:"refreshData",isMaximized:"isMaximized",parentParameters:"parentParameters"},outputs:{onMaximize:"onMaximize"},decls:7,vars:7,consts:[[1,"box"],["class","box-header",4,"ngIf"],["DexihMessage",""],[1,"box-content"],[3,"hubKey","parentParameters","objectType","objectKey","showToolbar","onMaximize"],[1,"box-header"],[1,"p-3","bg-secondary","text-white"],[1,"m-1"],[3,"data"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Dc(1,ie,4,1,"div",1),o.Dc(2,ae,3,1,"div",1),o.Lb(3,"dexih-message",null,2),o.Ob(5,"div",3),o.Ob(6,"preview-data",4),o.Vb("onMaximize",(function(e){return t.maximize(e)})),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.yb(1),o.hc("ngIf",t.item.header),o.yb(1),o.hc("ngIf",t.item.description),o.yb(4),o.hc("hubKey",t.hubKey)("parentParameters",t.parentParameters)("objectType",t.eDataObjectType.DashboardItem)("objectKey",t.item.key)("showToolbar",!0))},directives:[d.t,l.a,Y,te.a],styles:[".box[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:100%}.box[_ngcontent-%COMP%]   .box-header[_ngcontent-%COMP%]{flex:0 1 auto}.box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{flex:1 1 auto}"]}),e})();const se=["DexihMessage"];function re(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-button-refresh",7),o.Vb("click",(function(){return o.vc(e),o.Zb().refresh()})),o.Nb(),o.Ob(1,"dexih-button-edit",8),o.Vb("click",(function(){return o.vc(e),o.Zb().edit()})),o.Nb()}}function oe(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",9),o.Ob(1,"input-parameters-view",10),o.Vb("onRefreshData",(function(){return o.vc(e),o.Zb().refresh()}))("onChange",(function(){return o.vc(e),o.Zb().parameterChange()})),o.Nb(),o.Nb()}if(2&e){const e=o.Zb();o.yb(1),o.hc("hubKey",e.hubKey)("objectType",e.eDataObjectType.Dashboard)("objectKey",e.dashboardKey)("parameters",e.parameters)("refreshEvent",e.refreshDataSubject.asObservable())}}const ce=function(e,t,i,a,n){return{x:e,y:t,cols:i,rows:a,control:n}},be=function(e){return{maximize:e}};function he(e,t){if(1&e){const e=o.Pb();o.Ob(0,"gridster-item",14),o.Ob(1,"preview-dashboard-item",15),o.Vb("onMaximize",(function(i){o.vc(e);const a=t.index;return o.Zb(2).maximize(i,a)})),o.Nb(),o.Nb()}if(2&e){const e=t.$implicit,i=t.index,a=o.Zb(2);o.hc("item",o.qc(6,ce,e.x,e.y,e.cols,e.rows,e))("ngClass",o.mc(12,be,i===a.maximizedIndex))("hidden",a.maximizedIndex>=0&&i!==a.maximizedIndex),o.yb(1),o.hc("hubKey",a.hubKey)("item",e)("parentParameters",a.parameters)}}function le(e,t){if(1&e&&(o.Ob(0,"gridster",11,12),o.Dc(2,he,2,14,"gridster-item",13),o.Nb()),2&e){const e=o.Zb();o.hc("options",e.options),o.yb(2),o.hc("ngForOf",e.dashboard.dexihDashboardItems)}}let ue=(()=>{class e{constructor(e,t,i){this.authService=e,this.router=t,this.route=i,this.refreshDataSubject=new I.a,this.name="loading...",this.eDataObjectType=r.lb,this.dashboard=null,this.cancelToken=new s.a}ngOnInit(){try{this._subscription=Object(a.a)(this.route.params,this.authService.getSharedDataIndex("",[],50,!1)).subscribe(e=>{let t=e[0];this.hubKey=+t.hubKey,this.dashboardKey=+t.dashboardKey,this.refresh()})}catch(e){this.dexihMessage.addMessage(e)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}parameterChange(){this.refresh()}refresh(){this.authService.getDashboard(this.hubKey,this.dashboardKey).then(e=>{this.refreshDataSubject.next(),this.setOptions(e),this.dashboard=e,this.name=e.name,this.parameters||(this.parameters=e.parameters)}).catch(e=>{this.dexihMessage.addMessage(e),this.dashboard=null})}setOptions(e){this.options={gridType:ee.c.ScrollVertical,compactType:ee.a.None,margin:5,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,mobileBreakpoint:640,minCols:e.minCols,maxCols:e.maxCols,minRows:e.minRows,maxRows:e.maxRows,maxItemCols:100,minItemCols:1,maxItemRows:100,minItemRows:1,maxItemArea:2500,minItemArea:1,defaultItemCols:2,defaultItemRows:2,fixedColWidth:105,fixedRowHeight:105,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{enabled:!1},resizable:{enabled:!1},swap:!1,pushItems:!0,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:ee.b.None,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,itemChangeCallback:(e,t)=>{this.itemResize(e,t)},itemResizeCallback:(e,t)=>{this.itemResize(e,t)},itemInitCallback:(e,t)=>{this.itemResize(e,t)}}}maximize(e,t){this.maximizedIndex=e?t:-1}itemResize(e,t){}edit(){this.router.navigate(["hub",this.hubKey,"dashboards","dashboard-edit",this.dashboardKey])}}return e.\u0275fac=function(t){return new(t||e)(o.Kb(c.a),o.Kb(b.e),o.Kb(b.a))},e.\u0275cmp=o.Eb({type:e,selectors:[["preview-dashboard"]],viewQuery:function(e,t){var i;1&e&&o.Bc(se,!0),2&e&&o.rc(i=o.Wb())&&(t.dexihMessage=i.first)},decls:10,vars:4,consts:[[1,"container-fluid"],["DexihMessage",""],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","close"],["header",""],["class","m-3",4,"ngIf"],[2,"height","800px"],[3,"ngIf"],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[1,"m-3"],[3,"hubKey","objectType","objectKey","parameters","refreshEvent","onRefreshData","onChange"],[3,"options"],["gridster",""],[3,"item","ngClass","hidden",4,"ngFor","ngForOf"],[3,"item","ngClass","hidden"],[3,"hubKey","item","parentParameters","onMaximize"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Lb(1,"dexih-message",null,1),o.Ob(3,"dexih-widget",2),o.Vb("close",(function(){return t.close()})),o.Dc(4,re,2,0,"ng-template",null,3,o.Ec),o.Dc(6,oe,2,5,"div",4),o.Ob(7,"div"),o.Ob(8,"div",5),o.Dc(9,le,3,2,"ng-template",6),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.yb(3),o.hc("title","Preview "+t.name)("showCloseButton",!0),o.yb(3),o.hc("ngIf",t.parameters),o.yb(3),o.hc("ngIf",t.dashboard))},directives:[l.a,u.P,d.t,u.s,u.j,S,ee.d,d.s,ee.e,d.q,ne],styles:[".maximize[_ngcontent-%COMP%]{height:calc(100%)!important;width:calc(100%)!important;top:0!important;left:0!important;right:0!important;bottom:0!important;transform:translateZ(0)!important;z-index:999}"]}),e})();const de=["DexihMessage"],me=["PreviewData"];function fe(e,t){if(1&e){const e=o.Pb();o.Ob(0,"dexih-button-refresh",7),o.Vb("click",(function(){return o.vc(e),o.Zb(2).previewData.refresh()})),o.Nb(),o.Ob(1,"download-button",8),o.Vb("download",(function(t){return o.vc(e),o.Zb(2).previewData.downloadData(t)})),o.Nb(),o.Ob(2,"dexih-button-edit",9),o.Vb("click",(function(){return o.vc(e),o.Zb(2).edit()})),o.Nb()}}function ge(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",2),o.Ob(1,"dexih-widget",3),o.Vb("close",(function(){return o.vc(e),o.Zb().close()})),o.Dc(2,fe,3,0,"ng-template",null,4,o.Ec),o.Lb(4,"preview-data",5,6),o.Nb(),o.Nb()}if(2&e){const e=o.Zb();o.yb(1),o.hc("title","Preview "+e.title)("showCloseButton",!0)("padding",!1),o.yb(3),o.hc("hubKey",e.hubKey)("objectType",e.objectType)("objectKey",e.objectKey)("parameters",e.parameters)("updateQueryParameters",!0)}}function pe(e,t){if(1&e&&(o.Ob(0,"div"),o.Lb(1,"preview-data",5),o.Nb()),2&e){const e=o.Zb();o.yb(1),o.hc("hubKey",e.hubKey)("objectType",e.objectType)("objectKey",e.objectKey)("parameters",e.parameters)("updateQueryParameters",!1)}}let ye=(()=>{class e{constructor(e,t,i){this.authService=e,this.route=t,this.router=i,this.embed=!1,this.title=""}ngOnInit(){try{this._subscription=Object(a.a)(this.route.params,this.route.queryParams).subscribe(e=>{let t=e[0],i=e[1];this.hubKey=+t.hubKey,this.objectType=+t.objectType,this.objectKey=+t.objectKey,"true"===i.embed&&(this.embed=!0)})}catch(e){this.dexihMessage.addMessage(e)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}ngAfterContentChecked(){this.previewData&&(this.title=this.previewData.name)}close(){this.authService.navigateUp()}edit(){switch(this.objectType){case r.lb.Datalink:this.router.navigate(["hub",this.hubKey,"datalinks","datalink-edit","edit",this.objectKey]);break;case r.lb.Table:this.router.navigate(["hub",this.hubKey,"tables","table-edit",this.objectKey]);break;case r.lb.View:this.router.navigate(["hub",this.hubKey,"views","view-edit",this.objectKey])}}}return e.\u0275fac=function(t){return new(t||e)(o.Kb(c.a),o.Kb(b.a),o.Kb(b.e))},e.\u0275cmp=o.Eb({type:e,selectors:[["preview"]],viewQuery:function(e,t){var i;1&e&&(o.Bc(de,!0),o.Kc(me,!0)),2&e&&(o.rc(i=o.Wb())&&(t.dexihMessage=i.first),o.rc(i=o.Wb())&&(t.previewData=i.first))},decls:2,vars:2,consts:[["class","container-fluid",4,"ngIf"],[4,"ngIf"],[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","padding","close"],["header",""],[3,"hubKey","objectType","objectKey","parameters","updateQueryParameters"],["PreviewData",""],["text","Reload",1,"mr-1",3,"click"],[1,"ml-1",3,"download"],[1,"ml-1",3,"click"]],template:function(e,t){1&e&&(o.Dc(0,ge,6,8,"div",0),o.Dc(1,pe,2,5,"div",1)),2&e&&(o.hc("ngIf",!t.embed),o.yb(1),o.hc("ngIf",t.embed))},directives:[d.t,u.P,Y,u.s,f.a,u.j],encapsulation:2}),e})()}}]);
//# sourceMappingURL=7-es2015.6629782376169fa10b7c.js.map