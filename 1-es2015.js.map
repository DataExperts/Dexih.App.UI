{"version":3,"sources":["./src/app/+hub/table/table-edit/table-column-edit/table-column-edit.component.ts","./src/app/+hub/table/table-edit/table-column-edit/table-column-edit.component.html","./src/app/+hub/table/table-edit/table-edit-main.component.ts","./src/app/+hub/table/table-edit/table-edit-main.component.html","./src/app/+hub/table/table-edit/table-edit.component.ts","./src/app/+hub/table/table-edit/table-edit.component.html","./src/app/+hub/table/table-edit/table-edit.module.ts","./src/app/+hub/table/table-edit/table-edit.routing.ts"],"names":[],"mappings":"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","file":"1-es2015.js","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { AuthService } from '../../../../+auth/auth.service';\nimport { HubService } from '../../../hub.service';\nimport { Location } from '@angular/common';\nimport { FormGroup } from '@angular/forms';\nimport { Subscription, combineLatest} from 'rxjs';\nimport { HubFormsService } from '../../../hub.forms.service';\n\n@Component({\n    selector: 'dexih-table-column-edit',\n    templateUrl: './table-column-edit.component.html',\n})\nexport class TableColumnEditComponent implements OnInit, OnDestroy {\n    private _subscription: Subscription;\n\n    public tableForm: FormGroup;\n    public columnKey: number;\n    public detailedView = true;\n\n    public pageTitle: string;\n    public action: string;\n\n\n    constructor(\n        private authService: AuthService,\n        private hubService: HubService,\n        public formService: HubFormsService,\n        private route: ActivatedRoute,\n        private router: Router        ) {\n    }\n\n    ngOnInit() {\n\n        try {\n            this._subscription = combineLatest(\n                this.route.data,\n                this.route.params,\n                this.route.queryParams,\n                this.formService.getCurrentFormObservable()\n            ).subscribe(result => {\n                let data = result[0];\n                let params = result[1];\n                let queryParams = result[2];\n                this.tableForm = result[3];\n\n                this.pageTitle = data['pageTitle'];\n                this.action = data['action'];\n\n                this.columnKey = +params['columnKey'];\n                this.detailedView = queryParams['detailed'] === 'false' ? false : true;\n            });\n        } catch (e) {\n            this.hubService.addHubClientErrorMessage(e, 'Table Column Edit');\n        }\n\n    }\n\n    ngOnDestroy() {\n        if (this._subscription) { this._subscription.unsubscribe(); }\n    }\n\n    isUpdated() {\n        this.authService.navigateUp();\n    }\n\n    changeColumn(columnKey: number) {\n        this.router.navigate(['column', columnKey], {relativeTo: this.route.parent});\n    }\n\n}\n","<column-edit [tableForm]=\"tableForm\" [columnKey]=\"columnKey\" [detailedView]=\"detailedView\" (isUpdated)=\"isUpdated()\" (changeColumn)=\"changeColumn($event)\"></column-edit>\n\n ","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { HubFormsService } from '../../hub.forms.service';\n\n@Component({\n  selector: 'dexih-table-edit-form',\n  templateUrl: './table-edit-main.component.html'\n})\nexport class TableEditMainComponent implements OnInit, OnDestroy {\n\n  constructor(\n    public formsService: HubFormsService,\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ngOnDestroy() {\n  }\n}\n","<dexih-table-edit-properties [formsService]='formsService'></dexih-table-edit-properties>\n<table-edit-columns [tableForm]='formsService.currentForm'></table-edit-columns>\n","import { HostListener, Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute, Router, Params } from '@angular/router';\nimport { HubService } from '../../hub.service';\nimport { AuthService } from '../../../+auth/auth.service';\nimport { Subscription, combineLatest} from 'rxjs';\nimport { HubFormsService } from '../../hub.forms.service';\nimport { DexihConnection, eConnectionCategory, DexihTable } from '../../../shared/shared.models';\nimport { HubCache, eCacheStatus } from '../../hub.models';\nimport { CancelToken } from '../../../+auth/auth.models';\n\n@Component({\n  selector: 'dexih-table-edit-form',\n  templateUrl: './table-edit.component.html'\n})\nexport class TableEditComponent implements OnInit, OnDestroy {\n  public tableKey: number;\n  public connectionKey: number;\n  public connection: DexihConnection;\n\n  eConnectionCategory = eConnectionCategory;\n\n  private hubCache: HubCache;\n  public action: string; // new or edit\n  public pageTitle: string;\n  public params: Params;\n\n  public cancelToken: CancelToken = new CancelToken();\n\n  private _subscription: Subscription;\n  private _hubCacheChangeSubscription: Subscription;\n  private _formChangeSubscription: Subscription;\n  private isLoaded = false;\n\n\n  constructor(private hubService: HubService,\n    public formsService: HubFormsService,\n    private authService: AuthService,\n    private route: ActivatedRoute,\n    private router: Router) {\n  }\n\n  ngOnInit() {\n    try {\n      this._subscription = combineLatest(\n        this.route.data,\n        this.route.params,\n        this.hubService.getHubCacheObservable(),\n      ).subscribe(result => {\n        let data = result[0];\n        this.params = result[1];\n        this.hubCache = result[2];\n\n        this.action = data['action'];\n        this.pageTitle = data['pageTitle'];\n\n        if (!this.hubCache || this.hubCache.status !== eCacheStatus.Loaded ) { return; }\n\n        if (this.isLoaded && this.action === 'new') { return; }\n\n        if (this.isLoaded && this.formsService.hasChanged) {\n            this.authService.confirmDialog('Synchronization warning',\n            'The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?')\n            .then(confirm => {\n                if (confirm) {\n                    this.load();\n                }\n            }).catch(reason => {\n                return;\n            });\n        } else {\n            this.load();\n        }\n\n      });\n    } catch (e) {\n      this.hubService.addHubClientErrorMessage(e, 'Table Edit');\n    }\n  }\n\n  ngOnDestroy() {\n    if (this._hubCacheChangeSubscription) { this._hubCacheChangeSubscription.unsubscribe(); }\n    if (this._formChangeSubscription) { this._formChangeSubscription.unsubscribe(); }\n    if (this._subscription) { this._subscription.unsubscribe(); }\n    this.cancelToken.cancel();\n\n    // shut down service\n    this.formsService.ngOnDestroy();\n  }\n\n  load() {\n    this.isLoaded = true;\n\n    if (this.action === 'edit') {\n      // get the hub key from the route data, and update the service.\n      this.tableKey = + this.params['tableKey'];\n\n      if (!this.tableKey) {\n        this.hubService.addHubErrorMessage('There was no table specified to edit.');\n      } else {\n        if (!this.hubCache.hub || !this.hubCache.hub.dexihDatajobs) {\n          this.hubService.addHubErrorMessage('The hub cache is not loaded.');\n        } else {\n\n          let table = this.hubCache.getTable(this.tableKey);\n          if (!table) {\n            this.hubService.addHubErrorMessage('The specified table could not be found.');\n          } else {\n            this.connection = this.hubCache.getConnection(table.connectionKey);\n            this.formsService.table(table);\n          }\n        }\n      }\n    }\n\n    if (this.action === 'new') {\n      let table: DexihTable;\n      if (this.hubService.newTable) {\n        table = this.hubService.newTable;\n        this.hubService.newTable = null;\n      } else {\n        this.connectionKey = + this.params['connectionKey'];\n\n        table = new DexihTable();\n        table.key = 0;\n        table.connectionKey = this.connectionKey;\n      }\n      this.formsService.table(table);\n\n      // update the url with the saved key\n      this._formChangeSubscription = this.formsService.getCurrentFormObservable().subscribe(tableForm => {\n        let key = tableForm.controls.key.value;\n        if (key) {\n          if (history.pushState) {\n            let newUrl = window.location.pathname.replace('/table-new', `/table-edit/${key}`)\n            this.router.navigateByUrl(newUrl);\n            this._formChangeSubscription.unsubscribe();\n          }\n        }\n      });\n    }\n  }\n\n  close() {\n    this.authService.navigateUp();\n  }\n\n  changedTables(tables) {\n    this.formsService.table(tables[0]);\n  }\n\n  createPaths() {\n    this.hubService.createPaths(this.formsService.currentForm.value, this.cancelToken).then(() => {\n      this.hubService.addHubSuccessMessage('The paths have been created.');\n    }).catch();\n  }\n\n\n  public canDeactivate(): Promise<boolean> {\n    return new Promise<boolean>((resolve) => {\n      if (this.formsService.hasChanged) {\n        this.authService.confirmDialog('The table has not been saved',\n          'The table changes have not been saved.  Do you want to discard the changes and exit?')\n          .then((confirm) => {\n              resolve(confirm);\n            }).catch(() => {\n              resolve(false);\n            });\n      } else {\n        resolve(true);\n      }\n    });\n  }\n\n  // @HostListener allows is to guard against browser refresh, close, etc.\n  @HostListener('window:beforeunload', ['$event'])\n  unloadNotification($event: any) {\n    if (this.formsService.hasChanged) {\n      $event.returnValue = 'The table changes have not been saved.  Do you want to discard the changes and exit?';\n    }\n  }\n}\n","\n<div class=\"container-fluid\">\n    <dexih-widget \n    [title]=\"'Edit Table ('  + formsService.currentForm?.controls?.name?.value +')'\" \n    iconClass=\"fa fa-lg fa-fw fa-table\" \n    [showCloseButton]=\"true\"\n    (close)=\"close()\"\n    >\n        <ng-template #header>\n            <dexih-invalid-form-details class=\"mr-1\" [control]=\"formsService.currentForm\" (click)=\"formsService.showErrors()\"></dexih-invalid-form-details>\n            <actions-table-button class=\"mr-1\" [showEdit]=\"false\" [tables]=\"this.formsService?.currentForm?.value ? [this.formsService?.currentForm?.value] : []\" (changedTables)=\"changedTables($event)\"></actions-table-button>\n            <dexih-button class=\"mr-1\" *ngIf=\"hubCache?.canWrite && connectionReference?.connectionCategory == eConnectionCategory.File\" \n            (click)=\"createPaths()\" title=\"Create the file paths (or folders).\" iconClass=\"fa fa-folder-open\" buttonClass='btn-primary'>\n                Create Paths\n            </dexih-button>\n            <save-button class=\"mr-1\" *ngIf=\"hubCache?.canWrite\" [formsService]=\"formsService\"></save-button>\n            <cancel-button [formsService]=\"formsService\"></cancel-button>\n        </ng-template>\n\n        <div>\n        <router-outlet></router-outlet>\n    </div>\n    </dexih-widget>\n</div>\n\n\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SharedModule } from '../../../shared/shared.module';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Routing } from './table-edit.routing';\nimport { TableEditComponent } from './table-edit.component';\nimport { TableEditMainComponent } from './table-edit-main.component';\nimport { HubSharedModule } from '../../hub.shared.module';\nimport { ItemEditGuard } from '../../item-edit.guard';\nimport { HubFormsService } from '../../hub.forms.service';\nimport { TableColumnEditComponent } from './table-column-edit/table-column-edit.component';\nimport { TableSharedModule } from '../table.shared.module';\n\n@NgModule({\n    imports: [\n        SharedModule,\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        Routing,\n        HubSharedModule,\n        TableSharedModule\n    ],\n    declarations: [\n      TableEditComponent,\n      TableEditMainComponent,\n      TableColumnEditComponent,\n    ],\n    providers: [\n        HubFormsService,\n        ItemEditGuard\n        ],\n    exports: [\n    ]\n})\nexport class TableEditModule {\n    static forRoot(): ModuleWithProviders<TableEditModule> {\n        return {\n            ngModule: TableEditModule,\n            providers: [ HubFormsService ]\n        };\n    }\n}\n","import { Routes, RouterModule } from '@angular/router';\nimport { TableEditComponent } from './table-edit.component';\nimport { TableColumnEditComponent } from './table-column-edit/table-column-edit.component';\nimport { ItemEditGuard } from '../../item-edit.guard';\nimport { TableEditPreviewDataComponent } from './table-edit-preview-data';\nimport { TableEditMainComponent } from './table-edit-main.component';\nimport { FileFormatEditComponent } from '../../fileFormat';\n\nexport const tableEditRoutes = [\n        { path: '', redirectTo: 'properties'},\n        { path: 'properties', component: TableEditMainComponent,  data: { navigateSkip: true} },\n        { path: 'column', component: TableColumnEditComponent, data: { pageTitle: 'Edit Column' } },\n        { path: 'column/:columnKey', component: TableColumnEditComponent, data: { pageTitle: 'Edit Column' } },\n        { path: 'table-preview/:tableKey', component: TableEditPreviewDataComponent, data: { pageTitle: 'Preview' } },\n        { path: 'fileFormat-new', component: FileFormatEditComponent, data: { action: 'new', pageTitle: 'New File Format'}},\n];\n\nexport const routes: Routes = [\n        { path: '', component: TableEditComponent, canDeactivate: [ItemEditGuard], children: tableEditRoutes},\n];\n\nexport const Routing = RouterModule.forChild(routes);\n"],"sourceRoot":"webpack:///"}