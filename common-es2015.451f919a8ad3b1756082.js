(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{M0ag:function(e,t,i){"use strict";var r=i("PCNd");i.d(t,"a",(function(){return r.a}))},d2yJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i("3Pt+"),s=i("2Vo4"),a=i("Kj3r"),n=i("fXoL");let o=(()=>{class e{constructor(e){this.fb=e,this._currentFormObservable=new s.a(null),this.formErrors={},this.hasChanged=!1,this.formSaving=!1,this.showAllErrors=!1,this.validationMessages={required:"A value is required.",duplicateName:"The value is already being used."},this.validationFieldMessages={}}ngOnDestroy(){this.clearFormSubscriptions()}clearFormSubscriptions(){this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._changesSubscription1&&this._changesSubscription1.unsubscribe(),this._changesSubscription2&&this._changesSubscription2.unsubscribe(),this._changesSubscription3&&this._changesSubscription3.unsubscribe(),this._changesSubscription4&&this._changesSubscription4.unsubscribe(),this._changesSubscription5&&this._changesSubscription5.unsubscribe()}createDefault(e,t){const i=this.fb.group({});this.addMissing(e,i,t),this.startForm(i)}addMissing(e,t,i){let s=Object.keys(i),a=Object.keys(t.controls);s.forEach(i=>{if(a.findIndex(e=>e===i)>=0);else{let s=new r.h(i);s.setValue(e[i]),t.addControl(i,s)}})}startForm(e){this.currentForm=e,this._currentFormObservable.next(e),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.currentForm.valueChanges.pipe(Object(a.a)(500)).subscribe(e=>{this.onValueChanged(e)}),this.onValueChanged(),this.hasChanged=!1}getCurrentFormObservable(){return this._currentFormObservable.asObservable()}onValueChanged(e){if(!this.currentForm)return;const t=this.currentForm;this.hasChanged=!0;for(const i of Object.keys(this.currentForm.controls)){this.formErrors[i]="";const e=t.get(i);if(e&&(e.dirty||this.showAllErrors)&&!e.valid){const t=this.validationFieldMessages[i];if(e.errors)for(const r of Object.keys(e.errors))if(t&&t[r])this.formErrors[i]+=t[r]+" ";else if(this.validationMessages[r])this.formErrors[i]+=this.validationMessages[r]+" ";else{let t;switch(r){case"minlength":t="Value is "+e.errors.minlength.actualLength+" charaters long, required minimum length is "+e.errors.minlength.requiredLength+" characters.";break;case"maxlength":t="Value is "+e.errors.maxlength.actualLength+" charaters long, required maximum length is "+e.errors.maxlength.requiredLength+" characters.";break;case"maxvalue":t="Value is "+e.value+" required maximum is "+e.errors.maxvalue.requiredValue+".";break;case"minvalue":t="Value is "+e.value+" required minimum is "+e.errors.minvalue.requiredValue+".";break;case"email":t="Value is not a valid email address.";break;case"passwordMatch":t="The passwords do not match.";break;case"pattern":t="Passwords must have one upper, lower, number, and symbol.";break;default:t="Field error: "+r}this.formErrors[i]+=t+" "}}}}showErrors(){this.showAllErrors=!0,this.onValueChanged()}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(r.g))},e.\u0275prov=n.Gb({token:e,factory:e.\u0275fac}),e})()},gQFH:function(e,t,i){"use strict";i.r(t),i.d(t,"TableEditModule",(function(){return j}));var r=i("ofXK"),s=i("PCNd"),a=i("3Pt+"),n=i("tyNb"),o=i("4Y1E"),c=i("ElCs"),h=i("itXk"),u=i("cvPx"),l=i("soiQ"),b=i("2v7R"),d=i("3WyZ"),m=i("fXoL"),v=i("Wumg"),f=i("iFLP"),g=i("Wz3H"),p=i("64E1"),S=i("oLr2");function C(e,t){if(1&e){const e=m.Pb();m.Ob(0,"dexih-button",8),m.Vb("click",(function(){return m.vc(e),m.Zb(2).createPaths()})),m.Fc(1," Create Paths "),m.Nb()}}function y(e,t){if(1&e&&m.Lb(0,"save-button",9),2&e){const e=m.Zb(2);m.hc("formsService",e.formsService)}}const w=function(e){return[e]},F=function(){return[]};function T(e,t){if(1&e){const e=m.Pb();m.Ob(0,"dexih-invalid-form-details",3),m.Vb("click",(function(){return m.vc(e),m.Zb().formsService.showErrors()})),m.Nb(),m.Ob(1,"actions-table-button",4),m.Vb("changedTables",(function(t){return m.vc(e),m.Zb().changedTables(t)})),m.Nb(),m.Dc(2,C,2,0,"dexih-button",5),m.Dc(3,y,1,1,"save-button",6),m.Lb(4,"cancel-button",7)}if(2&e){const e=m.Zb();m.hc("control",e.formsService.currentForm),m.yb(1),m.hc("showEdit",!1)("tables",null!=e.formsService&&null!=e.formsService.currentForm&&e.formsService.currentForm.value?m.mc(6,w,null==e.formsService||null==e.formsService.currentForm?null:e.formsService.currentForm.value):m.lc(8,F)),m.yb(1),m.hc("ngIf",(null==e.hubCache?null:e.hubCache.canWrite)&&(null==e.connectionReference?null:e.connectionReference.connectionCategory)==e.eConnectionCategory.File),m.yb(1),m.hc("ngIf",null==e.hubCache?null:e.hubCache.canWrite),m.yb(1),m.hc("formsService",e.formsService)}}let E=(()=>{class e{constructor(e,t,i,r,s){this.hubService=e,this.formsService=t,this.authService=i,this.route=r,this.router=s,this.eConnectionCategory=l.ib,this.cancelToken=new d.a,this.isLoaded=!1}ngOnInit(){try{this._subscription=Object(h.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===b.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Table Edit")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel(),this.formsService.ngOnDestroy()}load(){if(this.isLoaded=!0,"edit"===this.action)if(this.tableKey=+this.params.tableKey,this.tableKey)if(this.hubCache.hub&&this.hubCache.hub.dexihDatajobs){let e=this.hubCache.getTable(this.tableKey);e?(this.connection=this.hubCache.getConnection(e.connectionKey),this.formsService.table(e)):this.hubService.addHubErrorMessage("The specified table could not be found.")}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no table specified to edit.");if("new"===this.action){let e;this.hubService.newTable?(e=this.hubService.newTable,this.hubService.newTable=null):(this.connectionKey=+this.params.connectionKey,e=new l.H,e.key=0,e.connectionKey=this.connectionKey),this.formsService.table(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/table-new","/table-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}}close(){this.authService.navigateUp()}changedTables(e){this.formsService.table(e[0])}createPaths(){this.hubService.createPaths(this.formsService.currentForm.value,this.cancelToken).then(()=>{this.hubService.addHubSuccessMessage("The paths have been created.")}).catch()}canDeactivate(){return new Promise(e=>{this.formsService.hasChanged?this.authService.confirmDialog("The table has not been saved","The table changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.formsService.hasChanged&&(e.returnValue="The table changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(o.a),m.Kb(u.a),m.Kb(c.a),m.Kb(n.a),m.Kb(n.e))},e.\u0275cmp=m.Eb({type:e,selectors:[["dexih-table-edit-form"]],hostBindings:function(e,t){1&e&&m.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,m.uc)},decls:6,vars:2,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","close"],["header",""],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"showEdit","tables","changedTables"],["class","mr-1","title","Create the file paths (or folders).","iconClass","fa fa-folder-open","buttonClass","btn-primary",3,"click",4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],["title","Create the file paths (or folders).","iconClass","fa fa-folder-open","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"formsService"]],template:function(e,t){1&e&&(m.Ob(0,"div",0),m.Ob(1,"dexih-widget",1),m.Vb("close",(function(){return t.close()})),m.Dc(2,T,5,9,"ng-template",null,2,m.Ec),m.Ob(4,"div"),m.Lb(5,"router-outlet"),m.Nb(),m.Nb(),m.Nb()),2&e&&(m.yb(1),m.hc("title","Edit Table ("+(null==t.formsService.currentForm||null==t.formsService.currentForm.controls||null==t.formsService.currentForm.controls.name?null:t.formsService.currentForm.controls.name.value)+")")("showCloseButton",!0))},directives:[v.P,n.j,f.a,g.a,r.t,p.a,v.f,S.a],encapsulation:2}),e})();var O=i("dn85");let K=(()=>{class e{constructor(e,t,i,r,s){this.authService=e,this.hubService=t,this.formService=i,this.route=r,this.router=s,this.detailedView=!0}ngOnInit(){try{this._subscription=Object(h.a)(this.route.data,this.route.params,this.route.queryParams,this.formService.getCurrentFormObservable()).subscribe(e=>{let t=e[0],i=e[1],r=e[2];this.tableForm=e[3],this.pageTitle=t.pageTitle,this.action=t.action,this.columnKey=+i.columnKey,this.detailedView="false"!==r.detailed})}catch(e){this.hubService.addHubClientErrorMessage(e,"Table Column Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}isUpdated(){this.authService.navigateUp()}changeColumn(e){this.router.navigate(["column",e],{relativeTo:this.route.parent})}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(c.a),m.Kb(o.a),m.Kb(u.a),m.Kb(n.a),m.Kb(n.e))},e.\u0275cmp=m.Eb({type:e,selectors:[["dexih-table-column-edit"]],decls:1,vars:3,consts:[[3,"tableForm","columnKey","detailedView","isUpdated","changeColumn"]],template:function(e,t){1&e&&(m.Ob(0,"column-edit",0),m.Vb("isUpdated",(function(){return t.isUpdated()}))("changeColumn",(function(e){return t.changeColumn(e)})),m.Nb()),2&e&&m.hc("tableForm",t.tableForm)("columnKey",t.columnKey)("detailedView",t.detailedView)},directives:[O.a],encapsulation:2}),e})();var _=i("bK5D"),k=i("taGP"),x=i("Qrk8"),V=i("vDxl");let P=(()=>{class e{constructor(e){this.formsService=e}ngOnInit(){}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(u.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["dexih-table-edit-form"]],decls:2,vars:2,consts:[[3,"formsService"],[3,"tableForm"]],template:function(e,t){1&e&&(m.Lb(0,"dexih-table-edit-properties",0),m.Lb(1,"table-edit-columns",1)),2&e&&(m.hc("formsService",t.formsService),m.yb(1),m.hc("tableForm",t.formsService.currentForm))},directives:[x.a,V.a],encapsulation:2}),e})();var D=i("NUI7");const L=n.i.forChild([{path:"",component:E,canDeactivate:[_.a],children:[{path:"",redirectTo:"properties"},{path:"properties",component:P,data:{navigateSkip:!0}},{path:"column",component:K,data:{pageTitle:"Edit Column"}},{path:"column/:columnKey",component:K,data:{pageTitle:"Edit Column"}},{path:"table-preview/:tableKey",component:k.a,data:{pageTitle:"Preview"}},{path:"fileFormat-new",component:D.a,data:{action:"new",pageTitle:"New File Format"}}]}]);var N=i("RRRx"),M=i("vSNy");let j=(()=>{class e{static forRoot(){return{ngModule:e,providers:[u.a]}}}return e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({factory:function(t){return new(t||e)},providers:[u.a,_.a],imports:[[s.a,r.c,a.n,a.C,L,N.a,M.a]]}),e})()},taGP:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i("4Y1E"),s=i("ElCs"),a=i("itXk"),n=i("cvPx"),o=i("soiQ"),c=i("fXoL"),h=i("tyNb"),u=i("Wumg"),l=i("NHAS");function b(e,t){if(1&e){const e=c.Pb();c.Ob(0,"dexih-button-close",3),c.Vb("click",(function(){return c.vc(e),c.Zb().close()})),c.Nb()}}let d=(()=>{class e{constructor(e,t,i,r){this.formsService=e,this.hubService=t,this.authService=i,this.route=r,this.eDataObjectType=o.lb}ngOnInit(){try{this._subscription=Object(a.a)(this.route.data,this.hubService.getHubCacheObservable(),this.formsService.getCurrentFormObservable()).subscribe(e=>{let t=e[0],i=e[2];this.action=t.action,this.pageTitle=t.pageTitle,i&&(this.table=i.value)})}catch(e){this.hubService.addHubClientErrorMessage(e,"Table Edit Preview")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(c.Kb(n.a),c.Kb(r.a),c.Kb(s.a),c.Kb(h.a))},e.\u0275cmp=c.Eb({type:e,selectors:[["table-edit-preview-data"]],decls:4,vars:4,consts:[["title","Preview Table",3,"showExpandButton","padding"],["header",""],[3,"table","viewSource"],[3,"click"]],template:function(e,t){1&e&&(c.Ob(0,"dexih-widget-section",0),c.Dc(1,b,1,0,"ng-template",null,1,c.Ec),c.Lb(3,"preview-data",2),c.Nb()),2&e&&(c.hc("showExpandButton",!1)("padding",!1),c.yb(3),c.hc("table",t.table)("viewSource",t.eDataObjectType.Table))},directives:[u.T,l.a,u.d],encapsulation:2}),e})()}}]);