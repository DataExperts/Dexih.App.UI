{"version":3,"sources":["webpack:///src/app/+hub/test/datalinkTest-edit/datalinkTest-edit-guard.ts","webpack:///src/app/+hub/test/datalinkTest-edit/datalinkTest-edit.component.ts","webpack:///src/app/+hub/test/datalinkTest-edit/datalinkTest-edit.component.html","webpack:///src/app/+hub/test/datalinkTest-edit/datalinkTest-edit.module.ts","webpack:///src/app/+hub/test/datalinkTest-edit/datalinkTest-edit.routing.ts","webpack:///src/app/+hub/test/datalinkTest-edit/properties/datalinkTest-properties.component.ts","webpack:///src/app/+hub/test/datalinkTest-edit/properties/datalinkTest-properties.component.html","webpack:///src/app/+hub/test/datalinkTest-edit/step-edit/datalinkTest-edit-step.component.ts","webpack:///src/app/+hub/test/datalinkTest-edit/step-edit/datalinkTest-edit-step.component.html"],"names":["DatalinkTestEditGuard","component","canDeactivate","formsService","DatalinkTestEditComponent","hubService","authService","route","router","isLoaded","_subscription","data","params","getHubCacheObservable","subscribe","result","hubCache","action","pageTitle","status","Loaded","hasChanged","confirmDialog","then","confirm","load","reason","e","addHubClientErrorMessage","_hubCacheChangeSubscription","unsubscribe","_formChangeSubscription","ngOnDestroy","datalinkTestKey","addHubErrorMessage","hub","dexihDatalinkTests","datalinkTest","find","c","key","getCurrentFormObservable","form","controls","value","history","pushState","newUrl","window","location","pathname","replace","navigateByUrl","Promise","resolve","$event","returnValue","selector","templateUrl","unloadNotification","DatalinkTestEditModule","ngModule","providers","imports","declarations","exports","editRoutes","path","redirectTo","navigateSkip","routes","children","Routing","forChild","DatalinkTestPropertiesComponent","stepColumns","name","title","format","_stepTableData","stepTableData","asObservable","mainForm","updateSteps","stepData","steps","forEach","stepControl","step","datalink","dexihDatalinks","datalinkKey","push","updateDate","errors","valid","next","navigate","relativeTo","parent","stepsArray","dexihDatalinkTestSteps","index","findIndex","datalinkTestStepKey","removeAt","navigateUp","editStep","DatalinkTestEditStepComponent","formService","fb","showAllErrors","stepFormService","datalinkTestForm","minKey","t","isValid","updateTableNames","stepForm","datalinkTestStep","_formChanges","valueChanges","startForm","inputTableNames","dexihDatalinkTestTables","map","tt","table","getTable","tableKey","targetTableName","dexihDatalinkTargets","length","join","currentForm"],"mappings":"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","file":"4-es5.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { CanDeactivate } from '@angular/router';\nimport { Observable, combineLatest} from 'rxjs';\n\nexport interface CanComponentDeactivate {\n  canDeactivate: () => Observable<boolean> | Promise<boolean> | boolean;\n}\n\n@Injectable()\nexport class DatalinkTestEditGuard implements CanDeactivate<CanComponentDeactivate> {\n\n  canDeactivate(component: CanComponentDeactivate) {\n    return component && component.canDeactivate ? component.canDeactivate() : true;\n  }\n\n}\n","import { HostListener, Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute, Router, Params } from '@angular/router';\nimport { HubService } from '../../hub.service';\nimport { AuthService } from '../../../+auth/auth.service';\nimport { Subscription, combineLatest} from 'rxjs';\nimport { HubFormsService } from '../../hub.forms.service';\nimport { HubCache, eCacheStatus } from '../../hub.models';\nimport { DexihDatalinkTest } from '../../../shared/shared.models';\n\n@Component({\n  selector: 'dexih-datalinkTest-edit-form',\n  templateUrl: './datalinkTest-edit.component.html'\n})\nexport class DatalinkTestEditComponent implements OnInit, OnDestroy {\n  public datalinkTestKey: number;\n\n  public hubCache: HubCache;\n  public action: string; // new or edit\n  public pageTitle: string;\n  public params: Params;\n\n  private _subscription: Subscription;\n  private _formChangeSubscription: Subscription;\n  private _hubCacheChangeSubscription: Subscription;\n  private isLoaded = false;\n\n  constructor(private hubService: HubService,\n    public formsService: HubFormsService,\n    private authService: AuthService,\n    private route: ActivatedRoute,\n    private router: Router) {\n  }\n\n  ngOnInit() {\n    try {\n      this._subscription = combineLatest(\n        this.route.data,\n        this.route.params,\n        this.hubService.getHubCacheObservable(),\n      ).subscribe(result => {\n        let data = result[0];\n        this.params = result[1];\n        this.hubCache = result[2];\n\n        this.action = data['action'];\n        this.pageTitle = data['pageTitle'];\n\n        if (!this.hubCache || this.hubCache.status !== eCacheStatus.Loaded ) { return; }\n\n        if (this.isLoaded && this.action === 'new') { return; }\n\n        if (this.isLoaded && this.formsService.hasChanged) {\n            this.authService.confirmDialog('Synchronization warning',\n            'The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?')\n            .then(confirm => {\n                if (confirm) {\n                    this.load();\n                }\n            }).catch(reason => {\n                return;\n            });\n        } else {\n            this.load();\n        }\n\n      });\n    } catch (e) {\n      this.hubService.addHubClientErrorMessage(e, 'DatalinkTest Edit');\n    }\n  }\n\n  ngOnDestroy() {\n    if (this._hubCacheChangeSubscription) { this._hubCacheChangeSubscription.unsubscribe(); }\n    if (this._subscription) { this._subscription.unsubscribe(); }\n    if (this._formChangeSubscription) { this._formChangeSubscription.unsubscribe(); }\n\n    this.formsService.ngOnDestroy();\n  }\n\n  load() {\n    this.isLoaded = true;\n\n    if (this.action === 'edit') {\n      // get the hub key from the route data, and update the service.\n      this.datalinkTestKey = + this.params['datalinkTestKey'];\n\n      if (!this.datalinkTestKey) {\n        this.hubService.addHubErrorMessage('There was no datalink test specified to edit.');\n      } else {\n        if (!this.hubCache.hub || !this.hubCache.hub.dexihDatalinkTests) {\n          this.hubService.addHubErrorMessage('The hub cache is not loaded.');\n        } else {\n\n          let datalinkTest = this.hubCache.hub.dexihDatalinkTests.find(c => c.key === this.datalinkTestKey);\n          if (!datalinkTest) {\n            this.hubService.addHubErrorMessage('The specified datalink test could not be found.');\n          } else {\n            this.formsService.datalinkTest(datalinkTest);\n          }\n        }\n      }\n    }\n\n    if (this.action === 'new') {\n        let  datalinkTest = new DexihDatalinkTest();\n        datalinkTest.key = 0;\n        this.formsService.datalinkTest(datalinkTest);\n\n        // update the url with the saved key\n        this._formChangeSubscription = this.formsService.getCurrentFormObservable().subscribe(form => {\n          let key = form.controls.key.value;\n          if (key) {\n            if (history.pushState) {\n              let newUrl = window.location.pathname.replace('/datalinkTest-new', `/datalinkTest-edit/${key}`)\n              this.router.navigateByUrl(newUrl);\n              this._formChangeSubscription.unsubscribe();\n            }\n          }\n        });\n    }\n  }\n\n  public canDeactivate(): Promise<boolean> {\n    return new Promise<boolean>((resolve) => {\n      if (this.formsService.hasChanged) {\n        this.authService.confirmDialog('The data job has not been saved',\n          'The datalink test changes have not been saved.  Do you want to discard the changes and exit?')\n          .then((confirm) => {\n              resolve(confirm);\n            }).catch(() => {\n              resolve(false);\n            });\n      } else {\n        resolve(true);\n      }\n    });\n  }\n\n  // @HostListener allows is to guard against browser refresh, close, etc.\n  @HostListener('window:beforeunload', ['$event'])\n  unloadNotification($event: any) {\n    if (this.formsService.hasChanged) {\n      $event.returnValue = 'The datalink test changes have not been saved.  Do you want to discard the changes and exit?';\n    }\n  }\n}\n","<div class=\"container\">\n    <d-widget title=\"Edit Datalink Test\" iconClass=\"fa fa-lg fa-fw fa-cog\">\n\n    <ng-template #header>\n            <dexih-invalid-form-details class=\"mr-1\" [control]=\"formsService.currentForm\" (click)=\"formsService.showErrors()\"></dexih-invalid-form-details>\n            <save-button *ngIf=\"hubCache.canWrite\"  class=\"mr-1\" [formsService]=\"formsService\"></save-button>\n            <cancel-button  class=\"mr-1\" [formsService]=\"formsService\"></cancel-button>\n        </ng-template>\n\n        <router-outlet></router-outlet>\n    </d-widget>\n</div>  \n\n\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routing } from './datalinkTest-edit.routing';\nimport { SharedModule } from '../../../shared/shared.module';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { DatalinkTestEditComponent } from './datalinkTest-edit.component';\nimport { DatalinkTestPropertiesComponent } from './properties/datalinkTest-properties.component';\nimport { DatalinkTestEditStepComponent } from './step-edit/datalinkTest-edit-step.component';\n\nimport { HubFormsService } from '../../hub.forms.service';\nimport { DatalinkTestEditGuard } from './datalinkTest-edit-guard';\nimport { HubSharedModule } from '../../hub.shared.module';\n\n@NgModule({\n    imports: [\n        SharedModule,\n        CommonModule,\n        FormsModule,\n        Routing,\n        ReactiveFormsModule,\n        HubSharedModule\n    ],\n    declarations: [\n        DatalinkTestEditComponent,\n        DatalinkTestPropertiesComponent,\n        DatalinkTestEditStepComponent,\n    ],\n    providers: [ HubFormsService, DatalinkTestEditGuard ],\n    exports: []\n})\nexport class DatalinkTestEditModule {\n\n    static forRoot(): ModuleWithProviders<DatalinkTestEditModule> {\n        return {\n            ngModule: DatalinkTestEditModule,\n            providers: [ HubFormsService ]\n        };\n    }\n}\n","import { Routes, RouterModule } from '@angular/router';\nimport { DatalinkTestEditComponent } from './datalinkTest-edit.component';\nimport { DatalinkTestPropertiesComponent } from './properties/datalinkTest-properties.component';\nimport { DatalinkTestEditStepComponent } from './step-edit/datalinkTest-edit-step.component';\nimport { DatalinkTestEditGuard} from './datalinkTest-edit-guard';\n\nexport const editRoutes = [\n        { path: '', redirectTo: 'properties',  data: { navigateSkip: true}},\n        { path: 'properties', component: DatalinkTestPropertiesComponent, data: { navigateSkip: true, pageTitle: 'Properties' } },\n        { path: 'step', component: DatalinkTestEditStepComponent, data: { pageTitle: 'New Step' }  },\n        { path: 'step/:datalinkTestStepKey', component: DatalinkTestEditStepComponent, data: { pageTitle: 'Edit Step' }  },\n];\n\nexport const routes: Routes = [\n        { path: '', component: DatalinkTestEditComponent, canDeactivate: [DatalinkTestEditGuard], children: editRoutes},\n];\n\nexport const Routing = RouterModule.forChild(routes);\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { HubService } from '../../../hub.service';\nimport { AuthService } from '../../../../+auth/auth.service';\nimport { Subscription, combineLatest, BehaviorSubject, Observable} from 'rxjs';\nimport { HubFormsService } from '../../../hub.forms.service';\nimport { FormGroup, FormArray } from '@angular/forms';\nimport { HubCache } from '../../../hub.models';\nimport { DexihDatalinkTestStep } from '../../../../shared/shared.models';\n\n@Component({\n\n  selector: 'datalinkTest-properties-form',\n  templateUrl: './datalinkTest-properties.component.html'\n})\nexport class DatalinkTestPropertiesComponent implements OnInit, OnDestroy {\n\n  private datalinkTestKey: number;\n\n  private hubCache: HubCache;\n  public action: string; // new or edit\n  public pageTitle: string;\n\n  private _subscription: Subscription;\n\n  public hasChanged = false;\n  public mainForm: FormGroup;\n\n  stepColumns = [\n    { name: 'name', title: 'Name', format: '' },\n    { name: 'datalink', title: 'Datalink', format: '' },\n    { name: 'updateDate', title: 'Last Modified', format: 'Calendar' },\n    { name: 'errors', title: 'Errors', format: '' },\n  ];\n\n  private _stepTableData = new BehaviorSubject<Array<any>>(null);\n  stepTableData: Observable<Array<any>> = this._stepTableData.asObservable();\n\n  constructor(private hubService: HubService,\n    private authService: AuthService,\n    public formsService: HubFormsService,\n    private route: ActivatedRoute,\n    private router: Router) {\n  }\n\n  ngOnInit() {\n    try {\n      this._subscription = combineLatest(\n        this.hubService.getHubCacheObservable(),\n        this.formsService.getCurrentFormObservable(),\n      ).subscribe(result => {\n        this.hubCache = result[0];\n        this.mainForm = result[1];\n\n        this.updateSteps();\n      });\n    } catch (e) {\n      this.hubService.addHubClientErrorMessage(e, 'Data Job Edit Properties');\n    }\n  }\n\n  ngOnDestroy() {\n    if (this._subscription) { this._subscription.unsubscribe(); }\n  }\n\n  updateSteps() {\n    let stepData = [];\n    if (this.mainForm) {\n      let steps = (<FormArray>this.mainForm.controls['dexihDatalinkTestSteps']);\n      steps.controls.forEach(stepControl => {\n        let step = <DexihDatalinkTestStep> stepControl.value;\n        let datalink = this.hubCache.hub.dexihDatalinks.find(c => c.key === step.datalinkKey);\n        stepData.push({\n          key: step.key,\n          name: step.name,\n          datalink: datalink ? datalink.name : 'Not specified',\n          updateDate: step.updateDate,\n          errors: stepControl.valid ? 'No errors' : 'Errors'\n        });\n      });\n    }\n\n    this._stepTableData.next(stepData);\n  }\n\n  newStep() {\n    this.router.navigate(['step'], { relativeTo: this.route.parent });\n  }\n\n  editStep(step: DexihDatalinkTestStep) {\n    this.router.navigate(['step', step.key], { relativeTo: this.route.parent });\n  }\n\n\n  deleteSteps(steps: Array<DexihDatalinkTestStep>) {\n    let stepsArray = <FormArray>this.mainForm.controls.dexihDatalinkTestSteps;\n\n    steps.forEach(step => {\n      let index = stepsArray.controls.findIndex(c => c.value.datalinkTestStepKey === step.key);\n      stepsArray.removeAt(index);\n    });\n    this.updateSteps();\n  }\n\n  close() {\n    this.authService.navigateUp();\n  }\n\n}\n","<div class=\"list-group-item list-group-item-info  rounded-0\">\n\t<div class=\"d-flex flex-row\">\n\t\t<h5>Properties</h5>\n\t</div>\n</div>\n\n<div class=\"list-group-item p-3\">\n\n\t<form *ngIf=\"mainForm\" [formGroup]=\"mainForm\">\n\t\t<fieldset>\n\n\t\t\t<section>\n\t\t\t\t<form-input label=\"Test Name\" formControlName=\"name\" placeholder=\"Enter the name.\" [autocapitalize]=\"on\" iconClass=\"fa fa-list\" [errors]=\"formsService.formErrors['name']\">\n\t\t\t\t</form-input>\n\t\t\t</section>\n\n\t\t\t<section>\n\t\t\t\t<form-textarea label=\"Description\" formControlName=\"description\" placeholder=\"Enter a description\" iconClass=\"fa fa-comment\"\n\t\t\t\t [errors]=\"formsService.formErrors['description']\">\n\t\t\t\t</form-textarea>\n\t\t\t</section>\n\n\t\t\t<section>\n\t\t\t\t<form-select label=\"Audit Connection\" formControlName=\"auditConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t\titemKey=\"key\" itemName=\"name\" [errors]=\"formsService.formErrors.auditConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t\tnote=\"Connection where test results are stored.\">\n\t\t\t\t\t<connection-edit-button [key]=\"mainForm.controls.auditConnectionKey.value\"></connection-edit-button>\n\t\t\t\t</form-select>\n\t\t\t</section>\n\t\t</fieldset>\n\t</form>\n\n</div>\n\n<div class=\"list-group-item list-group-item-info  rounded-0\">\n\t<div class=\"d-flex flex-row\">\n\t\t<h5>Steps</h5>\n\t</div>\n</div>\n<div class=\"list-group-item p-0\">\n\t<d-table [enableMultiSelect]=\"true\" [enableManualSort]=\"true\" sortColumn=\"position\" [columns]=\"stepColumns\"\n\t [dataObservable]=\"stepTableData\" (rowClick)='editStep($event)'>\n\t\t<ng-template #selectedItemsAction select=\"selectedItemsAction\" let-items=\"items\">\n\t\t\t<d-button-delete (click)=\"deleteSteps(items)\"></d-button-delete>\n\t\t</ng-template>\n\n\t\t<ng-template #selectedItemAction select=\"selectedItemAction\" let-item=\"item\">\n\t\t\t<d-button-edit (click)=\"editStep(item)\"></d-button-edit>\n\t\t</ng-template>\n\n\t\t<ng-template #actions select=\"actionsTemplate\" let-items=\"items\">\n\t\t\t<d-button-new class=\"mr-1\" (click)=\"newStep()\" title=\"Create a new step\"></d-button-new>\n\t\t</ng-template>\n\t</d-table>\n</div>","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { HubService } from '../../../hub.service';\nimport { Observable, BehaviorSubject, Subscription, combineLatest} from 'rxjs';\nimport { FormGroup, FormArray, FormBuilder } from '@angular/forms';\nimport { AuthService } from '../../../../+auth/auth.service';\nimport { HubFormsService } from '../../../hub.forms.service';\nimport { HubCache } from '../../../hub.models';\nimport { DexihDatalinkTestStep } from '../../../../shared/shared.models';\n\n@Component({\n    selector: 'datalinkTest-edit-step',\n    templateUrl: './datalinkTest-edit-step.component.html'\n})\nexport class DatalinkTestEditStepComponent implements OnInit, OnDestroy {\n    private _subscription: Subscription;\n    private _formChanges: Subscription;\n\n    private hubCache: HubCache;\n\n    private datalinkTestStepKey: number;\n    datalinkTestKey: number;\n\n    datalinkTestForm: FormGroup;\n\n    targetTableName: string;\n    inputTableNames: string[];\n\n    stepFormService: HubFormsService;\n    showAllErrors = false;\n\n    stepColumns = [\n        { name: 'name', title: 'Name', format: '' },\n        { name: 'datalink', title: 'Datalink', format: '' },\n        { name: 'dependencies', title: 'Dependencies', format: '' },\n        { name: 'updateDate', title: 'Last Modified', format: 'Calendar' },\n    ];\n\n    private _stepTableData = new BehaviorSubject<Array<any>>(null);\n    stepTableData: Observable<Array<any>> = this._stepTableData.asObservable();\n\n    constructor(\n        private hubService: HubService,\n        private authService: AuthService,\n        private formService: HubFormsService,\n        private route: ActivatedRoute,\n        private fb: FormBuilder) {\n\n        // create a separate formService instance to manage the copied form\n        this.stepFormService = new HubFormsService(fb, hubService, authService);\n    }\n\n    ngOnInit() {\n        try {\n            this._subscription = combineLatest(\n                this.route.data,\n                this.route.params,\n                this.hubService.getHubCacheObservable(),\n                this.formService.getCurrentFormObservable(),\n            ).subscribe(result => {\n                let params = result[1];\n                this.hubCache = result[2];\n                let mainForm = result[3];\n\n                this.datalinkTestStepKey = +params['datalinkTestStepKey'];\n\n                if (mainForm) {\n                    this.datalinkTestForm = mainForm;\n                    let step: DexihDatalinkTestStep;\n\n                    if (this.datalinkTestStepKey) {\n                        step = mainForm.value.dexihDatalinkTestSteps\n                            .find(c => c.key === this.datalinkTestStepKey);\n\n                        if (!step) {\n                            this.authService.navigateUp();\n                            return;\n                        }\n                    } else {\n                        step = new DexihDatalinkTestStep();\n                        // if new trigger, then set a temporary key of -1 or lower.\n                        let minKey = -1;\n                        this.datalinkTestForm.value.dexihDatalinkTestSteps.forEach(t => {\n                            if (t.key <= minKey) {\n                                minKey = t.key - 1;\n                            }\n                        });\n                        step.key = minKey;\n                        this.datalinkTestStepKey = minKey;\n                        step.isValid = true;\n                    }\n\n                    this.updateTableNames(step);\n\n                    const stepForm = this.stepFormService.datalinkTestStep(step);\n                    this._formChanges = stepForm.controls.datalinkKey.valueChanges.subscribe(datalinkKey => {\n                        this.updateTableNames(stepForm.value);\n                    });\n\n                    this.stepFormService.startForm(stepForm);\n                }\n            });\n        } catch (e) {\n            this.hubService.addHubClientErrorMessage(e, 'DatalinkTest Edit Step');\n        }\n\n    }\n\n    ngOnDestroy() {\n        if (this._subscription) { this._subscription.unsubscribe(); }\n    }\n\n    private updateTableNames(step: DexihDatalinkTestStep) {\n        this.inputTableNames = step.dexihDatalinkTestTables.map(tt => {\n            let table = this.hubCache.getTable(tt.tableKey);\n            if (table) {\n                return table.name;\n            } else {\n                return 'Table not found.';\n            }\n        });\n\n        this.targetTableName = 'No target defined.';\n        if (step.datalinkKey) {\n            let datalink = this.hubCache.hub.dexihDatalinks.find(c => c.key ===  step.datalinkKey);\n            if (datalink && datalink.dexihDatalinkTargets.length > 0) {\n                this.targetTableName = datalink.dexihDatalinkTargets.map(c => this.hubCache.getTable(c.tableKey).name).join(', ');\n            }\n        }\n    }\n\n    cancel() {\n        this.authService.navigateUp();\n    }\n\n    applyExit() {\n        const stepForm = this.stepFormService.currentForm;\n        const stepsArray = <FormArray>this.datalinkTestForm.controls.dexihDatalinkTestSteps;\n\n        const index = stepsArray.controls\n            .findIndex(c => c.value.key === this.datalinkTestStepKey && c.value.isValid);\n\n        if (index < 0) {\n            stepsArray.push(stepForm);\n        } else {\n            stepsArray.removeAt(index);\n            stepsArray.push(stepForm);\n        }\n\n        this.authService.navigateUp();\n    }\n}\n","<div *ngIf=\"stepFormService.currentForm\">\n<div class=\"list-group-item list-group-item-info rounded-0\">\n\t<div class=\"d-flex flex-row\">\n\t\t<h5>Step Properties</h5>\n\t\t<div class=\"ml-auto\">\n\t\t\t<d-button-apply class=\"mr-1\" [disabled]=\"!stepFormService.hasChanged\" (click)=\"applyExit()\"></d-button-apply>\n\t\t\t<d-button-cancel (click)=\"cancel()\"></d-button-cancel>\n\t\t</div>\n\t</div>\n</div>\n\n<div class=\"list-group-item\" >\n\t<form [formGroup]=\"stepFormService.currentForm\">\n\t\t<fieldset>\n\t\t\t<section>\n\t\t\t\t<form-input label=\"Data Step Name\" formControlName=\"name\" placeholder=\"Enter the step name.\" [autocapitalize]=\"on\" iconClass=\"fa fa-list\"\n\t\t\t\t [errors]=\"stepFormService.formErrors.name\" note=\"Enter a name for the data step, blank will use datalink name.\">\n\t\t\t\t</form-input>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<form-textarea label=\"Description\" formControlName=\"description\" placeholder=\"Enter a description\" iconClass=\"fa fa-comment\"\n\t\t\t\t [errors]=\"stepFormService.formErrors['description']\">\n\t\t\t\t</form-textarea>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<form-select label=\"Data Link\" formControlName=\"datalinkKey\" [items]=\"hubCache.hub.dexihDatalinks\" itemKey=\"key\"\n\t\t\t\t itemName=\"name\" [errors]=\"stepFormService.formErrors.datalinkKey\" iconClass=\"fa fa-database\">\n\t\t\t\t <datalink-edit-button [key]=\"stepFormService.currentForm.controls.datalinkKey?.value\"></datalink-edit-button>\n\t\t\t\t</form-select>\n\t\t\t</section>\n\t\t</fieldset>\n\t</form>\n</div>\n\n<div class=\"list-group-item list-group-item-info rounded-0\">\n\t<div class=\"d-flex flex-row\">\n\t\t<h5>Target Table: {{targetTableName}}</h5>\n\t\t<div class=\"ml-auto\">\n\t\t\t<d-button-apply class=\"mr-1\" [disabled]=\"!stepFormService.hasChanged\" (click)=\"applyExit()\"></d-button-apply>\n\t\t\t<d-button-cancel (click)=\"cancel()\"></d-button-cancel>\n\t\t</div>\n\t</div>\n</div>\n<div class=\"list-group-item\" *ngIf=\"stepFormService.currentForm\">\n\t<form [formGroup]=\"stepFormService.currentForm\">\n\t\t<fieldset>\n\t\t\t<section>\n\t\t\t\t<form-select label=\"Target Connection\" formControlName=\"targetConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t itemKey=\"key\" itemName=\"name\" [errors]=\"stepFormService.formErrors.targetConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t note=\"Connection for the datalink target table\">\n\t\t\t\t <connection-edit-button [key]=\"stepFormService.currentForm.controls.targetConnectionKey?.value\"></connection-edit-button>\n\t\t\t\t</form-select>\n\t\t\t</section>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Target Table Name\" formControlName=\"targetTableName\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t [errors]=\"stepFormService.formErrors['targetTableName']\" note=\"Name of target table\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Target Table Schema\" formControlName=\"targetSchema\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t [errors]=\"stepFormService.formErrors['targetSchema']\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t\t<section>\n\t\t\t\t<form-select label=\"Expected Connection\" formControlName=\"expectedConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t itemKey=\"key\" itemName=\"name\" [errors]=\"stepFormService.formErrors.expectedConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t note=\"Connection where the expected target data is.\">\n\t\t\t\t <connection-edit-button [key]=\"stepFormService.currentForm.controls.expectedConnectionKey?.value\"></connection-edit-button>\n\t\t\t\t</form-select>\n\t\t\t</section>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Expected Table Name\" formControlName=\"expectedTableName\" placeholder=\"Enter the name.\"\n\t\t\t\t\t iconClass=\"fa fa-list\" [errors]=\"stepFormService.formErrors['expectedTableName']\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Expected Table Schema\" formControlName=\"expectedSchema\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t [errors]=\"stepFormService.formErrors['expectedSchema']\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t\t<section>\n\t\t\t\t<form-select label=\"Error Connection\" formControlName=\"errorConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t itemKey=\"key\" itemName=\"name\" [errors]=\"stepFormService.formErrors.errorConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t note=\"Connection where the error data should be sent.\">\n\t\t\t\t <connection-edit-button [key]=\"stepFormService.currentForm.controls.errorConnectionKey?.value\"></connection-edit-button>\n\t\t\t\t</form-select>\n\t\t\t</section>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Error Table Name\" formControlName=\"errorTableName\" placeholder=\"Enter the name.\"\n\t\t\t\t\t iconClass=\"fa fa-list\" [errors]=\"stepFormService.formErrors['errorTableName']\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t<form-input label=\"Error Table Schema\" formControlName=\"errorSchema\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t [errors]=\"stepFormService.formErrors['errorSchema']\">\n\t\t\t\t\t</form-input>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</fieldset>\n\t</form>\n</div>\n\n<div *ngFor=\"let testTable of stepFormService.currentForm.controls.dexihDatalinkTestTables.controls; let i = index;\">\n\t<div class=\"list-group-item list-group-item-info rounded-0\">\n\t\t<div class=\"d-flex flex-row\">\n\t\t\t<h5>Source Table: {{inputTableNames[i]}}</h5>\n\t\t\t<div class=\"ml-auto\">\n\t\t\t\t<d-button-apply class=\"mr-1\" [disabled]=\"!stepFormService.hasChanged\" (click)=\"applyExit()\"></d-button-apply>\n\t\t\t\t<d-button-cancel (click)=\"cancel()\"></d-button-cancel>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class=\"list-group-item\" *ngIf=\"stepFormService.currentForm\">\n\t\t<form [formGroup]=\"testTable\">\n\t\t\t<fieldset>\n\t\t\t\t<section>\n\t\t\t\t\t<form-select label=\"Source Connection\" formControlName=\"sourceConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t\t itemKey=\"key\" itemName=\"name\" [errors]=\"stepFormService.formErrors.sourceConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t\t note=\"Connection where the source test data is.\">\n\t\t\t\t\t <connection-edit-button [key]=\"stepFormService.currentForm.controls.sourceConnectionKey?.value\"></connection-edit-button>\n\t\t\t\t\t</form-select>\n\t\t\t\t</section>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t\t<form-input label=\"Source Table Name\" formControlName=\"sourceTableName\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t\t [errors]=\"stepFormService.formErrors['sourceTableName']\">\n\t\t\t\t\t\t</form-input>\n\t\t\t\t\t</section>\n\t\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t\t<form-input label=\"Source Table Schema\" formControlName=\"sourceSchema\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t\t [errors]=\"stepFormService.formErrors['sourceSchema']\">\n\t\t\t\t\t\t</form-input>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t\t<section>\n\t\t\t\t\t<form-select label=\"Test Connection\" formControlName=\"testConnectionKey\" [items]=\"hubCache.hub.dexihConnections\"\n\t\t\t\t\t itemKey=\"key\" itemName=\"name\" [errors]=\"stepFormService.formErrors.testConnectionKey\" iconClass=\"fa fa-database\"\n\t\t\t\t\t note=\"Connection where the test data is.\">\n\t\t\t\t\t <connection-edit-button [key]=\"stepFormService.currentForm.controls.testConnectionKey?.value\"></connection-edit-button>\n\t\t\t\t\t</form-select>\n\t\t\t\t</section>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t\t<form-input label=\"Test Table Name\" formControlName=\"testTableName\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t\t [errors]=\"stepFormService.formErrors['testTableName']\">\n\t\t\t\t\t\t</form-input>\n\t\t\t\t\t</section>\n\t\t\t\t\t<section class=\"form-group col-md-6\">\n\t\t\t\t\t\t<form-input label=\"Test Table Schema\" formControlName=\"testSchema\" placeholder=\"Enter the name.\" iconClass=\"fa fa-list\"\n\t\t\t\t\t\t [errors]=\"stepFormService.formErrors['testSchema']\">\n\t\t\t\t\t\t</form-input>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t</fieldset>\n\t\t</form>\n\t</div>\n</div>\n</div>"]}