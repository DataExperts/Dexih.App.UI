(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{V0Sv:function(e,t,i){"use strict";i.r(t),i.d(t,"AdminModule",(function(){return T}));var s=i("tyNb"),r=i("fXoL");let n=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Eb({type:e,selectors:[["admin-main"]],decls:2,vars:0,consts:[["id","content"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Lb(1,"router-outlet"),r.Nb())},directives:[s.j],encapsulation:2}),e})();var a=i("ElCs"),o=i("2Vo4"),c=(i("aCdC"),i("24Dg")),l=i("Wumg"),b=i("H3K+");const u=["DexihMessage"];function m(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button",9),r.Vb("click",(function(){r.vc(e);const i=t.items;return r.Zb().reinviteUsers(i)})),r.Fc(1,"Resend Invite"),r.Nb(),r.Ob(2,"dexih-button-delete",10),r.Vb("click",(function(){r.vc(e);const i=t.items;return r.Zb().deleteUsers(i)})),r.Nb(),r.Ob(3,"dexih-button",11),r.Vb("click",(function(){r.vc(e);const i=t.items;return r.Zb().revokeUsers(i)})),r.Fc(4,"Revoke"),r.Nb(),r.Ob(5,"dexih-button",12),r.Vb("click",(function(){r.vc(e);const i=t.items;return r.Zb().enableUsers(i)})),r.Fc(6,"Enable"),r.Nb()}}const h=function(e){return["edit-user",e]};function d(e,t){1&e&&r.Lb(0,"dexih-button-edit",13),2&e&&r.hc("routerLink",r.mc(1,h,t.item.userName))}const f=function(){return["new-user"]},p=function(){return["invite-users"]};function v(e,t){1&e&&(r.Lb(0,"dexih-button-new",14),r.Ob(1,"dexih-button",15),r.Fc(2,"Invite"),r.Nb()),2&e&&(r.hc("routerLink",r.lc(2,f)),r.yb(1),r.hc("routerLink",r.lc(3,p)))}let g=(()=>{class e{constructor(e,t,i){this.authService=e,this.router=t,this.route=i,this.columns=[{name:"email",title:"Email",format:""},{name:"firstName",title:"First Name",format:""},{name:"lastName",title:"Last Name",format:""},{name:"isInvited",title:"Is Invited",format:"Boolean"},{name:"emailConfirmed",title:"Email Confirmed",format:"Boolean"},{name:"isRegistered",title:"Is Registered",format:"Boolean"},{name:"isEnabled",title:"Is Enabled",format:"Boolean"},{name:"lockoutEnd",title:"Lockout End",format:"Time"},{name:"terms",title:"Agreed terms",format:"Boolean"},{name:"subscription",title:"Agreed subscription",format:"Boolean"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.refreshUsers()}ngOnDestroy(){}refreshUsers(){this.authService.post("/api/Admin/GetUsers",{searchString:"",maxResults:100},"Getting user details...").then(e=>{this._tableData.next(e)}).catch(e=>{this.dexihMessage.addMessage(e)})}deleteUsers(e){const t=e.map(e=>e.userName);this.authService.confirmDialog("Delete users?","This action will delete users with the following emails: <p>"+t.join("</p><p>")+"</p>  <p></p>Are you sure?").then(e=>{e&&this.authService.post("/api/Admin/DeleteUsers",{emails:t},"Deleting users...").then(e=>{this.refreshUsers()}).catch(e=>{this.dexihMessage.addMessage(e)})})}revokeUsers(e){const t=e.map(e=>e.userName);this.authService.confirmDialog("Revoke users?","This action will revoke users with the following emails: <p>"+t.join("</p><p>")+"</p>  <p></p>Are you sure?").then(t=>{t&&this.authService.post("/api/Admin/RevokeUsers",{emails:e.map(e=>e.userName)},"Revoking users...").then(e=>{this.refreshUsers()}).catch(e=>{this.dexihMessage.addMessage(e)})})}enableUsers(e){const t=e.map(e=>e.userName);this.authService.confirmDialog("Enable users?","This action will re-enable logins for users with the following emails: <p>"+t.join("</p><p>")+"</p>  <p></p>Are you sure?").then(t=>{t&&this.authService.post("/api/Admin/EnableUsers",{emails:e.map(e=>e.userName)},"Enabling users...").then(e=>{this.refreshUsers()}).catch(e=>{this.dexihMessage.addMessage(e)})})}reinviteUsers(e){this.authService.post("/api/Admin/ReInviteUsers",{emails:e.map(e=>e.userName)},"Inviting users...").then(e=>{this.dexihMessage.addSuccessMessage("Emails have been sent to the selected users.")}).catch(e=>{this.dexihMessage.addMessage(e)})}editUser(e){this.router.navigate(["edit-user",e.userName],{queryParamsHandling:"merge",relativeTo:this.route.parent})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(s.e),r.Kb(s.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["users"]],viewQuery:function(e,t){var i;1&e&&r.Bc(u,!0),2&e&&r.rc(i=r.Wb())&&(t.dexihMessage=i.first)},decls:11,vars:3,consts:[["DexihMessage",""],[1,"container-fluid"],["title","Users","iconClass","fa fa-lg fa-fw fa-group"],[3,"enableMultiSelect","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["iconClass","fa fa-envelope","buttonClass","btn-primary","title","invite or resend invite to selected users.",1,"mr-1",3,"click"],["title","Delete selected users",1,"mr-1",3,"click"],["iconClass","fa fa-lock","buttonClass","btn-danger","title","Revoke selected users access.",1,"mr-1",3,"click"],["iconClass","fa fa-unlock","buttonClass","btn-success","title","Re-enable selected users access",3,"click"],["title","Edit User",3,"routerLink"],["title","Create a new user",1,"mr-1",3,"routerLink"],["iconClass","fa fa-envelope","buttonClass","btn-primary","title","Invite users",3,"routerLink"]],template:function(e,t){1&e&&(r.Lb(0,"dexih-message",null,0),r.Ob(2,"div",1),r.Ob(3,"dexih-widget",2),r.Ob(4,"dexih-table",3),r.Vb("rowClick",(function(e){return t.editUser(e)})),r.Dc(5,m,7,0,"ng-template",4,5,r.Ec),r.Dc(7,d,1,3,"ng-template",6,7,r.Ec),r.Dc(9,v,3,4,"ng-template",null,8,r.Ec),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.yb(4),r.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[c.a,l.P,b.a,l.f,l.g,l.j,s.f,l.o],encapsulation:2}),e})();var N=i("itXk"),O=i("d2yJ");class k{constructor(){this.hubQuota=1,this.inviteQuota=5,this.firstName=null,this.lastName=null,this.terms=!1,this.subscription=!1,this.isEnabled=!1,this.isRegistered=!1,this.isInvited=!1,this.accessFailedCount=0,this.email=null,this.emailConfirmed=!1,this.userName=null,this.id=null,this.lockoutEnabled=!1,this.lockoutEnd=null,this.twoFactorEnabled=!1,this.phoneNumber=null,this.phoneNumberConfirmed=!1}}class w{constructor(){this.emails=[],this.hubQuota=1,this.inviteQuota=5,this.role=x.User}}var x=function(e){return e[e.Administrator=1]="Administrator",e[e.Manager=2]="Manager",e[e.User=3]="User",e[e.Viewer=4]="Viewer",e[e.None=5]="None",e}({});const C=[{key:x.Administrator,name:"Administrator"},{key:x.Manager,name:"Manager"},{key:x.User,name:"User"},{key:x.Viewer,name:"Viewer"},{key:x.None,name:"None"}];var S=i("ofXK"),y=i("3Pt+");const E=["DexihMessage"];function U(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button-save",9),r.Vb("click",(function(){return r.vc(e),r.Zb().save()})),r.Nb(),r.Ob(1,"dexih-button-cancel",10),r.Vb("click",(function(){return r.vc(e),r.Zb().cancel()})),r.Nb()}if(2&e){const e=r.Zb();r.hc("busy",e.formsService.formSaving)}}function L(e,t){if(1&e&&(r.Ob(0,"form",11),r.Ob(1,"fieldset"),r.Ob(2,"section"),r.Lb(3,"form-input",12),r.Nb(),r.Ob(4,"section"),r.Lb(5,"form-input",13),r.Nb(),r.Ob(6,"div",14),r.Ob(7,"section",15),r.Lb(8,"form-input",16),r.Nb(),r.Ob(9,"section",15),r.Lb(10,"form-input",17),r.Nb(),r.Nb(),r.Ob(11,"div",14),r.Ob(12,"section",15),r.Lb(13,"form-checkbox",18),r.Nb(),r.Ob(14,"section",15),r.Lb(15,"form-checkbox",19),r.Nb(),r.Nb(),r.Ob(16,"div",14),r.Ob(17,"section",15),r.Lb(18,"form-input",20),r.Nb(),r.Ob(19,"section",15),r.Lb(20,"form-input",21),r.Nb(),r.Nb(),r.Ob(21,"div",14),r.Ob(22,"section",15),r.Lb(23,"form-checkbox",22),r.Nb(),r.Ob(24,"section",15),r.Lb(25,"form-checkbox",23),r.Nb(),r.Nb(),r.Ob(26,"div",14),r.Ob(27,"section",15),r.Lb(28,"form-checkbox",24),r.Nb(),r.Ob(29,"section",15),r.Lb(30,"form-checkbox",25),r.Nb(),r.Nb(),r.Ob(31,"div",14),r.Ob(32,"section",15),r.Lb(33,"form-checkbox",26),r.Nb(),r.Ob(34,"section",15),r.Lb(35,"form-input",27),r.Nb(),r.Nb(),r.Ob(36,"div",14),r.Ob(37,"section",15),r.Lb(38,"form-input",28),r.Nb(),r.Ob(39,"section",15),r.Lb(40,"form-checkbox",29),r.Nb(),r.Nb(),r.Ob(41,"div",14),r.Ob(42,"section",15),r.Lb(43,"form-checkbox",30),r.Nb(),r.Nb(),r.Nb(),r.Nb()),2&e){const e=r.Zb();r.hc("formGroup",e.formsService.currentForm),r.yb(8),r.hc("autocapitalize",!0),r.yb(2),r.hc("autocapitalize",!0)}}function D(e,t){}function M(e,t){if(1&e){const e=r.Pb();r.Ob(0,"li",31),r.Ob(1,"h3"),r.Fc(2),r.Nb(),r.Lb(3,"hr"),r.Ob(4,"div"),r.Ob(5,"a",32),r.Vb("click",(function(){r.vc(e);const i=t.$implicit;return r.Zb().deleteLogin(i)})),r.Fc(6,"Delete"),r.Nb(),r.Nb(),r.Nb()}if(2&e){const e=t.$implicit;r.yb(2),r.Hc("Provider: ",e.loginProvider,"")}}let I=(()=>{class e{constructor(e,t,i,s,r){this.authService=e,this.formsService=t,this.route=i,this.router=s,this.location=r}ngOnInit(){try{this._subscription=Object(N.a)(this.route.data,this.route.params).subscribe(e=>{let t=e[1];if(this.action=e[0].action,"new"===this.action){const e=new k;this.formsService.createDefault(e,e)}else{if(this.email=t.userName,!this.email)return void this.authService.navigateUp();this.refreshForm()}})}catch(e){this.dexihMessage.addMessage(e.message)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}refreshForm(){this.authService.post("/api/Admin/GetUser",{email:this.email},"Getting user details...").then(e=>{this.logins=e.logins,this.formsService.createDefault(e,new k)}).catch(e=>{this.dexihMessage.addMessage(e)})}save(){const e=this.formsService.currentForm.value;"new"===this.action?this.authService.post("/api/Admin/AddUsers",{users:[e],sendInvite:!0},"Adding users...").then(e=>{this.authService.navigateUp()}).catch(e=>{this.dexihMessage.addMessage(e)}):this.authService.post("/api/Admin/UpdateUsers",{users:[e]},"Updating users...").then(e=>{this.authService.navigateUp()}).catch(e=>{this.dexihMessage.addMessage(e)})}cancel(){this.authService.navigateUp()}deleteLogin(e){this.authService.post("/api/Admin/RemoveExternalLogin",{email:this.formsService.currentForm.value.email,provider:e.loginProvider,providerKey:e.providerKey},"Removing external login...").then(e=>{this.refreshForm()}).catch(e=>{this.dexihMessage.addMessage(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(O.a),r.Kb(s.a),r.Kb(s.e),r.Kb(S.n))},e.\u0275cmp=r.Eb({type:e,selectors:[["user-edit-form"]],viewQuery:function(e,t){var i;1&e&&r.Bc(E,!0),2&e&&r.rc(i=r.Wb())&&(t.dexihMessage=i.first)},features:[r.xb([O.a])],decls:13,vars:4,consts:[["DexihMessage",""],[1,"container","pt-3"],["title","User Details","iconClass","fa fa-lg fa-fw fa-user",3,"padding"],["header",""],[3,"formGroup",4,"ngIf"],["title","Logins","subTitle","The following login providers are available for this login","iconClass","fa fa-lg fa-fw fa-life-saver",3,"padding"],["tools",""],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"mr-1",3,"busy","click"],[3,"click"],[3,"formGroup"],["label","Email Address","formControlName","email","placeholder","Enter the email.","iconClass","fa fa-list"],["label","User Name","formControlName","userName","placeholder","Enter the user name.","iconClass","fa fa-list"],[1,"form-row"],[1,"form-group","col-md-6"],["label","First Name","formControlName","firstName","placeholder","First Name",3,"autocapitalize"],["label","Last Name","formControlName","lastName","placeholder","Last Name",3,"autocapitalize"],["label","Agreed Terms","formControlName","terms"],["label","Agreed Subscription","formControlName","subscription"],["type","number","label","Maximum Personal Hubs","formControlName","hubQuota","placeholder","Enter the number of hubs","iconClass","fa fa-list"],["type","number","label","Number of invites","formControlName","inviteQuota"],["label","Is Invited","formControlName","isInvited"],["label","IsRegistered","formControlName","isRegistered"],["label","Is Enabled","formControlName","isEnabled"],["label","Email is confirmed","formControlName","emailConfirmed"],["label","Lockout Enabled","formControlName","lockoutEnabled"],["type","date","label","Lockout End","formControlName","lockoutEnd"],["label","Phone Number","formControlName","phoneNumber"],["label","Phone Number Confirmed","formControlName","phoneNumberConfirmed"],["label","Two Factor Enabled","formControlName","twoFactorEnabled"],[1,"list-group-item"],["title","Remove the following login",1,"btn","btn-danger","text-white",3,"click"]],template:function(e,t){1&e&&(r.Lb(0,"dexih-message",null,0),r.Ob(2,"div",1),r.Ob(3,"dexih-widget-vertical"),r.Ob(4,"dexih-widget",2),r.Dc(5,U,2,1,"ng-template",null,3,r.Ec),r.Dc(7,L,44,3,"form",4),r.Nb(),r.Ob(8,"dexih-widget",5),r.Dc(9,D,0,0,"ng-template",null,6,r.Ec),r.Ob(11,"ul",7),r.Dc(12,M,7,1,"li",8),r.Nb(),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.yb(4),r.hc("padding",!0),r.yb(3),r.hc("ngIf",t.formsService.currentForm),r.yb(1),r.hc("padding",!0),r.yb(4),r.hc("ngForOf",t.logins))},directives:[c.a,l.S,l.P,S.t,S.s,l.t,l.b,y.I,y.t,y.l,l.D,y.s,y.j,l.A],encapsulation:2}),e})();const F=["DexihMessage"];function A(e,t){1&e&&r.Lb(0,"i",8)}const K=function(e){return{disabled:e}};function P(e,t){if(1&e){const e=r.Pb();r.Ob(0,"button",5),r.Vb("click",(function(){return r.vc(e),r.Zb().save()})),r.Dc(1,A,1,0,"i",6),r.Fc(2," Send Invites "),r.Nb(),r.Ob(3,"dexih-button-cancel",7),r.Vb("click",(function(){return r.vc(e),r.Zb().cancel()})),r.Nb()}if(2&e){const e=r.Zb();r.hc("ngClass",r.mc(2,K,e.formsService.formSaving||!e.formsService.hasChanged)),r.yb(1),r.hc("ngIf",e.formsService.formSaving)}}function R(e,t){if(1&e&&(r.Ob(0,"form",9),r.Ob(1,"fieldset"),r.Ob(2,"section"),r.Lb(3,"form-tags",10),r.Nb(),r.Ob(4,"div",11),r.Ob(5,"section",12),r.Lb(6,"form-input",13),r.Nb(),r.Ob(7,"section",12),r.Lb(8,"form-input",14),r.Nb(),r.Nb(),r.Ob(9,"section"),r.Lb(10,"form-select",15),r.Nb(),r.Nb(),r.Nb()),2&e){const e=r.Zb();r.hc("formGroup",e.formsService.currentForm),r.yb(10),r.hc("items",e.roles)("enableFilter",!1)}}const V=s.i.forChild([{path:"",component:n,children:[{path:"users",data:{pageTitle:"Users"},children:[{path:"",component:g,data:{pageTitle:"Users Summary"}},{path:"edit-user/:userName",component:I,data:{action:"edit",pageTitle:"Edit User"}},{path:"new-user",component:I,data:{action:"new",pageTitle:"New User"}},{path:"invite-users",component:(()=>{class e{constructor(e,t,i,s,r){this.authService=e,this.formsService=t,this.route=i,this.router=s,this.location=r,this.roles=C}ngOnInit(){this._routeDataSubscription=this.route.data.subscribe(e=>{this.action=e.action;const t=new w;this.formsService.createDefault(t,t)})}ngOnDestroy(){this._routeDataSubscription&&this._routeDataSubscription.unsubscribe()}save(){this.authService.post("/api/Admin/InviteUsers",{emails:this.formsService.currentForm.value.emails,hubQuota:this.formsService.currentForm.value.hubQuota,inviteQuota:this.formsService.currentForm.value.inviteQuota,role:this.formsService.currentForm.value.role},"Inviting users...").then(e=>{this.authService.navigateUp()}).catch(e=>{this.dexihMessage.addMessage(e)})}cancel(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(O.a),r.Kb(s.a),r.Kb(s.e),r.Kb(S.n))},e.\u0275cmp=r.Eb({type:e,selectors:[["users-invite-form"]],viewQuery:function(e,t){var i;1&e&&r.Bc(F,!0),2&e&&r.rc(i=r.Wb())&&(t.dexihMessage=i.first)},features:[r.xb([O.a])],decls:7,vars:2,consts:[["DexihMessage",""],[1,"container-fluid"],["title","Invite Users","iconClass","fa fa-lg fa-fw fa-user",3,"padding"],["tools",""],[3,"formGroup",4,"ngIf"],[1,"btn","btn-primary","mr-1",3,"ngClass","click"],["class","fa fa-spin fa-cog",4,"ngIf"],[3,"click"],[1,"fa","fa-spin","fa-cog"],[3,"formGroup"],["label","Email Addresses","formControlName","emails","placeholder","Provide emails to invite.","note","Enter email addresses of users to invite to join the integration hub."],[1,"form-row"],[1,"form-group","col-md-6"],["type","number","label","Maximum Personal Hubs","formControlName","hubQuota","placeholder","Enter the number of hubs.","iconClass","fa fa-list"],["type","number","label","Number of invites","formControlName","inviteQuota","placeholder","Enter the number of invites."],["label","Default Role","formControlName","role","itemName","name","itemKey","key","note","Enter the role provided to the invited users.",3,"items","enableFilter"]],template:function(e,t){1&e&&(r.Lb(0,"dexih-message",null,0),r.Ob(2,"div",1),r.Ob(3,"dexih-widget",2),r.Dc(4,P,4,4,"ng-template",null,3,r.Ec),r.Dc(6,R,11,3,"form",4),r.Nb(),r.Nb()),2&e&&(r.yb(3),r.hc("padding",!0),r.yb(3),r.hc("ngIf",t.formsService.currentForm))},directives:[c.a,l.P,S.t,S.q,l.b,y.I,y.t,y.l,l.F,y.s,y.j,l.D,l.E],encapsulation:2}),e})(),data:{pageTitle:"Invite Users"}}]}]}]);var Q=i("PCNd");let T=(()=>{class e{}return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[Q.a,V,y.C]]}),e})()}}]);