function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{V0Sv:function(e,t,i){"use strict";i.r(t),i.d(t,"AdminModule",(function(){return B}));var n,r=i("tyNb"),s=i("fXoL"),a=((n=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||n)},n.\u0275cmp=s.Eb({type:n,selectors:[["admin-main"]],decls:2,vars:0,consts:[["id","content"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Lb(1,"router-outlet"),s.Nb())},directives:[r.j],encapsulation:2}),n),o=i("ElCs"),c=i("2Vo4"),l=(i("aCdC"),i("24Dg")),u=i("Wumg"),b=i("H3K+"),m=["DexihMessage"];function f(e,t){if(1&e){var i=s.Pb();s.Ob(0,"dexih-button",9),s.Vb("click",(function(){s.vc(i);var e=t.items;return s.Zb().reinviteUsers(e)})),s.Fc(1,"Resend Invite"),s.Nb(),s.Ob(2,"dexih-button-delete",10),s.Vb("click",(function(){s.vc(i);var e=t.items;return s.Zb().deleteUsers(e)})),s.Nb(),s.Ob(3,"dexih-button",11),s.Vb("click",(function(){s.vc(i);var e=t.items;return s.Zb().revokeUsers(e)})),s.Fc(4,"Revoke"),s.Nb(),s.Ob(5,"dexih-button",12),s.Vb("click",(function(){s.vc(i);var e=t.items;return s.Zb().enableUsers(e)})),s.Fc(6,"Enable"),s.Nb()}}var h=function(e){return["edit-user",e]};function d(e,t){1&e&&s.Lb(0,"dexih-button-edit",13),2&e&&s.hc("routerLink",s.mc(1,h,t.item.userName))}var v=function(){return["new-user"]},p=function(){return["invite-users"]};function g(e,t){1&e&&(s.Lb(0,"dexih-button-new",14),s.Ob(1,"dexih-button",15),s.Fc(2,"Invite"),s.Nb()),2&e&&(s.hc("routerLink",s.lc(2,v)),s.yb(1),s.hc("routerLink",s.lc(3,p)))}var N,k=((N=function(){function e(t,i,n){_classCallCheck(this,e),this.authService=t,this.router=i,this.route=n,this.columns=[{name:"email",title:"Email",format:""},{name:"firstName",title:"First Name",format:""},{name:"lastName",title:"Last Name",format:""},{name:"isInvited",title:"Is Invited",format:"Boolean"},{name:"emailConfirmed",title:"Email Confirmed",format:"Boolean"},{name:"isRegistered",title:"Is Registered",format:"Boolean"},{name:"isEnabled",title:"Is Enabled",format:"Boolean"},{name:"lockoutEnd",title:"Lockout End",format:"Time"},{name:"terms",title:"Agreed terms",format:"Boolean"},{name:"subscription",title:"Agreed subscription",format:"Boolean"}],this._tableData=new c.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){this.refreshUsers()}},{key:"ngOnDestroy",value:function(){}},{key:"refreshUsers",value:function(){var e=this;this.authService.post("/api/Admin/GetUsers",{searchString:"",maxResults:100},"Getting user details...").then((function(t){e._tableData.next(t)})).catch((function(t){e.dexihMessage.addMessage(t)}))}},{key:"deleteUsers",value:function(e){var t=this,i=e.map((function(e){return e.userName}));this.authService.confirmDialog("Delete users?","This action will delete users with the following emails: <p>"+i.join("</p><p>")+"</p>  <p></p>Are you sure?").then((function(e){e&&t.authService.post("/api/Admin/DeleteUsers",{emails:i},"Deleting users...").then((function(e){t.refreshUsers()})).catch((function(e){t.dexihMessage.addMessage(e)}))}))}},{key:"revokeUsers",value:function(e){var t=this,i=e.map((function(e){return e.userName}));this.authService.confirmDialog("Revoke users?","This action will revoke users with the following emails: <p>"+i.join("</p><p>")+"</p>  <p></p>Are you sure?").then((function(i){i&&t.authService.post("/api/Admin/RevokeUsers",{emails:e.map((function(e){return e.userName}))},"Revoking users...").then((function(e){t.refreshUsers()})).catch((function(e){t.dexihMessage.addMessage(e)}))}))}},{key:"enableUsers",value:function(e){var t=this,i=e.map((function(e){return e.userName}));this.authService.confirmDialog("Enable users?","This action will re-enable logins for users with the following emails: <p>"+i.join("</p><p>")+"</p>  <p></p>Are you sure?").then((function(i){i&&t.authService.post("/api/Admin/EnableUsers",{emails:e.map((function(e){return e.userName}))},"Enabling users...").then((function(e){t.refreshUsers()})).catch((function(e){t.dexihMessage.addMessage(e)}))}))}},{key:"reinviteUsers",value:function(e){var t=this;this.authService.post("/api/Admin/ReInviteUsers",{emails:e.map((function(e){return e.userName}))},"Inviting users...").then((function(e){t.dexihMessage.addSuccessMessage("Emails have been sent to the selected users.")})).catch((function(e){t.dexihMessage.addMessage(e)}))}},{key:"editUser",value:function(e){this.router.navigate(["edit-user",e.userName],{queryParamsHandling:"merge",relativeTo:this.route.parent})}}]),e}()).\u0275fac=function(e){return new(e||N)(s.Kb(o.a),s.Kb(r.e),s.Kb(r.a))},N.\u0275cmp=s.Eb({type:N,selectors:[["users"]],viewQuery:function(e,t){var i;1&e&&s.Bc(m,!0),2&e&&s.rc(i=s.Wb())&&(t.dexihMessage=i.first)},decls:11,vars:3,consts:[["DexihMessage",""],[1,"container-fluid"],["title","Users","iconClass","fa fa-lg fa-fw fa-group"],[3,"enableMultiSelect","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["iconClass","fa fa-envelope","buttonClass","btn-primary","title","invite or resend invite to selected users.",1,"mr-1",3,"click"],["title","Delete selected users",1,"mr-1",3,"click"],["iconClass","fa fa-lock","buttonClass","btn-danger","title","Revoke selected users access.",1,"mr-1",3,"click"],["iconClass","fa fa-unlock","buttonClass","btn-success","title","Re-enable selected users access",3,"click"],["title","Edit User",3,"routerLink"],["title","Create a new user",1,"mr-1",3,"routerLink"],["iconClass","fa fa-envelope","buttonClass","btn-primary","title","Invite users",3,"routerLink"]],template:function(e,t){1&e&&(s.Lb(0,"dexih-message",null,0),s.Ob(2,"div",1),s.Ob(3,"dexih-widget",2),s.Ob(4,"dexih-table",3),s.Vb("rowClick",(function(e){return t.editUser(e)})),s.Dc(5,f,7,0,"ng-template",4,5,s.Ec),s.Dc(7,d,1,3,"ng-template",6,7,s.Ec),s.Dc(9,g,3,4,"ng-template",null,8,s.Ec),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(4),s.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[l.a,u.P,b.a,u.f,u.g,u.j,r.f,u.o],encapsulation:2}),N),C=i("itXk"),y=i("d2yJ"),O=function e(){_classCallCheck(this,e),this.hubQuota=1,this.inviteQuota=5,this.firstName=null,this.lastName=null,this.terms=!1,this.subscription=!1,this.isEnabled=!1,this.isRegistered=!1,this.isInvited=!1,this.accessFailedCount=0,this.email=null,this.emailConfirmed=!1,this.userName=null,this.id=null,this.lockoutEnabled=!1,this.lockoutEnd=null,this.twoFactorEnabled=!1,this.phoneNumber=null,this.phoneNumberConfirmed=!1},w=function e(){_classCallCheck(this,e),this.emails=[],this.hubQuota=1,this.inviteQuota=5,this.role=x.User},x=function(e){return e[e.Administrator=1]="Administrator",e[e.Manager=2]="Manager",e[e.User=3]="User",e[e.Viewer=4]="Viewer",e[e.None=5]="None",e}({}),S=[{key:x.Administrator,name:"Administrator"},{key:x.Manager,name:"Manager"},{key:x.User,name:"User"},{key:x.Viewer,name:"Viewer"},{key:x.None,name:"None"}],E=i("ofXK"),U=i("3Pt+"),L=["DexihMessage"];function D(e,t){if(1&e){var i=s.Pb();s.Ob(0,"dexih-button-save",9),s.Vb("click",(function(){return s.vc(i),s.Zb().save()})),s.Nb(),s.Ob(1,"dexih-button-cancel",10),s.Vb("click",(function(){return s.vc(i),s.Zb().cancel()})),s.Nb()}if(2&e){var n=s.Zb();s.hc("busy",n.formsService.formSaving)}}function M(e,t){if(1&e&&(s.Ob(0,"form",11),s.Ob(1,"fieldset"),s.Ob(2,"section"),s.Lb(3,"form-input",12),s.Nb(),s.Ob(4,"section"),s.Lb(5,"form-input",13),s.Nb(),s.Ob(6,"div",14),s.Ob(7,"section",15),s.Lb(8,"form-input",16),s.Nb(),s.Ob(9,"section",15),s.Lb(10,"form-input",17),s.Nb(),s.Nb(),s.Ob(11,"div",14),s.Ob(12,"section",15),s.Lb(13,"form-checkbox",18),s.Nb(),s.Ob(14,"section",15),s.Lb(15,"form-checkbox",19),s.Nb(),s.Nb(),s.Ob(16,"div",14),s.Ob(17,"section",15),s.Lb(18,"form-input",20),s.Nb(),s.Ob(19,"section",15),s.Lb(20,"form-input",21),s.Nb(),s.Nb(),s.Ob(21,"div",14),s.Ob(22,"section",15),s.Lb(23,"form-checkbox",22),s.Nb(),s.Ob(24,"section",15),s.Lb(25,"form-checkbox",23),s.Nb(),s.Nb(),s.Ob(26,"div",14),s.Ob(27,"section",15),s.Lb(28,"form-checkbox",24),s.Nb(),s.Ob(29,"section",15),s.Lb(30,"form-checkbox",25),s.Nb(),s.Nb(),s.Ob(31,"div",14),s.Ob(32,"section",15),s.Lb(33,"form-checkbox",26),s.Nb(),s.Ob(34,"section",15),s.Lb(35,"form-input",27),s.Nb(),s.Nb(),s.Ob(36,"div",14),s.Ob(37,"section",15),s.Lb(38,"form-input",28),s.Nb(),s.Ob(39,"section",15),s.Lb(40,"form-checkbox",29),s.Nb(),s.Nb(),s.Ob(41,"div",14),s.Ob(42,"section",15),s.Lb(43,"form-checkbox",30),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&e){var i=s.Zb();s.hc("formGroup",i.formsService.currentForm),s.yb(8),s.hc("autocapitalize",!0),s.yb(2),s.hc("autocapitalize",!0)}}function I(e,t){}function F(e,t){if(1&e){var i=s.Pb();s.Ob(0,"li",31),s.Ob(1,"h3"),s.Fc(2),s.Nb(),s.Lb(3,"hr"),s.Ob(4,"div"),s.Ob(5,"a",32),s.Vb("click",(function(){s.vc(i);var e=t.$implicit;return s.Zb().deleteLogin(e)})),s.Fc(6,"Delete"),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=t.$implicit;s.yb(2),s.Hc("Provider: ",n.loginProvider,"")}}var A,_=((A=function(){function e(t,i,n,r,s){_classCallCheck(this,e),this.authService=t,this.formsService=i,this.route=n,this.router=r,this.location=s}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(C.a)(this.route.data,this.route.params).subscribe((function(t){var i=t[1];if(e.action=t[0].action,"new"===e.action){var n=new O;e.formsService.createDefault(n,n)}else{if(e.email=i.userName,!e.email)return void e.authService.navigateUp();e.refreshForm()}}))}catch(t){this.dexihMessage.addMessage(t.message)}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"refreshForm",value:function(){var e=this;this.authService.post("/api/Admin/GetUser",{email:this.email},"Getting user details...").then((function(t){e.logins=t.logins,e.formsService.createDefault(t,new O)})).catch((function(t){e.dexihMessage.addMessage(t)}))}},{key:"save",value:function(){var e=this,t=this.formsService.currentForm.value;"new"===this.action?this.authService.post("/api/Admin/AddUsers",{users:[t],sendInvite:!0},"Adding users...").then((function(t){e.authService.navigateUp()})).catch((function(t){e.dexihMessage.addMessage(t)})):this.authService.post("/api/Admin/UpdateUsers",{users:[t]},"Updating users...").then((function(t){e.authService.navigateUp()})).catch((function(t){e.dexihMessage.addMessage(t)}))}},{key:"cancel",value:function(){this.authService.navigateUp()}},{key:"deleteLogin",value:function(e){var t=this;this.authService.post("/api/Admin/RemoveExternalLogin",{email:this.formsService.currentForm.value.email,provider:e.loginProvider,providerKey:e.providerKey},"Removing external login...").then((function(e){t.refreshForm()})).catch((function(e){t.dexihMessage.addMessage(e)}))}}]),e}()).\u0275fac=function(e){return new(e||A)(s.Kb(o.a),s.Kb(y.a),s.Kb(r.a),s.Kb(r.e),s.Kb(E.n))},A.\u0275cmp=s.Eb({type:A,selectors:[["user-edit-form"]],viewQuery:function(e,t){var i;1&e&&s.Bc(L,!0),2&e&&s.rc(i=s.Wb())&&(t.dexihMessage=i.first)},features:[s.xb([y.a])],decls:13,vars:4,consts:[["DexihMessage",""],[1,"container","pt-3"],["title","User Details","iconClass","fa fa-lg fa-fw fa-user",3,"padding"],["header",""],[3,"formGroup",4,"ngIf"],["title","Logins","subTitle","The following login providers are available for this login","iconClass","fa fa-lg fa-fw fa-life-saver",3,"padding"],["tools",""],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"mr-1",3,"busy","click"],[3,"click"],[3,"formGroup"],["label","Email Address","formControlName","email","placeholder","Enter the email.","iconClass","fa fa-list"],["label","User Name","formControlName","userName","placeholder","Enter the user name.","iconClass","fa fa-list"],[1,"form-row"],[1,"form-group","col-md-6"],["label","First Name","formControlName","firstName","placeholder","First Name",3,"autocapitalize"],["label","Last Name","formControlName","lastName","placeholder","Last Name",3,"autocapitalize"],["label","Agreed Terms","formControlName","terms"],["label","Agreed Subscription","formControlName","subscription"],["type","number","label","Maximum Personal Hubs","formControlName","hubQuota","placeholder","Enter the number of hubs","iconClass","fa fa-list"],["type","number","label","Number of invites","formControlName","inviteQuota"],["label","Is Invited","formControlName","isInvited"],["label","IsRegistered","formControlName","isRegistered"],["label","Is Enabled","formControlName","isEnabled"],["label","Email is confirmed","formControlName","emailConfirmed"],["label","Lockout Enabled","formControlName","lockoutEnabled"],["type","date","label","Lockout End","formControlName","lockoutEnd"],["label","Phone Number","formControlName","phoneNumber"],["label","Phone Number Confirmed","formControlName","phoneNumberConfirmed"],["label","Two Factor Enabled","formControlName","twoFactorEnabled"],[1,"list-group-item"],["title","Remove the following login",1,"btn","btn-danger","text-white",3,"click"]],template:function(e,t){1&e&&(s.Lb(0,"dexih-message",null,0),s.Ob(2,"div",1),s.Ob(3,"dexih-widget-vertical"),s.Ob(4,"dexih-widget",2),s.Dc(5,D,2,1,"ng-template",null,3,s.Ec),s.Dc(7,M,44,3,"form",4),s.Nb(),s.Ob(8,"dexih-widget",5),s.Dc(9,I,0,0,"ng-template",null,6,s.Ec),s.Ob(11,"ul",7),s.Dc(12,F,7,1,"li",8),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(4),s.hc("padding",!0),s.yb(3),s.hc("ngIf",t.formsService.currentForm),s.yb(1),s.hc("padding",!0),s.yb(4),s.hc("ngForOf",t.logins))},directives:[l.a,u.S,u.P,E.t,E.s,u.t,u.b,U.I,U.t,U.l,u.D,U.s,U.j,u.A],encapsulation:2}),A),P=["DexihMessage"];function K(e,t){1&e&&s.Lb(0,"i",8)}var R=function(e){return{disabled:e}};function V(e,t){if(1&e){var i=s.Pb();s.Ob(0,"button",5),s.Vb("click",(function(){return s.vc(i),s.Zb().save()})),s.Dc(1,K,1,0,"i",6),s.Fc(2," Send Invites "),s.Nb(),s.Ob(3,"dexih-button-cancel",7),s.Vb("click",(function(){return s.vc(i),s.Zb().cancel()})),s.Nb()}if(2&e){var n=s.Zb();s.hc("ngClass",s.mc(2,R,n.formsService.formSaving||!n.formsService.hasChanged)),s.yb(1),s.hc("ngIf",n.formsService.formSaving)}}function Q(e,t){if(1&e&&(s.Ob(0,"form",9),s.Ob(1,"fieldset"),s.Ob(2,"section"),s.Lb(3,"form-tags",10),s.Nb(),s.Ob(4,"div",11),s.Ob(5,"section",12),s.Lb(6,"form-input",13),s.Nb(),s.Ob(7,"section",12),s.Lb(8,"form-input",14),s.Nb(),s.Nb(),s.Ob(9,"section"),s.Lb(10,"form-select",15),s.Nb(),s.Nb(),s.Nb()),2&e){var i=s.Zb();s.hc("formGroup",i.formsService.currentForm),s.yb(10),s.hc("items",i.roles)("enableFilter",!1)}}var T,Z,j=r.i.forChild([{path:"",component:a,children:[{path:"users",data:{pageTitle:"Users"},children:[{path:"",component:k,data:{pageTitle:"Users Summary"}},{path:"edit-user/:userName",component:_,data:{action:"edit",pageTitle:"Edit User"}},{path:"new-user",component:_,data:{action:"new",pageTitle:"New User"}},{path:"invite-users",component:(T=function(){function e(t,i,n,r,s){_classCallCheck(this,e),this.authService=t,this.formsService=i,this.route=n,this.router=r,this.location=s,this.roles=S}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this._routeDataSubscription=this.route.data.subscribe((function(t){e.action=t.action;var i=new w;e.formsService.createDefault(i,i)}))}},{key:"ngOnDestroy",value:function(){this._routeDataSubscription&&this._routeDataSubscription.unsubscribe()}},{key:"save",value:function(){var e=this;this.authService.post("/api/Admin/InviteUsers",{emails:this.formsService.currentForm.value.emails,hubQuota:this.formsService.currentForm.value.hubQuota,inviteQuota:this.formsService.currentForm.value.inviteQuota,role:this.formsService.currentForm.value.role},"Inviting users...").then((function(t){e.authService.navigateUp()})).catch((function(t){e.dexihMessage.addMessage(t)}))}},{key:"cancel",value:function(){this.authService.navigateUp()}}]),e}(),T.\u0275fac=function(e){return new(e||T)(s.Kb(o.a),s.Kb(y.a),s.Kb(r.a),s.Kb(r.e),s.Kb(E.n))},T.\u0275cmp=s.Eb({type:T,selectors:[["users-invite-form"]],viewQuery:function(e,t){var i;1&e&&s.Bc(P,!0),2&e&&s.rc(i=s.Wb())&&(t.dexihMessage=i.first)},features:[s.xb([y.a])],decls:7,vars:2,consts:[["DexihMessage",""],[1,"container-fluid"],["title","Invite Users","iconClass","fa fa-lg fa-fw fa-user",3,"padding"],["tools",""],[3,"formGroup",4,"ngIf"],[1,"btn","btn-primary","mr-1",3,"ngClass","click"],["class","fa fa-spin fa-cog",4,"ngIf"],[3,"click"],[1,"fa","fa-spin","fa-cog"],[3,"formGroup"],["label","Email Addresses","formControlName","emails","placeholder","Provide emails to invite.","note","Enter email addresses of users to invite to join the integration hub."],[1,"form-row"],[1,"form-group","col-md-6"],["type","number","label","Maximum Personal Hubs","formControlName","hubQuota","placeholder","Enter the number of hubs.","iconClass","fa fa-list"],["type","number","label","Number of invites","formControlName","inviteQuota","placeholder","Enter the number of invites."],["label","Default Role","formControlName","role","itemName","name","itemKey","key","note","Enter the role provided to the invited users.",3,"items","enableFilter"]],template:function(e,t){1&e&&(s.Lb(0,"dexih-message",null,0),s.Ob(2,"div",1),s.Ob(3,"dexih-widget",2),s.Dc(4,V,4,4,"ng-template",null,3,s.Ec),s.Dc(6,Q,11,3,"form",4),s.Nb(),s.Nb()),2&e&&(s.yb(3),s.hc("padding",!0),s.yb(3),s.hc("ngIf",t.formsService.currentForm))},directives:[l.a,u.P,E.t,E.q,u.b,U.I,U.t,U.l,u.F,U.s,U.j,u.D,u.E],encapsulation:2}),T),data:{pageTitle:"Invite Users"}}]}]}]),G=i("PCNd"),B=((Z=function e(){_classCallCheck(this,e)}).\u0275mod=s.Ib({type:Z}),Z.\u0275inj=s.Hb({factory:function(e){return new(e||Z)},providers:[],imports:[[G.a,j,U.C]]}),Z)}}]);