function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"/fhR":function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a("3WyZ"),i=a("itXk"),r=a("2v7R"),o=a("soiQ"),s=a("fXoL"),c=a("ElCs"),l=a("Xjf6"),u=a("tyNb"),b=a("cvPx"),h=a("3Pt+"),d=a("ofXK"),f=a("Wumg"),m=a("obiC"),v=a("H3K+"),p=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};function g(e,t){if(1&e&&(s.Ob(0,"section"),s.Ob(1,"div",2),s.Fc(2," There are no files configured. Create a file based connection, and add at least one file definition. "),s.Lb(3,"hr"),s.Ob(4,"div"),s.Ob(5,"a",3),s.Fc(6,"New Connection"),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb();s.yb(5),s.jc("routerLink","/hub/",a.hubCache.hub.hubKey,"/connections/connection-new/Source")}}function y(e,t){if(1&e&&(s.Ob(0,"section",16),s.Ob(1,"form-select",22),s.Ob(2,"a",13),s.Fc(3,"("),s.Lb(4,"i",14),s.Fc(5," New )"),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(4);s.yb(1),s.hc("items",a.hubCache.hub.dexihFileFormats)("enableFilter",!1)("allowNullSelect",!0),s.yb(1),s.jc("routerLink","/hub/",a.hubCache.hub.hubKey,"/fileFormats/fileFormat-new")}}function C(e,t){if(1&e&&(s.Ob(0,"form",10),s.Ob(1,"div",11),s.Ob(2,"section"),s.Ob(3,"form-select",12),s.Ob(4,"a",13),s.Fc(5,"("),s.Lb(6,"i",14),s.Fc(7," New )"),s.Nb(),s.Nb(),s.Nb(),s.Ob(8,"div",15),s.Ob(9,"section",16),s.Lb(10,"form-select",17),s.Nb(),s.Dc(11,y,6,4,"section",18),s.Nb(),s.Ob(12,"section"),s.Lb(13,"form-checkbox",19),s.Lb(14,"form-checkbox",20),s.Lb(15,"form-checkbox",21),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(3);s.hc("formGroup",a.bulkLoadForm),s.yb(3),s.hc("items",a.fileConnections),s.yb(1),s.jc("routerLink","//hub/",a.hubCache.hub.hubKey,"/connections/connection-new/Source"),s.yb(6),s.hc("items",a.formatTypes),s.yb(1),s.hc("ngIf",a.bulkLoadForm.controls.formatType.value==a.eTypeCode.Text)}}function k(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button",38),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).uploadSelected(e)})),s.Fc(1,"Upload"),s.Nb(),s.Ob(2,"dexih-button-cancel",39),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).cancelSelected(e)})),s.Nb(),s.Ob(3,"dexih-button-delete",40),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).removeSelected(e)})),s.Nb()}}function w(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",41),s.Ob(1,"form-checkbox",42),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(4).automaticUpload=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(4);s.yb(1),s.hc("ngModel",n.automaticUpload)}}var S=function(e){return{width:e}};function T(e,t){if(1&e&&(s.Ob(0,"div",45),s.Lb(1,"div",46),s.Nb()),2&e){var a=s.Zb().item;s.yb(1),s.hc("ngStyle",s.mc(1,S,a.progress+"%"))}}var O=function(e,t,a){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":a}};function N(e,t){if(1&e&&(s.Dc(0,T,2,3,"div",43),s.Ob(1,"span"),s.Lb(2,"i",44),s.Fc(3),s.Nb()),2&e){var a=t.item,n=s.Zb(4);s.hc("ngIf",a.isRunning()),s.yb(2),s.hc("ngClass",s.oc(3,O,a.status===n.eFileStatus.Complete,a.status===n.eFileStatus.Error,a.status===n.eFileStatus.Cancelled)),s.yb(1),s.Gc(a.status)}}function D(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button",47),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).saveTables(e)})),s.Fc(1,"Create Tables"),s.Nb(),s.Ob(2,"dexih-button",48),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).createDatalinks(e)})),s.Fc(3,"Create Datalinks"),s.Nb(),s.Ob(4,"dexih-button-delete",49),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb(4).discardTables(e)})),s.Nb()}}function x(e,t){if(1&e){var a=s.Pb();s.Ob(0,"ul",23),s.Ob(1,"dexih-widget-section",24),s.Ob(2,"div",25),s.Vb("dropFiles",(function(e){return s.vc(a),s.Zb(3).filesDrop(e)})),s.Fc(3," Drop Files to Load Here "),s.Ob(4,"div",26),s.Ob(5,"input",27),s.Vb("change",(function(e){return s.vc(a),s.Zb(3).uploadFile(e)})),s.Nb(),s.Ob(6,"label",28),s.Fc(7,"Choose files"),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Ob(8,"dexih-widget-section",29),s.Ob(9,"dexih-table",30),s.Dc(10,k,4,0,"ng-template",31,32,s.Ec),s.Dc(12,w,2,1,"ng-template",null,33,s.Ec),s.Dc(14,N,4,7,"ng-template",34,35,s.Ec),s.Nb(),s.Nb(),s.Ob(16,"dexih-widget-section",36),s.Ob(17,"dexih-table",37),s.Vb("rowClick",(function(e){return s.vc(a),s.Zb(3).editTable(e)})),s.Dc(18,D,5,0,"ng-template",31,32,s.Ec),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(3);s.yb(1),s.hc("showExpandButton",!0),s.yb(1),s.hc("requireFiles",!0),s.yb(6),s.hc("showExpandButton",!0)("padding",!1),s.yb(1),s.hc("enableMultiSelect",!0)("columns",n.uploadColumns)("data",n.uploadedFiles),s.yb(7),s.hc("showExpandButton",!0)("padding",!1),s.yb(1),s.hc("enableMultiSelect",!0)("columns",n.tableColumns)("data",n.tables)}}function F(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-widget",7),s.Vb("close",(function(){return s.vc(a),s.Zb(2).close()})),s.Dc(1,C,16,5,"form",8),s.Dc(2,x,20,12,"ul",9),s.Nb()}if(2&e){var n=s.Zb(2);s.hc("title","Bulk Load: "+(null==n.connection?null:n.connection.name))("showCloseButton",!0),s.yb(1),s.hc("ngIf",n.bulkLoadForm),s.yb(1),s.hc("ngIf",n.connection)}}function V(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-apply",52),s.Vb("click",(function(){return s.vc(a),s.Zb(3).applyChanges()})),s.Nb(),s.Ob(1,"dexih-button-cancel",53),s.Vb("click",(function(){return s.vc(a),s.Zb(3).cancel()})),s.Nb()}}function I(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-widget",50),s.Vb("close",(function(){return s.vc(a),s.Zb(2).closeTable()})),s.Dc(1,V,2,0,"ng-template",null,51,s.Ec),s.Lb(3,"router-outlet"),s.Nb()}if(2&e){var n=s.Zb(2);s.hc("title","Edit table: "+n.formsService.currentForm.controls.name.value)("showCloseButton",!0)}}function K(e,t){if(1&e&&(s.Ob(0,"div",4),s.Dc(1,F,3,4,"dexih-widget",5),s.Dc(2,I,4,2,"dexih-widget",6),s.Nb()),2&e){var a=s.Zb();s.yb(1),s.hc("ngIf",!a.currentTable),s.yb(1),s.hc("ngIf",a.currentTable)}}var E=function(){var e=function(){function e(t,a,i,s,c,l){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.route=i,this.router=s,this.formsService=c,this.fb=l,this.entityType="Table",this.canEdit=!1,this.formatTypes=r.m,this.eTypeCode=o.pc,this.eFileStatus=n.h,this.automaticUpload=!0,this.uploadedFiles=[],this.reference=null,this.tables=[],this.currentTable=null,this.cancelToken=new n.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.tableColumns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description"},{name:"name",title:"Table Name"}],this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){var a=t[0];e.hubCache=t[1];var n=t[2];e.fileConnections=e.hubCache.hub.dexihConnections.filter((function(e){var t=n.connections.find((function(t){return e.connectionAssemblyName===t.connectionAssemblyName&&e.connectionClassName===t.connectionClassName}));return!!t&&(t.connectionCategory===o.ib.File||e.purpose!==o.jb.Source)}));var i=+a.connectionKey;i||e.fileConnections.length>0&&(i=e.fileConnections[0].key),e.bulkLoadForm=e.fb.group({connectionKey:[i],formatType:[o.pc.Text],fileFormatKey:[],includeFileName:[!1],includeFileDate:[!1],includeFileRowNumber:[!1]}),e.updateConnection(i),e._connectionKeySubscription&&e._connectionKeySubscription.unsubscribe(),e._connectionKeySubscription=e.bulkLoadForm.controls.connectionKey.valueChanges.subscribe((function(t){e.updateConnection(t)}))})),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._flatFilesSubscription=this.hubService.getFlatFilesObservable().subscribe((function(t){t.reference===e.reference&&(e.tables=t.tables)}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Files Manage")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._connectionKeySubscription&&this._connectionKeySubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateConnection",value:function(e){this.connection=this.hubCache.getConnection(e),!this.connection&&e?this.hubService.addHubErrorMessage("The connection with the key ".concat(e," could not be found.")):this.connection&&(this.pageTitle="Load files for "+this.connection.name,this.showPage=!0)}},{key:"uploadFile",value:function(e){return this.doUpload(e.srcElement.files),!1}},{key:"filesDrop",value:function(e){this.doUpload(e)}},{key:"doUpload",value:function(e){var t=this;Array.prototype.forEach.call(e,(function(e){var a=t.bulkLoadForm.value;t.hubService.bulkUploadFiles(a.connectionKey,a.fileFormatKey,a.formatType,a.includeFileName,a.includeFileDate,a.includeFileRowNumber,e.name,t.cancelToken).then((function(a){var i=a.url;t.reference=a.reference;var r=new n.d(e,i);t.uploadedFiles=t.uploadedFiles.concat(r),t.automaticUpload&&t.authService.upload(r).then((function(a){a.success?t.hubService.addHubSuccessMessage(e.name+" uploaded."):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)}))})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"editTable",value:function(e){this.currentTable=e,this.formsService.table(e),this.router.navigate(["table-edit"],{relativeTo:this.route})}},{key:"applyChanges",value:function(){this.formsService.hasChanged&&Object.assign(this.currentTable,this.formsService.currentForm.value),this.currentTable=null,this.authService.navigateUp()}},{key:"cancel",value:function(){this.currentTable=null,this.authService.navigateUp()}},{key:"saveTables",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n,i,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object.assign([],this.tables),n=[],i=regeneratorRuntime.mark((function t(i){var r,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e[i],t.next=3,o.hubService.saveTables([r]);case 3:s=t.sent,n.push(s[0].key),c=o.tables.findIndex((function(e){return r.key===e.key})),a.splice(c,1);case 7:case"end":return t.stop()}}),t)})),r=0;case 3:if(!(r<e.length)){t.next=8;break}return t.delegateYield(i(r),"t0",5);case 5:r++,t.next=3;break;case 8:return t.abrupt("return",(this.tables=a,n));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"createDatalinks",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveTables(e);case 2:a=t.sent.join("|"),this.router.navigate(["/hub",this.hubCache.hub.hubKey,"tables","datalink-new",a,0],{relativeTo:this.route.root});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"discardTables",value:function(e){for(var t=this,a=Object.assign([],this.tables),n=function(n){var i=e[n],r=t.tables.findIndex((function(e){return i.key===e.key}));a.splice(r,1)},i=0;i<e.length;i++)n(i);this.tables=a}},{key:"uploadSelected",value:function(e){var t=this;e.forEach((function(e){t.authService.upload(e).then((function(e){t.hubService.addHubMessage(e)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"removeSelected",value:function(e){var t=this;e.forEach((function(e){var a=t.uploadedFiles.findIndex((function(t){return t.id===e.id}));a>=0&&t.uploadedFiles.splice(a,1)}))}},{key:"cancelSelected",value:function(e){e.forEach((function(e){return e.cancel()}))}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.tables.length>0?e.authService.confirmDialog("Unsaved tables!","Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.tables.length>0&&(e.returnValue="Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Kb(c.a),s.Kb(l.a),s.Kb(u.a),s.Kb(u.e),s.Kb(b.a),s.Kb(h.g))},e.\u0275cmp=s.Eb({type:e,selectors:[["files-bulk-load"]],hostBindings:function(e,t){1&e&&s.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,s.uc)},decls:2,vars:2,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],[1,"btn","btn-sm","btn-primary","text-white",3,"routerLink","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close",4,"ngIf"],[3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close"],[3,"formGroup",4,"ngIf"],["class","list-group",4,"ngIf"],[3,"formGroup"],[1,"m-3"],["label","Connection","formControlName","connectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","The connection where the files will be uploaded to.",3,"items"],[3,"routerLink"],[1,"fa","fa-sticky-note-o"],[1,"form-row"],[1,"col-md-6"],["label","Format Type","formControlName","formatType","itemKey","key","itemName","name","iconClass","fa fa-text","note","The format of data.",3,"items"],["class","col-md-6",4,"ngIf"],["label","Include file name field","formControlName","includeFileName"],["label","Include file date field","formControlName","includeFileDate"],["label","Include file row field","formControlName","includeFileRowNumber"],["label","File Format","formControlName","fileFormatKey","placeholder","File Format","itemKey","key","itemName","name","note","Specify the file format to use, if not specified, a csv (command separated) format will be used.","selectNullMessage","Use default (csv) format",3,"items","enableFilter","allowNullSelect"],[1,"list-group"],["title","Drop Files to Load",3,"showExpandButton"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],["title","Upload Queues",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Tables Created",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data","rowClick"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],[1,"d-flex","align-items-center","h-100"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],["iconClass","fa fa-table","title","Save the selected tables.",1,"ml-1",3,"click"],["iconClass","fa fa-exchange","title","Save the selected tables, and create datalinks to load them into a staging area.",1,"ml-1",3,"click"],["title","Discard the selected tables.","text","Discard",1,"ml-1",3,"click"],[3,"title","showCloseButton","close"],["header",""],[3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){1&e&&(s.Dc(0,g,7,1,"section",0),s.Dc(1,K,3,2,"div",1)),2&e&&(s.hc("ngIf",(null==t.hubCache?null:t.hubCache.hub)&&(!t.fileConnections||0===t.fileConnections.length)),s.yb(1),s.hc("ngIf",t.fileConnections&&t.fileConnections.length>0))},directives:[d.t,u.h,f.P,h.I,h.t,h.l,f.E,h.s,h.j,f.A,f.T,m.a,v.a,f.f,f.b,f.g,h.v,d.q,d.w,u.j,f.a],encapsulation:2}),e}()},LyCD:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a("itXk"),i=a("cvPx"),r=a("3WyZ"),o=a("2v7R"),s=a("soiQ"),c=a("fXoL"),l=a("4Y1E"),u=a("ElCs"),b=a("tyNb"),h=a("Wumg"),d=a("iFLP"),f=a("ofXK"),m=a("79jk"),v=a("64E1"),p=a("oLr2"),g=["dashboardItem"];function y(e,t){if(1&e){var a=c.Pb();c.Ob(0,"li"),c.Ob(1,"a",8),c.Vb("click",(function(){c.vc(a);var e=t.$implicit;return c.Zb(2).add(e.key)})),c.Fc(2),c.Nb(),c.Nb()}if(2&e){var n=t.$implicit;c.yb(2),c.Gc(n.name)}}function C(e,t){if(1&e&&c.Lb(0,"save-button",13),2&e){var a=c.Zb(2);c.hc("formsService",a.formsService)}}function k(e,t){if(1&e){var a=c.Pb();c.Ob(0,"dexih-invalid-form-details",3),c.Vb("click",(function(){return c.vc(a),c.Zb().formsService.showErrors()})),c.Nb(),c.Ob(1,"dexih-button-edit",4),c.Vb("click",(function(){return c.vc(a),c.Zb().toggleEdit()})),c.Nb(),c.Ob(2,"dexih-button",5),c.Vb("click",(function(){return c.vc(a),c.Zb().toggleLock()})),c.Nb(),c.Ob(3,"dexih-button-refresh",6),c.Vb("click",(function(){return c.vc(a),c.Zb().refresh()})),c.Nb(),c.Ob(4,"dexih-button-dropdown",7),c.Ob(5,"a",8),c.Vb("click",(function(){return c.vc(a),c.Zb().newView()})),c.Fc(6,"(New View)"),c.Nb(),c.Dc(7,y,3,1,"li",9),c.Nb(),c.Ob(8,"download-button",10),c.Vb("download",(function(e){return c.vc(a),c.Zb().download(e)})),c.Nb(),c.Dc(9,C,1,1,"save-button",11),c.Lb(10,"cancel-button",12)}if(2&e){var n=c.Zb();c.hc("control",n.formsService.currentForm),c.yb(1),c.hc("text",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.showEdit?"Hide Edit":"Edit"),c.yb(1),c.hc("iconClass",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.lock?"fa fa-lock":"fa fa-unlock")("text",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.lock?"Unlock":"Lock"),c.yb(5),c.hc("ngForOf",n.views),c.yb(2),c.hc("ngIf",n.hubCache.canWrite),c.yb(1),c.hc("formsService",n.formsService)}}var w=function(){var e=function(){function e(t,a,n,i,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=o,this.isLoaded=!1,this.isRefreshing=!1,this.refreshComplete=!1,this.cancelToken=new r.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(n.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.remoteAgent=t[3],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===o.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.views=e.hubCache.hub.dexihViews,e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Dashboard Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.dashboardKey=+this.params.dashboardKey,this.dashboardKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihDashboards.find((function(t){return t.key===e.dashboardKey}));t=JSON.parse(JSON.stringify(t)),this.formsService.dashboard(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no dashboard specified to edit.");if("new"===this.action){this.refreshComplete=!0;var a=new s.i;a.minCols=4,a.maxCols=100,a.minRows=4,a.maxRows=100,a.autoRefresh=!0,this.formsService.dashboard(a),this.formsService.currentForm.controls.runTime.value.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/dashboard-new","/dashboard-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.formsService.currentForm.controls.autoRefresh.value&&this.remoteAgent&&!this.refreshComplete&&(this.refreshComplete=!0,this.refresh())}},{key:"refresh",value:function(){var e=this;this.hubService.previewDashboard(this.formsService.currentForm.value,this.formsService.currentForm.value.parameters,this.cancelToken).then((function(t){var a=e.formsService.currentForm.controls.dexihDashboardItems;t.forEach((function(t){var n=a.controls.find((function(e){return e.controls.key.value===t.dashboardItemKey}));if(n){var i=n.controls.runTime.value.data;i.isRefreshing=!0,e.hubService.getRemoteResponse(t.dataKey,e.cancelToken).then((function(t){t.columns=e.authService.constructDataTableColumns(t.columns),i.data.next(t),i.isRefreshing=!1})).catch()}}))}))}},{key:"toggleEdit",value:function(){var e=this.formsService.currentForm.controls.runTime.value;e.showEdit=!e.showEdit,this.formsService.currentForm.controls.runTime.setValue(e)}},{key:"toggleLock",value:function(){var e=this.formsService.currentForm.controls.runTime.value;e.lock=!e.lock,this.formsService.currentForm.controls.runTime.setValue(e)}},{key:"add",value:function(e){var t=this.hubCache.hub.dexihViews.find((function(t){return t.key===e}));if(t){var a=this.formsService.currentForm,n=a.controls.dexihDashboardItems,i=new s.j;i.key=this.hubCache.getNextSequence(),i.cols=1,i.rows=1,i.x=-1,i.y=-1;e:for(var r=0;r<a.controls.maxRows.value;r++)for(var o=0;o<a.controls.maxCols.value;o++){for(var c=!1,l=0;l<n.controls.length;l++){var u=n.controls[l].value;if(u.x<=o&&u.x+u.cols>o&&u.y<=r&&u.y+u.rows>r){c=!0;break}}if(!c){i.x=o,i.y=r;break e}}i.viewKey=e,i.name=t.name;var b=this.formsService.dashboardItem(i);this.formsService.updateDashboardItemView(b),n.push(b)}}},{key:"newView",value:function(){this.router.navigate(["view-new"],{relativeTo:this.route})}},{key:"download",value:function(e){var t=this,a=this.formsService.currentForm.controls.dexihDashboardItems.value.filter((function(e){return e.viewKey})).map((function(e){var a=t.hubCache.hub.dexihViews.find((function(t){return t.key===e.viewKey})),n=new s.M;return a.sourceType===s.lb.Datalink&&(n.objectKey=a.sourceDatalinkKey,n.objectType=s.lb.Datalink),a.sourceType===s.lb.Table&&(n.objectKey=a.sourceTableKey,n.objectType=s.lb.Table),n.query=a.selectQuery,n}));this.hubService.downloadData(a,!1,e,this.cancelToken)}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The dashboard has not been saved","The dashboard changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The dashboard changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.Kb(l.a),c.Kb(u.a),c.Kb(i.a),c.Kb(b.a),c.Kb(b.e))},e.\u0275cmp=c.Eb({type:e,selectors:[["dexih-dashboard-edit-form"]],viewQuery:function(e,t){var a;1&e&&c.Kc(g,!0),2&e&&c.rc(a=c.Wb())&&(t.dashboardItems=a)},hostBindings:function(e,t){1&e&&c.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.uc)},features:[c.xb([i.a])],decls:5,vars:3,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-pie-chart",3,"title","showCloseButton","padding","close"],["header",""],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"text","click"],[1,"mr-1",3,"iconClass","text","click"],[1,"mr-1",3,"click"],["iconClass","fa fa-plus","text","Add",1,"mr-1"],[1,"dropdown-item",3,"click"],[4,"ngFor","ngForOf"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"]],template:function(e,t){1&e&&(c.Ob(0,"div",0),c.Ob(1,"dexih-widget",1),c.Vb("close",(function(){return t.close()})),c.Dc(2,k,11,7,"ng-template",null,2,c.Ec),c.Lb(4,"router-outlet"),c.Nb(),c.Nb()),2&e&&(c.yb(1),c.jc("title","Dashboard - ",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.name.value,""),c.hc("showCloseButton",!0)("padding",!1))},directives:[h.P,b.j,d.a,h.j,h.f,h.s,h.i,f.s,m.a,f.t,v.a,p.a],encapsulation:2}),e}()},MbvK:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n=a("XNiG"),i=a("itXk"),r=a("VRyK"),o=a("cvPx"),s=a("Z+eP"),c=a("3WyZ"),l=a("2v7R"),u=a("soiQ"),b=a("fXoL"),h=a("4Y1E"),d=a("ElCs"),f=a("tyNb"),m=a("ofXK"),v=a("Wumg"),p=a("PMKX"),g=a("/pur"),y=a("iFLP"),C=a("79jk"),k=a("64E1"),w=a("oLr2"),S=a("YcGA"),T=a("3Pt+"),O=a("+F4M"),N=a("hJJo"),D=a("RXlv"),x=a("H3K+"),F=a("kzgk");function V(e,t){if(1&e&&b.Lb(0,"save-button",23),2&e){var a=b.Zb(3);b.hc("formsService",a.formsService)}}var I=function(e){return{active:e}};function K(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",10),b.Vb("click",(function(){return b.vc(a),b.Zb(2).formsService.showErrors()})),b.Nb(),b.Ob(1,"dexih-button-refresh",11),b.Vb("click",(function(){return b.vc(a),b.Zb(2).refresh()})),b.Nb(),b.Ob(2,"download-button",12),b.Vb("download",(function(e){return b.vc(a),b.Zb(2).download(e)})),b.Nb(),b.Ob(3,"div",13),b.Ob(4,"label",14),b.Ob(5,"input",15),b.Vb("click",(function(){return b.vc(a),b.Zb(2).toggleChart()})),b.Nb(),b.Lb(6,"i",16),b.Nb(),b.Ob(7,"label",17),b.Ob(8,"input",18),b.Vb("click",(function(){return b.vc(a),b.Zb(2).toggleChart()})),b.Nb(),b.Lb(9,"i",19),b.Nb(),b.Nb(),b.Dc(10,V,1,1,"save-button",20),b.Ob(11,"dexih-button-edit",21),b.Vb("click",(function(){return b.vc(a),b.Zb(2).toggleEdit()})),b.Nb(),b.Lb(12,"cancel-button",22)}if(2&e){var n=b.Zb(2);b.hc("control",n.formsService.currentForm),b.yb(4),b.hc("ngClass",b.mc(6,I,!1===n.showChart)),b.yb(3),b.hc("ngClass",b.mc(8,I,!0===n.showChart)),b.yb(3),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("text",n.showEdit?"Hide Edit":"Edit"),b.yb(1),b.hc("formsService",n.formsService)}}function E(e,t){if(1&e&&(b.Ob(0,"section",32),b.Ob(1,"form-select",37),b.Lb(2,"table-edit-button",38),b.Nb(),b.Nb()),2&e){var a=b.Zb(4);b.yb(1),b.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),b.yb(1),b.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function L(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section",32),b.Ob(1,"form-select",39),b.Lb(2,"datalink-edit-button",38),b.Nb(),b.Ob(3,"dexih-button-refresh",40),b.Vb("click",(function(){return b.vc(a),b.Zb(4).refreshDatalink()})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(1),b.hc("errors",null==n.errors?null:n.errors.sourceDatalinkKey)("items",n.datalinks),b.yb(1),b.hc("key",n.formsService.currentForm.controls.sourceDatalinkKey.value)}}function _(e,t){if(1&e&&(b.Ob(0,"form",28),b.Ob(1,"fieldset"),b.Ob(2,"section"),b.Lb(3,"form-input",29),b.Nb(),b.Ob(4,"section"),b.Lb(5,"form-textarea",30),b.Nb(),b.Ob(6,"section"),b.Ob(7,"div",31),b.Ob(8,"section",32),b.Lb(9,"form-select",33),b.Nb(),b.Dc(10,E,3,3,"section",34),b.Dc(11,L,4,3,"section",34),b.Nb(),b.Lb(12,"form-checkbox",35),b.Lb(13,"form-checkbox",36),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb(3);b.hc("formGroup",a.formsService.currentForm),b.yb(3),b.hc("autocapitalize",a.on)("errors",a.formsService.formErrors.name),b.yb(2),b.hc("showMarkdown",!0),b.yb(4),b.hc("items",a.sourceTypes)("enableFilter",!1),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eDataObjectType.Table),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eDataObjectType.Datalink)}}function P(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",41),b.Ob(1,"dexih-button-refresh",42),b.Vb("click",(function(){return b.vc(a),b.Zb(3).refresh()})),b.Nb(),b.Nb()}2&e&&(b.yb(1),b.hc("autoCompact",!1))}function M(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-widget-section",24),b.Dc(1,_,14,8,"form",25),b.Ob(2,"input-parameters",26),b.Vb("onRefreshData",(function(){return b.vc(a),b.Zb(2).refresh()}))("onChange",(function(){return b.vc(a),b.Zb(2).parameterChange()})),b.Nb(),b.Dc(3,P,2,1,"div",27),b.Nb()}if(2&e){var n=b.Zb(2);b.hc("showExpandButton",!0),b.yb(1),b.hc("ngIf",n.showEdit),b.yb(1),b.hc("showEdit",n.showEdit)("parameters",null==n.formsService.currentForm?null:n.formsService.currentForm.controls.parameters)("formsService",n.formsService)("refreshEvent",n.refreshDataSubject.asObservable()),b.yb(1),b.hc("ngIf",!n.data||0===n.data.length)}}function A(e,t){if(1&e){var a=b.Pb();b.Ob(0,"span",45),b.Ob(1,"div",46),b.Ob(2,"div",47),b.Fc(3),b.Nb(),b.Nb(),b.Ob(4,"form-input",48),b.Vb("ngModelChange",(function(e){return b.vc(a),t.$implicit.value=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit,i=t.index;b.yb(3),b.Hc(" ",n.logicalName," "),b.yb(1),b.jc("name","column",i,""),b.hc("placeholder","Enter "+n.logicalName)("ngModel",n.value)}}function R(e,t){if(1&e&&(b.Ob(0,"dexih-widget-section",43),b.Dc(1,A,5,4,"span",44),b.Nb()),2&e){var a=b.Zb(2);b.hc("showExpandButton",!0),b.yb(1),b.hc("ngForOf",a.inputColumns)}}function j(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-widget-section",49),b.Ob(1,"query-builder",50),b.Vb("hasChanged",(function(){return b.vc(a),b.Zb(2).hasChanged()}))("onRefreshData",(function(){return b.vc(a),b.Zb(2).refresh()})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(2);b.hc("showExpandButton",!0),b.yb(1),b.hc("selectQuery",n.formsService.currentForm.controls.selectQuery.value)("columns",n.tableColumns)("inputColumns",n.inputColumns)("parameters",n.formsService.currentForm.controls.parameters.value)("refreshEvent",n.refreshDataSubject.asObservable())}}function Z(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-refresh",11),b.Vb("click",(function(){return b.vc(a),b.Zb(4).refresh()})),b.Nb()}}function H(e,t){if(1&e&&(b.Ob(0,"dexih-table",53),b.Dc(1,Z,1,0,"ng-template",null,54,b.Ec),b.Nb()),2&e){var a=b.Zb(3);b.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",a.columns)("data",a.data)("hideTable",a.showChart)}}function G(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div"),b.Ob(1,"chart-builder",55),b.Vb("hasChanged",(function(){return b.vc(a),b.Zb(3).hasChanged()})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(3);b.yb(1),b.hc("title",n.formsService.currentForm.controls.name.value)("columns",n.columns)("data",n.data)("config",n.formsService.currentForm.controls.chartConfig.value)("showEdit",n.showEdit)}}function q(e,t){if(1&e&&(b.Dc(0,H,3,5,"dexih-table",51),b.Dc(1,G,2,5,"div",52)),2&e){var a=b.Zb(2);b.hc("ngIf",!a.showChart),b.yb(1),b.hc("ngIf",a.showChart)}}function B(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",1),b.Ob(1,"dexih-widget",2),b.Vb("close",(function(){return b.vc(a),b.Zb().close()})),b.Dc(2,K,13,10,"ng-template",null,3,b.Ec),b.Dc(4,M,4,7,"dexih-widget-section",4),b.Dc(5,R,2,2,"dexih-widget-section",5),b.Ob(6,"series-animate",6),b.Vb("hasChanged",(function(){return b.vc(a),b.Zb().hasChanged()}))("dataChange",(function(e){return b.vc(a),b.Zb().data=e})),b.Nb(),b.Dc(7,j,2,6,"dexih-widget-section",7),b.Dc(8,q,2,2,"ng-template",8),b.Nb(),b.Lb(9,"dexih-help",9),b.Nb()}if(2&e){var n=b.Zb();b.yb(1),b.hc("showCloseButton",!0)("padding",!1),b.yb(3),b.hc("ngIf",n.formsService.currentForm&&(n.showEdit||(null==n.formsService.currentForm?null:n.formsService.currentForm.controls.parameters.length)>0||(null==n.datalinkParameters?null:n.datalinkParameters.length)>0)),b.yb(1),b.hc("ngIf",n.inputColumns&&n.inputColumns.length>0),b.yb(1),b.hc("showEdit",n.showEdit)("animateConfig",n.animateConfig)("columns",n.columns)("baseData",n.baseData)("data",n.data),b.yb(1),b.hc("ngIf",n.showEdit),b.yb(1),b.hc("ngIf",(null==n.columns?null:n.columns.length)>0&&(null==n.data?null:n.data.length)>0)}}var U=function(){var e=function(){function e(t,a,i,r,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=i,this.route=r,this.router=o,this.showEdit=!1,this.hasEdited=!1,this.refreshDataSubject=new n.a,this.sourceTypes=[{key:u.lb.Datalink,name:"Datalink"},{key:u.lb.Table,name:"Table"}],this.eViewType=u.rc,this.eDataObjectType=u.lb,this.connectionTables=[],this.datalinks=[],this.showChart=!1,this.isLoaded=!1,this.firstLoad=!0,this.dialogOpen=!1,this.animationValues=[],this.animationPaused=!1,this.cancelToken=new c.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.remoteAgent=t[3],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===l.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Edit")}}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,this.hubCache&&this.hubCache.isLoaded()&&(this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks),"edit"===this.action)if(this.viewKey=+this.params.viewKey,this.viewKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihViews.find((function(t){return t.key===e.viewKey}));null==(t=JSON.parse(JSON.stringify(t))).selectQuery&&(t.selectQuery=new u.V),null==t.animateConfig&&(t.animateConfig=new u.a),this.inputColumns=t.inputValues,this.showChart=t.viewType===u.rc.Chart,this.formsService.view(t),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no view specified to edit.");if("new"===this.action){var a=new u.L;a.selectQuery=new u.V,a.animateConfig=new u.a,this.formsService.view(a),this.watchChanges(),this.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/view-new","/view-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.remoteAgent&&(this.firstLoad?this.formsService.currentForm.controls.autoRefresh.value&&this.refresh():this.dialogOpen||(this.dialogOpen=!0,this.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then((function(t){t&&e.refresh(),e.dialogOpen=!1}))))}},{key:"watchChanges",value:function(){var e=this;this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(r.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe((function(){e.reset(),e.selectQuery=new u.V,e.animateConfig=new u.a,e.getColumns(),e.refreshDatalink(),e.refresh()}))}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"toggleChart",value:function(){this.showChart?(this.showChart=!1,this.formsService.currentForm.controls.viewType.setValue(u.rc.Table)):(this.showChart=!0,null==this.formsService.currentForm.controls.chartConfig.value&&this.formsService.currentForm.controls.chartConfig.setValue(new u.b),this.formsService.currentForm.controls.viewType.setValue(u.rc.Chart))}},{key:"getColumns",value:function(){var e=this.formsService.currentForm,t=e.controls.inputValues.value;if(e.controls.sourceType.value===u.lb.Table&&e.controls.sourceTableKey.value>0){var a=this.hubCache.getTable(e.controls.sourceTableKey.value);if(a)return this.inputColumns=a.dexihTableColumns.filter((function(e){return e.isInput})).map((function(e){return t.find((function(t){return t.name===e.name})),{datalinkKey:0,datalinkName:"",name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue,defaultValue:e.defaultValue}})),void(this.tableColumns=a.dexihTableColumns);this.reset()}else this.reset();if(e.controls.sourceType.value===u.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){var n=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(n){var i=new s.b;i.buildInputOutput(this.hubCache,n),this.tableColumns=i.getDatalinkOutputColumns(n),this.inputColumns=n.sourceDatalinkTable.dexihDatalinkColumns.filter((function(e){return e.isInput})).map((function(e){var a,i=t.find((function(t){return t.name===e.name}));return a=i?i.value:e.defaultValue,{datalinkKey:n.key,datalinkName:n.name,name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:a,defaultValue:e.defaultValue}}))}else this.reset()}else this.reset()}},{key:"reset",value:function(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null,this.baseData=null}},{key:"refreshDatalink",value:function(){for(var e=this.formsService.currentForm,t=this.formsService.currentForm.controls.parameters,a=t.controls.length-1;a>=0;a--)t.controls[a].value.datalinkParameterKey&&t.removeAt(a);if(e.controls.sourceType.value===u.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){var n=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(n){var i,r=_createForOfIteratorHelper(n.parameters);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=Object.assign({},o);s.datalinkParameterKey=o.key,s.key=this.hubCache.getNextSequence();var c=this.formsService.parameter(s);t.push(c)}}catch(l){r.e(l)}finally{r.f()}}}}},{key:"refresh",value:function(){var e=this,t=this.formsService.currentForm,a=[],n=this.formsService.currentForm.controls.parameters.getRawValue();n&&(a=a.concat(n));var i=t.value;i.selectQuery=t.controls.selectQuery.value,i.animateConfig=t.controls.animateConfig.value,(i.sourceType===u.lb.Table&&i.sourceTableKey>0||i.sourceType===u.lb.Datalink&&i.sourceDatalinkKey>0)&&this.hubService.previewView(i,this.inputColumns,a,this.cancelToken).then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.baseData=t.data,e.animateConfig.seriesColumn||(e.data=e.baseData)})).catch((function(){}))}},{key:"download",value:function(e){var t=this.formsService.currentForm.value,a=new u.M;t.sourceType===u.lb.Datalink&&(a.objectKey=t.sourceDatalinkKey,a.objectType=u.lb.Datalink),t.sourceType===u.lb.Table&&(a.objectKey=t.sourceTableKey,a.objectType=u.lb.Table),a.query=this.selectQuery,this.hubService.downloadData([a],!1,e,this.cancelToken)}},{key:"hasChanged",value:function(){this.formsService.markAsChanged()}},{key:"parameterChange",value:function(){this.formsService.currentForm.controls.autoRefresh.value&&this.refresh()}},{key:"toggleEdit",value:function(){this.showEdit=!this.showEdit,this.hasEdited=!0}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.hasEdited&&e.formsService.hasChanged?e.authService.confirmDialog("The view has not been saved","The view changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.hasEdited&&this.formsService.hasChanged&&(e.returnValue="The view changes have not been saved.  Do you want to discard the changes and exit?")}},{key:"animateConfig",get:function(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.animateConfig.value},set:function(e){var t,a;null===(a=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===a||a.controls.animateConfig.setValue(e)}},{key:"selectQuery",get:function(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.selectQuery.value},set:function(e){var t,a;null===(a=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===a||a.controls.selectQuery.setValue(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(b.Kb(h.a),b.Kb(d.a),b.Kb(o.a),b.Kb(f.a),b.Kb(f.e))},e.\u0275cmp=b.Eb({type:e,selectors:[["dexih-view-edit-form"]],hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},features:[b.xb([o.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit View","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton",4,"ngIf"],["title","InputColumns",3,"showExpandButton",4,"ngIf"],[3,"showEdit","animateConfig","columns","baseData","data","hasChanged","dataChange"],["title","Query Configuration",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"mr-1",3,"control","click"],["text","Reload",1,"mr-1",3,"click"],[1,"mr-1",3,"download"],["data-toggle","buttons","title","Table",1,"btn-group","btn-group-toggle","mr-1"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","table","autocomplete","off",3,"click"],[1,"fa","fa-table"],["title","Chart",1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","chart","autocomplete","off",3,"click"],[1,"fa","fa-bar-chart"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"mr-1",3,"text","click"],[3,"formsService"],[1,"mr-1",3,"formsService"],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],[3,"showEdit","parameters","formsService","refreshEvent","onRefreshData","onChange"],["class","mt-3",4,"ngIf"],[3,"formGroup"],["label","View Name","formControlName","name","placeholder","Enter the view name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["formControlName","autoRefresh","label","Automatically refresh data when view is opened"],["label","View is shared in the catalog to users with read access.","formControlName","isShared"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["text","Refresh Parameters",3,"click"],[1,"mt-3"],["text","Reload",1,"mr-1",3,"autoCompact","click"],["title","InputColumns",3,"showExpandButton"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable",4,"ngIf"],[4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable"],["actions",""],[3,"title","columns","data","config","showEdit","hasChanged"]],template:function(e,t){1&e&&b.Dc(0,B,10,11,"div",0),2&e&&b.hc("ngIf",t.formsService)},directives:[m.t,v.P,p.a,g.a,y.a,v.s,C.a,m.q,v.j,k.a,w.a,v.T,S.a,T.I,T.t,T.l,v.D,T.s,T.j,v.H,v.E,v.A,O.a,N.a,m.s,T.v,D.a,x.a,F.a],encapsulation:2}),e}()},NUI7:function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return P}));var n=a("2Vo4"),i=a("itXk"),r=a("soiQ"),o=a("fXoL"),s=a("4Y1E"),c=a("ElCs"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("/pur"),d=a("ofXK"),f=a("EjXd"),m=a("mWX8"),v=function(){return["fileFormat-new"]};function p(e,t){1&e&&o.Lb(0,"dexih-button-new",10),2&e&&o.hc("routerLink",o.lc(1,v))}function g(e,t){if(1&e&&o.Dc(0,p,1,2,"dexih-button-new",9),2&e){var a=o.Zb();o.hc("ngIf",a.hubCache.canWrite)}}function y(e,t){1&e&&o.Lb(0,"actions-fileFormat-button",11),2&e&&o.hc("fileFormat",t.item)}function C(e,t){if(1&e){var a=o.Pb();o.Ob(0,"dexih-button-delete",15),o.Vb("click",(function(){o.vc(a);var e=o.Zb().items;return o.Zb().deleteFileFormats(e)})),o.Nb()}}function k(e,t){if(1&e){var a=o.Pb();o.Ob(0,"dexih-button-save-local",12),o.Vb("click",(function(){o.vc(a);var e=t.items;return o.Zb().export(e)})),o.Nb(),o.Dc(1,C,1,0,"dexih-button-delete",13),o.Lb(2,"tags-update-button",14)}if(2&e){var n=t.items,i=o.Zb();o.yb(1),o.hc("ngIf",i.hubCache.canWrite),o.yb(1),o.hc("objectType",i.eSharedObjectType.FileFormat)("objects",n)}}var w,S=((w=function(){function e(t,a,i,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=i,this.route=o,this.eSharedObjectType=r.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new n.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateFileFormats()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"File Format Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteFileFormats",value:function(e){this.hubService.deleteFileFormats(e)}},{key:"updateFileFormats",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihFileFormats.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(r.dc.FileFormat,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editFileFormat",value:function(e){this.router.navigate(["fileFormat-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddFileFormat(e.key,a)})),this.hubService.exportHub(a,1===e.length?"FileFormat - "+e[0].name+".json":"fileFormats.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==r.dc.FileFormat&&t.changeClass!==r.dc.TagObjects||e.updateFileFormats()}))}}]),e}()).\u0275fac=function(e){return new(e||w)(o.Kb(s.a),o.Kb(c.a),o.Kb(l.e),o.Kb(l.a))},w.\u0275cmp=o.Eb({type:w,selectors:[["fileFormats"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","File Formats","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],["class","mr-1","title","Create a new file format",3,"routerLink",4,"ngIf"],["title","Create a new file format",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"fileFormat"],[1,"mr-1",3,"click"],["title","Delete selected file formats",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["title","Delete selected file formats",3,"click"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"dexih-widget",1),o.Vb("close",(function(){return t.close()})),o.Ob(2,"dexih-table",2),o.Vb("rowClick",(function(e){return t.editFileFormat(e)})),o.Dc(3,g,1,1,"ng-template",null,3,o.Ec),o.Dc(5,y,1,1,"ng-template",4,5,o.Ec),o.Dc(7,k,3,3,"ng-template",6,7,o.Ec),o.Nb(),o.Nb(),o.Lb(9,"dexih-help",8),o.Nb()),2&e&&(o.yb(1),o.hc("showCloseButton",!0),o.yb(1),o.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,b.a,h.a,d.t,u.o,l.f,f.a,u.u,m.a,u.g],encapsulation:2}),w),T=a("cvPx"),O=a("2v7R"),N=a("iFLP"),D=a("64E1"),x=a("oLr2"),F=a("3Pt+");function V(e,t){if(1&e&&o.Lb(0,"save-button",8),2&e){var a=o.Zb(2);o.hc("formsService",a.formsService)}}function I(e,t){if(1&e){var a=o.Pb();o.Ob(0,"dexih-invalid-form-details",5),o.Vb("click",(function(){return o.vc(a),o.Zb().formsService.showErrors()})),o.Nb(),o.Dc(1,V,1,1,"save-button",6),o.Lb(2,"cancel-button",7)}if(2&e){var n=o.Zb();o.hc("control",n.formsService.currentForm),o.yb(1),o.hc("ngIf",n.hubCache.canWrite),o.yb(1),o.hc("formsService",n.formsService)}}function K(e,t){if(1&e&&(o.Ob(0,"div"),o.Lb(1,"form-input",32),o.Nb()),2&e){var a=o.Zb(2);o.yb(1),o.hc("errors",a.formsService.formErrors.comment)}}function E(e,t){if(1&e&&(o.Ob(0,"div"),o.Lb(1,"form-input",33),o.Nb()),2&e){var a=o.Zb(2);o.yb(1),o.hc("maxlength",1)("errors",a.formsService.formErrors.quote)}}function L(e,t){if(1&e&&(o.Ob(0,"form",9),o.Ob(1,"fieldset"),o.Ob(2,"section"),o.Lb(3,"form-input",10),o.Nb(),o.Ob(4,"section"),o.Lb(5,"form-textarea",11),o.Nb(),o.Ob(6,"div",12),o.Ob(7,"section",13),o.Lb(8,"form-input",14),o.Nb(),o.Lb(9,"section",13),o.Nb(),o.Ob(10,"div",12),o.Ob(11,"section",13),o.Lb(12,"form-input",15),o.Nb(),o.Ob(13,"section",13),o.Lb(14,"form-input",16),o.Nb(),o.Nb(),o.Ob(15,"div",12),o.Ob(16,"section",13),o.Lb(17,"form-checkbox",17),o.Nb(),o.Ob(18,"section",13),o.Lb(19,"form-checkbox",18),o.Nb(),o.Nb(),o.Ob(20,"div",12),o.Ob(21,"section",13),o.Lb(22,"form-checkbox",19),o.Nb(),o.Ob(23,"section",13),o.Lb(24,"form-checkbox",20),o.Nb(),o.Nb(),o.Ob(25,"div",12),o.Ob(26,"section",13),o.Lb(27,"form-checkbox",21),o.Dc(28,K,2,1,"div",22),o.Nb(),o.Ob(29,"section",13),o.Lb(30,"form-checkbox",23),o.Dc(31,E,2,2,"div",22),o.Nb(),o.Nb(),o.Ob(32,"div",12),o.Ob(33,"section",13),o.Lb(34,"form-checkbox",24),o.Nb(),o.Ob(35,"section",13),o.Lb(36,"form-checkbox",25),o.Nb(),o.Nb(),o.Ob(37,"div",12),o.Ob(38,"section",13),o.Lb(39,"form-checkbox",26),o.Nb(),o.Ob(40,"section",13),o.Lb(41,"form-checkbox",27),o.Nb(),o.Nb(),o.Ob(42,"div",12),o.Ob(43,"section",13),o.Lb(44,"form-checkbox",28),o.Nb(),o.Ob(45,"section",13),o.Lb(46,"form-checkbox",29),o.Nb(),o.Nb(),o.Ob(47,"div",12),o.Ob(48,"section",13),o.Lb(49,"form-checkbox",30),o.Nb(),o.Ob(50,"section",13),o.Lb(51,"form-checkbox",31),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e){var a=o.Zb();o.hc("formGroup",a.formsService.currentForm),o.yb(3),o.hc("errors",a.formsService.formErrors.name)("autocapitalize",!0),o.yb(2),o.hc("showMarkdown",!0),o.yb(3),o.hc("errors",a.formsService.formErrors.delimiter),o.yb(4),o.hc("errors",a.formsService.formErrors.bufferSize),o.yb(2),o.hc("errors",a.formsService.formErrors.skipHeaderRows),o.yb(14),o.hc("ngIf",a.formsService.currentForm.controls.allowComments.value),o.yb(3),o.hc("ngIf",!a.formsService.currentForm.controls.ignoreQuotes.value)}}var _,P=((_=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===O.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"File Format Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe()}},{key:"load",value:function(){var e=this;if(this.hubCache.isLoaded()){if(!this.hubCache||this.hubCache.status!==O.j.Loaded||this.isLoaded)return;if(this.isLoaded=!0,"edit"===this.action)if(this.fileFormatKey=+this.params.fileFormatKey,this.fileFormatKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihFileFormats.find((function(t){return t.key===e.fileFormatKey}));this.formsService.fileFormat(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no file format specified to edit.");if("new"===this.action){var a=new r.y;this.formsService.fileFormat(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/fileFormat-new","/fileFormat-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}}}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||_)(o.Kb(s.a),o.Kb(c.a),o.Kb(T.a),o.Kb(l.a),o.Kb(l.e))},_.\u0275cmp=o.Eb({type:_,selectors:[["dexih-fileFormat-edit-form"]],features:[o.xb([T.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Format","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","File Format Name","formControlName","name","placeholder","Enter the file format name.","iconClass","fa fa-list",3,"errors","autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Delimiter","formControlName","delimiter","placeholder","Enter the delimiter","iconClass","fa fa-list","note","The field delimiter (use \\t=tab, \\n=new line, \\r=carriage return).",3,"errors"],["type","number","label","Buffer Size","formControlName","bufferSize","placeholder","Enter buffer size","iconClass","fa fa-list","note","The size of the internal buffer that is used when reader or writing data.",3,"errors"],["type","number","label","Skip Header Rows Count","formControlName","skipHeaderRows","placeholder","Enter row count","iconClass","fa fa-list","note","The number of rows at the start of the file that will be ignored.",3,"errors"],["label","Has Header Record","formControlName","hasHeaderRecord","note","Tells the reader/writer if there is a header row in the CSV file."],["label","Ignore Header White Space","formControlName","ignoreHeaderWhiteSpace","note","Tells the reader to ignore white space in the headers when matching the columns to the properties by name."],["label","Match to Column to Header","formControlName","matchHeaderRecord","note","Tells the reader to use the column heading name to load the data.  If unchecked, columns will be read into fields in the order specified in the table columns."],["label","Set White Space Cells to Null ","formControlName","setWhiteSpaceCellsToNull","note","Set empty cells or cells containing only white spaces to null."],["label","Allow Comments","formControlName","allowComments"],[4,"ngIf"],["label","Ignore Quotes","formControlName","ignoreQuotes"],["label","Quote All Fields","formControlName","quoteAllFields","note","Tells the writer whether all fields written should have quotes around them; regardless if the field contains anything that should be escaped."],["label","Quote No Fields","formControlName","quoteNoFields","note","Tells the writer whether all fields written should not have quotes around them; regardless if the field contains anything that should be escaped."],["label","Trim Fields","formControlName","trimFields","note","Tells the reader to trim whitespace from the beginning and ending of the field value when reading."],["label","Trim Headers","formControlName","trimHeaders","note","Tells the reader to ignore white space from the beginning and ending of the headers when matching the columns to the properties by name."],["label","Detect Column Count Changes","formControlName","detectColumnCountChanges","note","Check for changes in the number of column from row to row.  If true, the job will abend."],["label","Ignore Reading Exceptions","formControlName","ignoreReadingExceptions","note","Tells the reader to ignore any issues when parsing the file.  Issues mean the file is bad in some way, and the parser isn't able to recover."],["label","Will Abend On Missing Field","formControlName","willThrowOnMissingField","note","Indicates if the job should be abended if reading and an expected field is missing."],["label","Skip Empty Records","formControlName","skipEmptyRecords","note","Tells the reader a record should be skipped when reading if it's empty. A record is considered empty if all fields are empty."],["label","Comment","formControlName","comment","placeholder","Enter comment character","iconClass","fa fa-list","note","The value used to denote a line that is commented out.",3,"errors"],["label","Quote","formControlName","quote","placeholder","Enter the quote","iconClass","fa fa-list","note","The value used to escape fields that contain a delimiter, quote, or line ending.",3,"maxlength","errors"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"dexih-widget",1),o.Vb("close",(function(){return t.close()})),o.Dc(2,I,3,3,"ng-template",null,2,o.Ec),o.Dc(4,L,52,9,"form",3),o.Nb(),o.Lb(5,"dexih-help",4),o.Nb()),2&e&&(o.yb(1),o.hc("showCloseButton",!0)("padding",!0),o.yb(3),o.hc("ngIf",t.formsService.currentForm))},directives:[u.P,d.t,h.a,N.a,D.a,x.a,F.I,F.t,F.l,u.D,F.s,F.j,u.H,u.A,F.o],encapsulation:2}),_)},NbKI:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a("fXoL"),i=a("XNiG"),r=a("itXk"),o=a("3WyZ"),s=a("soiQ"),c=a("ElCs"),l=a("Xjf6"),u=a("cvPx"),b=a("Wumg"),h=a("ofXK"),d=a("3Pt+"),f=a("YcGA"),m=a("PMKX"),v=a("HjvC"),p=a("l2bN"),g=a("H3K+"),y=a("g8Ys"),C=["widget"];function k(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button-edit",10),n.Vb("click",(function(){return n.vc(a),n.Zb().toggleEdit()})),n.Nb()}2&e&&n.hc("compact",!0)}function w(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button-preview",10),n.Vb("click",(function(){return n.vc(a),n.Zb().toggleEdit()})),n.Nb()}2&e&&n.hc("compact",!0)}function S(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button",14),n.Vb("click",(function(){return n.vc(a),n.Zb().maximise()})),n.Nb()}}function T(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button",15),n.Vb("click",(function(){return n.vc(a),n.Zb().maximise()})),n.Nb()}}function O(e,t){if(1&e){var a=n.Pb();n.Ob(0,"span",20),n.Ob(1,"div",21),n.Ob(2,"div",22),n.Fc(3),n.Nb(),n.Nb(),n.Ob(4,"form-input",23),n.Vb("ngModelChange",(function(e){return n.vc(a),t.$implicit.value=e})),n.Nb(),n.Nb()}if(2&e){var i=t.$implicit,r=t.index;n.yb(3),n.Hc(" ",i.logicalName," "),n.yb(1),n.jc("name","column",r,""),n.hc("placeholder","Enter "+i.logicalName)("ngModel",i.value)}}function N(e,t){if(1&e&&(n.Ob(0,"div",18),n.Dc(1,O,5,4,"span",19),n.Nb()),2&e){var a=n.Zb(2);n.yb(1),n.hc("ngForOf",a.inputColumns)}}function D(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",18),n.Ob(1,"input-parameters",24),n.Vb("onRefreshData",(function(){return n.vc(a),n.Zb(2).refresh()})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb(2);n.yb(1),n.hc("showEdit",!1)("parameters",i.item.controls.parameters)("formsService",i.formsService)("parentParameters",i.parentParameters)("refreshEvent",i.refreshDataSubject.asObservable())}}function x(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",25),n.Ob(1,"series-animate",26),n.Vb("hasChanged",(function(){return n.vc(a),n.Zb(2).hasChanged()}))("dataChange",(function(e){return n.vc(a),n.Zb(2).dataRows=e})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb(2);n.yb(1),n.hc("showEdit",!1)("showFrame",!1)("animateConfig",null==i.dataResult?null:i.dataResult.viewConfig.animateConfig)("columns",null==i.dataResult?null:i.dataResult.columns)("baseData",null==i.dataResult?null:i.dataResult.data)("data",i.dataRows)}}function F(e,t){if(1&e&&(n.Ob(0,"div"),n.Dc(1,N,2,1,"div",16),n.Dc(2,D,2,5,"div",16),n.Dc(3,x,2,6,"div",17),n.Nb()),2&e){var a=n.Zb();n.yb(1),n.hc("ngIf",a.inputColumns&&a.inputColumns.length>0),n.yb(1),n.hc("ngIf",a.item.controls.parameters.length>0),n.yb(1),n.hc("ngIf",!(null!=a.data&&a.data.isRefreshing)&&(null==a.dataResult||null==a.dataResult.columns?null:a.dataResult.columns.length)>0&&(null==a.dataResult?null:a.dataResult.viewConfig)&&(null==a.dataResult?null:a.dataResult.data))}}function V(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",27),n.Ob(1,"form",28),n.Ob(2,"section"),n.Lb(3,"form-input",29),n.Nb(),n.Ob(4,"section"),n.Lb(5,"form-textarea",30),n.Nb(),n.Ob(6,"section"),n.Ob(7,"form-select",31),n.Lb(8,"view-edit-button",32),n.Nb(),n.Nb(),n.Ob(9,"section"),n.Lb(10,"form-checkbox",33),n.Lb(11,"form-checkbox",34),n.Nb(),n.Nb(),n.Ob(12,"input-parameters",35),n.Vb("onRefreshData",(function(){return n.vc(a),n.Zb().refresh()})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb();n.yb(1),n.hc("formGroup",i.item),n.yb(2),n.hc("autocapitalize",i.on),n.yb(2),n.hc("showMarkdown",!0),n.yb(2),n.hc("items",i.views),n.yb(1),n.hc("key",i.item.controls.viewKey.value),n.yb(4),n.hc("showEdit",i.showEdit)("allowAddRemove",!1)("parameters",i.item.controls.parameters)("formsService",i.formsService)("parentParameters",i.parentParameters)("refreshEvent",i.refreshDataSubject.asObservable())}}function I(e,t){1&e&&(n.Ob(0,"div",40),n.Lb(1,"div",41),n.Fc(2," Refreshing, please wait... "),n.Nb())}function K(e,t){if(1&e&&(n.Ob(0,"div",46),n.Ob(1,"div",47),n.Ob(2,"b"),n.Fc(3),n.Nb(),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(3),n.Gc(a.item.controls.name.value)}}function E(e,t){if(1&e&&(n.Ob(0,"div",48),n.Ob(1,"div",18),n.Lb(2,"ngx-md",49),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(2),n.hc("data",a.item.controls.description.value)}}function L(e,t){if(1&e&&n.Lb(0,"dexih-table",54),2&e){var a=n.Zb(5);n.hc("enableMultiSelect",!1)("enableResponsive",!1)("enableSaveCsv",!1)("enableFilter",!1)("columns",a.dataResult.columns)("data",a.dataRows)}}function _(e,t){if(1&e&&n.Lb(0,"chart-view",55),2&e){var a=n.Zb(5);n.hc("responsive",!0)("columns",a.dataResult.columns)("data",a.dataRows)("config",a.view.chartConfig)}}function P(e,t){if(1&e&&(n.Ob(0,"div",50),n.Dc(1,L,1,6,"dexih-table",51),n.Ob(2,"div",52),n.Dc(3,_,1,4,"chart-view",53),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(1),n.hc("ngIf",a.view.viewType==a.eViewType.Table),n.yb(2),n.hc("ngIf",a.view.viewType==a.eViewType.Chart)}}function M(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",56),n.Vb("click",(function(){return n.vc(a),n.Zb(4).refresh()})),n.Lb(1,"i",57),n.Fc(2," Select to refresh the view. "),n.Nb()}}function A(e,t){if(1&e&&(n.Dc(0,K,4,1,"div",42),n.Dc(1,E,3,1,"div",43),n.Dc(2,P,4,2,"div",44),n.Dc(3,M,3,0,"ng-template",null,45,n.Ec)),2&e){var a=n.sc(4),i=n.Zb(3);n.hc("ngIf",i.item.controls.header.value),n.yb(1),n.hc("ngIf",i.item.controls.description.value),n.yb(1),n.hc("ngIf",!(null!=i.data&&i.data.isRefreshing)&&(null==i.dataResult||null==i.dataResult.columns?null:i.dataResult.columns.length)>0&&(null==i.dataResult||null==i.dataResult.data?null:i.dataResult.data.length)>0)("ngIfElse",a)}}var R=function(e){return{overflow:e}};function j(e,t){if(1&e&&(n.Ob(0,"div",37),n.Dc(1,I,3,0,"div",38),n.Dc(2,A,5,4,"ng-template",null,39,n.Ec),n.Nb()),2&e){var a=n.sc(3),i=n.Zb(2);n.hc("ngStyle",n.mc(3,R,i.item.controls.scrollable.value?"scroll":"hidden")),n.yb(1),n.hc("ngIf",null==i.data?null:i.data.isRefreshing)("ngIfElse",a)}}function Z(e,t){if(1&e&&n.Dc(0,j,4,5,"div",36),2&e){var a=n.Zb();n.hc("ngIf",!a.showPreview&&a.view)}}var H=function(){var e=function(){function e(t,a,r){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.formsService=r,this.showEdit=!0,this.showPreview=!1,this.isMaximized=!1,this.onRemove=new n.n,this.onMaximize=new n.n,this.eViewType=s.rc,this.firstLoad=!0,this.dialogOpen=!1,this.dataRows=[],this.refreshDataSubject=new i.a,this.cancelToken=new o.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(r.a)(this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a;e.hubCache=t[0],e.remoteAgent=t[1],e.hubService.isHubCacheLoaded&&(e.views=e.hubCache.hub.dexihViews,(null===(a=e.item)||void 0===a?void 0:a.controls.viewKey)&&(e.view=e.hubCache.hub.dexihViews.find((function(t){return t.key===e.item.controls.viewKey.value})),e.data=e.item.controls.runTime.value.data,e.data?e._refreshDataSubscription=e.data.data.subscribe((function(t){t&&(e.dataResult=t,t.viewConfig.animateConfig||(e.dataRows=e.dataResult.data),t.status&&e.hubService.addHubMessage(t.status,!1,e.view.name))})):e.remoteAgent&&(e.firstLoad?e.refresh():e.dialogOpen||(e.dialogOpen=!0,e.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then((function(t){t&&e.refresh(),e.dialogOpen=!1}))),e.firstLoad=!1)),e.parentParameters=e.formsService.currentForm.controls.parameters.value,e._parametersSubscription&&e._parametersSubscription.unsubscribe(),e._parametersSubscription=e.formsService.currentForm.controls.parameters.valueChanges.subscribe((function(t){e.parentParameters=t})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._refreshDataSubscription&&this._refreshDataSubscription.unsubscribe(),this._parametersSubscription&&this._parametersSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"ngOnChanges",value:function(e){var t=this,a=e.item;if(a){var n=a.currentValue;this.views&&n.value&&(this.view=this.hubCache.hub.dexihViews.find((function(e){return e.key===n.value}))),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._viewKeySubscription=n.controls.viewKey.valueChanges.subscribe((function(e){t.formsService.updateDashboardItemView(n)}))}}},{key:"refresh",value:function(){var e=this,t=this.hubService.previewViewKey(this.item.controls.viewKey.value,null,this.formsService.currentForm.controls.parameters.value,this.item.controls.parameters.value,this.cancelToken);this.data=this.item.controls.runTime.value.data,this.data.refresh(t),t.then((function(t){e.refreshDataSubject.next(),e.dataResult=t,e.dataResult.viewConfig.animateConfig||(e.dataRows=e.dataResult.data)})).catch((function(t){e.hubService.addHubMessage(t)}))}},{key:"parameterChange",value:function(){this.refresh()}},{key:"toggleEdit",value:function(){this.showEdit=!this.showEdit}},{key:"removeItem",value:function(e){e.preventDefault(),e.stopPropagation(),this.onRemove.emit()}},{key:"maximise",value:function(){this.onMaximize.emit(this.item)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(n.Kb(c.a),n.Kb(l.a),n.Kb(u.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["dashboard-item"]],viewQuery:function(e,t){var a;1&e&&n.Bc(C,!0),2&e&&n.rc(a=n.Wb())&&(t.widget=a.first)},inputs:{item:"item",showEdit:"showEdit",showPreview:"showPreview",refreshData:"refreshData",isMaximized:"isMaximized"},outputs:{onRemove:"onRemove",onMaximize:"onMaximize"},features:[n.wb],decls:16,vars:9,consts:[[1,"side-menu"],[1,"side-menu-content"],[1,"spin-icon"],[1,"fa","fa-cog","fa-spin"],[1,"side-menu-box"],[1,"bg-light","rounded","p-1"],[3,"compact","click"],["class","ml-1",3,"compact","click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",3,"click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",3,"click",4,"ngIf"],[1,"ml-1",3,"compact","click"],[4,"ngIf"],["class","p-3 gridster-item-content",4,"ngIf"],[3,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",1,"ml-1",3,"click"],["buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",1,"ml-1",3,"click"],["class","m-1",4,"ngIf"],["class","m-1","style","z-index: 99999;",4,"ngIf"],[1,"m-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"showEdit","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],[1,"m-1",2,"z-index","99999"],[3,"showEdit","showFrame","animateConfig","columns","baseData","data","hasChanged","dataChange"],[1,"p-3","gridster-item-content"],[3,"formGroup"],["label","Item Name","formControlName","name","placeholder","Enter the dashboard item name.","iconClass","fa fa-list",3,"autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Select View","formControlName","viewKey","itemKey","key","itemName","name",3,"items"],[3,"key"],["label","Show Header","formControlName","header"],["label","Allow Scrolling","formControlName","scrollable"],[3,"showEdit","allowAddRemove","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],["class","box",3,"ngStyle",4,"ngIf"],[1,"box",3,"ngStyle"],["class","p-3",4,"ngIf","ngIfElse"],["notRefreshing",""],[1,"p-3"],[1,"dexih-loader"],["class","box-header bg-secondary text-white",4,"ngIf"],["class","box-header",4,"ngIf"],["class","box-content",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"box-header","bg-secondary","text-white"],[1,"m-3"],[1,"box-header"],[3,"data"],[1,"box-content"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data",4,"ngIf"],[1,"h-100"],[3,"responsive","columns","data","config",4,"ngIf"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data"],[3,"responsive","columns","data","config"],[1,"alert","alert-info",3,"click"],[1,"fa","fa-warning"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"div",1),n.Ob(2,"div",2),n.Lb(3,"i",3),n.Nb(),n.Ob(4,"div",4),n.Ob(5,"div",5),n.Ob(6,"div"),n.Ob(7,"dexih-button-refresh",6),n.Vb("click",(function(){return t.refresh()})),n.Nb(),n.Dc(8,k,1,1,"dexih-button-edit",7),n.Dc(9,w,1,1,"dexih-button-preview",7),n.Dc(10,S,1,0,"dexih-button",8),n.Dc(11,T,1,0,"dexih-button",9),n.Ob(12,"dexih-button-delete",10),n.Vb("click",(function(e){return t.removeItem(e)})),n.Nb(),n.Nb(),n.Dc(13,F,4,3,"div",11),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Dc(14,V,13,11,"div",12),n.Dc(15,Z,1,1,"ng-template",13)),2&e&&(n.yb(7),n.hc("compact",!0),n.yb(1),n.hc("ngIf",!t.showEdit),n.yb(1),n.hc("ngIf",t.showEdit),n.yb(1),n.hc("ngIf",!t.isMaximized),n.yb(1),n.hc("ngIf",t.isMaximized),n.yb(1),n.hc("compact",!0),n.yb(1),n.hc("ngIf",!t.showEdit&&!t.showPreview&&t.view),n.yb(1),n.hc("ngIf",t.showEdit),n.yb(1),n.hc("ngIf",!t.showEdit))},directives:[b.s,h.t,b.g,b.j,b.q,b.f,h.s,b.D,d.s,d.v,f.a,m.a,d.I,d.t,d.l,d.j,b.H,b.E,v.a,b.A,h.w,p.a,g.a,y.a],styles:[".dashboard-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;overflow:auto}"]}),e}()},cvPx:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a("fXoL"),i=a("3Pt+"),r=a("2Vo4"),o=a("rgmq"),s=a("Z+eP"),c=a("2v7R"),l=a("soiQ"),u=a("4Y1E"),b=a("ElCs"),h=function(){var e=function(){function e(t,a,n){var i=this;_classCallCheck(this,e),this.fb=t,this.hubService=a,this.authService=n,this._datalinkTargetChanges=[],this._parameterChanges=[],this._currentFormObservable=new r.a(null),this.formErrors={},this.hasChanged=!1,this.formSaving=!1,this.showAllErrors=!1,this.IgnoreFormChange=!1,this.ignoreHubCacheChange=!1,this.formChangeCount=0,this.logger=new o.a("hub.forms.service"),this.validationMessages={required:"A value is required.",duplicateName:"The value is already being used.",dataType:"The data types are inconsistent.",invalidClass:"The function method could not be found"},this.validationFieldMessages={},this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe((function(e){i.hubCache=e}))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.clearFormSubscriptions(),this.currentForm=null,this.updateDate=null,this.formErrors={},this.hasChanged=!1,this.formSaving=!1,this.showAllErrors=!1,this.IgnoreFormChange=!1,this.formChangeCount=0}},{key:"clearFormSubscriptions",value:function(){this.logger.LogC((function(){return"clearFormSubscriptions started"}),o.b.Trace),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._connectionChangesSubscription1&&this._connectionChangesSubscription1.unsubscribe(),this._connectionChangesSubscription2&&this._connectionChangesSubscription2.unsubscribe(),this._connectionChangesSubscription3&&this._connectionChangesSubscription3.unsubscribe(),this._tableChangesSubscription1&&this._tableChangesSubscription1.unsubscribe(),this._tableChangesSubscription2&&this._tableChangesSubscription2.unsubscribe(),this._tableColumnChangesSubscription1&&this._tableColumnChangesSubscription1.unsubscribe(),this._tableColumnChangesSubscription2&&this._tableColumnChangesSubscription2.unsubscribe(),this._tableColumnChangesSubscription3&&this._tableColumnChangesSubscription3.unsubscribe(),this._datalinkChangesSubscription1&&this._datalinkChangesSubscription1.unsubscribe(),this._datalinkChangesSubscription2&&this._datalinkChangesSubscription2.unsubscribe(),this._datalinkChangesSubscription3&&this._datalinkChangesSubscription3.unsubscribe(),this._datalinkTestChangesSubscription&&this._datalinkTestChangesSubscription.unsubscribe(),this._genericParameterSubscription&&this._genericParameterSubscription.unsubscribe(),this._datalinkTargetChanges.forEach((function(e){return e.unsubscribe()})),this._parameterChanges.forEach((function(e){return e.unsubscribe()}))}},{key:"addMissing",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(e){var r=Object.keys(a),o=Object.keys(t.controls);r.forEach((function(a){if(-1===n.findIndex((function(e){return e===a}))&&-1===o.findIndex((function(e){return e===a}))){var r=new i.h(a),s=e[a];void 0===s&&(s=null),r.setValue(s),t.addControl(a,r)}})),this.updateDate=e.updateDate}}},{key:"startForm",value:function(e){var t=this;this.logger.LogC((function(){return"startForm started"}),o.b.Trace),e&&(this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=e.valueChanges.subscribe((function(e){t.onValueChanged(e)})),this.onValueChanged()),this.currentForm=e,this._currentFormObservable.next(e),this.hasChanged=!1,this.logger.LogC((function(){return"startForm finished"}),o.b.Trace)}},{key:"getCurrentFormObservable",value:function(){return this._currentFormObservable.asObservable()}},{key:"onValueChanged",value:function(e){var t=this;if(!1===this.IgnoreFormChange){if(this.logger.LogC((function(){return"onValueChanged started.  Counter = "+t.formChangeCount++}),o.b.Trace),!this.currentForm||!this.currentForm.value)return;var a=this.currentForm;this.hasChanged=!0,this.formErrors=this.getFormErrorMessages(a,this.showAllErrors),this.logger.LogC((function(){return"onValueChanged completed"}),o.b.Trace)}}},{key:"markAsChanged",value:function(){this.currentForm&&this.currentForm.value&&(this.hasChanged=!0,this.currentForm.markAsDirty())}},{key:"showErrors",value:function(){this.showAllErrors=!0,this.onValueChanged()}},{key:"getFormErrorMessages",value:function(e,t){var a={};if(!e.controls)return"";for(var n=0,r=Object.keys(e.controls);n<r.length;n++){var o=r[n];a[o]="";var s=e.get(o);if(s&&(s.dirty||t)&&!s.valid)if(s instanceof i.e);else{var c=this.validationFieldMessages[o];if(s&&s.errors)for(var l=0,u=Object.keys(s.errors);l<u.length;l++){var b=u[l];if(c&&c[b])a[o]+=c[b]+" ";else if(this.validationMessages[b])a[o]+=this.validationMessages[b]+" ";else{var h=this.createErrorMessage(b,s);a[o]+=h+" "}}}}return a}},{key:"getErrorMessage",value:function(e){if(e&&e.errors){for(var t="",a=0,n=Object.keys(e.errors);a<n.length;a++){var i=n[a];this.validationMessages[i]?t+=this.validationMessages[i]+" ":t=this.createErrorMessage(i,e)}return t}return""}},{key:"createErrorMessage",value:function(e,t){var a="";switch(e){case"minlength":a="Value is "+t.errors.minlength.actualLength+" characters long, required minimum length is "+t.errors.minlength.requiredLength+" characters.";break;case"maxlength":a="Value is "+t.errors.maxlength.actualLength+" characters long, required maximum length is "+t.errors.maxlength.requiredLength+" characters.";break;case"maxvalue":a="Value is "+t.value+" required maximum is "+t.errors.maxvalue.required+".";break;case"minvalue":a="Value is "+t.value+" required minimum is "+t.errors.minvalue.required+".";break;default:a="Field error: "+e}return a}},{key:"watchChanges",value:function(e,t,a,n){var i=this;this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.formSaving||(this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(r){if(!i.ignoreHubCacheChange){if(i.ignoreHubCacheChange=!0,r.changeClass===e&&r.data&&r.data[t]===i.currentForm.value[t])switch(r.changeType){case l.Eb.Replace:if(i.currentForm.pristine){var o=Object.assign({},r.data);n.call(i,o)}else i.authService.confirmDialog("The "+a+" has changed","Another session has updated this "+a+", would you like to discard any changes in this session and update with the new version?").then((function(e){if(e){var t=Object.assign({},r.data);i.ngOnDestroy(),n.call(i,t)}})).catch((function(e){}));break;case l.Eb.Delete:i.authService.confirmDialog("The "+a+" has been deleted","Another session has deleted this "+a+", would you like to discard current changes?").then((function(e){e&&i.authService.navigateUp()})).catch((function(e){}))}i.ignoreHubCacheChange=!1}})))}},{key:"save",value:function(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=this,a=regeneratorRuntime.mark((function e(){var t,a,r,o,s,c,u,b,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i||!this.formSaving&&this.hasChanged){e.next=3;break}return e.abrupt("return");case 3:if(this.formSaving=!0,t=this.valueMethod?this[this.valueMethod]():this.currentForm.getRawValue(),!i){e.next=8;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.name;case 1:if(!h.hubCache.hub[h.property.cacheProperty].find((function(e){return e.name===a}))){e.next=9;break}return e.next=4,h.authService.promptDialog("Specify a new name","The name ".concat(a," already exists.  Specify a new name for the ").concat(h.property.displayName," and then select ok to save this as a copy."),"",a+" 2");case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:e.next=1;break;case 9:t.name=a,t.key=0;case 10:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:if("object"!=typeof(a=e.t0)){e.next=8;break}return e.abrupt("return",a.v);case 8:return this.ignoreHubCacheChange=!0,r=t.currentStatus,o=t.entityStatus,s=t.previousStatus,c=t.runTime,t.currentStatus=null,t.entityStatus=null,t.previousStatus=null,t.runTime=null,e.next=13,this.authService.post("/api/Hub/"+this.saveMethod,{hubKey:this.hubCache.hub.hubKey,value:t},"Saving...");case 13:u=e.sent,(b=new l.P)[this.property.property]=[{importAction:l.Eb.New,item:u}],this.hubService.updateHubChange(b),this.formGroupFunc&&(this.formGroupFunc(u),this.currentForm.controls.currentStatus&&this.currentForm.controls.currentStatus.setValue(r),this.currentForm.controls.entityStatus&&this.currentForm.controls.entityStatus.setValue(o),this.currentForm.controls.previousStatus&&this.currentForm.controls.previousStatus.setValue(s),this.currentForm.controls.runTime&&this.currentForm.controls.runTime.setValue(c),this.ignoreHubCacheChange=!1),this.formSaving=!1,this.hasChanged=!1,n?this.authService.navigateUp():this.hubService.addHubSuccessMessage("The save operation completed."),e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),e.t1&&(this.hubService.addHubMessage(e.t1),this.currentForm.markAsDirty());case 21:return e.prev=21,this.formSaving=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[0,18,21,24]])})),new((t=void 0)||(t=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(t){i(t)}}function o(e){try{s(a.throw(e))}catch(t){i(t)}}function s(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,o)}s((a=a.apply(e,[])).next())}))}},{key:"saveLocal",value:function(){var e;e=this.valueMethod?this[this.valueMethod]():this.currentForm.getRawValue();var t=this.hubCache,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");this.property.cacheGetMethod&&t[this.property.cacheGetMethod](e,a),a[this.property.cacheProperty].push(e),this.hubService.exportHub(a,this.property.displayName+"-"+e.name+".json")}},{key:"cancel",value:function(){this.formSaving||this.authService.navigateUp()}},{key:"getFormErrors",value:function(){return this.getFormErrorsRecursive(this.currentForm,0,0)}},{key:"getFormErrorsRecursive",value:function(e,t,a){for(var n=this,r="",o=0,s=Object.keys(e.controls);o<s.length;o++){var c=s[o],l=e.get(c);if(l&&!l.valid)if(r+=" ".repeat(3*t)+"The control ".concat(c," at position ").concat(a," has the following error(s):<p></p>"),l instanceof i.e)l.controls.forEach((function(e,a){r+=n.getFormErrorsRecursive(e,t+1,a)}));else if(l instanceof i.k)r+=this.getFormErrorsRecursive(l,t+1,0);else for(var u=0,b=Object.keys(l.errors);u<b.length;u++){var h=b[u];r+=" ".repeat(3*t+1)+h+":"+this.createErrorMessage(h,l)+"<p></p>"}}return r}},{key:"stringCompare",value:function(e,t){return!e&&!t||!(!e||!t)&&e.trim().toLowerCase()===t.trim().toLowerCase()}},{key:"parameter",value:function(e){var t={showRefresh:e.listOfValuesKey>0,isRefreshing:!1,items:[]};e.value&&0===e.rank&&(t.items=[{key:e.value,name:e.valueDesc}]);var a=this.fb.group({name:[{value:e.name,disabled:e.datalinkParameterKey>0},[i.G.required,i.G.minLength(1),i.G.maxLength(50)]],runTime:[t],datalinkParameterKey:e.datalinkParameterKey});this.addMissing(e,a,new l.Q);var n=a.controls.listOfValuesKey.valueChanges.subscribe((function(e){a.controls.runTime.setValue({showRefresh:a.controls.listOfValuesKey.value>0,isRefreshing:!1,items:[]})}));this._parameterChanges.push(n);var r=a.controls.rank.valueChanges.subscribe((function(e){var t=a.controls.value.value;0===e&&t&&Array.isArray(t)&&(0===t.length?(a.controls.value.setValue(null),a.controls.valueDesc.setValue(t[0])):(a.controls.value.setValue(t[0]),a.controls.valueDesc.setValue(t[0]))),1===e&&t&&!Array.isArray(t)&&a.controls.value.setValue(null)}));return this._parameterChanges.push(r),a}},{key:"connection",value:function(e){this.logger.LogC((function(){return"connection"}),o.b.Trace);var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateConnectionNameValidator()]],connectionStringDisplay:[e.connectionString?"(Connection string hidden)":"",[]],passwordDisplay:[e.password?"**************************":"",[]],connectionStringRaw:["",[]],passwordRaw:["",[]]},{validators:[this.requiredConnectionFields()]});this.property=c.u.find((function(e){return e.type===l.dc.Connection})),this.saveMethod="SaveConnection",this.formGroupFunc=this.connection,this.addMissing(e,t,new l.f),this.clearFormSubscriptions(),this._connectionChangesSubscription1&&this._connectionChangesSubscription1.unsubscribe(),this._connectionChangesSubscription1=t.controls.passwordDisplay.valueChanges.subscribe((function(e){t.controls.passwordRaw.setValue(e)})),this._connectionChangesSubscription2&&this._connectionChangesSubscription2.unsubscribe(),this._connectionChangesSubscription2=t.controls.connectionStringDisplay.valueChanges.subscribe((function(e){t.controls.connectionStringRaw.setValue(e)})),this.startForm(t),this.watchChanges(l.dc.Connection,"key","Connection",this.connection),this.logger.LogC((function(){return"connection finished"}),o.b.Trace)}},{key:"duplicateConnectionNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihConnections.findIndex((function(t){return t.key!==e.currentForm.value.key&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"requiredConnectionFields",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.controls.useConnectionString,n=t.controls.connectionStringDisplay,i=t.controls.server;if(!a||!n||!i)return;return n.setErrors(null),i.setErrors(null),a.value&&!n.value&&n.setErrors({required:!0}),void(a.value||i.value||i.setErrors({required:!0}))}}}},{key:"table",value:function(e){this.clearFormSubscriptions();var t=this.tableForm(e);this.formGroupFunc=this.table,this.property=c.u.find((function(e){return e.type===l.dc.Table})),this.saveMethod="SaveTable",this.watchChanges(l.dc.Table,"tableKey","table",this.table),this.startForm(t)}},{key:"tableForm",value:function(e){var t=this,a=this.fb.group({name:[e.name,[i.G.required,i.G.maxLength(250),this.duplicateTableNameValidator()]],connectionKey:[e.connectionKey,[i.G.required]],logicalName:[e.logicalName,[i.G.required,i.G.maxLength(250)]],useLogical:[this.hubCache.defaultTableLogicalName(e.schema,e.name)!==e.logicalName,[]],dexihTableColumns:this.fb.array([])},{validator:this.requiredTableFields()}),n=a.controls.dexihTableColumns;return e.dexihTableColumns.filter((function(e){return e.isValid})).forEach((function(e){n.push(t.tableColumn(n.value,e))})),this._tableChangesSubscription1&&this._tableChangesSubscription1.unsubscribe(),this._tableChangesSubscription1=a.controls.useLogical.valueChanges.subscribe((function(e){a.controls.useLogical.value||a.controls.logicalName.setValue(t.hubCache.defaultTableLogicalName(a.controls.schema.value,a.controls.name.value))})),this._tableChangesSubscription2&&this._tableChangesSubscription2.unsubscribe(),this._tableChangesSubscription2=a.controls.name.valueChanges.subscribe((function(e){a.controls.useLogical.value||a.controls.logicalName.setValue(t.hubCache.defaultTableLogicalName(a.controls.schema.value,a.controls.name.value))})),this.addMissing(e,a,new l.H),a}},{key:"duplicateTableNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihTables.find((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)&&t.connectionKey===e.currentForm.value.connectionKey}))?{duplicateName:{name:a}}:null}}}},{key:"requiredTableFields",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.controls.useConnectionString,n=t.controls.connectionStringDisplay,i=t.controls.server;if(!a||!n||!i)return;return n.setErrors(null),i.setErrors(null),a.value&&!n.value&&n.setErrors({required:!0}),void(a.value||i.value||i.setErrors({required:!0}))}}}},{key:"tableColumn",value:function(e,t){var a=this,n=t.childColumns?t.childColumns:[],r=this.fb.group({name:[t.name,[i.G.required,i.G.maxLength(250),this.duplicateTableColumnNameValidator(e)]],logicalName:[t.logicalName,[i.G.required,i.G.maxLength(250)]],precision:[t.precision,[this.columnMinRangeValidator(0),this.columnMaxRangeValidator(30)]],scale:[t.scale,[this.columnMinRangeValidator(0),this.columnMaxRangeValidator(30)]],useLogical:[t.name!==t.logicalName,[]],isString:[t.dataType===l.pc.String||t.dataType===l.pc.CharArray,[]],isNumber:[t.dataType===l.pc.Double||t.dataType===l.pc.Decimal||t.dataType===l.pc.Single,[]],childColumns:this.fb.array(n.filter((function(e){return e.isValid})).map((function(e){return a.tableColumn(n,e)}))),runTime:{impact:c.k,lineage:c.k}});this.addMissing(t,r,new l.I),this._tableColumnChangesSubscription1&&this._tableColumnChangesSubscription1.unsubscribe(),this._tableColumnChangesSubscription1=r.controls.dataType.valueChanges.subscribe((function(e){r.controls.isString.setValue(e===l.pc.String||e===l.pc.CharArray),r.controls.isNumber.setValue(e===l.pc.Double||e===l.pc.Decimal||e===l.pc.Single)})),this._tableColumnChangesSubscription2&&this._tableColumnChangesSubscription2.unsubscribe(),this._tableColumnChangesSubscription2=r.controls.useLogical.valueChanges.subscribe((function(e){r.controls.useLogical.value||r.controls.logicalName.setValue(r.controls.name.value)})),this._tableColumnChangesSubscription3&&this._tableColumnChangesSubscription3.unsubscribe(),this._tableColumnChangesSubscription3=r.controls.name.valueChanges.subscribe((function(e){r.controls.useLogical.value||r.controls.logicalName.setValue(r.controls.name.value)}));for(var o=0,s=Object.keys(r.controls);o<s.length;o++){var u=s[o];r.controls[u].validator&&r.controls[u].updateValueAndValidity()}return r}},{key:"duplicateTableColumnNameValidator",value:function(e){var t=this;return e?function(a){if(t.currentForm){var n=a.value;if(a.parent){var i=a.parent.value.key,r=a.parent.value.columnGroup;if(e)return e.findIndex((function(e){return e.key!==i&&e.columnGroup===r&&e.isValid&&t.stringCompare(e.name,n)}))>=0?{duplicateName:{name:n}}:null}}}:null}},{key:"requiredNotZero",value:function(){return function(e){var t=e.value;return t&&0!==t?null:{required:{name:e.value}}}}},{key:"columnMinRangeValidator",value:function(e){return function(t){var a=t.value,n=t.parent;if(n&&n.controls.isNumber.value)return Number(t.value)>=e?null:{minvalue:{name:a,required:e}}}}},{key:"columnMaxRangeValidator",value:function(e){return function(t){var a=t.value,n=t.parent;if(n&&n.controls.isNumber.value)return Number(t.value)<=e?null:{maxvalue:{name:a,required:e}}}}},{key:"fileFormat",value:function(e){var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateFileFormatNameValidator()]],quote:[e.quote,[i.G.maxLength(1)]]});this.formGroupFunc=this.fileFormat,this.property=c.u.find((function(e){return e.type===l.dc.FileFormat})),this.saveMethod="SaveFileFormat",this.addMissing(e,t,new l.y),this.clearFormSubscriptions(),this.watchChanges(l.dc.FileFormat,"fileFormatKey","file format",this.fileFormat),this.startForm(t)}},{key:"duplicateFileFormatNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihFileFormats.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"view",value:function(e){var t=this;this.clearFormSubscriptions();var a=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),n=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateViewNameValidator()]],sourceType:[e.sourceType,[i.G.required]],sourceDatalinkKey:[e.sourceDatalinkKey],sourceTableKey:[e.sourceTableKey],parameters:this.fb.array(a)},{validator:this.validateViewSource()});this.formGroupFunc=this.view,this.property=c.u.find((function(e){return e.type===l.dc.View})),this.saveMethod="SaveView",this.addMissing(e,n,new l.L),this.watchChanges(l.dc.View,"viewKey","view",this.view),this.startForm(n)}},{key:"duplicateViewNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihViews.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"validateViewSource",value:function(){return function(e){var t=e.get("sourceType").value,a=e.get("sourceTableKey"),n=e.get("sourceDatalinkKey");if(a.setErrors(null),n.setErrors(null),t===l.lb.Table){if(!a.value)return a.setErrors({required:!0})}else if(t===l.lb.Datalink&&!n.value)return n.setErrors({required:!0})}}},{key:"dashboard",value:function(e){var t=this;this.clearFormSubscriptions();var a=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),n=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateDashboardNameValidator()]],dexihDashboardItems:this.fb.array([]),parameters:this.fb.array(a),runTime:{showEdit:!1,lock:!0}},{}),r=n.controls.dexihDashboardItems;e.dexihDashboardItems.filter((function(e){return e.isValid})).forEach((function(e){r.push(t.dashboardItem(e))})),this.formGroupFunc=this.dashboard,this.property=c.u.find((function(e){return e.type===l.dc.Dashboard})),this.saveMethod="SaveDashboard",this.addMissing(e,n,new l.i),this.watchChanges(l.dc.Dashboard,"dashboardKey","dashboard",this.dashboard),this.startForm(n)}},{key:"duplicateDashboardNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihDashboards.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"dashboardItem",value:function(e){var t=this,a=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),r=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50)]],parameters:this.fb.array(a),runTime:{resizeEvent:new n.n,data:new c.b}});return this.addMissing(e,r,new l.j),r}},{key:"updateDashboardItemView",value:function(e){var t=this;if(this.hubCache.hub.dexihViews&&e.controls.viewKey.value){var a=this.hubCache.hub.dexihViews.find((function(t){return t.key===e.controls.viewKey.value}));if(this.view){e.controls.name.setValue(this.view.name),e.controls.runTime.value.data=new c.b;var n=e.controls.parameters,i=n.value;n.clear();var r=a.parameters;if(a.sourceType===l.lb.Datalink){var o=this.hubCache.hub.dexihDatalinks.find((function(e){return e.key===a.sourceDatalinkKey}));o&&o.parameters&&(r=r.concat(o.parameters))}r.forEach((function(e){var a=i.find((function(t){return t.name===e.name})),r=new l.Q;a?(r.name=a.name,r.value=a.value):(r.name=e.name,r.value=e.value,r.listOfValuesKey=e.listOfValuesKey);var o=t.parameter(r);n.push(o)}))}}}},{key:"listOfValuesItem",value:function(e){var t=this.fb.group({key:[e.key,[i.G.required,i.G.minLength(1),i.G.maxLength(50)]]});return this.addMissing(e,t,new l.R),t}},{key:"listOfValues",value:function(e){var t,a=this;t=e.staticData?e.staticData.map((function(e){return a.listOfValuesItem(e)})):[];var n=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateLovNameValidator()]],sourceType:[e.sourceType,[i.G.required]],sourceDatalinkKey:[e.sourceDatalinkKey],sourceTableKey:[e.sourceTableKey],staticData:this.fb.array(t)},{validator:this.validateViewSource()});this.formGroupFunc=this.listOfValues,this.property=c.u.find((function(e){return e.type===l.dc.ListOfValues})),this.saveMethod="SaveListOfValues",this.addMissing(e,n,new l.E),this.clearFormSubscriptions(),this.watchChanges(l.dc.ListOfValues,"listOfValuesKey","listOfValues",this.listOfValues),this.startForm(n)}},{key:"duplicateLovNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihListOfValues.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"api",value:function(e){var t=this;this.clearFormSubscriptions();var a=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),n=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50)]],sourceType:[e.sourceType,[i.G.required]],sourceDatalinkKey:[e.sourceDatalinkKey],sourceTableKey:[e.sourceTableKey],parameters:this.fb.array(a)},{validator:this.validateDatalinkTable()});this.formGroupFunc=this.api,this.saveMethod="SaveApi",this.property=c.u.find((function(e){return e.type===l.dc.Api})),this.addMissing(e,n,new l.d),this.watchChanges(l.dc.Api,"apiKey","api",this.api),this.startForm(n)}},{key:"validation",value:function(e){var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateValidationNameValidator()]]});this.formGroupFunc=this.validation,this.property=c.u.find((function(e){return e.type===l.dc.ColumnValidation})),this.saveMethod="SaveColumnValidation",this.addMissing(e,t,new l.e),this.watchChanges(l.dc.ColumnValidation,"key","column validation",this.validation),this.startForm(t)}},{key:"duplicateValidationNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihColumnValidations.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"customFunction",value:function(e){var t=this,a=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateCustomFunctionNameValidator()]],dexihCustomFunctionParameters:this.fb.array(e.dexihCustomFunctionParameters.filter((function(e){return e.isValid})).map((function(e){return t.customFunctionParametersFormGroup(e)})))});this.formGroupFunc=this.customFunction,this.saveMethod="SaveCustomFunction",this.property=c.u.find((function(e){return e.type===l.dc.CustomFunction})),this.addMissing(e,a,new l.g),this.watchChanges(l.dc.CustomFunction,"customFunctionKey","custom function",this.customFunction),this.startForm(a)}},{key:"duplicateCustomFunctionNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihCustomFunctions.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"customFunctionParametersFormGroup",value:function(e){var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(1),i.G.maxLength(50)]]});return this.addMissing(e,t,new l.h),t}},{key:"hubVariable",value:function(e){var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateHubVariableNameValidator()]],valueRaw:[e.isEncrypted?null:e.value]});this.formGroupFunc=this.hubVariable,this.saveMethod="SaveHubVariable",this.property=c.u.find((function(e){return e.type===l.dc.HubVariable})),this.addMissing(e,t,new l.C),this.watchChanges(l.dc.HubVariable,"hubVariable","hub variable",this.hubVariable),this.startForm(t)}},{key:"duplicateHubVariableNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihHubVariables.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"tag",value:function(e){var t=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateTagNameValidator()]]});this.formGroupFunc=this.tag,this.saveMethod="SaveTag",this.property=c.u.find((function(e){return e.type===l.dc.Tags})),this.addMissing(e,t,new l.J),this.watchChanges(l.dc.Tags,"tag","hub variable",this.tag),this.startForm(t)}},{key:"duplicateTagNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihTags.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"datalinkTest",value:function(e){var t=this,a=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateDatalinkTestNameValidator()]],dexihDatalinkTestSteps:this.fb.array([])}),n=a.controls.dexihDatalinkTestSteps;e.dexihDatalinkTestSteps.filter((function(e){return e.isValid})).forEach((function(e){n.push(t.datalinkTestStep(e))})),this.formGroupFunc=this.datalinkTest,this.saveMethod="SaveDatalinkTest",this.property=c.u.find((function(e){return e.type===l.dc.DatalinkTest})),this.addMissing(e,a,new l.t),this.watchChanges(l.dc.DatalinkTest,"datalinkTest","datalink test",this.datalinkTest),this.startForm(a)}},{key:"duplicateDatalinkTestNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihDatalinkTests.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"datalinkTestStep",value:function(e){var t=this,a=this.fb.group({dexihDatalinkTestTables:this.fb.array([])}),n=a.controls.dexihDatalinkTestTables;return e.dexihDatalinkTestTables.filter((function(e){return e.isValid})).forEach((function(e){n.push(t.datalinkTestTable(e))})),this.addMissing(e,a,new l.u),this._datalinkTestChangesSubscription&&this._datalinkTestChangesSubscription.unsubscribe(),this._datalinkTestChangesSubscription=a.controls.datalinkKey.valueChanges.subscribe((function(e){for(var a=t.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e}));n.length>0;)n.removeAt(0);if(a.sourceDatalinkTable.sourceTableKey){var i=new l.v;i.tableKey=a.sourceDatalinkTable.sourceTableKey,i.isValid=!0,n.push(t.datalinkTestTable(i))}a.dexihDatalinkTransforms.filter((function(e){return e.joinDatalinkTable&&e.joinDatalinkTable.sourceTableKey})).forEach((function(e){var a=new l.v;a.tableKey=e.joinDatalinkTable.sourceTableKey,a.isValid=!0,n.push(t.datalinkTestTable(a))}))})),a}},{key:"datalinkTestTable",value:function(e){var t=this.fb.group({});return this.addMissing(e,t,new l.v),t}},{key:"triggerFormGroup",value:function(e){var t=this.fb.group({});return this.addMissing(e,t,new l.K),t}},{key:"datalinkStepFormGroup",value:function(e,t){var a=this,n=t.parameters.filter((function(e){return e.isValid})).map((function(e){return a.parameter(e)})),r=this.fb.group({key:[t.key,[]],name:[t.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateStepNameValidator(e)]],datalinkKey:[t.datalinkKey,[i.G.required]],dexihDatalinkDependencies:this.fb.array(t.dexihDatalinkDependencies.filter((function(e){return e.isValid})).map((function(e){return a.datalinkDependencyFormGroup(e)}))),dexihDatalinkStepColumns:this.fb.array(t.dexihDatalinkStepColumns.filter((function(e){return e.isValid})).map((function(e){return a.datalinkStepColumnFormGroup(e)}))),parameters:this.fb.array(n)});return this.addMissing(t,r,new l.p),r}},{key:"datalinkDependencyFormGroup",value:function(e){var t=this.fb.group({});return this.addMissing(e,t,new l.n),t}},{key:"datalinkStepColumnFormGroup",value:function(e){var t=this.fb.group({});return this.addMissing(e,t,new l.q),t}},{key:"datajob",value:function(e){var t=this;this.clearFormSubscriptions();var a=e.dexihTriggers.filter((function(e){return e.isValid})).map((function(e){return t.triggerFormGroup(e)})),n=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),r=this.fb.array([]),o=this.fb.group({key:[e.key,[]],name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateDatajobNameValidator()]],auditConnectionKey:[e.auditConnectionKey,[this.requiredNotZero()]],failAction:[e.failAction,[i.G.required]],dexihDatalinkSteps:r,dexihTriggers:this.fb.array(a),parameters:this.fb.array(n)});e.dexihDatalinkSteps.filter((function(e){return e.isValid})).forEach((function(e){r.push(t.datalinkStepFormGroup(o,e))})),this.formGroupFunc=this.datajob,this.saveMethod="SaveDatajob",this.property=c.u.find((function(e){return e.type===l.dc.Datajob})),this.addMissing(e,o,new l.k),this.watchChanges(l.dc.Datajob,"key","data job",this.datajob),this.startForm(o)}},{key:"duplicateDatajobNameValidator",value:function(){var e=this;return function(t){if(e.currentForm){var a=t.value;return e.hubCache.hub.dexihDatajobs.findIndex((function(t){return t.key!==e.currentForm.controls.key.value&&t.isValid&&e.stringCompare(t.name,a)}))>=0?{duplicateName:{name:a}}:null}}}},{key:"duplicateStepNameValidator",value:function(e){var t=this;return function(a){if(t.currentForm){var n=a.value;if(a&&a.parent){var i=a.parent.controls.key.value;return e.value.dexihDatalinkSteps.findIndex((function(e){return e.key!==i&&e.isValid&&e.name===n}))>=0?{duplicateName:{name:n}}:null}}}}},{key:"remoteAgent",value:function(e){var t=this.fb.group({});this.clearFormSubscriptions(),this.addMissing(e,t,new l.G),this.startForm(t)}},{key:"getDatalinkValue",value:function(){return this.currentForm.value}},{key:"datalinkTableColumn",value:function(e,t){var a=this,n=t.childColumns?t.childColumns:[],r=this.fb.group({name:[t.name,[i.G.required,i.G.maxLength(250),this.duplicateDatalinkColumnNameValidator(e)]],logicalName:[t.logicalName,[i.G.required,i.G.maxLength(250)]],precision:[t.precision,[this.columnMinRangeValidator(0),this.columnMaxRangeValidator(30)]],scale:[t.scale,[this.columnMinRangeValidator(0),this.columnMaxRangeValidator(30)]],useLogical:[t.name!==t.logicalName,[]],isString:[t.dataType===l.pc.String||t.dataType===l.pc.CharArray,[]],isNumber:[t.dataType===l.pc.Double||t.dataType===l.pc.Decimal||t.dataType===l.pc.Single,[]],childColumns:this.fb.array(n.filter((function(e){return e.isValid})).map((function(e){return a.datalinkTableColumn(n,e)}))),runTime:{impact:c.k,lineage:c.k}});this.addMissing(t,r,new l.m),this._tableColumnChangesSubscription1&&this._tableColumnChangesSubscription1.unsubscribe(),this._tableColumnChangesSubscription1=r.controls.dataType.valueChanges.subscribe((function(e){r.controls.isString.setValue(e===l.pc.String||e===l.pc.CharArray),r.controls.isNumber.setValue(e===l.pc.Double||e===l.pc.Decimal||e===l.pc.Single)})),this._tableColumnChangesSubscription2&&this._tableColumnChangesSubscription2.unsubscribe(),this._tableColumnChangesSubscription2=r.controls.useLogical.valueChanges.subscribe((function(e){r.controls.useLogical.value||r.controls.logicalName.setValue(r.controls.name.value)})),this._tableColumnChangesSubscription3&&this._tableColumnChangesSubscription3.unsubscribe(),this._tableColumnChangesSubscription3=r.controls.name.valueChanges.subscribe((function(e){r.controls.useLogical.value||r.controls.logicalName.setValue(r.controls.name.value)}));for(var o=0,s=Object.keys(r.controls);o<s.length;o++){var u=s[o];r.controls[u].validator&&r.controls[u].updateValueAndValidity()}return r}},{key:"duplicateDatalinkColumnNameValidator",value:function(e){var t=this;return function(a){if(!e)return null;if(t.currentForm){var n=a.value;if(a.parent){var i=a.parent.value.key;if(e)return e.findIndex((function(e){return e.key!==i&&e.isValid&&t.stringCompare(e.name,n)}))>=0?{duplicateName:{name:n}}:null}}}}},{key:"datalinkTransformFormGroup",value:function(e){var t=this,a=this.fb.group({datalinkTransformKey:[e.key,[]],name:[e.name,[]],datalinkKey:[e.datalinkKey,[i.G.required]],joinDatalinkTable:e.joinDatalinkTable?this.sourceDatalinkTableFormGroup(e.joinDatalinkTable):null,nodeDatalinkColumn:e.nodeDatalinkColumn?e.nodeDatalinkColumn:null,isValid:!0,runTime:{inputColumns:null,outputColumns:null,transformColumns:null}});return a.addControl("dexihDatalinkTransformItems",this.fb.array(e.dexihDatalinkTransformItems.filter((function(e){return e.isValid})).map((function(e){return t.datalinkDatalinkTransformItemFormGroup(a,e)})))),this.addMissing(e,a,new l.w),a}},{key:"datalinkDatalinkTransformItemFormGroup",value:function(e,t){var a=this,n=this.fb.group({dexihFunctionParameters:this.fb.array(t.dexihFunctionParameters.filter((function(e){return e.isValid})).map((function(e){return a.datalinkFunctionParametersFormGroup(e)}))),targetDatalinkColumn:[t.targetDatalinkColumn,[this.duplicateOutputColumn(e)]],functionClassName:[t.functionClassName],functionMethodName:[t.functionMethodName],isValid:!0},{asyncValidators:[this.invalidClassName()]});return this.addMissing(t,n,new l.x),this._genericParameterSubscription&&this._genericParameterSubscription.unsubscribe(),this._genericParameterSubscription=n.controls.genericTypeCode.valueChanges.subscribe((function(){var e=n.controls.genericTypeCode.value;n.controls.dexihFunctionParameters.controls.filter((function(e){return e.value.isGeneric})).forEach((function(t){var a=t;a.controls.dataType.setValue(e),a.controls.arrayParameters.controls.forEach((function(t){t.controls.dataType.setValue(e)}))}))})),n}},{key:"duplicateOutputColumn",value:function(e){var t=this;return function(a){if(t.currentForm){var n=a.value,i=e.controls.runTime.value.transformColumns;return i&&n&&i.filter((function(e){return e.name===n.name})).length>1?{duplicateName:{name:name}}:null}}}},{key:"invalidClassName",value:function(){var e=this;return function(t){var a=t;return a.controls.functionMethodName.setErrors(null),e.currentForm&&a.controls.transformItemType&&a.controls.transformItemType.value===l.kc.BuiltInFunction?new Promise((function(t,n){e.hubService.GetFunctionReference(a.value).then((function(e){if(e)t(null);else{var n=a.controls.functionClassName.value+"."+a.controls.functionMethodName.value;a.controls.functionMethodName.setErrors({invalidClass:{value:n}}),t({invalidClass:{value:n}})}})).catch((function(e){n(e)}))})):Promise.resolve(null)}}},{key:"datalinkFunctionParametersFormGroup",value:function(e){var t=this,a=this.fb.group({datalinkColumn:e.datalinkColumn,runTime:e.runTime,arrayParameters:this.fb.array(e.arrayParameters.filter((function(e){return e.isValid})).map((function(e){return t.datalinkFunctionArrayParametersFormGroup(e)})))},{validator:this.inconsistentDataType()});return this.addMissing(e,a,new l.A),a}},{key:"datalinkFunctionArrayParametersFormGroup",value:function(e){var t=this.fb.group({datalinkColumn:e.datalinkColumn,runTime:e.runTime},{validator:this.inconsistentDataType()});return this.addMissing(e,t,new l.z),t}},{key:"inconsistentDataType",value:function(){var e=this;return function(t){var a;if(e.currentForm){var n=t.controls.datalinkColumn;if(n&&n.value){var i=n.value.dataType;if(i!==(null===(a=t.controls.dataType)||void 0===a?void 0:a.value))return n.setErrors({dataType:{dataType:i}}),{dataType:{dataType:i}};n.setErrors(null)}}return null}}},{key:"datalinkProfileFormGroup",value:function(e){var t=this.fb.group({isValid:!0});return this.addMissing(e,t,new l.o),t}},{key:"datalinkTargetFormGroup",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!a&&e.tableKey&&(a=this.hubCache.getTable(e.tableKey));var n=this.fb.group({table:a?this.tableForm(a):null,runTime:{inputColumns:null},nodeDatalinkColumn:e.nodeDatalinkColumn?e.nodeDatalinkColumn:null,isValid:!0});this.addMissing(e,n,new l.s);var i=n.controls.tableKey.valueChanges.subscribe((function(e){if(e>0){var i=(a=t.hubCache.getTable(e))?t.tableForm(a):null;n.setControl("table",i)}}));return this._datalinkTargetChanges.push(i),n}},{key:"sourceDatalinkTableFormGroup",value:function(e){var t=this,a=this.fb.group({sourceType:[e.sourceType,[i.G.required]],sourceTableKey:[e.sourceTableKey,[]],sourceDatalinkKey:[e.sourceDatalinkKey,[]],isValid:!0,dexihDatalinkColumns:this.fb.array([])},{validator:this.validateDatalinkTable()}),n=a.controls.dexihDatalinkColumns;return e.dexihDatalinkColumns.filter((function(e){return e.isValid})).forEach((function(e){n.push(t.datalinkTableColumn(n.value,e))})),this.addMissing(e,a,new l.r),a}},{key:"validateDatalinkTable",value:function(){return function(e){var t=e.get("sourceType").value,a=e.get("sourceTableKey"),n=e.get("sourceDatalinkKey");if(a.setErrors(null),n.setErrors(null),t===l.gc.Table){if(!a.value)return a.setErrors({required:!0})}else if(t===l.gc.Datalink&&!n.value)return n.setErrors({required:!0})}}},{key:"missingSourceDatalinkKey",value:function(e){return function(t){return e!==l.gc.Datalink||t.value?null:{required:"required"}}}},{key:"datalink",value:function(e){var t=this;this.logger.LogC((function(){return"datalink key:".concat(e.key," datalink:").concat(e.name)}),o.b.Debug),this.clearFormSubscriptions();var a=e.dexihDatalinkProfiles.filter((function(e){return e.isValid})).map((function(e){return t.datalinkProfileFormGroup(e)})),n=e.dexihDatalinkTargets.filter((function(e){return e.isValid})).map((function(e){return t.datalinkTargetFormGroup(e)})),r=e.dexihDatalinkTransforms.filter((function(e){return e.isValid})).map((function(e){return t.datalinkTransformFormGroup(e)})),s=e.parameters.filter((function(e){return e.isValid})).map((function(e){return t.parameter(e)})),u=this.fb.group({name:[e.name,[i.G.required,i.G.minLength(3),i.G.maxLength(50),this.duplicateDatalinkNameValidator(e.key)]],sourceDatalinkTable:this.sourceDatalinkTableFormGroup(e.sourceDatalinkTable),auditConnectionKey:[e.auditConnectionKey,[]],updateStrategy:[e.updateStrategy,[]],dexihDatalinkTransforms:this.fb.array(r),dexihDatalinkProfiles:this.fb.array(a),dexihDatalinkTargets:this.fb.array(n),parameters:this.fb.array(s),isValid:!0}),b=new l.l;b.sourceDatalinkTable=new l.r,this.addMissing(e,u,b),this.formGroupFunc=this.datalink,this.saveMethod="SaveDatalink",this.property=c.u.find((function(e){return e.type===l.dc.Datalink})),this.valueMethod="getDatalinkValue",this._datalinkChangesSubscription1&&this._datalinkChangesSubscription1.unsubscribe(),this._datalinkChangesSubscription1=u.valueChanges.subscribe((function(){t.updateTransformFormColumns(u)})),this.updateTransformFormColumns(u),this.watchChanges(l.dc.Datalink,"key","datalink",this.datalink),this.startForm(u)}},{key:"duplicateDatalinkNameValidator",value:function(e){var t=this;return function(a){if(t.currentForm){var n=a.value;return t.hubCache.hub.dexihDatalinks.findIndex((function(a){return a.key!==e&&a.isValid&&t.stringCompare(a.name,n)}))>=0?{duplicateName:{name:n}}:null}}}},{key:"updateTransformFormColumns",value:function(e){if(!1===this.IgnoreFormChange){this.IgnoreFormChange=!0;var t=e.controls.dexihDatalinkTransforms,a=e.value;(new s.b).buildInputOutput(this.hubCache,a),t.controls.forEach((function(e){var t=e,n=t.value,i=a.dexihDatalinkTransforms.find((function(e){return e.key===n.datalinkTransformKey}));t.controls.runTime.setValue(i.runTime),t.controls.dexihDatalinkTransformItems.controls.forEach((function(e){var t=e;t.controls.targetDatalinkColumn&&t.controls.targetDatalinkColumn.updateValueAndValidity(),t.controls.sourceDatalinkColumn&&t.controls.sourceDatalinkColumn.updateValueAndValidity(),t.controls.dexihFunctionParameters.controls.forEach((function(e){e.controls.datalinkColumn&&e.controls.datalinkColumn.updateValueAndValidity()}))}))})),e.controls.dexihDatalinkTargets.controls.forEach((function(e){var t=a.dexihDatalinkTargets.find((function(t){return t.key===e.controls.key.value}));t&&e.controls.runTime.setValue(t.runTime)})),this.IgnoreFormChange=!1}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(n.Sb(i.g),n.Sb(u.a),n.Sb(b.a))},e.\u0275prov=n.Gb({token:e,factory:e.\u0275fac}),e}()},e1St:function(e,t,a){"use strict";a.r(t),a.d(t,"HubBaseModule",(function(){return Is}));var n=a("3Pt+"),i=a("PCNd"),r=a("tyNb"),o=a("2Vo4"),s=a("itXk"),c=a("soiQ"),l=a("fXoL"),u=a("4Y1E"),b=a("ElCs"),h=a("Wumg"),d=a("H3K+"),f=a("MI/1"),m=a("VdXI"),v=a("ofXK"),p=a("mWX8");function g(e,t){if(1&e&&(l.Lb(0,"actions-columnValidation-button",8),l.Lb(1,"dependent-items-button",9)),2&e){var a=t.item,n=l.Zb();l.hc("columnValidation",a),l.yb(1),l.hc("key",a.key)("objectType",n.eSharedObjectType.ColumnValidation)}}function y(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",10),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().deleteValidations(e)})),l.Nb()}}function C(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",10),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb(),l.Dc(1,y,1,0,"dexih-button-delete",11),l.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=l.Zb();l.yb(1),l.hc("ngIf",i.hubCache.canWrite),l.yb(1),l.hc("objectType",i.eSharedObjectType.ColumnValidation)("objects",n)}}var k=function(){return["columnValidation-new"]};function w(e,t){1&e&&l.Lb(0,"dexih-button-new",14),2&e&&l.hc("routerLink",l.lc(1,k))}function S(e,t){if(1&e&&l.Dc(0,w,1,2,"dexih-button-new",13),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite)}}var T,O=((T=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateValidations()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteValidations",value:function(e){this.hubService.deleteColumnValidations(e)}},{key:"updateValidations",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihColumnValidations.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.ColumnValidation,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["columnValidation-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddColumnValidation(e.key,a)})),this.hubService.exportHub(a,1===e.length?"ColumnValidation - "+e[0].name+".json":"columnValidations.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.ColumnValidation&&t.changeClass!==c.dc.TagObjects||e.updateValidations()}))}}]),e}()).\u0275fac=function(e){return new(e||T)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},T.\u0275cmp=l.Eb({type:T,selectors:[["columnValidations"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Validation Rules","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"mr-1",3,"columnValidation"],[1,"mr-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,g,2,3,"ng-template",3,4,l.Ec),l.Dc(5,C,3,3,"ng-template",5,6,l.Ec),l.Dc(7,S,1,1,"ng-template",null,7,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,f.a,m.a,h.u,v.t,p.a,h.g,h.o,r.f],encapsulation:2}),T),N=a("2v7R"),D=a("cvPx"),x=a("1qMd"),F=a("3WyZ"),V=a("64E1"),I=a("iFLP"),K=a("oLr2");function E(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div"),l.Ob(1,"div",10),l.Ob(2,"div",11),l.Ob(3,"button",12),l.Vb("click",(function(){return l.vc(a),l.Zb(3).test()})),l.Lb(4,"i",13),l.Nb(),l.Nb(),l.Ob(5,"input",14),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb(3).testValue=e})),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(3);l.yb(5),l.hc("ngModel",n.testValue)}}function L(e,t){if(1&e&&l.Lb(0,"save-button",6),2&e){var a=l.Zb(3);l.hc("formsService",a.formsService)}}function _(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-invalid-form-details",7),l.Vb("click",(function(){return l.vc(a),l.Zb(2).formsService.showErrors()})),l.Nb(),l.Dc(1,E,6,1,"div",8),l.Dc(2,L,1,1,"save-button",9)}if(2&e){var n=l.Zb(2);l.hc("control",n.formsService.currentForm),l.yb(1),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("ngIf",n.hubCache.canWrite)}}function P(e,t){if(1&e&&(l.Ob(0,"div",4),l.Dc(1,_,3,3,"ng-template",5),l.Lb(2,"cancel-button",6),l.Nb()),2&e){var a=l.Zb();l.yb(1),l.hc("ngIf",a.hubCache&&a.hubCache.status===a.eCacheStatus.Loaded),l.yb(1),l.hc("formsService",a.formsService)}}function M(e,t){if(1&e&&(l.Ob(0,"div"),l.Fc(1),l.Nb()),2&e){var a=l.Zb(3);l.yb(1),l.Hc("Cleaned Value = ",a.testResult.cleanedValue," ")}}function A(e,t){if(1&e&&(l.Ob(0,"div"),l.Fc(1),l.Nb()),2&e){var a=l.Zb(3);l.yb(1),l.Hc("Reject Reason = ",a.testResult.rejectReason," ")}}function R(e,t){if(1&e&&(l.Ob(0,"section"),l.Ob(1,"div",30),l.Fc(2),l.Dc(3,M,2,1,"div",8),l.Dc(4,A,2,1,"div",8),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.Cb("alert-danger",0==a.testResult.success)("alert-success",1==a.testResult.success),l.yb(1),l.Hc(" Test Result = ",a.testResult.success," "),l.yb(1),l.hc("ngIf",a.testResult.cleanedValue),l.yb(1),l.hc("ngIf",a.testResult.rejectReason)}}function j(e,t){if(1&e&&(l.Ob(0,"section",17),l.Lb(1,"form-select",31),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("items",a.cleanActions)}}function Z(e,t){1&e&&(l.Ob(0,"section"),l.Lb(1,"form-input",32),l.Nb())}function H(e,t){1&e&&(l.Ob(0,"div",16),l.Ob(1,"section",17),l.Lb(2,"form-input",33),l.Nb(),l.Ob(3,"section",17),l.Lb(4,"form-input",34),l.Nb(),l.Nb())}function G(e,t){1&e&&(l.Ob(0,"section"),l.Lb(1,"form-input",35),l.Nb())}function q(e,t){1&e&&(l.Ob(0,"section"),l.Lb(1,"form-input",36),l.Nb())}function B(e,t){1&e&&(l.Ob(0,"div",16),l.Ob(1,"section",17),l.Lb(2,"form-input",37),l.Nb(),l.Ob(3,"section",17),l.Lb(4,"form-input",38),l.Nb(),l.Nb())}function U(e,t){if(1&e&&(l.Ob(0,"form",15),l.Ob(1,"fieldset"),l.Dc(2,R,5,7,"section",8),l.Ob(3,"div",16),l.Ob(4,"section",17),l.Lb(5,"form-input",18),l.Nb(),l.Ob(6,"section",17),l.Lb(7,"form-select",19),l.Nb(),l.Nb(),l.Ob(8,"section"),l.Lb(9,"form-textarea",20),l.Nb(),l.Ob(10,"div",16),l.Ob(11,"section",17),l.Lb(12,"form-select",21),l.Nb(),l.Dc(13,j,2,1,"section",22),l.Nb(),l.Dc(14,Z,2,0,"section",8),l.Ob(15,"section"),l.Lb(16,"form-checkbox",23),l.Nb(),l.Dc(17,H,5,0,"div",24),l.Dc(18,G,2,0,"section",8),l.Dc(19,q,2,0,"section",8),l.Dc(20,B,5,0,"div",24),l.Ob(21,"section"),l.Lb(22,"form-tags",25),l.Nb(),l.Ob(23,"section"),l.Lb(24,"form-tags",26),l.Nb(),l.Ob(25,"section"),l.Lb(26,"form-select",27),l.Nb(),l.Ob(27,"section"),l.Lb(28,"form-checkbox",28),l.Nb(),l.Ob(29,"section"),l.Lb(30,"form-checkbox",29),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.formsService.currentForm),l.yb(2),l.hc("ngIf",a.testResult),l.yb(3),l.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),l.yb(2),l.hc("items",a.typeCodes),l.yb(2),l.hc("showMarkdown",!0),l.yb(3),l.hc("items",a.InvalidActions),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.invalidAction==a.eInvalidAction.Clean||a.formsService.currentForm.value.invalidAction==a.eInvalidAction.RejectClean),l.yb(1),l.hc("ngIf",(a.formsService.currentForm.value.invalidAction==a.eInvalidAction.RejectClean||a.formsService.currentForm.value.invalidAction==a.eInvalidAction.Clean)&&a.formsService.currentForm.value.cleanAction==a.eCleanAction.CleanValue),l.yb(3),l.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.dataType!=a.eTypeCode.String&&a.formsService.currentForm.value.dataType!=a.eTypeCode.Char),l.yb(6),l.hc("items",a.connections)("allowNullSelect",!0)}}var z,W=((z=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.eInvalidAction=c.Fb,this.eCleanAction=c.fb,this.eTypeCode=c.pc,this.InvalidActions=N.g,this.CleanActions=N.a,this.typeCodes=x.a,this.invalidActions=N.g,this.cleanActions=N.a,this.lookupColumnValue="",this.isLoaded=!1,this.eCacheStatus=N.j,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.connections=this.hubCache.getConnectionTables(),"edit"===this.action)if(this.columnValidationKey=+this.params.validationKey,this.columnValidationKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihColumnValidations.find((function(t){return t.key===e.columnValidationKey}));this.formsService.validation(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no validation specified to edit.");if("new"===this.action){var a=new c.e;this.formsService.validation(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/columnValidation-new","/columnValidation-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.isLoaded=!0,this.getValidationLookupColumn(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this._lookupColumnSubscription=this.formsService.currentForm.controls.lookupColumnKey.valueChanges.subscribe((function(){e.getValidationLookupColumn()}))}},{key:"getValidationLookupColumn",value:function(){var e=this.formsService.currentForm.controls.lookupColumnKey.value;if(e){var t=this.hubCache.getColumn(e);if(t){var a=this.hubCache.getTable(t.tableKey);this.lookupColumnValue="Exists in table:"+a.name+", column:"+t.name}else this.lookupColumnValue="Column not found.  Re-select a valid column."}else this.lookupColumnValue=""}},{key:"test",value:function(){var e=this;this.hubService.testColumnValidation(this.formsService.currentForm.value,this.testValue,this.cancelToken).then((function(t){e.testResult=t}))}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The view has not been saved","The column validation changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The column validation changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||z)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e))},z.\u0275cmp=l.Eb({type:z,selectors:[["dexih-columnValidation-edit-form"]],hostBindings:function(e,t){1&e&&l.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,l.uc)},features:[l.xb([D.a])],decls:5,vars:3,consts:[[1,"container"],["title","Edit Validation","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],[1,"d-inline-flex"],[3,"ngIf"],[1,"mr-1",3,"formsService"],[1,"mr-1",3,"control","click"],[4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"input-group","mr-1"],[1,"input-group-prepend"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-check-circle-o"],["type","text","placeholder","Test value","aria-label","","aria-describedby","basic-addon1",1,"form-control",2,"max-width","100px",3,"ngModel","ngModelChange"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Column Validation Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Data Type","formControlName","dataType","itemKey","key","itemName","name",3,"items"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Validation Fail Action","formControlName","invalidAction","itemKey","key","itemName","name","note","Action to take when the validation fails.",3,"items"],["class","form-group col-md-6",4,"ngIf"],["label","Ignore null values.","formControlName","allowDbNull"],["class","form-row",4,"ngIf"],["label","Restrict to list of values","formControlName","listOfValues","placeholder","Provide a list of values which are valid."],["label","Excluded list of values","formControlName","listOfNotValues","placeholder","Provide a list of values which are valid."],["label","Restrict to values that exist in a lookup table column","formControlName","lookupColumnKey","grandParentName","name","parentName","name","itemKey","key","itemName","name","childItems","dexihTables","grandChildItems","dexihTableColumns","note","Checks the selected table column, and ensures the value contains at least one match.",3,"items","allowNullSelect"],["label","Only lookup values where the 'is current' column is true.","formControlName","lookupIsValid"],["label","Allow valid when lookup returns multiple rows.","formControlName","lookupMultipleRecords"],[1,"alert"],["label","Clean Action","formControlName","cleanAction","itemKey","key","itemName","name","note","Clean Action to apply",3,"items"],["label","Clean Value","formControlName","cleanValue","placeholder","Enter the clean value.","iconClass","fa fa-list"],["label","Minimum String Length","formControlName","minLength","placeholder","Enter the minimum string length","type","number","iconClass","fa fa-list"],["label","Maximum String Length","formControlName","maxLength","placeholder","Enter the maximum string length","type","number","iconClass","fa fa-list"],["label","Simple Pattern Match","formControlName","patternMatch","placeholder","Provide a match string","iconClass","fa fa-list","note","Simple pattern match, use the format - A=Upper, a=Lower, Z=Any Character, 9=numeric.  (For example: AA999 matches AS123)"],["label","Regular Expression Match","formControlName","regexMatch","placeholder","Provide a regular expression","iconClass","fa fa-list","note","Use a standard regular expression to validate.  For example [A-Za-z0-9] will ensure string only contains characters and numbers."],["label","Minimum Value","formControlName","minValue","placeholder","Enter the minimum value","type","number","iconClass","fa fa-list"],["label","Maximum Value","formControlName","maxValue","placeholder","Enter the maximum value","type","number","iconClass","fa fa-list"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,P,3,2,"ng-template",null,2,l.Ec),l.Dc(4,U,31,15,"form",3),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(3),l.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,V.a,I.a,n.c,n.s,n.v,K.a,n.I,n.t,n.l,h.D,n.j,h.E,h.H,h.A,h.F],encapsulation:2}),z),Q=a("rgmq"),$=a("/pur"),X=a("l2bN"),Y=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};function J(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",10),l.Vb("click",(function(){l.vc(a);var e=l.Zb(2);return!e.refreshingConnection&&e.refreshConnection()})),l.Fc(1,"Test"),l.Nb()}if(2&e){var n=l.Zb(2);l.hc("busy",n.refreshingConnection)}}function ee(e,t){if(1&e&&l.Lb(0,"save-button",11),2&e){var a=l.Zb(2);l.hc("formsService",a.formsService)}}var te=function(e){return["../../connection-import",e]};function ae(e,t){if(1&e&&(l.Ob(0,"dexih-button",13),l.Fc(1,"Import Tables"),l.Nb()),2&e){var a=l.Zb(4);l.hc("routerLink",l.mc(1,te,a.formsService.currentForm.controls.key.value))}}function ne(e,t){if(1&e&&l.Dc(0,ae,2,3,"dexih-button",12),2&e){var a=l.Zb(3);l.hc("ngIf",a.formsService.currentForm.controls.key.value)}}var ie=function(e){return["../../../tables","table-new",e]};function re(e,t){if(1&e&&(l.Ob(0,"dexih-button",13),l.Fc(1,"New File"),l.Nb()),2&e){var a=l.Zb(4);l.hc("routerLink",l.mc(1,ie,a.formsService.currentForm.controls.key.value))}}function oe(e,t){if(1&e&&l.Dc(0,re,2,3,"dexih-button",12),2&e){var a=l.Zb(3);l.hc("ngIf",a.formsService.currentForm.controls.key.value)}}function se(e,t){if(1&e&&(l.Ob(0,"dexih-button",13),l.Fc(1,"New WebService"),l.Nb()),2&e){var a=l.Zb(4);l.hc("routerLink",l.mc(1,ie,a.formsService.currentForm.controls.key.value))}}function ce(e,t){if(1&e&&l.Dc(0,se,2,3,"dexih-button",12),2&e){var a=l.Zb(3);l.hc("ngIf",a.formsService.currentForm.controls.key.value)}}function le(e,t){if(1&e&&(l.Dc(0,ne,1,1,"ng-template",8),l.Dc(1,oe,1,1,"ng-template",8),l.Dc(2,ce,1,1,"ng-template",8)),2&e){var a=l.Zb(2);l.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.SqlDatabase||a.connectionReference.connectionCategory==a.eConnectionCategory.DatabaseFile||a.connectionReference.connectionCategory==a.eConnectionCategory.NoSqlDatabase||a.connectionReference.connectionCategory==a.eConnectionCategory.Hub),l.yb(1),l.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.File),l.yb(1),l.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.WebService)}}function ue(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-invalid-form-details",5),l.Vb("click",(function(){return l.vc(a),l.Zb().formsService.showErrors()})),l.Nb(),l.Dc(1,J,2,1,"dexih-button",6),l.Dc(2,ee,1,1,"save-button",7),l.Dc(3,le,3,3,"ng-template",8),l.Lb(4,"cancel-button",9)}if(2&e){var n=l.Zb();l.hc("control",n.formsService.currentForm),l.yb(1),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("ngIf",n.hubCache.canWrite&&n.connectionReference),l.yb(1),l.hc("formsService",n.formsService)}}function be(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",33),l.Vb("click",(function(){return l.vc(a),l.Zb(7).revealConnectionString()})),l.Lb(1,"i",34),l.Fc(2," Reveal "),l.Nb()}}function he(e,t){1&e&&(l.Ob(0,"span"),l.Lb(1,"i",35),l.Fc(2," Revealing... please wait "),l.Nb())}function de(e,t){if(1&e&&(l.Ob(0,"span"),l.Fc(1," ("),l.Dc(2,be,3,0,"a",32),l.Dc(3,he,3,0,"span",23),l.Fc(4,")"),l.Nb()),2&e){var a=l.Zb(6);l.yb(2),l.hc("ngIf",0==a.revealingConnectionString),l.yb(1),l.hc("ngIf",1==a.revealingConnectionString)}}function fe(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form-input",31),l.Vb("keydown",(function(){return l.vc(a),l.Zb(5).connectionStringChanged()})),l.Dc(1,de,5,2,"span",23),l.Nb()}if(2&e){var n=l.Zb(5);l.hc("errors",n.formsService.formErrors.connectionStringDisplay),l.yb(1),l.hc("ngIf",!n.formsService.formErrors.connectionStringRaw)}}function me(e,t){if(1&e&&l.Lb(0,"form-select",36),2&e){var a=l.Zb(5);l.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function ve(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section"),l.Dc(1,fe,2,2,"form-input",28),l.Dc(2,me,1,3,"form-select",29),l.Ob(3,"form-checkbox",30),l.Vb("click",(function(){return l.vc(a),l.Zb(4).clearConnectionString()})),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(4);l.yb(1),l.hc("ngIf",!n.formsService.currentForm.controls.useConnectionStringVariable.value),l.yb(1),l.hc("ngIf",n.formsService.currentForm.controls.useConnectionStringVariable.value)}}function pe(e,t){if(1&e&&(l.Ob(0,"span"),l.Ob(1,"section"),l.Lb(2,"form-checkbox",27),l.Nb(),l.Dc(3,ve,4,2,"section",23),l.Nb()),2&e){var a=l.Zb(3);l.yb(3),l.hc("ngIf",1==a.formsService.currentForm.controls.useConnectionString.value)}}function ge(e,t){1&e&&(l.Ob(0,"section"),l.Lb(1,"form-checkbox",40),l.Nb())}function ye(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form-input",45),l.Vb("keydown",(function(){return l.vc(a),l.Zb(5).passwordChanged()})),l.Nb()}if(2&e){var n=l.Zb(5);l.hc("errors",n.formsService.formErrors.password)}}function Ce(e,t){if(1&e&&l.Lb(0,"form-select",46),2&e){var a=l.Zb(5);l.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function ke(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",18),l.Ob(1,"section",19),l.Lb(2,"form-select",41),l.Nb(),l.Ob(3,"section",19),l.Dc(4,ye,1,1,"form-input",42),l.Dc(5,Ce,1,3,"form-select",43),l.Ob(6,"form-checkbox",44),l.Vb("click",(function(){return l.vc(a),l.Zb(4).clearPassword()})),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(4);l.yb(2),l.hc("enableTextEntry",!0)("errors",n.formsService.formErrors.username)("items",n.variables)("enableFilter",!0),l.yb(2),l.hc("ngIf",0==n.formsService.currentForm.controls.usePasswordVariable.value),l.yb(1),l.hc("ngIf",n.formsService.currentForm.controls.usePasswordVariable.value)}}function we(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form-input",50),l.Vb("keydown",(function(){return l.vc(a),l.Zb(5).passwordChanged()})),l.Nb()}if(2&e){var n=l.Zb(5);l.hc("errors",n.formsService.formErrors.password)}}function Se(e,t){if(1&e&&l.Lb(0,"form-select",51),2&e){var a=l.Zb(5);l.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function Te(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",18),l.Ob(1,"section",19),l.Dc(2,we,1,1,"form-input",47),l.Dc(3,Se,1,3,"form-select",48),l.Ob(4,"form-checkbox",49),l.Vb("click",(function(){return l.vc(a),l.Zb(4).clearPassword()})),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(4);l.yb(2),l.hc("ngIf",0==n.formsService.currentForm.controls.usePasswordVariable.value),l.yb(1),l.hc("ngIf",n.formsService.currentForm.controls.usePasswordVariable.value)}}function Oe(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",33),l.Vb("click",(function(){return l.vc(a),l.Zb(5).refreshConnection()})),l.Lb(1,"i",34),l.Fc(2," Refresh "),l.Nb()}}function Ne(e,t){1&e&&(l.Ob(0,"span"),l.Lb(1,"i",35),l.Fc(2," Refreshing... please wait "),l.Nb())}function De(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",33),l.Vb("click",(function(){return l.vc(a),l.Zb(5).createDatabase()})),l.Lb(1,"i",54),l.Fc(2," New Database "),l.Nb()}}function xe(e,t){1&e&&(l.Ob(0,"span"),l.Lb(1,"i",35),l.Fc(2," Creating database... please wait "),l.Nb())}function Fe(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section",52),l.Ob(1,"form-select",53),l.Vb("textValueChange",(function(e){return l.vc(a),l.Zb(4).newDatabaseName(e)})),l.Fc(2," ("),l.Dc(3,Oe,3,0,"a",32),l.Dc(4,Ne,3,0,"span",23),l.Fc(5,") ( "),l.Dc(6,De,3,0,"a",32),l.Dc(7,xe,3,0,"span",23),l.Fc(8,") "),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(4);l.yb(1),l.hc("label",n.connectionReference.databaseDescription)("items",n.databases)("defaultItem",n.formsService.currentForm.value.defaultDatabase)("sortItems",!0)("enableTextEntry",!0),l.yb(2),l.hc("ngIf",0==n.refreshingConnection),l.yb(1),l.hc("ngIf",1==n.refreshingConnection),l.yb(2),l.hc("ngIf",0==n.creatingDatabase),l.yb(1),l.hc("ngIf",1==n.creatingDatabase)}}function Ve(e,t){if(1&e&&(l.Ob(0,"span"),l.Ob(1,"section"),l.Lb(2,"form-select",37),l.Nb(),l.Dc(3,ge,2,0,"section",23),l.Dc(4,ke,7,6,"div",38),l.Dc(5,Te,5,2,"div",38),l.Dc(6,Fe,9,9,"section",39),l.Nb()),2&e){var a=l.Zb(3);l.yb(2),l.hc("enableTextEntry",!0)("label",a.connectionReference.serverDescription)("errors",a.formsService.formErrors.server)("items",a.variables)("enableFilter",!0)("note",a.connectionReference.serverHelp),l.yb(1),l.hc("ngIf",1==a.connectionReference.allowsWindowsAuth),l.yb(1),l.hc("ngIf",a.connectionReference.allowsUserPassword&&(0==a.formsService.currentForm.controls.useWindowsAuth.value||0==a.connectionReference.allowsWindowsAuth)),l.yb(1),l.hc("ngIf",a.connectionReference.allowsToken&&(0==a.formsService.currentForm.controls.useWindowsAuth.value||0==a.connectionReference.allowsWindowsAuth)),l.yb(1),l.hc("ngIf",a.connectionReference.requiresDatabase)}}function Ie(e,t){if(1&e&&(l.Ob(0,"section"),l.Lb(1,"form-checkbox",55),l.Nb()),2&e){var a=l.Zb(3);l.yb(1),l.hc("errors",a.formsService.formErrors.embedTableKey)}}function Ke(e,t){if(1&e){var a=l.Pb();l.Ob(0,"span"),l.Ob(1,"section"),l.Ob(2,"markdown",24),l.Vb("click",(function(e){return l.vc(a),l.Zb(2).getRoute(e)})),l.Nb(),l.Nb(),l.Dc(3,pe,4,1,"span",23),l.Dc(4,Ve,7,10,"span",23),l.Ob(5,"div",18),l.Ob(6,"section",19),l.Lb(7,"form-input",25),l.Nb(),l.Ob(8,"section",19),l.Lb(9,"form-input",26),l.Nb(),l.Nb(),l.Dc(10,Ie,2,1,"section",23),l.Nb()}if(2&e){var n=l.Zb(2);l.yb(2),l.hc("data",n.connectionReference.description),l.yb(1),l.hc("ngIf",1==n.connectionReference.allowsConnectionString),l.yb(1),l.hc("ngIf",0==n.formsService.currentForm.controls.useConnectionString.value),l.yb(3),l.hc("errors",n.formsService.formErrors.connectionTimeout),l.yb(2),l.hc("errors",n.formsService.formErrors.commandTimeout),l.yb(1),l.hc("ngIf","Managed"==n.formsService.currentForm.controls.purpose.value)}}var Ee=function(){return{standalone:!0}};function Le(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form",14),l.Lb(1,"input",15),l.Lb(2,"input",16),l.Ob(3,"fieldset"),l.Ob(4,"section"),l.Lb(5,"form-select",17),l.Nb(),l.Ob(6,"div",18),l.Ob(7,"section",19),l.Lb(8,"form-input",20),l.Nb(),l.Ob(9,"section",19),l.Ob(10,"form-select",21),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb().connectionReference=e}))("ngModelChange",(function(e){return l.vc(a),l.Zb().selectDatabaseType(e)})),l.Nb(),l.Nb(),l.Nb(),l.Ob(11,"section"),l.Lb(12,"form-textarea",22),l.Nb(),l.Dc(13,Ke,11,6,"span",23),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("formGroup",n.formsService.currentForm),l.yb(5),l.hc("items",n.eConnectionPurposeItems)("enableFilter",!1)("errors",n.formsService.formErrors.purpose),l.yb(3),l.hc("autocapitalize",!0)("errors",n.formsService.formErrors.name),l.yb(2),l.hc("ngModel",n.connectionReference)("ngModelOptions",l.lc(14,Ee))("items",n.connectionTypes)("enableKeySelect",!1)("sortItems",!0),l.yb(2),l.hc("showMarkdown",!0)("errors",n.formsService.formErrors.description),l.yb(1),l.hc("ngIf",n.connectionReference)}}var _e,Pe=((_e=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.savingConnection=!1,this.refreshingConnection=!1,this.revealingConnectionString=!1,this.creatingDatabase=!1,this.databases=[],this.eConnectionPurposeItems=c.kb.filter((function(e){return e.key>0})),this.eConnectionPurpose=c.jb,this.eConnectionCategory=c.ib,this.cancelToken=new F.a,this.isLoaded=!1,this.variables=[],this.logger=new Q.a("connection-edit")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.logger.LogC((function(){return"OnInit"}),Q.b.Trace);try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){return Y(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[0],this.params=t[1],this.hubCache=t[2],this.remoteLibraries=t[3],this.action=a.action,this.pageTitle=a.pageTitle,this.variables=this.hubCache.hub.dexihHubVariables.map((function(e){return"{"+e.name+"}"})),e.t0=this.hubCache&&this.hubCache.status===N.j.Loaded,!e.t0){e.next=17;break}if(e.t1=this.isLoaded&&"new"===this.action,e.t1){e.next=17;break}if(!this.isLoaded||!this.formsService.hasChanged){e.next=15;break}this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(e){return Y(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e,!t.t0){t.next=4;break}return t.next=4,this.load();case 4:case"end":return t.stop()}}),t,this)})))})).catch((function(e){})),e.next=17;break;case 15:return e.next=17,this.load();case 17:case"end":return e.stop()}}),e,this)})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,n,i,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded=!0,"edit"!==this.action){e.next=21;break}if(this.connectionKey=+this.params.connectionKey,this.logger.LogC((function(){return"edit connection key ".concat(o.connectionKey,".")}),Q.b.Trace),!this.connectionKey){e.next=20;break}if(!this.hubCache.hub||!this.hubCache.hub.dexihConnections){e.next=17;break}if(!(t=this.hubCache.hub.dexihConnections.find((function(e){return e.key===o.connectionKey})))){e.next=14;break}return this.updateDatabaseTypes(t.purpose),e.next=8,this.hubService.GetConnectionReference(t);case 8:this.connectionReference=e.sent,this.formsService.connection(t),t.defaultDatabase&&(this.databases=[t.defaultDatabase]),this.logger.LogC((function(){return"edit connection, form loaded."}),Q.b.Trace),e.next=15;break;case 14:this.hubService.addHubErrorMessage("The specified connection could not be found."),this.logger.LogC((function(){return"edit connection with key ".concat(o.connectionKey," not found.")}),Q.b.Warning);case 15:e.next=18;break;case 17:this.hubService.addHubErrorMessage("The hub cache is not loaded.");case 18:e.next=21;break;case 20:this.hubService.addHubErrorMessage("There was no connection specified to edit.");case 21:if("new"===this.action&&((a=new c.f).purpose=+this.params.purpose,this.logger.LogC((function(){return"new connection, purpose ".concat(a.purpose,".")}),Q.b.Trace),this.updateDatabaseTypes(a.purpose),this.formsService.connection(a),this.updateUrl(),this.logger.LogC((function(){return"new connection, form loaded."}),Q.b.Trace)),"copy"!==this.action){e.next=35;break}return n=new c.f,i=+this.params.connectionKey,r=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i})),Object.assign(n,r),n.name+=" (copy)",n.key=null,e.next=29,this.hubService.GetConnectionReference(n);case 29:this.connectionReference=e.sent,this.logger.LogC((function(){return"copy connection, connectionKey ".concat(i,".")}),Q.b.Trace),this.updateDatabaseTypes(n.purpose),this.formsService.connection(n),this.updateUrl(),this.logger.LogC((function(){return"new connection, form loaded."}),Q.b.Trace);case 35:this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this._purposeSubscription=this.formsService.currentForm.controls.purpose.valueChanges.subscribe((function(e){o.updateDatabaseTypes(e)}));case 36:case"end":return e.stop()}}),e,this)})))}},{key:"updateUrl",value:function(){var e=this;this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname,i=n.indexOf("/connection-new");if(i>0){var r=n.substr(0,i)+"/connection-edit/"+a;e.router.navigateByUrl(r)}e._formChangeSubscription.unsubscribe()}}))}},{key:"updateDatabaseTypes",value:function(e){this.connectionTypes=this.remoteLibraries.connections.filter((function(t){return e===c.jb.Source&&t.allowsSourceConnection||e===c.jb.Managed&&t.allowsManagedConnection||e===c.jb.Target&&t.allowsTargetConnection}))}},{key:"selectDatabaseType",value:function(e){return Y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.formsService.currentForm.controls.connectionClassName.setValue(e.connectionClassName),this.formsService.currentForm.controls.connectionAssemblyName.setValue(e.connectionAssemblyName),this.connectionReference.connectionCategory===c.ib.Hub&&(this.formsService.currentForm.controls.server.value||(a=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),this.formsService.currentForm.controls.server.setValue(a)),this.formsService.currentForm.controls.username.value||(n=this.authService.getUser())&&this.formsService.currentForm.controls.username.setValue(n.email));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"connectionStringChanged",value:function(){this.logger.LogC((function(){return"connectionStringChanged."}),Q.b.Trace),this.formsService.currentForm.controls.connectionString.value&&(this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue(""))}},{key:"clearConnectionString",value:function(){this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue("")}},{key:"revealConnectionString",value:function(){var e=this;this.logger.LogC((function(){return"revealConnectionString."}),Q.b.Trace),this.revealingConnectionString=!0,this.hubService.decrypt(this.formsService.currentForm.controls.connectionString.value,this.cancelToken).then((function(t){e.formsService.currentForm.controls.connectionStringDisplay.setValue(t),e.revealingConnectionString=!1})).catch((function(t){e.hubService.addHubMessage(t),e.revealingConnectionString=!1}))}},{key:"passwordChanged",value:function(){this.logger.LogC((function(){return"passwordChanged."}),Q.b.Trace),this.formsService.currentForm.controls.password.value&&(this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue(""))}},{key:"clearPassword",value:function(){this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue("")}},{key:"refreshConnection",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.LogC((function(){return"refreshConnection."}),Q.b.Trace),e.next=3,this.encryptConnection();case 3:this.refreshingConnection=!0,this.hubService.refreshConnection(this.formsService.currentForm.value,this.cancelToken).then((function(e){t.hubService.addHubSuccessMessage("The connection was successful."),t.databases=e,t.refreshingConnection=!1})).catch((function(e){t.hubService.addHubMessage(e),t.refreshingConnection=!1}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"newDatabaseName",value:function(e){this.formsService.currentForm.controls.defaultDatabase.setValue(e)}},{key:"createDatabase",value:function(){var e=this;this.creatingDatabase=!0,this.authService.promptDialog("Create Database","Enter the name for the new database?").then((function(t){return Y(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,this.encryptConnection();case 3:(a=Object.assign({},this.formsService.currentForm.value)).defaultDatabase=t,this.hubService.createDatabase(a,this.cancelToken).then((function(){n.hubService.addHubSuccessMessage("The database was created successfully."),n.databases=[t],n.formsService.currentForm.controls.defaultDatabase.setValue(t),n.creatingDatabase=!1})).catch((function(e){n.hubService.addHubMessage(e),n.creatingDatabase=!1})),e.next=8;break;case 7:this.creatingDatabase=!1;case 8:case"end":return e.stop()}}),e,this)})))})).catch((function(){e.creatingDatabase=!1}))}},{key:"encryptConnection",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.formsService.currentForm,!(a=t.controls.passwordRaw.value)){e.next=6;break}return e.next=4,this.hubService.encrypt(a,this.cancelToken);case 4:n=e.sent,t.controls.password.setValue(n),t.controls.passwordRaw.setValue(null);case 6:if(!(i=t.controls.connectionStringRaw.value)){e.next=12;break}return e.next=10,this.hubService.encrypt(i,this.cancelToken);case 10:r=e.sent,t.controls.connectionString.setValue(r),t.controls.connectionStringRaw.setValue(null);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"save",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.encryptConnection();case 2:return e.next=4,this.formsService.save();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The connection has not been saved","The connection changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"getRoute",value:function(e){this.authService.getRoute(e)}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The connection changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||_e)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e))},_e.\u0275cmp=l.Eb({type:_e,selectors:[["dexih-connection-edit-form"]],hostBindings:function(e,t){1&e&&l.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,l.uc)},features:[l.xb([D.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Connection","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1","buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",3,"busy","click",4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"ngIf"],[3,"formsService"],["buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",1,"mr-1",3,"busy","click"],[1,"mr-1",3,"formsService"],["class","mr-1","iconClass","fa fa-plus",3,"routerLink",4,"ngIf"],["iconClass","fa fa-plus",1,"mr-1",3,"routerLink"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["label","Purpose","formControlName","purpose","placeholder","Connection purpose","iconClass","fa fa-database","itemName","name","itemKey","key",3,"items","enableFilter","errors"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Name","formControlName","name","placeholder","Enter a name for the connection","iconClass","fa fa-database",3,"autocapitalize","errors"],["label","Database Type","itemName","name","itemKey","name","iconClass","fa fa-database",3,"ngModel","ngModelOptions","items","enableKeySelect","sortItems","ngModelChange"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown","errors"],[4,"ngIf"],[3,"data","click"],["type","number","label","Connection Timeout","formControlName","connectionTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will wait to establish a connection.",3,"errors"],["type","number","label","Command Timeout","formControlName","commandTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will for a command to start returning a result.",3,"errors"],["label","Use a connection string","formControlName","useConnectionString"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown",4,"ngIf"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for connection string","formControlName","useConnectionStringVariable",3,"click"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],[1,"fa","fa-refresh"],[1,"fa","fa-spin","fa-refresh"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry"],["formControlName","server","placeholder","Enter the details.","iconClass","fa fa-server",3,"enableTextEntry","label","errors","items","enableFilter","note"],["class","form-row",4,"ngIf"],["ng-disabled","refreshingConnection || creatingDatabase",4,"ngIf"],["label","Use windows authentication","formControlName","useWindowsAuth"],["label","User Name","formControlName","username","placeholder","Enter user name","iconClass","fa fa-user",3,"enableTextEntry","errors","items","enableFilter"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for password","formControlName","usePasswordVariable",3,"click"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for token","formControlName","usePasswordVariable",3,"click"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["ng-disabled","refreshingConnection || creatingDatabase"],["formControlName","defaultDatabase","iconClass","fa fa-database","textEntryNote","Enter the database name",3,"label","items","defaultItem","sortItems","enableTextEntry","textValueChange"],[1,"fa","fa-edit"],["label","Multi-use Managed Database (table keys will be added to table names to allow multiple hubs to use same database)","formControlName","embedTableKey",3,"errors"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,ue,5,5,"ng-template",null,2,l.Ec),l.Dc(4,Le,14,15,"form",3),l.Nb(),l.Lb(5,"dexih-help",4),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(3),l.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,$.a,I.a,V.a,h.f,K.a,r.f,n.I,n.t,n.l,h.E,n.s,n.j,h.D,n.v,h.H,X.a,h.A],encapsulation:2}),_e);function Me(e,t){}function Ae(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-splitdropdown",12),l.Vb("buttonClick",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().importSelected(e)})),l.Ob(1,"a",13),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().newDatalinks(e)})),l.Fc(2,"Import & Create Datalinks"),l.Nb(),l.Nb()}}function Re(e,t){if(1&e){var a=l.Pb();l.Dc(0,Ae,3,0,"dexih-button-splitdropdown",10),l.Ob(1,"dexih-button-delete",11),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().deleteSelected(e)})),l.Nb()}if(2&e){var n=l.Zb();l.hc("ngIf",n.hubCache.canWrite)}}var je=function(e){return["table-edit",e]};function Ze(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-edit",15),l.Vb("click",(function(){l.vc(a);var e=l.Zb(2);return e.deleteSelected(e.items)})),l.Nb()}if(2&e){var n=l.Zb().item;l.hc("routerLink",l.mc(1,je,n.key))}}function He(e,t){1&e&&l.Dc(0,Ze,1,3,"dexih-button-edit",14),2&e&&l.hc("ngIf",t.item.key)}function Ge(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-dropdown",16),l.Ob(1,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setTableFilter("All")})),l.Fc(2,"All"),l.Nb(),l.Ob(3,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setTableFilter("Imported")})),l.Fc(4,"Imported"),l.Nb(),l.Ob(5,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setTableFilter("NonImported")})),l.Fc(6,"Non Imported"),l.Nb(),l.Nb(),l.Ob(7,"dexih-button-dropdown",18),l.Ob(8,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setViewFilter("All")})),l.Fc(9,"All"),l.Nb(),l.Ob(10,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setViewFilter("Tables")})),l.Fc(11,"Tables"),l.Nb(),l.Ob(12,"a",17),l.Vb("click",(function(){return l.vc(a),l.Zb().setViewFilter("Views")})),l.Fc(13,"Views"),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("text",n.tableFilter)("pullRight",!0),l.yb(1),l.Cb("active","All"==n.tableFilter),l.yb(2),l.Cb("active","Imported"==n.tableFilter),l.yb(2),l.Cb("active","NonImported"==n.tableFilter),l.yb(2),l.hc("text",n.viewFilter)("pullRight",!0),l.yb(1),l.Cb("active","All"==n.viewFilter),l.yb(2),l.Cb("active","Imported"==n.viewFilter),l.yb(2),l.Cb("active","NonImported"==n.viewFilter)}}var qe,Be=((qe=function(){function e(t,a,n,i){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.router=n,this.route=i,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new F.a,this.columns=[{name:"schema",title:"Schema",format:""},{name:"name",title:"Name",format:""},{name:"tableType",title:"Type",enum:c.ic,format:"Enum"},{name:"entityStatus.message",title:"Latest Status"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable(),this.tableFilter="All",this.viewFilter="Tables"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.showPageMessage="Querying source database tables.  Please wait...";try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){return a=e,i=regeneratorRuntime.mark((function e(){var a,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[1],this.hubCache=t[2],n=t[3],this.connectionKey=+a.connectionKey,!this.connectionKey){e.next=15;break}if(e.t0=this.hubCache.isLoaded(),!e.t0){e.next=13;break}return this.connection=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i.connectionKey})),e.next=10,this.hubService.GetConnectionReference(this.connection);case 10:this.connectionReference=e.sent,this.showPage=!1,n?this.connection?this.getTables(this.connection):(this.hubService.addHubErrorMessage("The connection could not be found."),this.close()):this.showPageMessage="Waiting for an active remote agent...";case 13:e.next=16;break;case 15:this.hubService.addHubErrorMessage("There was no connection specified to import tables."),this.close();case 16:case"end":return e.stop()}}),e,this)})),new((n=void 0)||(n=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(a){t(a)}}function o(e){try{s(i.throw(e))}catch(a){t(a)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}s((i=i.apply(a,[])).next())}));var a,n,i}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Import")}this.watchChanges()}},{key:"setTableFilter",value:function(e){this.tableFilter=e,this.updateFilter()}},{key:"setViewFilter",value:function(e){this.viewFilter=e,this.updateFilter()}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"updateFilter",value:function(){var e;switch(this.tableFilter){case"Imported":e=this.tables.filter((function(e){return e.key>0}));break;case"NonImported":e=this.tables.filter((function(e){return 0===e.key||!e.key}));break;default:e=this.tables}switch(this.viewFilter){case"Views":e=e.filter((function(e){return e.tableType===c.ic.View}));break;case"Tables":e=e.filter((function(e){return e.tableType===c.ic.Table}))}this._tableData.next(e)}},{key:"getTables",value:function(e){var t=this;this.showPage=!1,this.showPageMessage="Importing tables from remote database...",this.hubService.getDatabaseTableNames(e,this.cancelToken).then((function(a){t.tables=a;for(var n=t.hubCache.hub.dexihTables.filter((function(t){return t.connectionKey===e.key})),i=function(i){var r=null,o=a[i];n&&!(r=n.find((function(e){return e.name===o.name&&e.schema===o.schema})))&&t.connectionReference&&t.connectionReference.defaultSchema===o.schema&&(r=n.find((function(e){return e.name===o.name&&!e.schema}))),r?t.tables[i]=r:(o.connectionKey=e.key,o.tableType=o.tableType,o.entityStatus=new N.c)},r=0;r<a.length;r++)i(r);t.showPage=!0,t.showPageMessage="",t.updateFilter()})).catch((function(e){t.hubService.addHubMessage(e)}))}},{key:"import",value:function(e){var t=this;this.hubService.importTables([e],!0,this.cancelToken).then((function(e){t.mergeTables(e)})).catch((function(t){e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=c.hc.Error,e.entityStatus.message=t.message}))}},{key:"deleteTable",value:function(e){this.hubService.deleteTables([e]).then((function(t){e.entityStatus.isBusy=!1})).catch((function(t){e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=c.hc.Error,e.entityStatus.message=t.message}))}},{key:"importSelected",value:function(e){var t=this,a=e.filter((function(e){return!e.entityStatus.isBusy}));a.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.importTables(a,!0,this.cancelToken).then((function(e){t.mergeTables(e)})).catch((function(e){a.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"mergeTables",value:function(e){var t=this;e&&(e.forEach((function(e){var a=t.tables.findIndex((function(t){return t.name===e.name&&t.schema===e.schema}));a>=0&&(t.tables[a]=e)})),this.updateFilter())}},{key:"deleteSelected",value:function(e){var t=e.filter((function(e){return!e.entityStatus.isBusy&&e.key>0}));0===t.length&&this.authService.informationDialog("Can not delete","None of the selected tables can be deleted, as they are either busy, or have not been imported."),t.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.deleteTables(t).then((function(e){t.forEach((function(e){return e.entityStatus.isBusy=!1}))})).catch((function(e){t.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"editTable",value:function(e){e&&e.key&&this.router.navigate(["table-edit",e.key],{relativeTo:this.route.parent})}},{key:"newDatalinks",value:function(e){var t=this,a=e.filter((function(e){return!e.entityStatus.isBusy}));a.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.importTables(a,!0,this.cancelToken).then((function(e){t.mergeTables(e);var a=e.map((function(e){return e.key})).join("|");t.router.navigate(["datalink-new",a,0],{relativeTo:t.route.parent})})).catch((function(e){a.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){if(t.changeClass===c.dc.Table){if(t.changeType===c.Eb.Replace||t.changeType===c.Eb.New){var a=t.data;if(a.connectionKey===e.connectionKey){var n=e.tables.findIndex((function(e){return e.name===a.name&&e.schema===a.schema}));n>=0&&(e.tables[n]=a,e.updateFilter())}}if(t.changeType===c.Eb.Delete){var i=t.data;if(i.connectionKey===e.connectionKey){var r=e.tables.find((function(e){return e.key===i.key}));r&&(r.key=null,r.entityStatus.isBusy=!1,r.updateDate=null,r.createDate=null,e.updateFilter())}}}}))}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||qe)(l.Kb(b.a),l.Kb(u.a),l.Kb(r.e),l.Kb(r.a))},qe.\u0275cmp=l.Eb({type:qe,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:11,vars:10,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-database",3,"title","showIf","loadingMessage","showCloseButton","padding","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["select","filter"],["filter",""],["class","mr-1","text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",3,"buttonClick",4,"ngIf"],["title","Delete selected tables",3,"click"],["text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",1,"mr-1",3,"buttonClick"],["title","Import tables and create default staging datalinks",1,"dropdown-item",3,"click"],["class","mr-1","queryParamsHandling","","preserveFragment","","title","Edit this table",3,"routerLink","click",4,"ngIf"],["queryParamsHandling","","preserveFragment","","title","Edit this table",1,"mr-1",3,"routerLink","click"],["buttonClass","btn-primary","iconClass","fa fa-download","title","Filter by import status",1,"mr-1",3,"text","pullRight"],[1,"dropdown-item",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-table","title","Filter by tables/views",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,Me,0,0,"ng-template",null,2,l.Ec),l.Ob(4,"dexih-table",3),l.Vb("rowClick",(function(e){return t.editTable(e)})),l.Dc(5,Re,2,1,"ng-template",4,5,l.Ec),l.Dc(7,He,1,1,"ng-template",6,7,l.Ec),l.Dc(9,Ge,14,16,"ng-template",8,9,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("title","Import Tables for "+(null==t.connection?null:t.connection.name))("showIf",t.showPage)("loadingMessage",t.showPageMessage)("showCloseButton",!0)("padding",!1),l.yb(3),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,v.t,h.g,h.w,h.j,r.f,h.i],encapsulation:2}),qe),Ue=a("Ifnz"),ze=a("965U");function We(e,t){1&e&&l.Lb(0,"actions-connection-button",9),2&e&&l.hc("connections",t.items)}function Qe(e,t){if(1&e&&l.Lb(0,"tags-update-button",10),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.Connection)("objects",a)}}var $e=function(e){return{purposeFilter:e}};function Xe(e,t){if(1&e&&(l.Ob(0,"a",14),l.Fc(1),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(2);l.Cb("active",n.purposeFilter==a.key),l.hc("queryParams",l.mc(5,$e,a.key))("title",a.name),l.yb(1),l.Gc(a.name)}}var Ye=function(){return{purposeFilter:"All"}};function Je(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",11),l.Ob(1,"a",12),l.Fc(2,"All"),l.Nb(),l.Dc(3,Xe,2,7,"a",13),l.ac(4,"gtFilter"),l.Nb()),2&e){var a=l.Zb();l.hc("autoCompact",!1)("text",a.eConnectionPurpose[a.purposeFilter])("pullRight",!0),l.yb(1),l.Cb("active","All"==a.purposeFilter),l.hc("queryParams",l.lc(11,Ye)),l.yb(2),l.hc("ngForOf",l.dc(4,7,a.eConnectionPurposeItems,"key",0))}}var et,tt=((et=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eConnectionPurpose=c.jb,this.eConnectionPurposeItems=c.kb,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{name:"purpose",title:"Purpose",format:""},{name:"type",title:"Type",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.purposeFilter=+a.purposeFilter,e.purposeFilter||(e.purposeFilter=0),e.pageTitle=c.jb[e.purposeFilter]+" Connections",e.updateConnections()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteConnection",value:function(e){this.hubService.deleteConnections([e]).catch((function(e){}))}},{key:"deleteConnections",value:function(e){this.hubService.deleteConnections(e)}},{key:"editConnection",value:function(e){this.router.navigate(["connection-edit",e.key],{relativeTo:this.route})}},{key:"updateConnections",value:function(){var e,t,a,n,i;return a=this,i=regeneratorRuntime.mark((function a(){var n,i,r,o,s,l,u=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.hubCache||!this.hubCache.isLoaded()){a.next=34;break}n=0!==this.purposeFilter&&this.purposeFilter?this.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===u.purposeFilter})):this.hubCache.hub.dexihConnections,i=[],a.prev=3,o=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(n);case 5:return a.next=7,o.next();case 7:if((r=a.sent).done){a.next=15;break}return s=r.value,a.next=11,this.hubService.GetConnectionReference(s);case 11:l=a.sent,i.push({key:s.key,connectionAssemblyName:s.connectionAssemblyName,connectionClassName:s.connectionClassName,purpose:c.jb[s.purpose],type:l?l.name:"Unknown ("+s.connectionClassName+")",name:s.name,tags:this.hubCache.getObjectTags(c.dc.Connection,s.key),description:s.description,updateDate:s.updateDate});case 13:a.next=5;break;case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(3),e={error:a.t0};case 20:if(a.prev=20,a.prev=21,a.t1=r&&!r.done&&(t=o.return),!a.t1){a.next=26;break}return a.next=26,t.call(o);case 26:if(a.prev=26,!e){a.next=29;break}throw e.error;case 29:return a.finish(26);case 30:return a.finish(20);case 31:this._tableData.next(i),a.next=35;break;case 34:this._tableData.next(null);case 35:case"end":return a.stop()}}),a,this,[[3,17,20,31],[21,,26,30]])})),new((n=void 0)||(n=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(a){t(a)}}function o(e){try{s(i.throw(e))}catch(a){t(a)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}s((i=i.apply(a,[])).next())}))}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddConnection(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Connection - "+e[0].name+".json":"connections.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Connection&&t.changeClass!==c.dc.TagObjects||e.updateConnections()}))}}]),e}()).\u0275fac=function(e){return new(e||et)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},et.\u0275cmp=l.Eb({type:et,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Connections","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[3,"connections"],[1,"ml-1",3,"objectType","objects"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.editConnection(e)})),l.Dc(3,We,1,1,"ng-template",null,3,l.Ec),l.Dc(5,Qe,1,2,"ng-template",4,5,l.Ec),l.Dc(7,Je,5,12,"ng-template",6,7,l.Ec),l.Nb(),l.Nb(),l.Lb(9,"dexih-help",8),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,Ue.a,p.a,h.i,r.h,v.s],pipes:[ze.a],encapsulation:2}),et),at=a("obiC"),nt=["fileInput"];function it(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section",9),l.Ob(1,"form-select",16),l.Vb("ngModelChange",(function(e){return l.vc(a),t.$implicit.action=e})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit,i=l.Zb(2);l.yb(1),l.jc("label","",i.eSharedObjectType[n.objectType]," Action"),l.jc("note","Action when importing ",i.eSharedObjectType[n.objectType],""),l.hc("ngModel",n.action)("items",i.importActions)}}function rt(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-widget",3),l.Vb("close",(function(){return l.vc(a),l.Zb().close()})),l.Ob(1,"ul",4),l.Ob(2,"li",5),l.Ob(3,"h5"),l.Fc(4,"Drop Export Files"),l.Nb(),l.Nb(),l.Ob(5,"li",6),l.Ob(6,"div",7),l.Vb("dropFiles",(function(e){return l.vc(a),l.Zb().filesDrop(e)})),l.Ob(7,"div",8),l.Ob(8,"section",9),l.Fc(9," Drop import files "),l.Nb(),l.Ob(10,"section",9),l.Ob(11,"div",10),l.Ob(12,"input",11,12),l.Vb("change",(function(e){return l.vc(a),l.Zb().uploadFile(e)})),l.Nb(),l.Ob(14,"label",13),l.Fc(15,"Choose file"),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(16,"li",14),l.Ob(17,"h5"),l.Fc(18,"Import Options"),l.Nb(),l.Nb(),l.Ob(19,"li",6),l.Ob(20,"fieldset"),l.Ob(21,"div",8),l.Dc(22,it,2,4,"section",15),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("showCloseButton",!0),l.yb(6),l.hc("requireFiles",!0),l.yb(16),l.hc("ngForOf",n.importOptions)}}function ot(e,t){if(1&e&&(l.Ob(0,"ul",25),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.yb(1),l.Hc(" Warning: ",a," ")}}function st(e,t){if(1&e&&(l.Ob(0,"div",23),l.Dc(1,ot,2,1,"ul",24),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("ngForOf",a.import.warnings)}}function ct(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",26),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(2).importSelected(e)})),l.Nb()}}function lt(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",27),l.Vb("click",(function(){return l.vc(a),l.Zb(2).importAll()})),l.Nb(),l.Ob(1,"dexih-button-close",28),l.Vb("click",(function(){return l.vc(a),l.Zb(2).reset()})),l.Nb()}}function ut(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-widget",17),l.Vb("close",(function(){return l.vc(a),l.Zb().reset()})),l.Dc(1,st,2,1,"div",18),l.Ob(2,"dexih-table",19),l.Dc(3,ct,1,0,"ng-template",20,21,l.Ec),l.Dc(5,lt,2,0,"ng-template",null,22,l.Ec),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("showCloseButton",!0),l.yb(1),l.hc("ngIf",(null==n.import||null==n.import.warnings?null:n.import.warnings.length)>0),l.yb(1),l.hc("enableMultiSelect",!0)("columns",n.columns)("dataObservable",n.tableData)}}var bt,ht=((bt=function(){function e(t,a,n){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.hubFormsService=n,this.automaticUpload=!0,this.pageTitle="Import Objects",this.showPage=!1,this.showPageMessage="Loading...",this.importActions=N.o,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",format:"Md",description:"description"},{name:"objectType",title:"Type",format:""},{name:"importAction",title:"Action",format:"Enum",enum:c.Eb}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.importOptions=N.u.map((function(e){return{action:c.Eb.Replace,objectType:e.type}})),this._hubCacheChangeSubscription=this.hubService.getHubCacheObservable().subscribe((function(t){e.hubCache=t}))}},{key:"ngOnDestroy",value:function(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"doImport",value:function(e){var t=this,a=new FormData;a.append("file",e,e.name),a.append("hubKey",this.hubCache.hub.hubKey.toString());for(var n=0;n<this.importOptions.length;n++)a.append("ImportActions[".concat(n,"].Action"),this.importOptions[n].action.toString()),a.append("ImportActions[".concat(n,"].ObjectType"),this.importOptions[n].objectType.toString());this.authService.postForm("/api/Hub/ImportPlan",a).then((function(e){t.import=e,t.refreshImport()}))}},{key:"uploadFile",value:function(e){this.doImport(e.srcElement.files[0])}},{key:"filesDrop",value:function(e){this.doImport(e[0])}},{key:"refreshImport",value:function(){var e=this,t=[];N.u.forEach((function(a){e.import[a.property].forEach((function(e){t.push({objectType:a.property,name:e.item.name,importAction:e.importAction,item:e})}))})),this._tableData.next(t)}},{key:"reset",value:function(){this._tableData.next(null)}},{key:"importSelected",value:function(e){var t=this,a=new c.P;e.forEach((function(e){a[e.objectType]||(a[e.objectType]=[]),a[e.objectType].push(e.item)})),this.hubService.importPackage(a).then((function(){t.authService.navigateUp()}))}},{key:"importAll",value:function(){var e=this;this.hubService.importPackage(this.import).then((function(){e.authService.navigateUp()}))}}]),e}()).\u0275fac=function(e){return new(e||bt)(l.Kb(b.a),l.Kb(u.a),l.Kb(D.a))},bt.\u0275cmp=l.Eb({type:bt,selectors:[["import"]],viewQuery:function(e,t){var a;1&e&&l.Bc(nt,!0),2&e&&l.rc(a=l.Wb())&&(t.fileInput=a.first)},features:[l.xb([D.a])],decls:5,vars:6,consts:[[1,"container"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],[1,"list-group"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"form-row"],[1,"form-group","col-md-6"],[1,"custom-file","w-auto","pull-right"],["type","file",1,"custom-file-input",3,"change"],["fileInput",""],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","list-group-item-info"],["class","form-group col-md-6",4,"ngFor","ngForOf"],["itemKey","key","itemName","name",3,"label","ngModel","items","note","ngModelChange"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],["class","alert alert-warning",4,"ngIf"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"alert","alert-warning"],["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],["iconClass","fa fa-upload","buttonClass","btn-primary","text","Import Selected",1,"ml-1",3,"click"],["iconClass","fa fa-cloud-upload","buttonClass","btn-primary","text","Import All",3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){if(1&e&&(l.Ob(0,"div",0),l.Dc(1,rt,23,3,"dexih-widget",1),l.ac(2,"async"),l.Dc(3,ut,7,5,"dexih-widget",2),l.ac(4,"async"),l.Nb()),2&e){var a,n,i=!(null!=(a=l.bc(2,2,t.tableData))&&a.length),r=(null==(n=l.bc(4,4,t.tableData))?null:n.length)>0;l.yb(1),l.hc("ngIf",i),l.yb(2),l.hc("ngIf",r)}},directives:[v.t,h.P,at.a,v.s,h.E,n.s,n.v,d.a,h.f,h.d],pipes:[v.b],encapsulation:2}),bt);function dt(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",8),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb()}}function ft(e,t){}function mt(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",9),l.Vb("click",(function(){return l.vc(a),l.Zb().exportAll()})),l.Nb()}}var vt,pt=((vt=function(){function e(t,a){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"label",title:"Item Type"},{name:"updateDate",title:"Last Modified",format:"Calendar"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){if(e.hubCache=t[0],e.hubCache.isLoaded()){var a=e.hubCache.getSharedObjects();e.data=a}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"exportAll",value:function(){this.export(this.data)}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddObject(e.type,e.item,a)})),this.hubService.exportHub(a,1===e.length?"".concat(e[0].label,"-").concat(e[0].type,".json"):"hub-".concat(this.hubCache.hub.name,".json"))}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||vt)(l.Kb(u.a),l.Kb(b.a))},vt.\u0275cmp=l.Eb({type:vt,selectors:[["export"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Export","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","data","tags"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["text","Export Selected",1,"mr-1",3,"click"],["text","Export All",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Dc(3,dt,1,0,"ng-template",3,4,l.Ec),l.Dc(5,ft,0,0,"ng-template",5,6,l.Ec),l.Dc(7,mt,1,0,"ng-template",null,7,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("data",t.data)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.u],encapsulation:2}),vt),gt=a("Npcx"),yt=a("mL+N");function Ct(e,t){if(1&e&&l.Lb(0,"dependent-items-button",11),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.Datajob)}}function kt(e,t){if(1&e&&l.Lb(0,"datalink-status",12),2&e){var a=t.item;l.hc("datajobKey",null==a?null:a.key)}}function wt(e,t){if(1&e&&l.Lb(0,"tags-update-button",13),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.Datajob)("objects",a)}}function St(e,t){1&e&&l.Lb(0,"actions-datajob-button",14),2&e&&l.hc("datajobs",t.items)}var Tt,Ot=((Tt=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateDatajobs()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datajob Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateDatajobs",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDatajobs.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.Datajob,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editDatajob",value:function(e){this.router.navigate(["datajob-edit",e.key],{relativeTo:this.route})}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Datajob&&t.changeClass!==c.dc.TagObjects||e.updateDatajobs()}))}}]),e}()).\u0275fac=function(e){return new(e||Tt)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},Tt.\u0275cmp=l.Eb({type:Tt,selectors:[["datajobs"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Data Jobs","iconClass","fa fa-lg fa-fw fa-calendar",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Datalinks","path","/assets/help/reference/datajob.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[3,"datajobKey"],[1,"ml-1",3,"objectType","objects"],[3,"datajobs"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.editDatajob(e)})),l.Dc(3,Ct,1,2,"ng-template",3,4,l.Ec),l.Dc(5,kt,1,1,"ng-template",5,6,l.Ec),l.Dc(7,wt,1,2,"ng-template",7,8,l.Ec),l.Dc(9,St,1,1,"ng-template",null,9,l.Ec),l.Nb(),l.Nb(),l.Lb(11,"dexih-help",10),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,gt.a,p.a,yt.a],encapsulation:2}),Tt),Nt=a("A4o/");function Dt(e,t){1&e&&l.Lb(0,"actions-datalink-button",13),2&e&&l.hc("datalinks",t.items)}var xt=function(e){return{typeFilter:e}};function Ft(e,t){if(1&e&&(l.Ob(0,"a",17),l.Fc(1),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(2);l.Cb("active",n.typeFilter==a.key),l.hc("queryParams",l.mc(5,xt,a.key))("title",a.name),l.yb(1),l.Gc(a.name)}}var Vt=function(){return{typeFilter:"All"}};function It(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",14),l.Ob(1,"a",15),l.Fc(2,"All"),l.Nb(),l.Dc(3,Ft,2,7,"a",16),l.ac(4,"gtFilter"),l.Nb()),2&e){var a=l.Zb();l.hc("autoCompact",!1)("text",a.eDatalinkType[a.typeFilter])("pullRight",!0),l.yb(1),l.Cb("active","All"==a.typeFilter),l.hc("queryParams",l.lc(11,Vt)),l.yb(2),l.hc("ngForOf",l.dc(4,7,a.eDatalinkTypeItems,"key",0))}}function Kt(e,t){if(1&e&&l.Lb(0,"tags-update-button",18),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.Datalink)("objects",a)}}function Et(e,t){if(1&e&&l.Lb(0,"datalink-status",19),2&e){var a=t.item;l.hc("datalinkKey",null==a?null:a.key)}}function Lt(e,t){if(1&e&&l.Lb(0,"dependent-items-button",20),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.Datalink)}}var _t,Pt=((_t=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.eDatalinkType=c.nb,this.eDatalinkTypeItems=c.ob,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"datalinkType",title:"Datalink Type",format:""},{name:"sourceName",title:"Source",format:""},{name:"targetName",title:"Target",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.hubCache.isLoaded()&&(e.typeFilter=+a.typeFilter,e.typeFilter||(e.typeFilter=0),e.updateDatalinks())}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateDatalinks",value:function(){var e,t=this;if(this.hubCache.isLoaded())if(this.hubCache.hub.dexihDatalinks){e=0!==this.typeFilter&&this.typeFilter?this.hubCache.hub.dexihDatalinks.filter((function(e){return e.datalinkType===t.typeFilter})):this.hubCache.hub.dexihDatalinks;var a=new Array;e.forEach((function(e){var n,i="";switch(e.sourceDatalinkTable.sourceType){case c.gc.Table:var r=t.hubCache.getTable(e.sourceDatalinkTable.sourceTableKey);i=r?r.logicalName:"Error, not found";break;case c.gc.Datalink:var o=t.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e.sourceDatalinkTable.sourceDatalinkKey}));i=o?"Datalink: "+o.name:"Error, not found";break;case c.gc.Rows:i="Static Rows"}n=e.isQuery?"None specified.":e.dexihDatalinkTargets.filter((function(e){return e.isValid})).map((function(e){var a=t.hubCache.getTable(e.tableKey);return a&&a.logicalName||"Error, not found"})).join(", "),a.push({key:e.key,datalinkType:t.eDatalinkType[e.datalinkType],name:e.name,tags:t.hubCache.getObjectTags(c.dc.Datalink,e.key),description:e.description,sourceName:i,targetName:n,updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"})})),this._tableData.next(a)}else this._tableData.next(new Array)}},{key:"editDatalink",value:function(e){this.router.navigate(["datalink-edit","edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Datalink&&t.changeClass!==c.dc.TagObjects||e.updateDatalinks()}))}}]),e}()).\u0275fac=function(e){return new(e||_t)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},_t.\u0275cmp=l.Eb({type:_t,selectors:[["datalink-index"]],decls:14,vars:7,consts:[[1,"container-fluid"],["title","Datalinks","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],["tableClass","table table-striped table-hover m-0",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/datalink.md",1,"m-3"],[3,"datalinks"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Datalinks",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkKey"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.editDatalink(e)})),l.Dc(3,Dt,1,1,"ng-template",null,3,l.Ec),l.Dc(5,It,5,12,"ng-template",4,5,l.Ec),l.Dc(7,Kt,1,2,"ng-template",6,7,l.Ec),l.Dc(9,Et,1,1,"ng-template",8,9,l.Ec),l.Dc(11,Lt,1,2,"ng-template",10,11,l.Ec),l.Nb(),l.Nb(),l.Lb(13,"dexih-help",12),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,Nt.a,h.i,r.h,v.s,p.a,gt.a,m.a],pipes:[ze.a],encapsulation:2}),_t),Mt=a("1mVc");function At(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save",6),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return!e.savingDatalink&&e.saveDatalink()})),l.Nb(),l.Ob(1,"dexih-button-cancel",7),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return!e.savingDatalink&&e.cancel()})),l.Nb()}if(2&e){var n=l.Zb();l.hc("busy",n.savingDatalink),l.yb(1),l.hc("busy",n.savingDatalink)}}function Rt(e,t){if(1&e&&(l.Ob(0,"span",11),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.yb(1),l.Hc(" ",a.name," ")}}function jt(e,t){if(1&e&&(l.Ob(0,"label",8),l.Fc(1,"Create datalinks for the following source table(s):"),l.Nb(),l.Ob(2,"div"),l.Ob(3,"div",9),l.Dc(4,Rt,2,1,"span",10),l.ac(5,"fieldSort"),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.yb(4),l.hc("ngForOf",l.cc(5,1,a.sourceTables,"name"))}}function Zt(e,t){if(1&e&&l.Lb(0,"form-input",20),2&e){var a=l.Zb(2);l.hc("autocapitalize",!0)("errors",a.formErrors.name)}}function Ht(e,t){1&e&&l.Lb(0,"form-input",21)}function Gt(e,t){if(1&e&&(l.Ob(0,"form",12),l.Ob(1,"fieldset"),l.Ob(2,"div",13),l.Ob(3,"section",14),l.Dc(4,Zt,1,2,"form-input",15),l.Dc(5,Ht,1,0,"form-input",16),l.Nb(),l.Ob(6,"section",14),l.Lb(7,"form-select",17),l.Nb(),l.Nb(),l.Ob(8,"div",13),l.Ob(9,"section",14),l.Lb(10,"form-select",18),l.Nb(),l.Ob(11,"section",14),l.Lb(12,"form-select",19),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.mainForm),l.yb(4),l.hc("ngIf",1==a.sourceTables.length),l.yb(1),l.hc("ngIf",a.sourceTables.length>1),l.yb(2),l.hc("items",a.eDatalinkTypeItems)("errors",a.formErrors.datalinkType),l.yb(3),l.hc("items",a.managedConnections)("errors",a.formErrors.targetConnectionKey)("allowNullSelect",!0),l.yb(2),l.hc("items",a.managedConnections)("errors",a.formErrors.auditConnectionKey)("allowNullSelect",!0)}}var qt=function(){return{standalone:!0}};function Bt(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section",14),l.Ob(1,"form-checkbox",26),l.Vb("ngModelChange",(function(e){return l.vc(a),t.$implicit.value=e})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit;l.yb(1),l.hc("label",n.name)("ngModel",n.value)("ngModelOptions",l.lc(3,qt))}}function Ut(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form"),l.Ob(1,"fieldset"),l.Ob(2,"section"),l.Ob(3,"div",13),l.Ob(4,"section",22),l.Lb(5,"form-checkbox",23),l.Nb(),l.Nb(),l.Ob(6,"div",13),l.Ob(7,"section",22),l.Ob(8,"label",8),l.Fc(9," Specify the audit columns (in addition to source columns) to be included in the target table. "),l.Nb(),l.Ob(10,"form-checkbox",24),l.Vb("ngModelChange",(function(){return l.vc(a),l.Zb().selectAllAuditColumns()})),l.Nb(),l.Nb(),l.Nb(),l.Ob(11,"div",13),l.Dc(12,Bt,2,4,"section",25),l.Nb(),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.yb(5),l.hc("ngModel",n.addSourceColumns),l.yb(5),l.hc("ngModel",n.allAuditColumns),l.yb(2),l.hc("ngForOf",n.auditColumnTypes)}}var zt,Wt,Qt=((zt=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.route=a,this.router=n,this.location=i,this.fb=r,this.hasChanged=!1,this.showAllErrors=!1,this.addSourceColumns=!0,this.eConnectionPurpose=c.jb,this.auditColumnTypes=[{key:c.qb.AutoIncrement,name:"Auto Incrementing Key",value:!1},{key:c.qb.IsCurrentField,name:"Is Current Flag",value:!1},{key:c.qb.Version,name:"Record Version",value:!1},{key:c.qb.ValidFromDate,name:"Valid From Date",value:!1},{key:c.qb.ValidToDate,name:"Valid To Date",value:!1},{key:c.qb.CreateDate,name:"Created Date",value:!1},{key:c.qb.UpdateDate,name:"Updated Date",value:!1},{key:c.qb.CreateAuditKey,name:"Created by AuditKey Reference",value:!1},{key:c.qb.UpdateAuditKey,name:"Updated by AuditKey Reference",value:!1}],this.allAuditColumns=!1,this.eDatalinkTypeItems=c.ob,this.savingDatalink=!1,this.formErrors={name:"",targetConnectionKey:"",auditConnectionKey:"",datalinkType:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},targetConnectionKey:{},auditConnectionKey:{},datalinkType:{required:"Datalink Type is required."}}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.managedTargetConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===c.jb.Managed||e.purpose===c.jb.Target})),e.managedConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===c.jb.Managed})),e.tableKeys=a.sourceTableKeys.split("|").map((function(e){return+e})),e.hubCache.status===N.j.Loaded){if(e.updateTables(),e.targetConnectionKey=+a.targetConnectionKey,!e.targetConnectionKey){var n=e.hubCache.hub.dexihConnections.find((function(e){return e.purpose===c.jb.Managed}));n&&(e.targetConnectionKey=n.key)}e.auditConnectionKey=e.targetConnectionKey,e.datalinkType=c.nb.General,e.buildForm(),e.watchChanges()}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink New")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"updateTables",value:function(){var e=this;this.sourceTableKeys=new Array,this.sourceTables=new Array,this.tableKeys&&this.hubCache.hub.dexihConnections&&this.hubCache.hub.dexihTables.forEach((function(t){e.tableKeys.findIndex((function(e){return e===t.key}))>=0&&(e.sourceTableKeys.push(t.key),e.sourceTables.push(t))}))}},{key:"buildForm",value:function(){var e=this;this.mainForm=this.fb.group({name:[this.name,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],datalinkType:[this.datalinkType,[n.G.required]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe((function(t){return e.onValueChanged()})),this.onValueChanged(),this.hasChanged=!1}},{key:"onValueChanged",value:function(){if(this.mainForm){var e=this.mainForm;this.hasChanged=!0;for(var t=0,a=Object.keys(this.formErrors);t<a.length;t++){var n=a[t];this.formErrors[n]="";var i=e.get(n);if(i&&(i.dirty||this.showAllErrors)&&!i.valid)for(var r=this.validationMessages[n],o=0,s=Object.keys(i.errors);o<s.length;o++){var c=s[o];this.formErrors[n]+=r[c]+" "}}}}},{key:"selectAllAuditColumns",value:function(){var e=this;this.allAuditColumns=!this.allAuditColumns,this.auditColumnTypes.forEach((function(t){return t.value=e.allAuditColumns}))}},{key:"saveDatalink",value:function(){var e=this;if(this.mainForm.valid){var t=this.mainForm.value;this.savingDatalink=!0;var a=this.auditColumnTypes.filter((function(e){return e.value})).map((function(e){return e.key}));this.hubService.createDatalinks(this.sourceTableKeys,t.name,t.datalinkType,t.targetConnectionKey,null,null,t.auditConnectionKey,this.addSourceColumns,a).then((function(t){e.savingDatalink=!1,1===t.length?e.openDatalink(t[0].key):e.router.navigate(["/hub",e.hubCache.hub.hubKey,"datalinks"],{relativeTo:e.route.root})})).catch((function(){e.savingDatalink=!1}))}else this.showAllErrors=!0,this.onValueChanged()}},{key:"cancel",value:function(){this.location.back()}},{key:"openDatalink",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a>=10&&this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinks"],{relativeTo:this.route.root}),setTimeout((function(){t.hubCache.hub.dexihDatalinks.findIndex((function(t){return t.key===e}))>=0?t.router.navigate(["/hub",t.hubCache.hub.hubKey,"datalinks","datalink-edit","edit",e],{relativeTo:t.route.root}):t.openDatalink(e,a++)}),500)}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===c.dc.Table&&e.updateTables()}))}}]),e}()).\u0275fac=function(e){return new(e||zt)(l.Kb(u.a),l.Kb(r.a),l.Kb(r.e),l.Kb(v.n),l.Kb(n.g))},zt.\u0275cmp=l.Eb({type:zt,selectors:[["dexih-datalink-new-form"]],decls:8,vars:4,consts:[[1,"container"],["title","New Datalink(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors",4,"ngIf"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment",4,"ngIf"],["formControlName","datalinkType","label","Type","itemKey","key","itemName","description",3,"items","errors"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for the target table.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],["formControlName","auditConnectionKey","label","Audit Connection","itemKey","key","itemName","name","note","Specify the connection to store execution results.","selectNullMessage","No datalink auditing",3,"items","errors","allowNullSelect"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment"],[1,"col","col-11"],["label","Include source columns in target table","name","addSourceColumns",3,"ngModel"],["label","Select All/None","name","selectAllAuditColumns",3,"ngModel","ngModelChange"],["class","form-group col-md-6",4,"ngFor","ngForOf"],[3,"label","ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return!t.savingDatalink&&t.cancel()})),l.Dc(2,At,2,2,"ng-template",null,2,l.Ec),l.Dc(4,jt,6,4,"ng-template",null,3,l.Ec),l.Dc(6,Gt,13,11,"form",4),l.Dc(7,Ut,13,3,"form",5),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(5),l.hc("ngIf",t.sourceTableKeys),l.yb(1),l.hc("ngIf",t.sourceTableKeys))},directives:[h.P,v.t,h.t,h.b,v.s,n.I,n.t,n.l,h.E,n.s,n.j,h.D,n.u,h.A,n.v],pipes:[Mt.a],encapsulation:2}),zt),$t=a("NHAS"),Xt=((Wt=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.eDataObjectType=c.lb}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params).subscribe((function(t){var a=t[0],n=t[1];e.action=a.action,e.pageTitle=a.pageTitle,e.key=+n.datalinkKey,e.previewUpdates="true"===n.previewUpdates}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Preview")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Wt)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.a))},Wt.\u0275cmp=l.Eb({type:Wt,selectors:[["datalink-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["title","Preview Datalink","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],[3,"key","previewUpdates","viewSource"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Lb(2,"preview-data",2),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("key",t.key)("previewUpdates",t.previewUpdates)("viewSource",t.eDataObjectType.Datalink))},directives:[h.P,$t.a],encapsulation:2}),Wt),Yt=a("NUI7");function Jt(e,t){if(1&e&&(l.Ob(0,"dexih-button",5),l.Fc(1),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(2);l.kc("routerLink","/hub/",null==n.hubCache?null:n.hubCache.hub.hubKey,"/connections/tables/table-new/",a.key,""),l.hc("autoCompact",!1),l.yb(1),l.Hc("New Table (",a.name,")")}}function ea(e,t){if(1&e&&(l.Ob(0,"div",2),l.Fc(1," There are no files configured. Create a file based connection, and add at least one file definition. "),l.Lb(2,"hr"),l.Ob(3,"div"),l.Lb(4,"dexih-button-new",3),l.Dc(5,Jt,2,4,"dexih-button",4),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.yb(4),l.jc("routerLink","/hub/",null==a.hubCache?null:a.hubCache.hub.hubKey,"/connections/connection-new/Source"),l.hc("autoCompact",!1),l.yb(1),l.hc("ngForOf",a.fileConnections)}}function ta(e,t){if(1&e&&(l.Ob(0,"a",13),l.Fc(1),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(3);l.kc("routerLink","/hub/",null==n.hubCache?null:n.hubCache.hub.hubKey,"/connections/tables/table-new/",a.key,""),l.yb(1),l.Gc(a.name)}}var aa=function(e,t){return{tableKey:e,path:t}};function na(e,t){if(1&e&&(l.Ob(0,"a",16),l.Lb(1,"i",17),l.Fc(2),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(4);l.Cb("active","item.name"==n.path),l.hc("queryParams",l.nc(4,aa,n.tableKey,a.key)),l.yb(2),l.Gc(a.name)}}function ia(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",14),l.Dc(1,na,3,7,"a",15),l.Nb()),2&e){var a=l.Zb(3);l.hc("text",a.eFlatFilePath[a.path])("pullRight",!0),l.yb(1),l.hc("ngForOf",a.eFlatFilePathItems)}}function ra(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",10),l.Dc(1,ta,2,3,"a",11),l.Nb(),l.Dc(2,ia,2,3,"dexih-button-dropdown",12)),2&e){var a=l.Zb(2);l.yb(1),l.hc("ngForOf",a.fileConnections),l.yb(1),l.hc("ngIf",(null==a.connectionReference?null:a.connectionReference.allowFlatFiles)&&(null==a.table?null:a.table.autoManageFiles))}}var oa=function(){return{standalone:!0}};function sa(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section"),l.Ob(1,"form-select",35),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb(3).updateStrategy=e})),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(3);l.yb(1),l.hc("ngModel",n.updateStrategy)("ngModelOptions",l.lc(3,oa))("items",n.updateStrategies)}}function ca(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",36),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(3).uploadSelected(e)})),l.Fc(1,"Upload"),l.Nb(),l.Ob(2,"dexih-button-cancel",37),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(3).cancelSelected(e)})),l.Nb(),l.Ob(3,"dexih-button-delete",38),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(3).removeSelected(e)})),l.Nb()}}function la(e,t){if(1&e){var a=l.Pb();l.Ob(0,"section"),l.Ob(1,"form-checkbox",39),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb(3).automaticUpload=e})),l.Nb(),l.Nb()}if(2&e){var n=l.Zb(3);l.yb(1),l.hc("ngModel",n.automaticUpload)}}var ua=function(e){return{width:e}};function ba(e,t){if(1&e&&(l.Ob(0,"div",42),l.Lb(1,"div",43),l.Nb()),2&e){var a=l.Zb().item;l.yb(1),l.hc("ngStyle",l.mc(1,ua,a.progress+"%"))}}var ha=function(e,t,a){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":a}};function da(e,t){if(1&e&&(l.Dc(0,ba,2,3,"div",40),l.Ob(1,"span"),l.Lb(2,"i",41),l.Fc(3),l.Nb()),2&e){var a=t.item,n=l.Zb(3);l.hc("ngIf",a.isRunning()),l.yb(2),l.hc("ngClass",l.oc(3,ha,a.status===n.eFileStatus.Complete,a.status===n.eFileStatus.Error,a.status===n.eFileStatus.Cancelled)),l.yb(1),l.Gc(a.status)}}function fa(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",50),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items,t=l.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Incoming)})),l.Fc(1,"To Incoming"),l.Nb()}}function ma(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",50),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items,t=l.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Outgoing)})),l.Fc(1,"To Processed"),l.Nb()}}function va(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",50),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items,t=l.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Processed)})),l.Fc(1,"To Processed"),l.Nb()}}function pa(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",50),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items,t=l.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Rejected)})),l.Fc(1,"To Rejected"),l.Nb()}}function ga(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",37),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(4).deleteSelected(e)})),l.Nb(),l.Ob(1,"dexih-button-download",37),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb(4).downloadSelected(e)})),l.Nb(),l.Ob(2,"dexih-button-dropdown",48),l.Dc(3,fa,2,0,"a",49),l.Dc(4,ma,2,0,"a",49),l.Dc(5,va,2,0,"a",49),l.Dc(6,pa,2,0,"a",49),l.Nb()}if(2&e){var n=l.Zb(4);l.yb(2),l.hc("pullRight",!0),l.yb(1),l.hc("ngIf",n.path!=n.eFlatFilePath.Incoming),l.yb(1),l.hc("ngIf",n.path!=n.eFlatFilePath.Outgoing),l.yb(1),l.hc("ngIf",n.path!=n.eFlatFilePath.Processed),l.yb(1),l.hc("ngIf",n.path!=n.eFlatFilePath.Rejected)}}var ya=function(e,t,a,n){return["/hub",e,"summary","files","manage",t,"file-preview",a,n]};function Ca(e,t){if(1&e&&l.Lb(0,"dexih-button-preview",51),2&e){var a=t.item,n=l.Zb(4);l.hc("routerLink",l.pc(1,ya,null==n.hubCache?null:n.hubCache.hub.hubKey,n.tableKey,n.path,a.fileName))}}function ka(e,t){if(1&e&&(l.Ob(0,"a",16),l.Lb(1,"i",17),l.Fc(2),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(6);l.Cb("active","item.name"==n.path),l.hc("queryParams",l.nc(4,aa,n.tableKey,a.key)),l.yb(2),l.Gc(a.name)}}function wa(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",54),l.Dc(1,ka,3,7,"a",15),l.Nb()),2&e){var a=l.Zb(5);l.hc("text",a.eFlatFilePath[a.path])("pullRight",!0),l.yb(1),l.hc("ngForOf",a.eFlatFilePathItems)}}function Sa(e,t){if(1&e){var a=l.Pb();l.Dc(0,wa,2,3,"dexih-button-dropdown",52),l.Ob(1,"dexih-button-refresh",53),l.Vb("click",(function(){return l.vc(a),l.Zb(4).refreshFiles()})),l.Nb()}if(2&e){var n=l.Zb(4);l.hc("ngIf",null==n.table?null:n.table.autoManageFiles)}}function Ta(e,t){if(1&e&&(l.Ob(0,"li",22),l.Ob(1,"h5"),l.Fc(2,"Files (Local directory: "),l.Ob(3,"a",44),l.Fc(4),l.Nb(),l.Fc(5,")"),l.Nb(),l.Nb(),l.Ob(6,"li",27),l.Ob(7,"dexih-table",45),l.Dc(8,ga,7,5,"ng-template",29,30,l.Ec),l.Dc(10,Ca,1,6,"ng-template",46,47,l.Ec),l.Dc(12,Sa,2,1,"ng-template",null,31,l.Ec),l.Nb(),l.Nb()),2&e){var a=l.Zb(3);l.yb(3),l.jc("href","file://///",a.localPath,"",l.xc),l.yb(1),l.Gc(a.localPath),l.yb(3),l.hc("enableMultiSelect",!0)("columns",a.columns)("dataObservable",a.tableData)}}function Oa(e,t){if(1&e){var a=l.Pb();l.Ob(0,"ul",18),l.Ob(1,"li",19),l.Ob(2,"section"),l.Ob(3,"form-select",20),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb(2).tableKey=e}))("ngModelChange",(function(e){return l.vc(a),l.Zb(2).updateTable(e)})),l.Nb(),l.Nb(),l.Dc(4,sa,2,4,"section",21),l.Nb(),l.Ob(5,"li",22),l.Ob(6,"h5"),l.Fc(7,"Drop Files to Upload"),l.Nb(),l.Nb(),l.Ob(8,"li",19),l.Ob(9,"div",23),l.Vb("dropFiles",(function(e){return l.vc(a),l.Zb(2).filesDrop(e)})),l.Fc(10," Drop Files to Upload Here "),l.Ob(11,"div",24),l.Ob(12,"input",25),l.Vb("change",(function(e){return l.vc(a),l.Zb(2).uploadFile(e)})),l.Nb(),l.Ob(13,"label",26),l.Fc(14,"Choose files"),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(15,"li",22),l.Ob(16,"h5"),l.Fc(17,"Upload Queue"),l.Nb(),l.Nb(),l.Ob(18,"li",27),l.Ob(19,"dexih-table",28),l.Dc(20,ca,4,0,"ng-template",29,30,l.Ec),l.Dc(22,la,2,1,"ng-template",null,31,l.Ec),l.Dc(24,da,4,7,"ng-template",32,33,l.Ec),l.Nb(),l.Nb(),l.Dc(26,Ta,14,5,"ng-template",34),l.Nb()}if(2&e){var n=l.Zb(2);l.yb(3),l.hc("ngModel",n.tableKey)("ngModelOptions",l.lc(9,oa))("items",n.connectionTables),l.yb(1),l.hc("ngIf",!(null!=n.connectionReference&&n.connectionReference.allowFlatFiles)),l.yb(5),l.hc("requireFiles",!0),l.yb(10),l.hc("enableMultiSelect",!0)("columns",n.uploadColumns)("data",n.uploadedFiles),l.yb(7),l.hc("ngIf",null==n.connectionReference?null:n.connectionReference.allowFlatFiles)}}function Na(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",6),l.Ob(1,"dexih-widget",7),l.Vb("close",(function(){return l.vc(a),l.Zb().close()})),l.Dc(2,ra,3,2,"ng-template",null,8,l.Ec),l.Dc(4,Oa,27,10,"ul",9),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.yb(1),l.hc("title","Manage Files: "+(null==n.table?null:n.table.name))("showCloseButton",!0),l.yb(3),l.hc("ngIf",n.table)}}var Da,xa=((Da=function(){function e(t,a,n,i){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.route=n,this.router=i,this.entityType="Table",this.canEdit=!1,this.updateStrategy=c.qc.Reload,this.updateStrategies=N.y,this.path=c.zb.None,this.eFlatFilePath=c.zb,this.eFlatFilePathItems=c.Ab.filter((function(e){return e.key>0})),this.eFileStatus=F.h,this.automaticUpload=!0,this.uploadedFiles=[],this.cancelToken=new F.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"fileName",title:"File Name",format:""},{name:"length",title:"Size",format:""},{name:"lastModified",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable(),this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){var a=t[1];e.hubCache=t[2],e.remoteLibraries=t[3],e.fileConnections=e.hubCache.hub.dexihConnections.filter((function(t){var a=e.remoteLibraries.connections.find((function(e){return t.connectionAssemblyName===e.connectionAssemblyName&&t.connectionClassName===e.connectionClassName}));return!!a&&(a.connectionCategory===c.ib.File||t.purpose!==c.jb.Source)}));var n=e.hubCache.getConnectionTables();e.connectionTables=n.filter((function(t){if(t.dexihTables.length>0)return null!=e.fileConnections.find((function(e){return t.key===e.key}))}));var i=!1;if(e.tableKey=+a.tableKey,e.tableKey||e.connectionTables.length>0&&e.connectionTables[0].dexihTables.length>0&&(e.tableKey=e.connectionTables[0].dexihTables[0].key,i=!0),e.path=+a.path,e.path||(e.path=c.zb.Incoming,i=!0),i)e.router.navigate([],{relativeTo:e.route,queryParams:{tableKey:e.tableKey,path:e.path},queryParamsHandling:"merge"});else{e.table=e.hubCache.getTable(e.tableKey);var r=e.hubCache.getConnection(e.table.connectionKey);e.connectionReference=e.remoteLibraries.connections.find((function(e){return r.connectionAssemblyName===e.connectionAssemblyName&&r.connectionClassName===e.connectionClassName})),!e.table&&e.tableKey?e.hubService.addHubErrorMessage("The table with the key ".concat(e.tableKey," could not be found.")):e.table&&(e.pageTitle="Manage files for "+e.table.name,e.showPage=!0,e.refreshFiles())}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Files Manage")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"updateTable",value:function(e){this.router.navigate([],{relativeTo:this.route,queryParams:{tableKey:e,path:"incoming"},queryParamsHandling:"merge"})}},{key:"refreshFiles",value:function(){var e=this;this.connectionReference.allowsFlatFiles&&this.hubService.getFileList(this.table,this.path,this.cancelToken).then((function(t){e._tableData.next(t)})).catch((function(t){e._tableData.next([])}))}},{key:"uploadSelected",value:function(e){var t=this;e.forEach((function(e){t.authService.upload(e).then((function(a){a.success?(t.hubService.addHubSuccessMessage("File ".concat(e.file.name," uploaded successfully.")),t.refreshFiles()):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"removeSelected",value:function(e){var t=this;e.forEach((function(e){var a=t.uploadedFiles.findIndex((function(t){return t.id===e.id}));a>=0&&t.uploadedFiles.splice(a,1)}))}},{key:"cancelSelected",value:function(e){e.forEach((function(e){return e.cancel()}))}},{key:"deleteSelected",value:function(e){var t=this,a=e.map((function(e){return e.fileName}));this.hubService.deleteFiles(this.table,this.path,a,this.cancelToken).then((function(e){e&&t.refreshFiles()})).catch()}},{key:"moveSelected",value:function(e,t){var a=this,n=e.map((function(e){return e.fileName}));this.hubService.moveFiles(this.table,this.path,t,n,this.cancelToken).then((function(e){e&&a.refreshFiles()})).catch((function(e){a.hubService.addHubMessage(status)}))}},{key:"downloadSelected",value:function(e){var t=this,a=e.map((function(e){return e.fileName}));this.hubService.downloadFiles(this.table,this.path,a,this.cancelToken).then((function(e){e&&t.refreshFiles()})).catch()}},{key:"preview",value:function(e){this.router.navigate(["hub",this.hubCache.hub.hubKey,"summary","files","manage",this.tableKey,this.path,e.fileName])}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"uploadFile",value:function(e){return this.doUpload(e.srcElement.files),!1}},{key:"doUpload",value:function(e){var t=this;Array.prototype.forEach.call(e,(function(e){t.hubService.uploadFile(t.table,t.path,t.updateStrategy,e.name,t.cancelToken).then((function(a){var n=new F.d(e,a);t.automaticUpload&&t.authService.upload(n).then((function(a){a.success?(t.hubService.addHubSuccessMessage("File ".concat(e.name," uploaded successfully.")),t.refreshFiles()):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)})),t.uploadedFiles.push(n),t.uploadedFiles=_toConsumableArray(t.uploadedFiles)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"filesDrop",value:function(e){this.doUpload(e)}}]),e}()).\u0275fac=function(e){return new(e||Da)(l.Kb(b.a),l.Kb(u.a),l.Kb(r.a),l.Kb(r.e))},Da.\u0275cmp=l.Eb({type:Da,selectors:[["files-manage"]],decls:2,vars:2,consts:[["class","alert alert-danger m-3",4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],["text","New Connection",3,"routerLink","autoCompact"],[3,"routerLink","autoCompact","title",4,"ngFor","ngForOf"],[3,"routerLink","autoCompact","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","close"],["header",""],["class","list-group",4,"ngIf"],["iconClass","fa fa-file-o","text","New File",1,"mr-1"],["class","dropdown-item",3,"routerLink","title",4,"ngFor","ngForOf"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[1,"dropdown-item",3,"routerLink","title"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight"],["class","dropdown-item","routerLinkActive","active","data-toggle","tab","routerLink",".",3,"active","queryParams",4,"ngFor","ngForOf"],["routerLinkActive","active","data-toggle","tab","routerLink",".",1,"dropdown-item",3,"queryParams"],[1,"fa","fa-elipsis-h"],[1,"list-group"],[1,"list-group-item"],["label","Flat File","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the flat file to manage",3,"ngModel","ngModelOptions","items","ngModelChange"],[4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","p-0"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],[3,"ngIf"],["label","Update Strategy","itemKey","key","itemName","description","iconClass","fa fa-database","note","Specify how records should be inserted/updated in the target table.",3,"ngModel","ngModelOptions","items","ngModelChange"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],[3,"href"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemAction"],["selectedItemAction",""],["iconClass","fa fa-mail-forward","text","Move",1,"mr-1",3,"pullRight"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[3,"routerLink"],["class","mr-1","buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[3,"click"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(l.Dc(0,ea,6,3,"div",0),l.Dc(1,Na,5,3,"div",1)),2&e&&(l.hc("ngIf",!t.connectionTables||0===t.connectionTables.length),l.yb(1),l.hc("ngIf",t.connectionTables&&t.connectionTables.length>0))},directives:[v.t,h.o,r.f,v.s,h.f,h.P,h.i,r.h,r.g,h.E,n.s,n.v,at.a,d.a,h.b,h.g,h.A,v.q,v.w,h.h,h.q,h.s],encapsulation:2}),Da);a("/fhR");var Fa=function(e){return["hubVariable-edit",e]};function Va(e,t){1&e&&l.Lb(0,"dexih-button-edit",9),2&e&&l.hc("routerLink",l.mc(1,Fa,t.item.key))}function Ia(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",10),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().deleteHubVariables(e)})),l.Nb()}}function Ka(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",10),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb(),l.Dc(1,Ia,1,0,"dexih-button-delete",11),l.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=l.Zb();l.yb(1),l.hc("ngIf",i.hubCache.canWrite),l.yb(1),l.hc("objectType",i.eSharedObjectType.HubVariable)("objects",n)}}var Ea=function(){return["hubVariable-new"]};function La(e,t){1&e&&l.Lb(0,"dexih-button-new",14),2&e&&l.hc("routerLink",l.lc(1,Ea))}function _a(e,t){if(1&e&&l.Dc(0,La,1,2,"dexih-button-new",13),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite)}}var Pa,Ma=((Pa=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"value",title:"Value",format:""},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateVariables()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Hub Variables Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteHubVariables",value:function(e){this.hubService.deleteHubVariables(e)}},{key:"updateVariables",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihHubVariables.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,value:t.isEncrypted?"(Encrypted)":t.value,isEncrypted:t.isEncrypted,tags:e.hubCache.getObjectTags(c.dc.HubVariable,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["hubVariable-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache.hub.dexihHubVariables.filter((function(t){return e.findIndex((function(e){return e.key===t.key}))>=0})),a=this.hubService.createHub(this.hubCache.hub.hubKey,"");a.dexihHubVariables=t,this.hubService.exportHub(a,"hub_variables.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.HubVariable&&t.changeClass!==c.dc.TagObjects||e.updateVariables()}))}}]),e}()).\u0275fac=function(e){return new(e||Pa)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},Pa.\u0275cmp=l.Eb({type:Pa,selectors:[["hubVariable"]],decls:10,vars:7,consts:[[1,"container-fluid"],["title","Hub Variables","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,Va,1,3,"ng-template",3,4,l.Ec),l.Dc(5,Ka,3,3,"ng-template",5,6,l.Ec),l.Dc(7,_a,1,1,"ng-template",null,7,l.Ec),l.Nb(),l.Nb(),l.Lb(9,"dexih-help",8),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,h.j,r.f,h.u,v.t,p.a,h.g,h.o],encapsulation:2}),Pa);function Aa(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save",7),l.Vb("click",(function(){return l.vc(a),l.Zb(2).save()})),l.Nb()}}function Ra(e,t){if(1&e&&(l.Dc(0,Aa,1,0,"dexih-button-save",5),l.Lb(1,"cancel-button",6)),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite),l.yb(1),l.hc("formsService",a.formsService)}}function ja(e,t){if(1&e&&(l.Ob(0,"form",8),l.Lb(1,"input",9),l.Lb(2,"input",10),l.Ob(3,"fieldset"),l.Ob(4,"div",11),l.Ob(5,"section",12),l.Lb(6,"form-input",13),l.Nb(),l.Ob(7,"section",12),l.Lb(8,"form-input",14),l.Nb(),l.Nb(),l.Ob(9,"section"),l.Lb(10,"form-checkbox",15),l.Nb(),l.Ob(11,"section"),l.Lb(12,"form-checkbox",16),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.formsService.currentForm),l.yb(6),l.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),l.yb(2),l.hc("label",a.formsService.currentForm.controls.isEnvironmentVariable.value?"Environment Variable Name":"Hub Variable Value")("type",a.formsService.currentForm.controls.isEncrypted.value?"password":"text")("errors",a.formsService.formErrors.value)}}var Za,Ha=((Za=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.pageTitle=a.pageTitle,e.action=a.action,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Edit Variables")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._isEncryptedSubscription&&this._isEncryptedSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.hubVariableKey=+this.params.hubVariableKey,this.hubVariableKey)if(this.hubCache.hub&&this.hubCache.hub.dexihHubVariables){var t=this.hubCache.hub.dexihHubVariables.find((function(t){return t.key===e.hubVariableKey}));this.formsService.hubVariable(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no variable specified to edit.");if("new"===this.action){var a=new c.C;a.value="",a.name="",this.formsService.hubVariable(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/hubVariable-new","/hubVariable-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this._isEncryptedSubscription=this.formsService.currentForm.controls.isEncrypted.valueChanges.subscribe((function(t){t||e.formsService.currentForm.controls.valueRaw.setValue("")}))}},{key:"save",value:function(){return e=this,a=regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.formsService.currentForm).controls.isEncrypted.value){e.next=10;break}if(!(a=t.controls.valueRaw.value)){e.next=8;break}return e.next=6,this.hubService.encrypt(a,this.cancelToken);case 6:n=e.sent,t.controls.value.setValue(n),t.controls.valueRaw.setValue(null);case 8:e.next=11;break;case 10:t.controls.value.setValue(t.controls.valueRaw.value);case 11:return e.next=13,this.formsService.save();case 13:case"end":return e.stop()}}),e,this)})),new((t=void 0)||(t=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(t){i(t)}}function o(e){try{s(a.throw(e))}catch(t){i(t)}}function s(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,o)}s((a=a.apply(e,[])).next())}));var e,t,a}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Za)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e))},Za.\u0275cmp=l.Eb({type:Za,selectors:[["dexih-hubVariable-edit-form"]],features:[l.xb([D.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Variable","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["class","mr-1",3,"click",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"click"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Hub Variable Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["formControlName","valueRaw","placeholder","Enter the value.","iconClass","fa fa-list","autocomplete","off",3,"label","type","errors"],["label","Encrypt value","formControlName","isEncrypted"],["label","Use an environment variable on the remote agent","formControlName","isEnvironmentVariable"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,Ra,2,2,"ng-template",null,2,l.Ec),l.Dc(4,ja,13,6,"form",3),l.Nb(),l.Lb(5,"dexih-help",4),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(3),l.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,$.a,V.a,h.t,n.I,n.t,n.l,h.D,n.s,n.j,h.A],encapsulation:2}),Za),Ga=a("24Dg"),qa=["DexihMessage"];function Ba(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save",12),l.Vb("click",(function(){return l.vc(a),l.Zb().addUsers()})),l.Nb()}if(2&e){var n=l.Zb();l.hc("disabled",0==n.emails.length)}}function Ua(e,t){if(1&e){var a=l.Pb();l.Ob(0,"a",17),l.Vb("click",(function(){l.vc(a);var e=t.$implicit,n=l.Zb().items;return l.Zb().setPermission(e.key,n)})),l.Fc(1),l.Nb()}if(2&e){var n=t.$implicit;l.yb(1),l.Gc(n.name)}}function za(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",13),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().deleteUsers(e)})),l.Nb(),l.Ob(1,"dexih-button-dropdown",14),l.Dc(2,Ua,2,1,"a",15),l.Nb(),l.Ob(3,"dexih-button-dropdown",16),l.Ob(4,"a",17),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().setUserAlert(!0,e)})),l.Fc(5,"Receive alert emails"),l.Nb(),l.Ob(6,"a",17),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().setUserAlert(!1,e)})),l.Fc(7,"Do not receive alert emails."),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.yb(2),l.hc("ngForOf",n.ePermissionItems)}}var Wa,Qa=((Wa=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.columns=[{name:"userName",title:"User Name",format:""},{name:"firstName",title:"First Name",format:""},{name:"lastName",title:"Last Name",format:""},{name:"permission",title:"Permission",enum:c.Wb,format:"Enum"},{name:"receiveAlerts",title:"Receives Alert Emails",format:"Boolean"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable(),this.ePermission=c.Wb,this.ePermissionItems=c.Xb,this.permission=c.Wb.PublishReader,this.emails=[],this.sendInvites=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.refreshUsers()}},{key:"ngOnDestroy",value:function(){}},{key:"refreshUsers",value:function(){var e=this;this.hubService.getHubUsers().then((function(t){e._tableData.next(t)}))}},{key:"setPermission",value:function(e,t){var a=this,n=t.map((function(e){return e.userName}));this.authService.confirmDialog("Confirm Permission Change","This action will change the selected user(s) hub permission to ".concat(c.Wb[this.permission],".  Proceed?")).then((function(t){t&&a.hubService.setUserPermissions(n,e,!1).then((function(e){a.dexihMessage.addSuccessMessage("The specified user(s) permission have been updated."),a.refreshUsers()}))}))}},{key:"setUserAlert",value:function(e,t){var a=this,n=t.map((function(e){return e.id}));this.hubService.setUserAlerts(n,e,!1).then((function(e){a.dexihMessage.addSuccessMessage("The specified user(s) alert email status have been updated."),a.refreshUsers()}))}},{key:"deleteUsers",value:function(e){var t=this,a=e.map((function(e){return e.userName}));this.authService.confirmDialog("Confirm Delete Users","This action will delete the selected user(s) from using this hub.  Proceed?").then((function(e){e&&t.hubService.removeUsers(a).then((function(e){t.dexihMessage.addSuccessMessage("The specified users have been removed from the hub."),t.refreshUsers()}))}))}},{key:"addUsers",value:function(){var e=this;this.emails.length>0&&this.permission&&this.authService.confirmDialog("Add Users","This action will added users with the specified emails to this hub with permission ".concat(c.Wb[this.permission],".  Proceed?")).then((function(t){t&&e.hubService.setUserPermissions(e.emails,e.permission,e.sendInvites).then((function(t){e.emails=[],e.dexihMessage.addSuccessMessage("The specified users have been added to the hub."),e.refreshUsers()}))}))}}]),e}()).\u0275fac=function(e){return new(e||Wa)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},Wa.\u0275cmp=l.Eb({type:Wa,selectors:[["users"]],viewQuery:function(e,t){var a;1&e&&l.Bc(qa,!0),2&e&&l.rc(a=l.Wb())&&(t.dexihMessage=a.first)},decls:19,vars:9,consts:[[1,"p-3"],["DexihMessage",""],[1,"container-fluid"],["title","Invite Users","iconClass","fa fa-lg fa-fw fa-birthday-cake",3,"padding"],["subHeader",""],["label","Permission","name","permission","itemKey","key","itemName","name","note","Permission level to grant to emails",3,"ngModel","items","enableFilter","ngModelChange"],["label","Email Addresses / User names","name","emails","note","Provide a list of user names or email addresses of users to join the hub.",3,"ngModel","ngModelChange"],["label","Send invites","name","sendInvites","note","Emails which are not registered to use the integration hub will be sent an invite to join.",3,"ngModel","ngModelChange"],["title","Current Users","iconClass","fa fa-lg fa-fw fa-group"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["text","Add User(s)",3,"disabled","click"],[1,"mr-1",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-lock","text","Set Permission"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["buttonClass","btn-primary","iconClass","fa fa-bell","text","Set User Alert",1,"ml-1"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(l.Lb(0,"dexih-message",0,1),l.Ob(2,"div",2),l.Ob(3,"dexih-widget-vertical"),l.Ob(4,"dexih-widget",3),l.Dc(5,Ba,1,1,"ng-template",null,4,l.Ec),l.Ob(7,"form"),l.Ob(8,"fieldset"),l.Ob(9,"section"),l.Ob(10,"form-select",5),l.Vb("ngModelChange",(function(e){return t.permission=e})),l.Nb(),l.Nb(),l.Ob(11,"section"),l.Ob(12,"form-tags",6),l.Vb("ngModelChange",(function(e){return t.emails=e})),l.Nb(),l.Nb(),l.Ob(13,"section"),l.Ob(14,"form-checkbox",7),l.Vb("ngModelChange",(function(e){return t.sendInvites=e})),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(15,"dexih-widget",8),l.Ob(16,"dexih-table",9),l.Dc(17,za,8,1,"ng-template",10,11,l.Ec),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(4),l.hc("padding",!0),l.yb(6),l.hc("ngModel",t.permission)("items",t.ePermissionItems)("enableFilter",!1),l.yb(2),l.hc("ngModel",t.emails),l.yb(2),l.hc("ngModel",t.sendInvites),l.yb(2),l.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[Ga.a,h.S,h.P,n.I,n.t,n.u,h.E,n.s,n.v,h.F,h.A,d.a,h.t,h.g,h.i,v.s],encapsulation:2}),Wa),$a=function(){return{statusFilter:"All"}},Xa=function(){return{statusFilter:"Ready"}},Ya=function(){return{statusFilter:"Offline"}},Ja=function(){return{statusFilter:"Unauthorized"}};function en(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",9),l.Ob(1,"a",10),l.Fc(2,"All"),l.Nb(),l.Ob(3,"a",11),l.Fc(4,"Ready"),l.Nb(),l.Ob(5,"a",12),l.Fc(6,"Offline"),l.Nb(),l.Ob(7,"a",13),l.Fc(8,"Unauthorized"),l.Nb(),l.Nb(),l.Fc(9,"\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")),2&e){var a=l.Zb();l.hc("text",a.statusFilter)("pullRight",!0),l.yb(1),l.Cb("active","All"==a.statusFilter),l.hc("queryParams",l.lc(14,$a)),l.yb(2),l.Cb("active","Ready"==a.statusFilter),l.hc("queryParams",l.lc(15,Xa)),l.yb(2),l.Cb("active","Offline"==a.statusFilter),l.hc("queryParams",l.lc(16,Ya)),l.yb(2),l.Cb("active","Unauthorized"==a.statusFilter),l.hc("queryParams",l.lc(17,Ja))}}function tn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",14),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().deleteSelected(e)})),l.Nb(),l.Ob(1,"dexih-button",15),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().authorize(e)})),l.Fc(2,"Authorize"),l.Nb(),l.Ob(3,"dexih-button",16),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().deAuthorize(e)})),l.Fc(4,"De-Authorize"),l.Nb()}}var an=function(e,t){return["agent-edit",e,t]};function nn(e,t){if(1&e&&l.Lb(0,"dexih-button-edit",17),2&e){var a=t.item;l.hc("routerLink",l.nc(1,an,a.remoteAgentKey,a.remoteAgentHubKey))}}var rn=function(){return["/hubs/index/agents/download"]};function on(e,t){1&e&&l.Lb(0,"dexih-button-download",18),2&e&&l.hc("routerLink",l.lc(1,rn))}var sn,cn=((sn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.columns=[{name:"name",title:"Name",format:""},{name:"connected",title:"Connected",format:"Boolean"},{name:"isAuthorized",title:"Authorized?",format:"Boolean"},{name:"user",title:"User",format:""},{name:"dataPrivacyStatus",title:"Data Privacy",format:"Enum",enum:c.mb},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"ipAddress",title:"Current IP Address",format:""},{name:"remoteAgentId",title:"Id",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"},{name:"lastLoginDateTime",title:"Last Login",format:"Calendar"},{name:"lastLoginIpAddress",title:"Last IP Address",format:""}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.queryParams,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.hubCache=t[1],e.remoteAgents=t[2],e.hubCache.isLoaded()&&(e.statusFilter=a.statusFilter,e.statusFilter||(e.statusFilter="All"),e.updateRemoteAgents())}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Remote Agent index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateRemoteAgents",value:function(){var e=this;if(this.hubCache&&this.hubCache.hub){var t=this.hubCache.hub.dexihRemoteAgentHubs.map((function(t){var a=e.remoteAgents?e.remoteAgents.find((function(e){return e.remoteAgentKey===t.remoteAgentKey})):null,n=a&&a.activeAgents&&a.activeAgents.length>0?a.activeAgents[0]:null;return{remoteAgentHubKey:t.remoteAgentHubKey,connected:null!==n,isAuthorized:t.isAuthorized,name:n?n.name:a?a.name:"Unknown",user:n?n.user:"",dataPrivacyStatus:n?n.dataPrivacyStatus:"",isEncrypted:n?n.isEncrypted:"",ipAddress:n?n.ipAddress:"",remoteAgentKey:t.remoteAgentKey,updateDate:t.updateDate,lastLoginDateTime:a?a.lastLoginDateTime:"",lastLoginIpAddress:a?a.lastLoginIpAddress:"",remoteAgentId:a?a.remoteAgentId:""}}));this.remoteAgents&&this.remoteAgents.forEach((function(e){var a=e.activeAgents&&e.activeAgents.length>0?e.activeAgents[0]:null;a&&t.findIndex((function(t){return t.remoteAgentKey===e.remoteAgentKey}))<0&&t.push({remoteAgentHubKey:0,connected:!0,isAuthorized:!1,name:a.name,user:a.user,dataPrivacyStatus:a.dataPrivacyStatus,isEncrypted:a.isEncrypted,ipAddress:a.ipAddress,remoteAgentKey:e.remoteAgentKey,remoteAgentId:e.remoteAgentId,updateDate:""})})),this._tableData.next(t)}}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===c.dc.RemoteAgent&&e.updateRemoteAgents()}))}},{key:"authorize",value:function(e){var t,a,n,i,r,o,s;return r=this,s=regeneratorRuntime.mark((function r(){var o,s=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,o=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a.value).isAuthorized){e.next=5;break}return t.remoteAgentHubKey?(n=s.hubCache.hub.dexihRemoteAgentHubs.find((function(e){return e.remoteAgentHubKey===t.remoteAgentHubKey}))).isAuthorized=!0:((n={hubKey:s.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:t.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null}).allowExternalConnect=!0,n.isSelected=!1),e.next=5,s.hubService.saveRemoteAgent(n);case 5:case"end":return e.stop()}}),e)})),t=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(e);case 3:return r.next=5,t.next();case 5:if((a=r.sent).done){r.next=9;break}return r.delegateYield(o(),"t0",7);case 7:r.next=3;break;case 9:r.next=14;break;case 11:r.prev=11,r.t1=r.catch(0),n={error:r.t1};case 14:if(r.prev=14,r.prev=15,r.t2=a&&!a.done&&(i=t.return),!r.t2){r.next=20;break}return r.next=20,i.call(t);case 20:if(r.prev=20,!n){r.next=23;break}throw n.error;case 23:return r.finish(20);case 24:return r.finish(14);case 25:case"end":return r.stop()}}),r,null,[[0,11,14,25],[15,,20,24]])})),new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{i(s.next(e))}catch(a){t(a)}}function n(e){try{i(s.throw(e))}catch(a){t(a)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(a,n)}i((s=s.apply(r,[])).next())}))}},{key:"deAuthorize",value:function(e){var t=this;e.forEach((function(e){if(e.isAuthorized&&e.remoteAgentHubKey){var a=t.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey}));a&&(a.isAuthorized=!1,t.hubService.saveRemoteAgent(a))}}))}},{key:"deleteSelected",value:function(e){var t=this;e.forEach((function(e){if(e.remoteAgentHubKey){var a=t.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey}));a&&(a.isAuthorized=!1,t.hubService.deleteRemoteAgent(a))}}))}},{key:"edit",value:function(e){this.router.navigate(["agent-edit",e.remoteAgentKey,e.remoteAgentHubKey],{relativeTo:this.route})}}]),e}()).\u0275fac=function(e){return new(e||sn)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},sn.\u0275cmp=l.Eb({type:sn,selectors:[["remoteagents"]],inputs:{hubKey:"hubKey"},decls:11,vars:6,consts:[[1,"container-fluid"],["title","Hub Remote Agents","iconClass","fa fa-lg fa-fw fa-wifi",3,"showCloseButton","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["buttonClass","btn btn-sm btn-outline-secondary","iconClass","fa fa-filter","title","Filter by a status",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Ready",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Offline Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Unauthorized Items",1,"dropdown-item",3,"queryParams"],["title","Delete selected remote agents",1,"mr-1",3,"click"],["iconClass","fa fa-check","buttonClass","btn-primary","title","Authorize the selected agents for this hub",1,"mr-1",3,"click"],["iconClass","fa fa-times","buttonClass","btn-danger","title","De-Authorize the selected agents",1,"mr-1",3,"click"],[1,"mr-1",3,"routerLink"],["iconClass","fa fa-download","text","Download Agent",1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,en,10,18,"ng-template",null,2,l.Ec),l.Ob(4,"dexih-table",3),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(5,tn,5,0,"ng-template",4,5,l.Ec),l.Dc(7,nn,1,4,"ng-template",6,7,l.Ec),l.Dc(9,on,1,2,"ng-template",null,8,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(3),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,h.i,r.h,h.g,h.f,h.j,r.f,h.h],encapsulation:2}),sn),ln=function(e){return["/hubs","index","agents","edit",e]};function un(e,t){if(1&e){var a=l.Pb();l.Lb(0,"dexih-button-edit",6),l.Ob(1,"dexih-button-save",7),l.Vb("click",(function(){return l.vc(a),l.Zb().save()})),l.Nb(),l.Lb(2,"cancel-button",8)}if(2&e){var n=l.Zb();l.hc("routerLink",l.mc(3,ln,n.remoteAgentKey)),l.yb(1),l.hc("disabled",!n.formsService.hasChanged),l.yb(1),l.hc("formsService",n.formsService)}}function bn(e,t){1&e&&l.Fc(0," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")}function hn(e,t){1&e&&(l.Ob(0,"div",9),l.Fc(1," Creating a new hub -> remote agent authorization "),l.Nb())}var dn=function(){return{standalone:!0}};function fn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form",10),l.Ob(1,"fieldset"),l.Ob(2,"section"),l.Ob(3,"form-input",11),l.Vb("ngModelChange",(function(e){return l.vc(a),l.Zb().name=e})),l.Nb(),l.Nb(),l.Ob(4,"section"),l.Lb(5,"form-checkbox",12),l.Nb(),l.Ob(6,"section"),l.Lb(7,"form-checkbox",13),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("formGroup",n.formsService.currentForm),l.yb(3),l.hc("disabled",!0)("ngModel",n.name)("ngModelOptions",l.lc(4,dn))}}var mn,vn=((mn=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.formsService=n,this.router=i,this.route=r,this.isNew=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.remoteAgents=t[3],e.hubCache.isLoaded()&&e.remoteAgents)if(e.remoteAgentKey=+a.remoteAgentKey,e.remoteAgentHubKey=+a.remoteAgentHubKey,e.remoteAgentKey){var n=e.remoteAgents.find((function(t){return t.remoteAgentKey===e.remoteAgentKey})),i=n.activeAgents&&n.activeAgents.length>0?n.activeAgents[0]:null;e.name=i?i.name:"",e.ipAddress=i?i.ipAddress:null,e.remoteAgentHub=e.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey})),e.remoteAgentHub||(e.remoteAgentHub={hubKey:e.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:n.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null},e.remoteAgentHub.allowExternalConnect=!0,e.remoteAgentHub.isSelected=!1,e.isNew=!0),e.formsService.remoteAgent(e.remoteAgentHub),0===e.remoteAgentHub.remoteAgentHubKey&&(e.formsService.hasChanged=!0)}else e.hubService.addHubErrorMessage("There was no remote agent specified to edit.")}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Remote Agent Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"addCurrentIp",value:function(){var e=this;if(this.ipAddress){var t=this.formsService.currentForm.controls.ipAddresses,a=t.value;a.findIndex((function(t){return t===e.ipAddress}))<0&&(a.push(this.ipAddress),t.setValue(a))}}},{key:"save",value:function(){var e=this;this.hubService.saveRemoteAgent(this.formsService.currentForm.value).then((function(t){t&&(e.hubService.addHubSuccessMessage("The remote agent updated successfully."),e.authService.navigateUp())}))}}]),e}()).\u0275fac=function(e){return new(e||mn)(l.Kb(b.a),l.Kb(u.a),l.Kb(D.a),l.Kb(r.e),l.Kb(r.a))},mn.\u0275cmp=l.Eb({type:mn,selectors:[["remote-agents"]],inputs:{hubKey:"hubKey"},features:[l.xb([D.a])],decls:11,vars:4,consts:[["DexihMessage",""],[1,"container"],["title","Edit Hub Remote Agent","iconClass","fa fa-lg fa-fw fa-database",3,"padding","showCloseButton","close"],["header",""],["class","alert alert-primary",4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"routerLink"],[1,"pl-1",3,"disabled","click"],[1,"pl-1",3,"formsService"],[1,"alert","alert-primary"],[3,"formGroup"],["label","Agent name","note","This can be changed in the agents appsettings.json config file.","iconClass","fa fa-comment",3,"disabled","ngModel","ngModelOptions","ngModelChange"],["label","Is default agent for this Hub","formControlName","isDefault"],["label","Is Authorized for this Hub.","formControlName","isAuthorized"]],template:function(e,t){1&e&&(l.Lb(0,"dexih-message",null,0),l.Ob(2,"div",1),l.Ob(3,"dexih-widget",2),l.Vb("close",(function(){return t.close()})),l.Dc(4,un,3,5,"ng-template",null,3,l.Ec),l.Fc(6," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"),l.Dc(7,bn,1,0,"ng-template",null,3,l.Ec),l.Dc(9,hn,2,0,"div",4),l.Dc(10,fn,8,5,"form",5),l.Nb(),l.Nb()),2&e&&(l.yb(3),l.hc("padding",!0)("showCloseButton",!0),l.yb(6),l.hc("ngIf",t.isNew),l.yb(1),l.hc("ngIf",t.formsService.currentForm))},directives:[Ga.a,h.P,v.t,h.j,r.f,h.t,V.a,n.I,n.t,n.l,h.D,n.s,n.v,h.A,n.j],encapsulation:2}),mn),pn=a("wTS4");function gn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-preview",11),l.Vb("click",(function(){l.vc(a);var e=t.item;return l.Zb().preview(e)})),l.Nb()}}function yn(e,t){}function Cn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-private",11),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().unshareSelectedTables(e)})),l.Nb()}}function kn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-download",12),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().downloadData(e)})),l.Nb(),l.Dc(1,Cn,1,0,"dexih-button-private",13)}if(2&e){var n=l.Zb();l.yb(1),l.hc("ngIf",n.hubCache.canWrite)}}var wn=function(){return{typeFilter:"All"}},Sn=function(){return{typeFilter:"Datalink"}},Tn=function(){return{typeFilter:"Table"}},On=function(){return{typeFilter:"View"}},Nn=function(){return{typeFilter:"Dashboard"}},Dn=function(){return{typeFilter:"Api"}};function xn(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",14),l.Ob(1,"a",15),l.Fc(2,"All"),l.Nb(),l.Ob(3,"a",16),l.Fc(4,"Datalinks"),l.Nb(),l.Ob(5,"a",17),l.Fc(6,"Tables"),l.Nb(),l.Ob(7,"a",18),l.Fc(8,"Views"),l.Nb(),l.Ob(9,"a",19),l.Fc(10,"Dashboards"),l.Nb(),l.Ob(11,"a",20),l.Fc(12,"Apis"),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("text",a.typeFilter)("pullRight",!0),l.yb(1),l.Cb("active","All"==a.typeFilter),l.hc("queryParams",l.lc(20,wn)),l.yb(2),l.Cb("active","Datalink"==a.typeFilter),l.hc("queryParams",l.lc(21,Sn)),l.yb(2),l.Cb("active","Table"==a.typeFilter),l.hc("queryParams",l.lc(22,Tn)),l.yb(2),l.Cb("active","View"==a.typeFilter),l.hc("queryParams",l.lc(23,On)),l.yb(2),l.Cb("active","Dashboard"==a.typeFilter),l.hc("queryParams",l.lc(24,Nn)),l.yb(2),l.Cb("active","Api"==a.typeFilter),l.hc("queryParams",l.lc(25,Dn))}}var Fn,Vn=((Fn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.cancelToken=new F.a,this.eSharedObjectType=c.dc,this.columns=[{name:"objectTypeName",title:"Type",format:""},{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:"Md"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.watchChanges(),e.typeFilter=a.typeFilter,e.typeFilter||(e.typeFilter="All"),e.route.snapshot.data.pageTitle=e.typeFilter,e.updateSharedData()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Shared Data Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateSharedData",value:function(){var e=this,t=new Array;this.hubCache&&this.hubCache.isLoaded()&&(this.hubCache.hub.dexihDatalinks||this.hubCache.hub.dexihConnections?("All"!==this.typeFilter&&"Datalink"!==this.typeFilter||this.hubCache.hub.dexihDatalinks.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:c.lb[c.lb.Datalink],objectType:c.lb.Datalink,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(c.dc.Datalink,a.key)})})),"All"!==this.typeFilter&&"Table"!==this.typeFilter||this.hubCache.hub.dexihTables.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:c.lb[c.lb.Table],objectType:c.lb.Table,name:a.logicalName+" ("+a.name+")",description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(c.dc.TagObjects,a.key)})})),"All"!==this.typeFilter&&"View"!==this.typeFilter||this.hubCache.hub.dexihViews.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:c.lb[c.lb.View],objectType:c.lb.View,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(c.dc.View,a.key)})})),"All"!==this.typeFilter&&"Dashboard"!==this.typeFilter||this.hubCache.hub.dexihDashboards.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:c.lb[c.lb.Dashboard],objectType:c.lb.Dashboard,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(c.dc.Dashboard,a.key)})})),"All"!==this.typeFilter&&"Api"!==this.typeFilter||this.hubCache.hub.dexihApis.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:c.lb[c.lb.Api],objectType:c.lb.Api,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(c.dc.Api,a.key)})})),this._tableData.next(t)):this._tableData.next(new Array))}},{key:"downloadData",value:function(e){var t=this;this.hubService.downloadData(e,!0,c.rb.Csv,this.cancelToken).then((function(){t.hubService.addHubSuccessMessage("The specified data is being downloaded.")})).catch((function(){}))}},{key:"preview",value:function(e){e.objectType===c.lb.Table&&this.router.navigate(["table-preview",e.objectKey],{relativeTo:this.route}),e.objectType===c.lb.Datalink&&this.router.navigate(["datalink-preview",e.objectKey],{relativeTo:this.route}),e.objectType===c.lb.View&&this.router.navigate(["view-preview",e.objectKey],{relativeTo:this.route}),e.objectType===c.lb.Dashboard&&this.router.navigate(["dashboard-preview",e.objectKey],{relativeTo:this.route}),e.objectType===c.lb.Api&&this.router.navigate(["api-preview",e.objectKey],{relativeTo:this.route})}},{key:"unshareSelectedTables",value:function(e){var t=e.filter((function(e){return e.objectType===c.lb.Datalink})).map((function(e){return e.objectKey}));t.length>0&&this.hubService.shareItems(t,c.lb.Datalink,!1);var a=e.filter((function(e){return e.objectType===c.lb.Table})).map((function(e){return e.objectKey}));a.length>0&&this.hubService.shareItems(a,c.lb.Table,!1)}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Datalink&&t.changeClass!==c.dc.Table||e.updateSharedData()}))}}]),e}()).\u0275fac=function(e){return new(e||Fn)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},Fn.\u0275cmp=l.Eb({type:Fn,selectors:[["sharedData-index"]],decls:11,vars:8,consts:[[1,"container-fluid"],["title","Shared Data","iconClass","fa fa-lg fa-fw fa-newspaper-o",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],[3,"click"],[1,"mr-1",3,"click"],[3,"click",4,"ngIf"],["buttonClass","btn-primary mr-1","iconClass","fa fa-filter","title","Filter by a purpose",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Datalinks",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Tables",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Views",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Dashboards",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Apis",1,"dropdown-item",3,"queryParams"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.preview(e)})),l.Dc(3,gn,1,0,"ng-template",3,4,l.Ec),l.Dc(5,yn,0,0,"ng-template",5,6,l.Ec),l.Dc(7,kn,2,1,"ng-template",7,8,l.Ec),l.Dc(9,xn,13,26,"ng-template",9,10,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!1),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.q,h.h,v.t,h.r,h.i,r.h],encapsulation:2}),Fn),In=a("Wz3H"),Kn=a("47Fv"),En=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};function Ln(e,t){}function _n(e,t){1&e&&l.Lb(0,"actions-table-button",14),2&e&&l.hc("tables",t.items)("refreshTables",!0)}function Pn(e,t){if(1&e&&l.Lb(0,"datalink-status",15),2&e){var a=t.item;l.hc("tableKey",null==a?null:a.key)}}var Mn=function(e){return{connectionKey:e}};function An(e,t){if(1&e&&(l.Ob(0,"a",22),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.hc("queryParams",l.mc(2,Mn,a.key)),l.yb(1),l.Gc(a.name)}}function Rn(e,t){if(1&e&&(l.Ob(0,"dexih-button-dropdown",20),l.Dc(1,An,2,4,"a",21),l.ac(2,"equalFilter"),l.Nb()),2&e){var a=l.Zb(2);l.hc("autoCompact",!1)("text",a.connectionName)("pullRight",!0),l.yb(1),l.hc("ngForOf",l.dc(2,4,a.hubCache.hub.dexihConnections,"isValid",!0))}}var jn=function(e){return{purposeFilter:e}};function Zn(e,t){if(1&e&&(l.Ob(0,"a",23),l.Fc(1),l.Nb()),2&e){var a=t.$implicit,n=l.Zb(2);l.Cb("active",n.purposeFilter==a.key),l.hc("queryParams",l.mc(5,jn,a.key))("title",a.name),l.yb(1),l.Gc(a.name)}}var Hn=function(){return{purposeFilter:"All"}};function Gn(e,t){if(1&e&&(l.Dc(0,Rn,3,8,"dexih-button-dropdown",16),l.Ob(1,"dexih-button-dropdown",17),l.Ob(2,"a",18),l.Fc(3,"All"),l.Nb(),l.Dc(4,Zn,2,7,"a",19),l.ac(5,"gtFilter"),l.Nb()),2&e){var a=l.Zb();l.hc("ngIf",null==a.hubCache?null:a.hubCache.hub),l.yb(1),l.hc("autoCompact",!1)("text",a.eConnectionPurpose[a.purposeFilter])("pullRight",!0),l.yb(1),l.Cb("active","0"==a.purposeFilter),l.hc("queryParams",l.lc(12,Hn)),l.yb(2),l.hc("ngForOf",l.dc(5,8,a.eConnectionPurposeItems,"key",0))}}function qn(e,t){if(1&e&&l.Lb(0,"tags-update-button",24),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.Table)("objects",a)}}function Bn(e,t){if(1&e&&l.Lb(0,"dependent-items-button",25),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.Table)}}var Un,zn,Wn=((zn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eConnectionPurposeItems=c.kb,this.eConnectionPurpose=c.jb,this.eSharedObjectType=c.dc,this.columns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"tableType",title:"Table Type",format:"Enum",enum:c.ic},{name:"connectionName",title:"Connection",footer:"connectionType",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){return En(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[2],this.hubCache=t[3],!this.hubCache.isLoaded()){e.next=5;break}return this.purposeFilter=a.purposeFilter,this.purposeFilter||(this.purposeFilter="All"),this.connectionKey=+a.connectionKey,this.connectionKey?(n=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i.connectionKey})))&&(this.connectionName=n.name):this.connectionName="All",e.next=5,this.updateTableData();case 5:case"end":return e.stop()}}),e,this)})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Table Index")}this.watchChanges()}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateTableData",value:function(){var e,t;return En(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,r,o,s,l=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.title="Tables ",this.connectionName="All",this.purposeFilter&&"All"!==this.purposeFilter&&(this.title+=": "+c.jb[this.purposeFilter]),!this.hubCache||!this.hubCache.isLoaded()){a.next=31;break}n=[],a.prev=2,i=regeneratorRuntime.mark((function e(){var t,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.value,a=l.hubCache.hub.dexihConnections.find((function(e){return e.key===t.connectionKey})),e.next=4,l.hubService.GetConnectionReference(a);case 4:i=e.sent,"All"!==l.purposeFilter&&l.purposeFilter&&(!a||a.purpose.toString()!==l.purposeFilter)||l.connectionKey&&t.connectionKey!==l.connectionKey||(o=t.tableType===c.ic.Query?"(Sql Query)":t.schema?t.schema+"."+t.name:t.name,l.hubCache.defaultTableLogicalName(t.schema,t.name)===t.logicalName?t.logicalName:"".concat(t.logicalName," (").concat(t.name,")"),s="",t.logicalName!==t.name&&(s="Name: "+t.name),s&&(s+="<br>"),t.description&&(s+=t.description),n.push({key:t.key,connectionType:a?c.jb[a.purpose]:"undefined",connectionName:a?a.name:"undefined",description:s,tableType:t.tableType,name:o,logicalName:t.logicalName,tags:l.hubCache.getObjectTags(c.dc.Table,t.key),updateDate:t.updateDate,connectionKey:a?a.key:"",isFile:!!i&&i.connectionCategory===c.ib.File,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}));case 6:case"end":return e.stop()}}),e)})),o=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(this.hubCache.hub.dexihTables);case 5:return a.next=7,o.next();case 7:if((r=a.sent).done){a.next=11;break}return a.delegateYield(i(),"t0",9);case 9:a.next=5;break;case 11:a.next=16;break;case 13:a.prev=13,a.t1=a.catch(2),e={error:a.t1};case 16:if(a.prev=16,a.prev=17,a.t2=r&&!r.done&&(t=o.return),!a.t2){a.next=22;break}return a.next=22,t.call(o);case 22:if(a.prev=22,!e){a.next=25;break}throw e.error;case 25:return a.finish(22);case 26:return a.finish(16);case 27:this.connectionKey&&(s=this.hubCache.hub.dexihConnections.find((function(e){return e.key===l.connectionKey})))&&(this.connectionName=s.name,this.title+=" for connection - "+s.name),this._tableData.next(n),a.next=32;break;case 31:this._tableData.next(null);case 32:case"end":return a.stop()}}),a,this,[[2,13,16,27],[17,,22,26]])})))}},{key:"routeSibling",value:function(e){this.router.navigate(["..",e])}},{key:"editTable",value:function(e){this.router.navigate(["table-edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}},{key:"getConnection",value:function(e){return this.hubCache.hub.dexihConnections.find((function(t){return t.key===e}))}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Table&&t.changeClass!==c.dc.TagObjects||e.updateTableData()}))}}]),e}()).\u0275fac=function(e){return new(e||zn)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},zn.\u0275cmp=l.Eb({type:zn,selectors:[["table-index"]],decls:16,vars:9,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","showIf","close"],["header",""],[3,"enableMultiSelect","columns","dataObservable","tags","enableStickyToolbar","toolbarZIndex","rowClick"],["actions",""],["select","rowStatus"],["rowStatus",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/table.md",1,"m-3"],[3,"tables","refreshTables"],[3,"tableKey"],["class","mr-1","buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",3,"autoCompact","text","pullRight",4,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",1,"mr-1",3,"autoCompact","text","pullRight"],["class","dropdown-item","routerLink",".",3,"queryParams",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,Ln,0,0,"ng-template",null,2,l.Ec),l.Ob(4,"dexih-table",3),l.Vb("rowClick",(function(e){return t.editTable(e)})),l.Dc(5,_n,1,2,"ng-template",null,4,l.Ec),l.Dc(7,Pn,1,1,"ng-template",5,6,l.Ec),l.Dc(9,Gn,6,13,"ng-template",7,8,l.Ec),l.Dc(11,qn,1,2,"ng-template",9,10,l.Ec),l.Dc(13,Bn,1,2,"ng-template",11,12,l.Ec),l.Nb(),l.Nb(),l.Lb(15,"dexih-help",13),l.Nb()),2&e&&(l.yb(1),l.hc("title",t.title)("showCloseButton",!0)("showIf",null==t.hubCache?null:t.hubCache.hub),l.yb(3),l.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags)("enableStickyToolbar",!0)("toolbarZIndex",100))},directives:[h.P,d.a,$.a,In.a,gt.a,v.t,h.i,r.h,v.s,p.a,m.a],pipes:[ze.a,Kn.a],encapsulation:2}),zn),Qn=((Un=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.eDataObjectType=c.lb,this.title="Preview Table"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.params,this.hubService.getHubCacheObservable(!0)).subscribe((function(t){var a=t[1];e.key=+t[0].tableKey;var n=a.getTable(e.key);n&&(e.title="Preview Table - "+n.logicalName)}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Table Preview Data")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Un)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.a))},Un.\u0275cmp=l.Eb({type:Un,selectors:[["table-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-exchange",3,"title","showCloseButton","close"],[3,"key","viewSource"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Lb(2,"preview-data",2),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("title",t.title)("showCloseButton",!0),l.yb(1),l.hc("key",t.key)("viewSource",t.eDataObjectType.Table))},directives:[h.P,$t.a],encapsulation:2}),Un);function $n(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",7),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().deleteCustomFunctions(e)})),l.Nb()}}function Xn(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",7),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb(),l.Dc(1,$n,1,0,"dexih-button-delete",8),l.Lb(2,"tags-update-button",9)}if(2&e){var n=t.items,i=l.Zb();l.yb(1),l.hc("ngIf",i.hubCache.canWrite),l.yb(1),l.hc("objectType",i.eSharedObjectType.CustomFunction)("objects",n)}}var Yn=function(){return["customFunction-new"]};function Jn(e,t){1&e&&l.Lb(0,"dexih-button-new",11),2&e&&l.hc("routerLink",l.lc(1,Yn))}function ei(e,t){if(1&e&&l.Dc(0,Jn,1,2,"dexih-button-new",10),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite)}}var ti,ai,ni=((ai=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateCustomFunctions()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteCustomFunctions",value:function(e){this.hubService.deleteCustomFunctions(e)}},{key:"updateCustomFunctions",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihCustomFunctions.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.CustomFunction,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["customFunction-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddCustomFunction(e.key,a)})),this.hubService.exportHub(a,1===e.length?"CustomFunction - "+e[0].name+".json":"customFunctions.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.CustomFunction&&t.changeClass!==c.dc.TagObjects||e.updateCustomFunctions()}))}}]),e}()).\u0275fac=function(e){return new(e||ai)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},ai.\u0275cmp=l.Eb({type:ai,selectors:[["customFunction"]],inputs:{hubKey:"hubKey"},decls:8,vars:8,consts:[[1,"container-fluid"],["title","Custom Functions","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,Xn,3,3,"ng-template",3,4,l.Ec),l.Dc(5,ei,1,1,"ng-template",null,5,l.Ec),l.Nb(),l.Nb(),l.Lb(7,"dexih-help",6),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!1),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,h.u,v.t,p.a,h.g,h.o,r.f],encapsulation:2}),ai),ii=((ti=function(){function e(){_classCallCheck(this,e),this.customFunctionParameterForm=null,this.addParameter=new l.n,this.removeParameter=new l.n,this.eBasicType=x.c,this.typeCodes=x.a,this.ignoreChanges=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){}},{key:"add",value:function(){this.addParameter.emit(this.customFunctionParameterForm)}},{key:"remove",value:function(){this.removeParameter.emit(this.customFunctionParameterForm)}}]),e}()).\u0275fac=function(e){return new(e||ti)},ti.\u0275cmp=l.Eb({type:ti,selectors:[["customFunction-parameter"]],inputs:{customFunctionParameterForm:"customFunctionParameterForm"},outputs:{addParameter:"addParameter",removeParameter:"removeParameter"},decls:15,vars:3,consts:[[1,"mb-1",3,"formGroup"],[1,"input-group"],["type","text","formControlName","name","placeholder","Enter a name for the parameter",1,"form-control"],["formControlName","dataType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],[1,"input-group-append"],[1,"input-group-text","p-0"],[1,"p-1"],["type","number","formControlName","rank",1,"mx-1"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"]],template:function(e,t){1&e&&(l.Ob(0,"form",0),l.Ob(1,"div",1),l.Lb(2,"input",2),l.Lb(3,"form-select",3),l.Ob(4,"div",4),l.Ob(5,"div",5),l.Ob(6,"span",6),l.Fc(7,"Array Dimensions (0-non array)"),l.Nb(),l.Lb(8,"input",7),l.Nb(),l.Ob(9,"div",5),l.Ob(10,"button",8),l.Vb("click",(function(){return t.add()})),l.Lb(11,"i",9),l.Nb(),l.Nb(),l.Ob(12,"div",5),l.Ob(13,"button",10),l.Vb("click",(function(){return t.remove()})),l.Lb(14,"i",11),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.hc("formGroup",t.customFunctionParameterForm),l.yb(3),l.hc("border",!1)("items",t.typeCodes))},directives:[n.I,n.t,n.l,n.c,n.s,n.j,h.E,n.y],encapsulation:2}),ti);function ri(e,t){if(1&e&&l.Lb(0,"save-button",13),2&e){var a=l.Zb(2);l.hc("formsService",a.formsService)}}function oi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-invalid-form-details",10),l.Vb("click",(function(){return l.vc(a),l.Zb().formsService.showErrors()})),l.Nb(),l.Dc(1,ri,1,1,"save-button",11),l.Lb(2,"cancel-button",12)}if(2&e){var n=l.Zb();l.hc("control",n.formsService.currentForm),l.yb(1),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("formsService",n.formsService)}}function si(e,t){if(1&e&&(l.Ob(0,"div"),l.Fc(1),l.Nb()),2&e){var a=l.Zb(3);l.yb(1),l.Hc("Cleaned Value = ",a.testResult.cleanedValue," ")}}function ci(e,t){if(1&e&&(l.Ob(0,"div"),l.Fc(1),l.Nb()),2&e){var a=l.Zb(3);l.yb(1),l.Hc("Reject Reason = ",a.testResult.rejectReason," ")}}function li(e,t){if(1&e&&(l.Ob(0,"section"),l.Ob(1,"div",20),l.Fc(2),l.Dc(3,si,2,1,"div",15),l.Dc(4,ci,2,1,"div",15),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.Cb("alert-danger",0==a.testResult.success)("alert-success",1==a.testResult.success),l.yb(1),l.Hc(" Test Result = ",a.testResult.success," "),l.yb(1),l.hc("ngIf",a.testResult.cleanedValue),l.yb(1),l.hc("ngIf",a.testResult.rejectReason)}}function ui(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",24),l.Ob(1,"dexih-button",25),l.Vb("click",(function(){l.vc(a);var e=l.Zb(3);return e.addParameter(null,e.eParameterDirection.Input)})),l.Fc(2,"Add Parameter "),l.Nb(),l.Nb()}}var bi=function(e){return{"z-index":e,position:"relative"}};function hi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",26),l.Ob(1,"customFunction-parameter",27),l.Vb("addParameter",(function(e){l.vc(a);var t=l.Zb(3);return t.addParameter(e,t.eParameterDirection.Input)}))("removeParameter",(function(e){return l.vc(a),l.Zb(3).removeParameter(e)})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit;l.hc("ngStyle",l.mc(2,bi,200-t.index)),l.yb(1),l.hc("customFunctionParameterForm",n)}}function di(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div"),l.Ob(1,"dexih-button",25),l.Vb("click",(function(){l.vc(a);var e=l.Zb(4);return e.addParameter(null,e.eParameterDirection.Output)})),l.Fc(2,"Add Parameter"),l.Nb(),l.Nb()}}function fi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",26),l.Ob(1,"customFunction-parameter",27),l.Vb("addParameter",(function(e){l.vc(a);var t=l.Zb(4);return t.addParameter(e,t.eParameterDirection.Output)}))("removeParameter",(function(e){return l.vc(a),l.Zb(4).removeParameter(e)})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit;l.hc("ngStyle",l.mc(2,bi,100-t.index)),l.yb(1),l.hc("customFunctionParameterForm",n)}}var mi=function(){return{"z-index":101,position:"relative"}};function vi(e,t){if(1&e&&(l.Ob(0,"div"),l.Ob(1,"div",21),l.Fc(2," Output Parameters "),l.Nb(),l.Ob(3,"div",26),l.Ob(4,"section"),l.Ob(5,"div",28),l.Lb(6,"input",29),l.Lb(7,"form-select",30),l.Nb(),l.Nb(),l.Dc(8,di,3,0,"div",15),l.Dc(9,fi,2,4,"div",7),l.Nb(),l.Lb(10,"br"),l.Nb()),2&e){var a=l.Zb(3);l.yb(3),l.hc("ngStyle",l.lc(5,mi)),l.yb(4),l.hc("border",!1)("items",a.typeCodes),l.yb(1),l.hc("ngIf",0===a.outputParameters.length),l.yb(1),l.hc("ngForOf",a.outputParameters)}}function pi(e,t){if(1&e&&(l.Ob(0,"div"),l.Ob(1,"div",21),l.Fc(2," Input Parameters "),l.Nb(),l.Dc(3,ui,3,0,"div",22),l.Dc(4,hi,2,4,"div",7),l.Nb(),l.Dc(5,vi,11,6,"div",15),l.Fc(6," Function Code "),l.Lb(7,"textarea",23)),2&e){var a=l.Zb(2);l.yb(3),l.hc("ngIf",0===a.inputParameters.length),l.yb(1),l.hc("ngForOf",a.inputParameters),l.yb(1),l.hc("ngIf",a.functionType!=a.eFunctionType.Condition)}}function gi(e,t){if(1&e&&(l.Ob(0,"form",14),l.Ob(1,"fieldset"),l.Dc(2,li,5,7,"section",15),l.Ob(3,"section"),l.Lb(4,"form-select",16),l.Nb(),l.Ob(5,"section"),l.Lb(6,"form-input",17),l.Nb(),l.Ob(7,"section"),l.Lb(8,"form-textarea",18),l.Nb(),l.Dc(9,pi,8,3,"ng-template",19),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.formsService.currentForm),l.yb(2),l.hc("ngIf",a.testResult),l.yb(2),l.hc("items",a.functionTypes),l.yb(2),l.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),l.yb(2),l.hc("showMarkdown",!0),l.yb(1),l.hc("ngIf",a.functionType)}}function yi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",31),l.Vb("click",(function(){return l.vc(a),l.Zb().test()})),l.Fc(1,"Syntax Check"),l.Nb(),l.Ob(2,"dexih-button",31),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return e.test(e.inputParameterValues)})),l.Fc(3,"Run"),l.Nb(),l.Ob(4,"dexih-button-save-local",32),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return e.downloadCode(e.inputParameterValues)})),l.Nb()}}function Ci(e,t){1&e&&(l.Ob(0,"div",33),l.Fc(1," Input Parameters "),l.Nb())}function ki(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div"),l.Ob(1,"div",37),l.Ob(2,"div",38),l.Fc(3),l.Nb(),l.Ob(4,"form-input",39),l.Vb("ngModelChange",(function(e){l.vc(a);var n=t.index,i=l.Zb(2).index;return l.Zb().inputParameterValues[i][n]=e})),l.Nb(),l.Ob(5,"div",40),l.Ob(6,"button",41),l.Vb("click",(function(){l.vc(a);var e=t.index,n=l.Zb(2).index;return l.Zb().addParameterValue(n,e)})),l.Lb(7,"i",42),l.Nb(),l.Nb(),l.Ob(8,"div",40),l.Ob(9,"button",43),l.Vb("click",(function(){l.vc(a);var e=t.index,n=l.Zb(2).index;return l.Zb().removeParameterValue(n,e)})),l.Lb(10,"i",44),l.Nb(),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=t.index,i=l.Zb(2),r=i.$implicit,o=i.index,s=l.Zb();l.yb(3),l.Hc(" ",r.controls.name.value+"["+n+"]"," "),l.yb(1),l.hc("border",!1)("ngModel",s.inputParameterValues[o][n])("name","inputParameterValues-"+o+"-"+n)}}function wi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div"),l.Ob(1,"div"),l.Ob(2,"dexih-button",25),l.Vb("click",(function(){l.vc(a);var e=l.Zb().index;return l.Zb().addParameterValue(e)})),l.Fc(3),l.Nb(),l.Nb(),l.Dc(4,ki,11,4,"div",36),l.Nb()}if(2&e){var n=l.Zb(),i=n.$implicit,r=n.index,o=l.Zb();l.yb(3),l.Hc(" Add ",i.controls.name.value," value "),l.yb(1),l.hc("ngForOf",o.inputParameterValues[r])}}function Si(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form-input",45),l.Vb("ngModelChange",(function(e){l.vc(a);var t=l.Zb().index;return l.Zb().inputParameterValues[t]=e})),l.Nb()}if(2&e){var n=l.Zb(),i=n.$implicit,r=n.index,o=l.Zb();l.hc("label",i.controls.name.value)("ngModel",o.inputParameterValues[r])("name","inputParameterValues"+r)}}function Ti(e,t){if(1&e&&(l.Ob(0,"div",26),l.Dc(1,wi,5,2,"div",34),l.Dc(2,Si,1,3,"ng-template",null,35,l.Ec),l.Nb()),2&e){var a=t.$implicit,n=t.index,i=l.sc(3);l.hc("ngStyle",l.mc(3,bi,200-n)),l.yb(1),l.hc("ngIf",a.controls.rank.value>0)("ngIfElse",i)}}function Oi(e,t){1&e&&(l.Ob(0,"div",33),l.Fc(1," Outputs Parameters "),l.Nb())}function Ni(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",26),l.Ob(1,"form-input",46),l.Vb("ngModelChange",(function(e){l.vc(a);var n=t.index;return l.Zb().outputParameterValues[n]=e})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit,i=t.index,r=l.Zb();l.hc("ngStyle",l.mc(5,bi,200-i)),l.yb(1),l.hc("disabled",!0)("label",n.controls.name.value)("ngModel",r.outputParameterValues[i])("name","outputParameterValues"+i)}}var Di,xi=((Di=function(){function e(t,a,n,i,r,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.location=o,this.typeCodes=x.a,this.eParameterDirection=c.Vb,this.outputParameters=[],this.inputParameters=[],this.outputParameterValues=[],this.inputParameterValues=[],this.functionTypes=x.d,this.eFunctionType=c.Cb,this.lookupColumnValue="",this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._functionTypeSubscription&&this._functionTypeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.customFunctionKey=+this.params.customFunctionKey,this.customFunctionKey)if(this.hubCache.hub&&this.hubCache.hub.dexihCustomFunctions){var t=this.hubCache.hub.dexihCustomFunctions.find((function(t){return t.key===e.customFunctionKey}));this.formsService.customFunction(t),this.functionType=this.formsService.currentForm.controls.functionType.value}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no custom function specified to edit.");if("new"===this.action){var a=new c.g;a.key=this.hubCache.getNextSequence(),this.formsService.customFunction(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a>=0&&history.pushState){var n=window.location.pathname.replace("/customFunction-new","/customFunction-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}})),this.functionType=this.formsService.currentForm.controls.functionType.value}this._functionTypeSubscription=this.formsService.currentForm.controls.functionType.valueChanges.subscribe((function(t){e.functionType=t,e.functionType!==c.Cb.Condition&&e.functionType!==c.Cb.JoinCondition&&e.functionType!==c.Cb.Validate||(e.formsService.currentForm.controls.returnType.setValue(c.pc.Boolean),e.updateParameters())})),this.updateParameters()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.currentForm&&!e.formsService.currentForm.pristine?e.authService.confirmDialog("Function has changed","The function has changed.  Would you like to discard the changes and return to the previous screen?").then((function(e){t(e)})).catch((function(e){t(!1)})):t(!0)}))}},{key:"parametersArray",value:function(){return this.formsService.currentForm.controls.dexihCustomFunctionParameters}},{key:"updateParameters",value:function(){var e=this.parametersArray();this.inputParameters=e.controls.sort((function(e,t){return e.value.position-t.value.position})).filter((function(e){return e.value.direction===c.Vb.Input})),this.outputParameters=e.controls.sort((function(e,t){return e.value.position-t.value.position})).filter((function(e){return e.value.direction===c.Vb.Output})),this.inputParameterValues.length=this.inputParameters.length,this.outputParameterValues.length=this.outputParameters.length}},{key:"addParameter",value:function(e,t){try{var a=new c.h;if(e){var n=e.value;a.dataType=n.dataType,a.name=n.name,a.position=n.position+1}a.key=this.hubCache.getNextSequence(),a.name="",a.direction=t,a.rank=0,a.isValid=!0;var i=this.parametersArray(),r=this.formsService.customFunctionParametersFormGroup(a);i.push(r),i.controls.sort((function(e,t){return e.value.position-t.value.position})).forEach((function(e,t){e.controls.position.setValue(10*t)})),this.updateParameters()}catch(o){this.hubService.addHubClientErrorMessage(o,"Edit Custom Function, add parameter")}}},{key:"addParameterValue",value:function(e,t){Array.isArray(this.inputParameterValues[e])?this.inputParameterValues[e].splice(t+1,0,""):this.inputParameterValues[e]=new Array(1)}},{key:"removeParameterValue",value:function(e,t){this.inputParameterValues[e].splice(t,1)}},{key:"removeParameter",value:function(e){try{var t=this.parametersArray(),a=t.controls.indexOf(e);a>-1&&t.removeAt(a),this.updateParameters()}catch(n){this.hubService.addHubClientErrorMessage(n,"Edit Custom Function, remove parameter")}}},{key:"downloadCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.createDataTransformItem();this.hubService.downloadCustomFunction(t,e)}},{key:"test",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.createDataTransformItem();this.hubService.testCustomFunction(a,t,this.cancelToken).then((function(t){e.syntaxMessage=new F.e(!0,"The function has successfully compiled.",null,null),t&&t.length>0?t.forEach((function(t,a){0===a?e.returnParameterValue=t:e.outputParameterValues[a-1]=t})):(e.returnParameterValue=null,e.outputParameterValues.forEach((function(e){return null})))})).catch((function(t){var a=t;t.stack&&(a=new F.e(!1,"Client Error: "+t.message,t.stack,"")),e.syntaxMessage=a,e.returnParameterValue=null,e.outputParameterValues.forEach((function(e){return null}))}))}},{key:"createDataTransformItem",value:function(){var e=this.formsService.currentForm.value,t=new c.x;t.functionCode=e.methodCode,t.functionResultCode=e.resultCode,t.transformItemType=c.kc.CustomFunction;var a=[];e.dexihCustomFunctionParameters.sort((function(e,t){return e.position-t.position})).forEach((function(e,t){if(e){var n=new c.A;n.key=0,n.datalinkTransformItemKey=0,n.name=e.name,n.rank=e.rank,n.direction=e.direction,n.dataType=e.dataType,n.position=t,n.isValid=!0,a.push(n)}}));var n=new c.A;return n.key=0,n.datalinkTransformItemKey=0,n.name="Return",n.rank=0,n.direction=c.Vb.ReturnValue,n.dataType=e.returnType,n.position=0,n.isValid=!0,a.push(n),t.dexihFunctionParameters=a,t}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Di)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e),l.Kb(v.n))},Di.\u0275cmp=l.Eb({type:Di,selectors:[["dexih-customFunction-edit-form"]],features:[l.xb([D.a])],decls:19,vars:11,consts:[[1,"container"],["title","Edit Function","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Test Function","iconClass","fa fa-lg fa-fw fa-code",3,"padding"],[3,"message"],["class","label",4,"ngIf"],[3,"ngStyle",4,"ngFor","ngForOf"],["label","Return Value","name","returnParameterValue","type","text",3,"disabled","ngModel","ngModelChange"],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],[4,"ngIf"],["label","Function Type","formControlName","functionType","itemKey","key","itemName","name","iconClass","fa fa-question",3,"items"],["label","Custom Function Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[3,"ngIf"],[1,"alert"],[1,"label","mb-1"],["class","mb-1",4,"ngIf"],["rows","20","width","100%","spellcheck","false","formControlName","methodCode",1,"form-control"],[1,"mb-1"],["iconClass","fa fa-plus-square-o","title","Click to add a parameter",3,"click"],[3,"ngStyle"],[3,"customFunctionParameterForm","addParameter","removeParameter"],[1,"input-group","mb-1"],["readonly","","value","Return Data Type",1,"form-control"],["formControlName","returnType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],["buttonClass","btn btn-success",1,"mr-1",3,"click"],["text","Sample Code",3,"click"],[1,"label"],[4,"ngIf","ngIfElse"],["showValue",""],[4,"ngFor","ngForOf"],[1,"input-group"],[1,"form-control"],["type","text","placeholder","Enter a test value for the parameter",1,"form-control","p-0",3,"border","ngModel","name","ngModelChange"],[1,"input-group-text","p-0"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"],["type","text","placeholder","Enter a test value for the parameter",3,"label","ngModel","name","ngModelChange"],["type","text",3,"disabled","label","ngModel","name","ngModelChange"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget-vertical"),l.Ob(2,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(3,oi,3,3,"ng-template",null,2,l.Ec),l.Dc(5,gi,10,7,"form",3),l.Nb(),l.Ob(6,"dexih-widget",4),l.Dc(7,yi,5,0,"ng-template",null,2,l.Ec),l.Lb(9,"dexih-message",5),l.Ob(10,"form"),l.Ob(11,"fieldset"),l.Ob(12,"div"),l.Dc(13,Ci,2,0,"div",6),l.Dc(14,Ti,4,5,"div",7),l.Ob(15,"form-input",8),l.Vb("ngModelChange",(function(e){return t.returnParameterValue=e})),l.Nb(),l.Dc(16,Oi,2,0,"div",6),l.Dc(17,Ni,2,7,"div",7),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Lb(18,"dexih-help",9),l.Nb(),l.Nb()),2&e&&(l.yb(2),l.hc("showCloseButton",!0)("padding",!0),l.yb(3),l.hc("ngIf",t.formsService.currentForm),l.yb(1),l.hc("padding",!0),l.yb(3),l.hc("message",t.syntaxMessage),l.yb(4),l.hc("ngIf",t.inputParameters.length>0),l.yb(1),l.hc("ngForOf",t.inputParameters),l.yb(1),l.hc("disabled",!0)("ngModel",t.returnParameterValue),l.yb(1),l.hc("ngIf",t.outputParameters.length>0),l.yb(1),l.hc("ngForOf",t.outputParameters))},directives:[h.S,h.P,v.t,Ga.a,n.I,n.t,n.u,v.s,h.D,n.s,n.v,$.a,I.a,V.a,K.a,n.l,h.E,n.j,h.H,n.c,h.f,v.w,ii,h.u],encapsulation:2}),Di),Fi=a("bK5D"),Vi=a("crXl");function Ii(e,t){if(1&e&&l.Lb(0,"dependent-items-button",11),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.DatalinkTest)}}function Ki(e,t){if(1&e&&l.Lb(0,"tags-update-button",12),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.DatalinkTest)("objects",a)}}function Ei(e,t){1&e&&l.Lb(0,"actions-datalinkTest-button",13),2&e&&l.hc("datalinkTests",t.items)}function Li(e,t){if(1&e&&l.Lb(0,"datalink-status",14),2&e){var a=t.item;l.hc("datalinkTestKey",null==a?null:a.key)}}var _i,Pi=((_i=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.cancelToken=new F.a,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Tests Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteDatalinkTests(e)}},{key:"snapshot",value:function(e){this.hubService.runDatalinkTestSnapshot(e,this.cancelToken)}},{key:"run",value:function(e){var t=e.map((function(e){return e.key}));this.hubService.runDatalinkTests(t,this.cancelToken)}},{key:"update",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDatalinkTests.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.DatalinkTest,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["datalinkTest-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubService.createHub(this.hubCache.hub.hubKey,"");t.dexihDatalinkTests=e,this.hubService.exportHub(t,"datalink_tests.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.DatalinkTest&&t.changeClass!==c.dc.TagObjects||e.update()}))}}]),e}()).\u0275fac=function(e){return new(e||_i)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},_i.\u0275cmp=l.Eb({type:_i,selectors:[["datalink-test"]],decls:12,vars:5,consts:[[1,"container-fluid"],["title","Datalink Tests","iconClass","fa fa-lg fa-fw fa-flag-checkered",3,"showCloseButton","close"],[3,"enableMultiSelect","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Datalink Test","path","/assets/help/reference/datalinkTest.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkTests"],[3,"datalinkTestKey"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,Ii,1,2,"ng-template",3,4,l.Ec),l.Dc(5,Ki,1,2,"ng-template",5,6,l.Ec),l.Dc(7,Ei,1,1,"ng-template",null,7,l.Ec),l.Dc(9,Li,1,1,"ng-template",8,9,l.Ec),l.Nb(),l.Nb(),l.Lb(11,"dexih-help",10),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,p.a,Vi.a,gt.a],encapsulation:2}),_i);function Mi(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save",5),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return!e.saving&&e.save()})),l.Nb(),l.Ob(1,"dexih-button-cancel",6),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return!e.saving&&e.cancel()})),l.Nb()}if(2&e){var n=l.Zb();l.hc("busy",n.saving),l.yb(1),l.hc("busy",n.saving)}}function Ai(e,t){if(1&e&&(l.Ob(0,"span",10),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.yb(1),l.Hc(" ",a.name," ")}}function Ri(e,t){if(1&e&&(l.Ob(0,"label",7),l.Fc(1,"Create automatic tests for the following datalink(s):"),l.Nb(),l.Ob(2,"div"),l.Ob(3,"div",8),l.Dc(4,Ai,2,1,"span",9),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.yb(4),l.hc("ngForOf",a.sourceDatalinks)}}function ji(e,t){if(1&e&&l.Lb(0,"form-input",21),2&e){var a=l.Zb(2);l.hc("errors",a.formErrors.name)}}function Zi(e,t){1&e&&l.Lb(0,"form-input",22)}function Hi(e,t){if(1&e&&(l.Ob(0,"form",11),l.Ob(1,"fieldset"),l.Ob(2,"div",12),l.Ob(3,"section",13),l.Dc(4,ji,1,1,"form-input",14),l.Dc(5,Zi,1,0,"form-input",15),l.Nb(),l.Ob(6,"section",13),l.Lb(7,"form-select",16),l.Nb(),l.Nb(),l.Ob(8,"div",12),l.Ob(9,"section",13),l.Lb(10,"form-select",17),l.Nb(),l.Ob(11,"section",13),l.Lb(12,"form-select",18),l.Nb(),l.Nb(),l.Nb(),l.Ob(13,"fieldset"),l.Ob(14,"section"),l.Ob(15,"div",12),l.Ob(16,"section",19),l.Lb(17,"form-checkbox",20),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.mainForm),l.yb(4),l.hc("ngIf",1==a.sourceDatalinks.length),l.yb(1),l.hc("ngIf",a.sourceDatalinks.length>1),l.yb(2),l.hc("items",a.hubCache.hub.dexihConnections)("errors",a.formErrors.auditConnectionKey),l.yb(3),l.hc("items",a.managedConnections)("errors",a.formErrors.sourceConnectionKey)("allowNullSelect",!0),l.yb(2),l.hc("items",a.managedConnections)("errors",a.formErrors.targetConnectionKey)("allowNullSelect",!0)}}var Gi,qi=((Gi=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.route=a,this.router=n,this.location=i,this.fb=r,this.cancelToken=new F.a,this.hasChanged=!1,this.showAllErrors=!1,this.saving=!1,this.formErrors={name:"",auditConnectionKey:"",sourceConnectionKey:"",targetConnectionKey:"",snapshotData:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},auditConnectionKey:{},targetConnectionKey:{},sourceConnectionKey:{},snapshotData:{}}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.managedConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===c.jb.Managed})),e.hubCache.status===N.j.Loaded){var n=a.datalinkKeys;if(e.sourceDatalinkKeys=new Array,e.sourceDatalinks=new Array,n&&e.hubCache.hub.dexihConnections){var i=n.split("|");e.hubCache.hub.dexihDatalinks.forEach((function(t){i.findIndex((function(e){return e===t.key.toString()}))>=0&&(e.sourceDatalinkKeys.push(t.key),e.sourceDatalinks.push(t))}))}var r=e.hubCache.hub.dexihConnections.find((function(e){return e.purpose===c.jb.Managed}));r&&(e.targetConnectionKey=r.key),e.sourceConnectionKey=e.targetConnectionKey,e.auditConnectionKey=e.targetConnectionKey,e.buildForm()}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink New")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"buildForm",value:function(){var e=this;this.mainForm=this.fb.group({name:[this.name,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],sourceConnectionKey:[this.sourceConnectionKey>0?this.sourceConnectionKey:null,[]],snapshotData:[!0,[]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe((function(t){return e.onValueChanged(t)})),this.onValueChanged(),this.hasChanged=!1}},{key:"onValueChanged",value:function(e){if(this.mainForm){var t=this.mainForm;this.hasChanged=!0;for(var a=0,n=Object.keys(this.formErrors);a<n.length;a++){var i=n[a];this.formErrors[i]="";var r=t.get(i);if(r&&(r.dirty||this.showAllErrors)&&!r.valid)for(var o=this.validationMessages[i],s=0,c=Object.keys(r.errors);s<c.length;s++){var l=c[s];this.formErrors[i]+=o[l]+" "}}}}},{key:"save",value:function(){var e=this;if(this.mainForm.valid){var t=this.mainForm.value;this.saving=!0,this.hubService.newDatalinkTest(this.name,this.sourceDatalinkKeys,t.auditConnectionKey,t.targetConnectionKey,t.sourceConnectionKey).then((function(a){return n=e,r=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.snapshotData,!e.t0){e.next=4;break}return e.next=4,this.hubService.runDatalinkTestSnapshot([a],this.cancelToken);case 4:this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinkTests","datalinkTest-edit",a.key],{relativeTo:this.route.root});case 5:case"end":return e.stop()}}),e,this)})),new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(r.next(e))}catch(a){t(a)}}function o(e){try{s(r.throw(e))}catch(a){t(a)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,o)}s((r=r.apply(n,[])).next())}));var n,i,r})).catch((function(t){e.saving=!1}))}else this.showAllErrors=!0,this.onValueChanged()}},{key:"cancel",value:function(){this.location.back()}}]),e}()).\u0275fac=function(e){return new(e||Gi)(l.Kb(u.a),l.Kb(r.a),l.Kb(r.e),l.Kb(v.n),l.Kb(n.g))},Gi.\u0275cmp=l.Eb({type:Gi,selectors:[["dexih-datalinkTest-new-form"]],decls:7,vars:3,consts:[[1,"container"],["title","New Datalink Test(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"list-group","d-inline-block"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors",4,"ngIf"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment",4,"ngIf"],["label","Audit Connection","formControlName","auditConnectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","Connection where test results are stored.",3,"items","errors"],["formControlName","sourceConnectionKey","label","Input Connection","itemKey","key","itemName","name","note","Specify the connection to use for any datalink source data.","selectNullMessage","No source table",3,"items","errors","allowNullSelect"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for target data.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],[1,"col","col-11"],["label","Snapshot and copy current source/target data into the test connections.","formControlName","snapshotData","name","snapshotData"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return!t.saving&&t.cancel()})),l.Dc(2,Mi,2,2,"ng-template",null,2,l.Ec),l.Dc(4,Ri,5,1,"ng-template",null,3,l.Ec),l.Dc(6,Hi,18,11,"form",4),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(5),l.hc("ngIf",t.sourceDatalinkKeys))},directives:[h.P,v.t,h.t,h.b,v.s,n.I,n.t,n.l,h.E,n.s,n.j,h.A,h.D],encapsulation:2}),Gi),Bi=a("MbvK"),Ui=a("ynzd"),zi=a("XNiG"),Wi=a("VRyK"),Qi=a("Z+eP"),$i=a("RXlv"),Xi=a("79jk"),Yi=a("+F4M"),Ji=a("hJJo"),er=a("YcGA");function tr(e,t){if(1&e&&l.Lb(0,"save-button",16),2&e){var a=l.Zb(2);l.hc("formsService",a.formsService)}}function ar(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-invalid-form-details",12),l.Vb("click",(function(){return l.vc(a),l.Zb().formsService.showErrors()})),l.Nb(),l.Ob(1,"download-button",13),l.Vb("download",(function(e){return l.vc(a),l.Zb().download(e)})),l.Nb(),l.Dc(2,tr,1,1,"save-button",14),l.Lb(3,"cancel-button",15)}if(2&e){var n=l.Zb();l.hc("control",n.formsService.currentForm),l.yb(2),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("formsService",n.formsService)}}function nr(e,t){if(1&e&&(l.Ob(0,"section",21),l.Ob(1,"form-select",28),l.Lb(2,"table-edit-button",29),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),l.yb(1),l.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function ir(e,t){if(1&e&&(l.Ob(0,"section",21),l.Ob(1,"form-select",30),l.Lb(2,"datalink-edit-button",29),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("errors",null==a.errors?null:a.errors.sourceDatalinkKey)("items",a.datalinks),l.yb(1),l.hc("key",a.formsService.currentForm.controls.sourceDatalinkKey.value)}}function rr(e,t){if(1&e&&(l.Ob(0,"form",17),l.Ob(1,"fieldset"),l.Ob(2,"section"),l.Lb(3,"form-input",18),l.Nb(),l.Ob(4,"section"),l.Lb(5,"form-textarea",19),l.Nb(),l.Ob(6,"section"),l.Ob(7,"div",20),l.Ob(8,"section",21),l.Lb(9,"form-checkbox",22),l.Nb(),l.Ob(10,"section",21),l.Lb(11,"form-input",23),l.Nb(),l.Nb(),l.Nb(),l.Ob(12,"section"),l.Ob(13,"div",20),l.Ob(14,"section",21),l.Lb(15,"form-checkbox",24),l.Nb(),l.Ob(16,"section",21),l.Lb(17,"form-time",25),l.Nb(),l.Nb(),l.Nb(),l.Ob(18,"section"),l.Ob(19,"div",20),l.Ob(20,"section",21),l.Lb(21,"form-select",26),l.Nb(),l.Dc(22,nr,3,3,"section",27),l.Dc(23,ir,3,3,"section",27),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.formsService.currentForm),l.yb(3),l.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),l.yb(2),l.hc("showMarkdown",!0),l.yb(6),l.hc("errors",a.formsService.formErrors.logDirectory),l.yb(6),l.hc("errors",a.formsService.formErrors.resetCacheInterval),l.yb(4),l.hc("items",a.sourceTypes)("enableFilter",!1),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eSourceType.Table),l.yb(1),l.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eSourceType.Datalink)}}function or(e,t){if(1&e&&(l.Ob(0,"dexih-widget-section",31),l.Lb(1,"input-parameters",32),l.Nb()),2&e){var a=l.Zb();l.hc("showExpandButton",!0)("padding",!0),l.yb(1),l.hc("showEdit",!0)("parameters",a.formsService.currentForm.controls.parameters)("formsService",a.formsService)}}function sr(e,t){if(1&e){var a=l.Pb();l.Ob(0,"span",35),l.Ob(1,"div",36),l.Ob(2,"div",37),l.Fc(3),l.Nb(),l.Nb(),l.Ob(4,"form-input",38),l.Vb("ngModelChange",(function(e){return l.vc(a),t.$implicit.value=e})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit,i=t.index;l.yb(3),l.Hc(" ",n.logicalName," "),l.yb(1),l.jc("name","column",i,""),l.hc("placeholder","Enter "+n.logicalName)("ngModel",n.value)}}function cr(e,t){if(1&e&&(l.Ob(0,"div",33),l.Dc(1,sr,5,4,"span",34),l.Nb()),2&e){var a=l.Zb();l.yb(1),l.hc("ngForOf",a.inputColumns)}}function lr(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-refresh",39),l.Vb("click",(function(){return l.vc(a),l.Zb().refresh()})),l.Nb()}}var ur,br=((ur=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.refreshDataSubject=new zi.a,this.sourceTypes=[{key:c.gc.Datalink,name:"Datalink"},{key:c.gc.Table,name:"Table"}],this.eSourceType=c.gc,this.connectionTables=[],this.datalinks=[],this.selectQuery=new c.V,this.data=[],this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.hubCache&&e.hubCache.isLoaded()&&(e.connectionTables=e.hubCache.getConnectionTables(),e.datalinks=e.hubCache.hub.dexihDatalinks),(!e.isLoaded||"new"!==e.action)&&(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load(),e.hubCache.isLoaded()))){if(!e.hubCache||e.hubCache.status!==N.j.Loaded||e.isLoaded)return;e.isLoaded=!0}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Api Edit")}}},{key:"load",value:function(){var e=this;if("edit"===this.action)if(this.apiKey=+this.params.apiKey,this.apiKey)if(this.hubCache.hub&&this.hubCache.hub.dexihApis){var t=this.hubCache.hub.dexihApis.find((function(t){return t.key===e.apiKey}));this.selectQuery=t.selectQuery,this.selectQuery||(this.selectQuery=new c.V),this.formsService.api(t),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no api specified to edit.");if("new"===this.action){var a=new c.d;this.formsService.api(a),this.watchChanges(),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/api-new","/api-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}}},{key:"watchChanges",value:function(){var e=this;this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(Wi.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe((function(){e.reset(),e.selectQuery=new c.V,e.getColumns()}))}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"getColumns",value:function(){var e=this.formsService.currentForm;if(e.controls.sourceType.value===c.gc.Table&&e.controls.sourceTableKey.value>0){var t=this.hubCache.getTable(e.controls.sourceTableKey.value);if(t)return this.tableColumns=t.dexihTableColumns,void(this.inputColumns=this.getInputColumns(t.dexihTableColumns));this.reset()}else this.reset();if(e.controls.sourceType.value===c.gc.Datalink&&e.controls.sourceDatalinkKey.value>0){var a=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(a){var n=new Qi.b;n.buildInputOutput(this.hubCache,a),this.tableColumns=n.getDatalinkOutputColumns(a),this.inputColumns=this.getInputColumns(a.sourceDatalinkTable.dexihDatalinkColumns)}else this.reset()}else this.reset()}},{key:"getInputColumns",value:function(e){return e.filter((function(e){return e.isInput})).map((function(e){return{name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue}}))}},{key:"reset",value:function(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null}},{key:"refresh",value:function(){var e=this,t=this.formsService.currentForm;t.controls.sourceType.value===c.gc.Datalink&&this.hubService.previewDatalinkKeyData(t.controls.sourceDatalinkKey.value,!1,this.selectQuery,this.inputColumns,t.controls.parameters.value,this.cancelToken).then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.data=t.data})).catch((function(){})),t.controls.sourceType.value===c.gc.Table&&this.hubService.previewTableKeyData(t.controls.sourceTableKey.value,!1,this.selectQuery,this.inputColumns,t.controls.parameters.value,this.cancelToken).then((function(t){e.columns=t.columns,e.data=t.data})).catch((function(){}))}},{key:"download",value:function(e){var t=this.formsService.currentForm.value,a=new c.M;t.sourceType===c.gc.Table&&(a.objectKey=t.sourceDatalinkKey,a.objectType=c.lb.Datalink),t.sourceType===c.gc.Table&&(a.objectKey=t.sourceTableKey,a.objectType=c.lb.Table),a.query=this.selectQuery,this.hubService.downloadData([a],!1,e,this.cancelToken)}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The api has not been saved","The api changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The api changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||ur)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e))},ur.\u0275cmp=l.Eb({type:ur,selectors:[["dexih-api-edit-form"]],hostBindings:function(e,t){1&e&&l.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,l.uc)},features:[l.xb([D.a])],decls:17,vars:16,consts:[[1,"container"],["title","Edit API","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],["title","Parameters",3,"showExpandButton","padding",4,"ngIf"],["title","Data",3,"showExpandButton"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","Api Name","formControlName","name","placeholder","Enter the api name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Auto Start","formControlName","autoStart","note","Re-start the API when the remote agent is restarted."],["label","Log Directory","formControlName","logDirectory","placeholder","Enter a directory to log api updates.","iconClass","fa fa-list","note","Directory to create detailed logs of API calls.  Leave blank to exclude file logging.",3,"errors"],["label","Cache Queries","formControlName","cacheQueries","note","Cache API called to improve performance"],["label","Reset Cache Interval","formControlName","cacheResetInterval","note","The interval to reset the cache (forcing a reload of new data).",3,"errors"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["title","Parameters",3,"showExpandButton","padding"],[3,"showEdit","parameters","formsService"],[1,"d-flex","flex-wrap","pt-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,ar,4,3,"ng-template",null,2,l.Ec),l.Ob(4,"dexih-widget-section",3),l.Dc(5,rr,24,10,"form",4),l.Nb(),l.Dc(6,or,2,5,"dexih-widget-section",5),l.Ob(7,"dexih-widget-section",6),l.Dc(8,cr,2,1,"div",7),l.Ob(9,"section"),l.Ob(10,"h5"),l.Fc(11,"Data Configuration"),l.Nb(),l.Ob(12,"query-builder",8),l.Vb("onRefreshData",(function(){return t.refresh()})),l.Nb(),l.Nb(),l.Ob(13,"dexih-table",9),l.Dc(14,lr,1,0,"ng-template",null,10,l.Ec),l.Nb(),l.Nb(),l.Nb(),l.Lb(16,"dexih-help",11),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!1),l.yb(3),l.hc("showExpandButton",!0),l.yb(1),l.hc("ngIf",t.formsService.currentForm),l.yb(1),l.hc("ngIf",t.formsService.currentForm),l.yb(1),l.hc("showExpandButton",!0),l.yb(1),l.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),l.yb(4),l.hc("selectQuery",t.selectQuery)("columns",t.tableColumns)("inputColumns",t.inputColumns)("parameters",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.parameters.value)("refreshEvent",t.refreshDataSubject.asObservable()),l.yb(1),l.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",t.columns)("data",t.data))},directives:[h.P,h.T,v.t,$i.a,d.a,$.a,I.a,Xi.a,V.a,K.a,n.I,n.t,n.l,h.D,n.s,n.j,h.H,h.A,h.I,h.E,Yi.a,Ji.a,er.a,v.s,n.v,h.s],encapsulation:2}),ur),hr=a("7q3d"),dr=a("Eg12");function fr(e,t){if(1&e&&l.Lb(0,"tags-update-button",11),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.ColumnValidation)("objects",a)}}function mr(e,t){if(1&e&&l.Lb(0,"dependent-items-button",12),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.Api)}}function vr(e,t){1&e&&l.Lb(0,"actions-api-button",13),2&e&&l.hc("apis",t.items)}function pr(e,t){if(1&e&&l.Lb(0,"api-status",14),2&e){var a=t.item;l.hc("apiKey",null==a?null:a.key)}}var gr,yr=((gr=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"apiSource",title:"Api Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateApis()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"editApi",value:function(e){this.router.navigate(["api-edit",e.key],{relativeTo:this.route})}},{key:"updateApis",value:function(){var e=this;if(this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihApis.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,apiSource:e.getSourceDetails(t),updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private",tags:e.hubCache.getObjectTags(c.dc.ColumnValidation,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"getSourceDetails",value:function(e){if(e.sourceType===c.gc.Table){var t=this.hubCache.getTable(e.sourceTableKey);return t?"Table: "+t.name:"Error: Table not found"}var a=this.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e.sourceDatalinkKey}));return a?"Datalink: "+a.name:"Error: Datalink not found"}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Api&&t.changeClass!==c.dc.TagObjects||e.updateApis()}))}}]),e}()).\u0275fac=function(e){return new(e||gr)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},gr.\u0275cmp=l.Eb({type:gr,selectors:[["apis"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Api's","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"apis"],[3,"apiKey"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.editApi(e)})),l.Dc(3,fr,1,2,"ng-template",3,4,l.Ec),l.Dc(5,mr,1,2,"ng-template",5,6,l.Ec),l.Dc(7,vr,1,1,"ng-template",null,7,l.Ec),l.Dc(9,pr,1,1,"ng-template",8,9,l.Ec),l.Nb(),l.Nb(),l.Lb(11,"dexih-help",10),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,p.a,m.a,hr.a,dr.a],encapsulation:2}),gr),Cr=a("v6kC");function kr(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-refresh",11),l.Vb("click",(function(){return l.vc(a),l.Zb().runDatalinks()})),l.Nb(),l.Ob(1,"dexih-button-cancel",12),l.Vb("click",(function(){return l.vc(a),l.Zb().cancel()})),l.Nb()}}function wr(e,t){if(1&e&&(l.Ob(0,"div",16),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.yb(1),l.Hc(" ",a.name," ")}}function Sr(e,t){if(1&e&&(l.Ob(0,"label",13),l.Fc(1,"Run the following datalink(s):"),l.Nb(),l.Ob(2,"div",14),l.Dc(3,wr,2,1,"div",15),l.ac(4,"fieldSort"),l.Nb()),2&e){var a=l.Zb();l.yb(3),l.hc("ngForOf",l.cc(4,1,a.datalinks,"name"))}}function Tr(e,t){if(1&e){var a=l.Pb();l.Ob(0,"span",20),l.Ob(1,"div",21),l.Ob(2,"div",18),l.Fc(3),l.Nb(),l.Nb(),l.Ob(4,"form-input",22),l.Vb("ngModelChange",(function(e){return l.vc(a),t.$implicit.value=e})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit,i=t.index;l.yb(3),l.Hc(" ",n.logicalName," "),l.yb(1),l.jc("name","column",i,""),l.hc("placeholder",n.logicalName)("ngModel",n.value)}}function Or(e,t){if(1&e&&(l.Ob(0,"div",17),l.Ob(1,"div",18),l.Fc(2," Input Values "),l.Nb(),l.Dc(3,Tr,5,4,"span",19),l.Nb()),2&e){var a=l.Zb();l.yb(3),l.hc("ngForOf",a.inputColumns)}}function Nr(e,t){if(1&e&&(l.Ob(0,"div"),l.Ob(1,"label",13),l.Fc(2,"Parameters:"),l.Nb(),l.Lb(3,"input-parameters-view",23),l.Nb()),2&e){var a=l.Zb();l.yb(3),l.hc("parameters",a.parameters)}}var Dr,xr,Fr=function(){return{standalone:!0}},Vr=((Dr=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.cancelToken=new F.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0],n=t[1];if(e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache.isLoaded()){var i=n.datalinkKeys;e.datalinks=new Array,i&&(e.inputColumns=[],e.parameters=[],i.split("|").map((function(e){return+e})).forEach((function(t){var a=e.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t}));e.datalinks.push(a),a.sourceDatalinkTable.dexihDatalinkColumns.filter((function(e){return e.isInput})).forEach((function(n){e.inputColumns.push({datalinkKey:t,datalinkName:a.name,name:n.name,logicalName:n.logicalName,dataType:n.dataType,rank:n.rank,value:n.defaultValue,defaultValue:n.defaultValue})})),a.parameters.forEach((function(t){e.parameters.findIndex((function(e){return e.name===t.name}))<0&&e.parameters.push(t)}))})))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Preview")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"runDatalinks",value:function(){this.hubService.runDatalinks(this.datalinks.map((function(e){return e.key})),this.truncateTable,this.resetIncremental,this.resetValue,this.inputColumns,this.parameters,this.cancelToken),this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Dr)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.a))},Dr.\u0275cmp=l.Eb({type:Dr,selectors:[["datalink-run"]],decls:20,vars:13,consts:[[1,"container"],["title","Datalink Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"d-flex","flex-wrap"],["class","alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"parameters"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,kr,2,0,"ng-template",null,2,l.Ec),l.Dc(4,Sr,5,4,"ng-template",null,3,l.Ec),l.Ob(6,"form"),l.Ob(7,"fieldset"),l.Ob(8,"section"),l.Ob(9,"div",4),l.Ob(10,"section",5),l.Ob(11,"form-checkbox",6),l.Vb("ngModelChange",(function(e){return t.truncateTable=e})),l.Nb(),l.Nb(),l.Nb(),l.Ob(12,"div",4),l.Ob(13,"section",5),l.Ob(14,"form-checkbox",7),l.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),l.Nb(),l.Nb(),l.Nb(),l.Ob(15,"div",4),l.Ob(16,"section",5),l.Ob(17,"form-input",8),l.Vb("ngModelChange",(function(e){return t.resetValue=e})),l.Nb(),l.Nb(),l.Nb(),l.Dc(18,Or,4,1,"div",9),l.Dc(19,Nr,4,1,"div",10),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(10),l.hc("ngModel",t.truncateTable)("ngModelOptions",l.lc(10,Fr)),l.yb(3),l.hc("ngModel",t.resetIncremental)("ngModelOptions",l.lc(11,Fr)),l.yb(3),l.hc("ngModel",t.resetValue)("ngModelOptions",l.lc(12,Fr)),l.yb(1),l.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),l.yb(1),l.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[h.P,n.I,n.t,n.u,h.A,n.s,n.v,h.D,v.t,h.s,h.b,v.s,Cr.a],pipes:[Mt.a],encapsulation:2}),Dr),Ir=a("Kj3r"),Kr=a("nlsZ"),Er=a("bRjT"),Lr=a("eOAR"),_r=a("OO45"),Pr=a("mj3h"),Mr=a("0oH3"),Ar=a("qKhg"),Rr=a("OWar"),jr=a("5Av2"),Zr=a("cSor"),Hr=a("Hd2u"),Gr=a("awqr"),qr=((xr=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e){return N.h.find((function(t){return t.key===e})).name}}]),e}()).\u0275fac=function(e){return new(e||xr)},xr.\u0275pipe=l.Jb({name:"objectTypeName",type:xr,pure:!0}),xr);function Br(e,t){if(1&e&&(l.Ob(0,"form",8),l.Ob(1,"fieldset"),l.Ob(2,"div",9),l.Ob(3,"section",10),l.Lb(4,"form-input",11),l.Nb(),l.Ob(5,"section",10),l.Lb(6,"form-select",12),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.hc("formGroup",a.searchForm),l.yb(6),l.hc("items",a.searchObjectTypes)}}function Ur(e,t){1&e&&(l.Ob(0,"div",5),l.Ob(1,"h5"),l.Fc(2,"No search results available."),l.Nb(),l.Nb())}function zr(e,t){if(1&e&&l.Lb(0,"datajob-view",27),2&e){var a=l.Zb().$implicit;l.hc("datajob",a.object)}}function Wr(e,t){if(1&e&&l.Lb(0,"datalink-view",28),2&e){var a=l.Zb().$implicit;l.hc("datalink",a.object)}}function Qr(e,t){if(1&e&&l.Lb(0,"connection-view",29),2&e){var a=l.Zb().$implicit;l.hc("connection",a.object)}}function $r(e,t){if(1&e&&l.Lb(0,"table-view",30),2&e){var a=l.Zb().$implicit;l.hc("connection",a.objectParent)("table",a.object)}}function Xr(e,t){if(1&e&&l.Lb(0,"table-column-view",31),2&e){var a=l.Zb().$implicit;l.hc("table",a.objectParent)("column",a.object)}}function Yr(e,t){if(1&e&&l.Lb(0,"columnValidation-view",32),2&e){var a=l.Zb().$implicit;l.hc("columnValidation",a.object)}}function Jr(e,t){if(1&e&&l.Lb(0,"fileFormat-view",33),2&e){var a=l.Zb().$implicit;l.hc("fileFormat",a.object)}}function eo(e,t){if(1&e&&l.Lb(0,"view-view",34),2&e){var a=l.Zb().$implicit;l.hc("view",a.object)}}function to(e,t){if(1&e&&l.Lb(0,"api-view",35),2&e){var a=l.Zb().$implicit;l.hc("api",a.object)}}function ao(e,t){if(1&e&&l.Lb(0,"dashboard-view",36),2&e){var a=l.Zb().$implicit;l.hc("dashboard",a.object)}}function no(e,t){if(1&e&&l.Lb(0,"listOfValues-view",37),2&e){var a=l.Zb().$implicit;l.hc("listOfValues",a.object)}}function io(e,t){if(1&e&&l.Lb(0,"datalinkTest-view",38),2&e){var a=l.Zb().$implicit;l.hc("datalinkTest",a.object)}}function ro(e,t){if(1&e&&(l.Ob(0,"li",13),l.Ob(1,"div"),l.Ob(2,"h5"),l.Fc(3),l.ac(4,"objectTypeName"),l.Nb(),l.Nb(),l.Ob(5,"div",14),l.Dc(6,zr,1,1,"datajob-view",15),l.Dc(7,Wr,1,1,"datalink-view",16),l.Dc(8,Qr,1,1,"connection-view",17),l.Dc(9,$r,1,2,"table-view",18),l.Dc(10,Xr,1,2,"table-column-view",19),l.Dc(11,Yr,1,1,"columnValidation-view",20),l.Dc(12,Jr,1,1,"fileFormat-view",21),l.Dc(13,eo,1,1,"view-view",22),l.Dc(14,to,1,1,"api-view",23),l.Dc(15,ao,1,1,"dashboard-view",24),l.Dc(16,no,1,1,"listOfValues-view",25),l.Dc(17,io,1,1,"datalinkTest-view",26),l.Nb(),l.Nb()),2&e){var a=t.$implicit,n=l.Zb();l.yb(3),l.Gc(l.bc(4,14,a.objectType)),l.yb(2),l.hc("ngSwitch",a.objectType),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Datajob),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Datalink),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Connection),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Table),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.TableColumn),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.ColumnValidation),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.FileFormat),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.View),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Api),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.Dashboard),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.ListOfValues),l.yb(1),l.hc("ngSwitchCase",n.eSearchObjectType.DatalinkTest)}}var oo,so,co=((oo=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.router=i,this.fb=r,this.searchObjectTypes=N.h,this.eSearchObjectType=N.l,this.isFirst=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.hubCache=t[1],!e.isFirst){e.isFirst=!1;var n=+a.searchObject;n||(n=0),e.searchForm=e.fb.group({searchString:[a.search,[]],searchObject:[n,[]]}),e.updateSearch(),e._searchSubscription&&e._searchSubscription.unsubscribe(),e._searchSubscription=e.searchForm.valueChanges.pipe(Object(Ir.a)(500)).subscribe((function(t){e.updateSearch()}))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Search")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._searchSubscription&&this._searchSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateSearch",value:function(){if(this.hubCache.isLoaded()&&(this.searchResults=this.hubCache.search(this.searchForm.value.searchString,this.searchForm.value.searchObject),history.pushState)){var e=this.hubCache.getHubUrl()+"/search",t=this.searchForm.value.searchString,a=this.searchForm.value.searchObject;t&&(e+="/"+a+"/"+t),this.router.navigateByUrl(e)}}}]),e}()).\u0275fac=function(e){return new(e||oo)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.a),l.Kb(r.e),l.Kb(n.g))},oo.\u0275cmp=l.Eb({type:oo,selectors:[["search"]],decls:8,vars:5,consts:[[1,"container-fluid"],["title","Search Results","iconClass","fa fa-lg fa-fw fa-search",3,"showCloseButton","padding","close"],[3,"formGroup",4,"ngIf"],["role","content"],["class","well",4,"ngIf"],[1,"well"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Search Term","formControlName","searchString","placeholder","Search...","iconClass","fa fa-search"],["label","Restrict to","formControlName","searchObject","itemKey","key","itemName","name",3,"items"],[1,"list-group-item"],[1,"col-xs-9",3,"ngSwitch"],[3,"datajob",4,"ngSwitchCase"],[3,"datalink",4,"ngSwitchCase"],[3,"connection",4,"ngSwitchCase"],[3,"connection","table",4,"ngSwitchCase"],[3,"table","column",4,"ngSwitchCase"],[3,"columnValidation",4,"ngSwitchCase"],[3,"fileFormat",4,"ngSwitchCase"],[3,"view",4,"ngSwitchCase"],[3,"api",4,"ngSwitchCase"],[3,"dashboard",4,"ngSwitchCase"],[3,"listOfValues",4,"ngSwitchCase"],[3,"datalinkTest",4,"ngSwitchCase"],[3,"datajob"],[3,"datalink"],[3,"connection"],[3,"connection","table"],[3,"table","column"],[3,"columnValidation"],[3,"fileFormat"],[3,"view"],[3,"api"],[3,"dashboard"],[3,"listOfValues"],[3,"datalinkTest"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,Br,7,2,"form",2),l.Ob(3,"div",3),l.Dc(4,Ur,3,0,"div",4),l.Ob(5,"div",5),l.Ob(6,"ul",6),l.Dc(7,ro,18,16,"li",7),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(1),l.hc("ngIf",t.searchForm),l.yb(2),l.hc("ngIf",!t.searchResults||0==(null==t.searchResults?null:t.searchResults.length)),l.yb(3),l.hc("ngForOf",t.searchResults))},directives:[h.P,v.t,v.s,n.I,n.t,n.l,h.D,n.s,n.j,h.E,v.x,v.y,Kr.a,Er.a,Lr.a,_r.a,Pr.a,Mr.a,Ar.a,Rr.a,jr.a,Zr.a,Hr.a,Gr.a],pipes:[qr],encapsulation:2}),oo),lo=a("RRRx"),uo=((so=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ib({type:so}),so.\u0275inj=l.Hb({factory:function(e){return new(e||so)},providers:[],imports:[[i.a,lo.a,n.C]]}),so),bo=a("SmOL");function ho(e,t){if(1&e&&l.Lb(0,"dependent-items-button",9),2&e){var a=t.item,n=l.Zb();l.hc("key",a.key)("objectType",n.eSharedObjectType.Dashboard)}}function fo(e,t){if(1&e&&l.Lb(0,"tags-update-button",10),2&e){var a=t.items,n=l.Zb();l.hc("objectType",n.eSharedObjectType.Dashboard)("objects",a)}}function mo(e,t){1&e&&l.Lb(0,"actions-dashboard-button",11),2&e&&l.hc("dashboards",t.items)}var vo,po=((vo=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateDashboards()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Dashboard Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteDashboards(e)}},{key:"updateDashboards",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDashboards.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,tags:e.hubCache.getObjectTags(c.dc.Dashboard,t.key),updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["dashboard-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddDashboard(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Dashboard - "+e[0].name+".json":"dashboards.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.Dashboard&&t.changeClass!==c.dc.TagObjects||e.updateDashboards()}))}}]),e}()).\u0275fac=function(e){return new(e||vo)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},vo.\u0275cmp=l.Eb({type:vo,selectors:[["dashboards"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Dashboards","iconClass","fa fa-lg fa-fw fa-pie-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Dashboards","path","/assets/help/reference/dashboard.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"dashboards"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,ho,1,2,"ng-template",3,4,l.Ec),l.Dc(5,fo,1,2,"ng-template",5,6,l.Ec),l.Dc(7,mo,1,1,"ng-template",null,7,l.Ec),l.Nb(),l.Nb(),l.Lb(9,"dexih-help",8),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,p.a,bo.a],encapsulation:2}),vo);function go(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-refresh",10),l.Vb("click",(function(){return l.vc(a),l.Zb().run()})),l.Nb(),l.Ob(1,"dexih-button-refresh",11),l.Vb("click",(function(){return l.vc(a),l.Zb().activate()})),l.Nb(),l.Ob(2,"dexih-button-cancel",12),l.Vb("click",(function(){return l.vc(a),l.Zb().cancel()})),l.Nb()}}function yo(e,t){if(1&e&&(l.Ob(0,"span",16),l.Fc(1),l.Nb()),2&e){var a=t.$implicit;l.yb(1),l.Hc(" ",a.name," ")}}function Co(e,t){if(1&e&&(l.Ob(0,"label",13),l.Fc(1,"Run the following datajobs(s):"),l.Nb(),l.Ob(2,"div"),l.Ob(3,"div",14),l.Dc(4,yo,2,1,"span",15),l.ac(5,"fieldSort"),l.Nb(),l.Nb()),2&e){var a=l.Zb();l.yb(4),l.hc("ngForOf",l.cc(5,1,a.datajobs,"name"))}}function ko(e,t){if(1&e&&(l.Ob(0,"div",17),l.Ob(1,"div",18),l.Fc(2," Input Parameters "),l.Nb(),l.Lb(3,"input-parameters-view",19),l.Nb()),2&e){var a=l.Zb();l.yb(3),l.hc("parameters",a.parameters)}}a("LyCD"),a("NbKI");var wo,So=function(){return{standalone:!0}},To=((wo=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.cancelToken=new F.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0],n=t[1];if(e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache.isLoaded()){var i=n.datajobKeys;e.datajobs=new Array,i&&(e.parameters=[],i.split("|").map((function(e){return+e})).forEach((function(t){var a=e.hubCache.hub.dexihDatajobs.find((function(e){return e.key===t}));e.datajobs.push(a),a.parameters.forEach((function(t){e.parameters.findIndex((function(e){return t.name===e.name}))<0&&e.parameters.push({name:t.name,value:t.value,rank:t.rank})}))})))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datajob Run")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"run",value:function(){this.hubService.runDatajobs(this.datajobs,this.truncateTable,this.resetIncremental,this.resetValue,this.parameters,this.cancelToken),this.authService.navigateUp()}},{key:"activate",value:function(){this.hubService.activateDatajobs(this.datajobs,this.parameters,this.cancelToken),this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||wo)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.a))},wo.\u0275cmp=l.Eb({type:wo,selectors:[["datajob-run"]],decls:19,vars:12,consts:[[1,"container"],["title","Datajob Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],["text","Activate Triggers",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],[3,"parameters"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Dc(2,go,3,0,"ng-template",null,2,l.Ec),l.Dc(4,Co,6,4,"ng-template",null,3,l.Ec),l.Ob(6,"form"),l.Ob(7,"fieldset"),l.Ob(8,"section"),l.Ob(9,"div",4),l.Ob(10,"section",5),l.Ob(11,"form-checkbox",6),l.Vb("ngModelChange",(function(e){return t.truncateTable=e})),l.Nb(),l.Nb(),l.Nb(),l.Ob(12,"div",4),l.Ob(13,"section",5),l.Ob(14,"form-checkbox",7),l.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),l.Nb(),l.Nb(),l.Nb(),l.Ob(15,"div",4),l.Ob(16,"section",5),l.Ob(17,"form-input",8),l.Vb("ngModelChange",(function(e){return t.resetValue=e})),l.Nb(),l.Nb(),l.Nb(),l.Dc(18,ko,4,1,"div",9),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0)("padding",!0),l.yb(10),l.hc("ngModel",t.truncateTable)("ngModelOptions",l.lc(9,So)),l.yb(3),l.hc("ngModel",t.resetIncremental)("ngModelOptions",l.lc(10,So)),l.yb(3),l.hc("ngModel",t.resetValue)("ngModelOptions",l.lc(11,So)),l.yb(1),l.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[h.P,n.I,n.t,n.u,h.A,n.s,n.v,h.D,v.t,h.s,h.b,v.s,Cr.a],pipes:[Mt.a],encapsulation:2}),wo);function Oo(e,t){if(1&e&&l.Lb(0,"save-button",17),2&e){var a=l.Zb(3);l.hc("formsService",a.formsService)}}function No(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-invalid-form-details",14),l.Vb("click",(function(){return l.vc(a),l.Zb(2).formsService.showErrors()})),l.Nb(),l.Dc(1,Oo,1,1,"save-button",15),l.Lb(2,"cancel-button",16)}if(2&e){var n=l.Zb(2);l.hc("control",n.formsService.currentForm),l.yb(1),l.hc("ngIf",n.hubCache.canWrite),l.yb(1),l.hc("formsService",n.formsService)}}function Do(e,t){if(1&e&&(l.Ob(0,"section",8),l.Ob(1,"form-select",18),l.Lb(2,"table-edit-button",19),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),l.yb(1),l.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function xo(e,t){if(1&e&&(l.Ob(0,"section",8),l.Ob(1,"form-select",20),l.Lb(2,"datalink-edit-button",19),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(1),l.hc("errors",null==a.errors?null:a.errors.sourceDatalinkKey)("items",a.datalinks),l.yb(1),l.hc("key",a.formsService.currentForm.controls.sourceDatalinkKey.value)}}function Fo(e,t){if(1&e&&(l.Ob(0,"div",7),l.Ob(1,"section",21),l.Lb(2,"form-select",22),l.Nb(),l.Ob(3,"section",21),l.Lb(4,"form-select",23),l.Nb(),l.Ob(5,"section",21),l.Lb(6,"form-select",24),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(2),l.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1),l.yb(2),l.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1),l.yb(2),l.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1)}}function Vo(e,t){1&e&&l.Lb(0,"form-input",29)}function Io(e,t){if(1&e&&(l.Ob(0,"div",7),l.Ob(1,"section",25),l.Ob(2,"div",26),l.Lb(3,"form-checkbox",27),l.Dc(4,Vo,1,0,"form-input",28),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.yb(3),l.hc("border",!0),l.yb(1),l.hc("ngIf",a.formsService.currentForm.controls.cache.value)}}function Ko(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button",32),l.Vb("click",(function(){return l.vc(a),l.Zb(3).add(-1)})),l.Fc(1,"Insert Item"),l.Nb(),l.Ob(2,"dexih-button-delete",33),l.Vb("click",(function(){return l.vc(a),l.Zb(3).clear()})),l.Nb()}}function Eo(e,t){if(1&e){var a=l.Pb();l.Ob(0,"form",34),l.Ob(1,"div",35),l.Ob(2,"div",36),l.Lb(3,"form-input",37),l.Nb(),l.Ob(4,"div",36),l.Lb(5,"form-input",38),l.Nb(),l.Ob(6,"div",36),l.Lb(7,"form-input",39),l.Nb(),l.Ob(8,"div",40),l.Ob(9,"button",41),l.Vb("click",(function(){l.vc(a);var e=t.index;return l.Zb(3).add(e)})),l.Lb(10,"i",42),l.Nb(),l.Ob(11,"button",43),l.Vb("click",(function(){l.vc(a);var e=t.index;return l.Zb(3).remove(e)})),l.Lb(12,"i",44),l.Nb(),l.Nb(),l.Nb(),l.Nb()}2&e&&(l.hc("formGroup",t.$implicit),l.yb(3),l.hc("border",!1),l.yb(2),l.hc("border",!1),l.yb(2),l.hc("border",!1))}function Lo(e,t){if(1&e&&(l.Ob(0,"dexih-widget-section",30),l.Dc(1,Ko,3,0,"ng-template",null,3,l.Ec),l.Dc(3,Eo,13,4,"form",31),l.Nb()),2&e){var a=l.Zb(2);l.hc("showExpandButton",!0),l.yb(3),l.hc("ngForOf",a.formsService.currentForm.controls.staticData.controls)}}function _o(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",49),l.Ob(1,"dexih-button-refresh",50),l.Vb("click",(function(){return l.vc(a),l.Zb(3).refreshData()})),l.Nb(),l.Nb()}2&e&&(l.yb(1),l.hc("autoCompact",!1))}function Po(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-refresh",53),l.Vb("click",(function(){return l.vc(a),l.Zb(4).refreshData()})),l.Nb()}}function Mo(e,t){if(1&e&&(l.Ob(0,"dexih-table",51),l.Dc(1,Po,1,0,"ng-template",null,52,l.Ec),l.Nb()),2&e){var a=l.Zb(3);l.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",a.columns)("data",a.data)}}function Ao(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-widget-section",45),l.Ob(1,"query-builder",46),l.Vb("hasChanged",(function(){return l.vc(a),l.Zb(2).hasChanged()}))("onRefreshData",(function(){return l.vc(a),l.Zb(2).refreshData()})),l.Nb(),l.Nb(),l.Dc(2,_o,2,1,"div",47),l.Dc(3,Mo,3,4,"dexih-table",48)}if(2&e){var n=l.Zb(2);l.hc("showExpandButton",!0),l.yb(1),l.hc("selectQuery",n.formsService.currentForm.controls.selectQuery.value)("columns",n.tableColumns)("inputColumns",n.inputColumns)("parameters",null)("refreshEvent",n.refreshDataSubject.asObservable()),l.yb(1),l.hc("ngIf",!n.data),l.yb(1),l.hc("ngIf",n.data)}}function Ro(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",1),l.Ob(1,"dexih-widget",2),l.Vb("close",(function(){return l.vc(a),l.Zb().close()})),l.Dc(2,No,3,3,"ng-template",null,3,l.Ec),l.Ob(4,"form",4),l.Ob(5,"fieldset"),l.Ob(6,"section"),l.Lb(7,"form-input",5),l.Nb(),l.Ob(8,"section"),l.Lb(9,"form-textarea",6),l.Nb(),l.Ob(10,"section"),l.Ob(11,"div",7),l.Ob(12,"section",8),l.Lb(13,"form-select",9),l.Nb(),l.Dc(14,Do,3,3,"section",10),l.Dc(15,xo,3,3,"section",10),l.Nb(),l.Dc(16,Fo,7,9,"div",11),l.Dc(17,Io,5,2,"div",11),l.Nb(),l.Nb(),l.Nb(),l.Dc(18,Lo,4,2,"dexih-widget-section",12),l.Dc(19,Ao,4,8,"ng-template",13),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.yb(1),l.hc("showCloseButton",!0)("padding",!1),l.yb(3),l.hc("formGroup",n.formsService.currentForm),l.yb(3),l.hc("autocapitalize",n.on)("errors",n.formsService.formErrors.name),l.yb(2),l.hc("showMarkdown",!0),l.yb(4),l.hc("items",n.sourceTypes)("enableFilter",!1),l.yb(1),l.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Table),l.yb(1),l.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Datalink),l.yb(1),l.hc("ngIf",n.tableColumns),l.yb(1),l.hc("ngIf",n.tableColumns),l.yb(1),l.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Static),l.yb(1),l.hc("ngIf",n.formsService.currentForm.value.sourceType!==n.eLOVObjectType.Static)}}var jo,Zo=((jo=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1,this.refreshDataSubject=new zi.a,this.cancelToken=new F.a,this.eLOVObjectType=c.Qb,this.connectionTables=[],this.datalinks=[],this.sourceTypes=c.Rb.filter((function(e){return e.key>0})),this.columns=[{name:"key",title:"Key"},{name:"name",title:"Name"},{name:"description",title:"Description"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.pageTitle=a.pageTitle,e.action=a.action,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Edit List Of Values")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._sourceChangeSubscription&&this._sourceChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks,"edit"===this.action)if(this.listOfValuesKey=+this.params.listOfValuesKey,this.listOfValuesKey)if(this.hubCache.hub&&this.hubCache.hub.dexihListOfValues){var t=this.hubCache.hub.dexihListOfValues.find((function(t){return t.key===e.listOfValuesKey}));t.selectQuery||(t.selectQuery=new c.V),this.formsService.listOfValues(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no list of values specified to edit.");if("new"===this.action){var a=new c.E;a.selectQuery=new c.V,this.formsService.listOfValues(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/listOfValues-new","/listOfValues-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.refreshColumns();var n=this.formsService.currentForm;this._sourceChangeSubscription=Object(Wi.a)(n.controls.sourceType.valueChanges,n.controls.sourceTableKey.valueChanges,n.controls.sourceDatalinkKey.valueChanges).subscribe((function(){e.refreshColumns()}))}},{key:"refreshColumns",value:function(){var e=this.formsService.currentForm;switch(e.controls.sourceType.value){case c.Qb.Datalink:var t=e.controls.sourceDatalinkKey.value,a=this.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t}));if(a){var n=new Qi.b;n.buildInputOutput(this.hubCache,a),this.tableColumns=n.getDatalinkOutputColumns(a)}else t>0&&this.hubService.addHubErrorMessage("The datalink with the key ".concat(t," could not be found.")),this.tableColumns=null;break;case c.Qb.Table:var i=e.controls.sourceTableKey.value,r=this.hubCache.hub.dexihTables.find((function(e){return e.key===i}));r?this.tableColumns=r.dexihTableColumns:(i>0&&this.hubService.addHubErrorMessage("The table with the key ".concat(i," could not be found.")),this.tableColumns=null)}}},{key:"refreshData",value:function(){var e=this;this.hubService.previewListOfValues(this.formsService.currentForm.value,!0,this.cancelToken).then((function(t){e.data=t,e.refreshDataSubject.next()})).catch((function(t){e.hubService.addHubMessage(t)}))}},{key:"hasChanged",value:function(){}},{key:"add",value:function(e){var t=this.formsService.currentForm,a=this.formsService.listOfValuesItem(new c.R);t.controls.staticData.insert(e+1,a)}},{key:"remove",value:function(e){this.formsService.currentForm.controls.staticData.removeAt(e)}},{key:"clear",value:function(){for(var e=this.formsService.currentForm.controls.staticData;e.controls.length>0;)e.removeAt(0)}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||jo)(l.Kb(u.a),l.Kb(b.a),l.Kb(D.a),l.Kb(r.a),l.Kb(r.e))},jo.\u0275cmp=l.Eb({type:jo,selectors:[["dexih-listOfValues-edit-form"]],features:[l.xb([D.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit List of Values","iconClass","fa fa-lg fa-list-alt",3,"showCloseButton","padding","close"],["header",""],[1,"m-3",3,"formGroup"],["label","List of Values","formControlName","name","placeholder","Enter the list of values name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["class","form-row",4,"ngIf"],["title","Static Values",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],[1,"form-group","col-md-4"],["label","Key Column","formControlName","keyColumn","itemKey","name","itemName","name","iconClass","fa fa-key",3,"items","allowNullSelect","enableFilter"],["label","Name Column","formControlName","nameColumn","itemKey","name","itemName","name","iconClass","fa fa-circle-o",3,"items","allowNullSelect","enableFilter"],["label","Description Column","formControlName","descriptionColumn","itemKey","name","itemName","name","iconClass","fa fa-comment-o",3,"items","allowNullSelect","enableFilter"],[1,"form-group","col-md-12"],[1,"d-flex","flex-wrap","pt-1"],["label","Cache Lookup","formControlName","cache",1,"input-group-prepend",3,"border"],["type","number","class","pl-1","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",4,"ngIf"],["type","number","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",1,"pl-1"],["title","Static Values",3,"showExpandButton"],["class","flex-fill",3,"formGroup",4,"ngFor","ngForOf"],["iconClass","fa fa-plus",1,"mr-1",3,"click"],["text","Clear All",3,"click"],[1,"flex-fill",3,"formGroup"],[1,"input-group"],[1,"form-control","p-0"],["formControlName","key","type","text","placeholder","Key Value",3,"border"],["formControlName","name","type","text","placeholder","Item name",3,"border"],["formControlName","key","type","text","placeholder","Description",3,"border"],[1,"input-group-append","flex-shrink-1","ml-1"],["type","button","value","Add",1,"btn","btn-light",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-light",3,"click"],[1,"fa","fa-minus-square-o"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],["class","m-3",4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data",4,"ngIf"],[1,"m-3"],["text","Reload",3,"autoCompact","click"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&l.Dc(0,Ro,20,14,"div",0),2&e&&l.hc("ngIf",t.formsService.currentForm)},directives:[v.t,h.P,n.I,n.t,n.l,h.D,n.s,n.j,h.H,h.E,I.a,V.a,K.a,Yi.a,Ji.a,h.A,h.T,v.s,h.f,h.g,$i.a,h.s,d.a],encapsulation:2}),jo),Ho=function(e){return["listOfValues-edit",e]};function Go(e,t){if(1&e&&(l.Lb(0,"dexih-button-edit",8),l.Lb(1,"dependent-items-button",9)),2&e){var a=t.item,n=l.Zb();l.hc("routerLink",l.mc(3,Ho,a.key)),l.yb(1),l.hc("key",a.key)("objectType",n.eSharedObjectType.ListOfValues)}}function qo(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",10),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().delete(e)})),l.Nb()}}function Bo(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",10),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb(),l.Dc(1,qo,1,0,"dexih-button-delete",11),l.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=l.Zb();l.yb(1),l.hc("ngIf",i.hubCache.canWrite),l.yb(1),l.hc("objectType",i.eSharedObjectType.ListOfValues)("objects",n)}}var Uo=function(){return["listOfValues-new"]};function zo(e,t){1&e&&l.Lb(0,"dexih-button-new",14),2&e&&l.hc("routerLink",l.lc(1,Uo))}function Wo(e,t){if(1&e&&l.Dc(0,zo,1,2,"dexih-button-new",13),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite)}}var Qo,$o=((Qo=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"sourceType",title:"Source Type",format:"Enum",enum:c.Qb},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(s.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Hub List of Values Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteListOfValues(e)}},{key:"update",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihListOfValues.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.ListOfValues,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["listOfValues-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");a.dexihListOfValues=e,e.forEach((function(e){t.getListOfValuesCache(e,a)})),this.hubService.exportHub(a,"list_of_values.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.ListOfValues&&t.changeClass!==c.dc.TagObjects||e.update()}))}}]),e}()).\u0275fac=function(e){return new(e||Qo)(l.Kb(u.a),l.Kb(b.a),l.Kb(r.e),l.Kb(r.a))},Qo.\u0275cmp=l.Eb({type:Qo,selectors:[["listOfValues"]],decls:9,vars:7,consts:[[1,"container-fluid"],["title","List Of Values","iconClass","fa fa-lg fa-fw fa-list-alt",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"ml-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,Go,2,5,"ng-template",3,4,l.Ec),l.Dc(5,Bo,3,3,"ng-template",5,6,l.Ec),l.Dc(7,Wo,1,1,"ng-template",null,7,l.Ec),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.j,r.f,m.a,h.u,v.t,p.a,h.g,h.o],encapsulation:2}),Qo),Xo=a("R0Ic"),Yo=a("Xjf6");function Jo(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-edit",12),l.Vb("click",(function(){l.vc(a);var e=l.Zb();return e.edit(e.item)})),l.Nb()}}function es(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-delete",12),l.Vb("click",(function(){l.vc(a);var e=l.Zb().items;return l.Zb().delete(e)})),l.Nb()}}function ts(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-save-local",12),l.Vb("click",(function(){l.vc(a);var e=t.items;return l.Zb().export(e)})),l.Nb(),l.Dc(1,es,1,0,"dexih-button-delete",13)}if(2&e){var n=l.Zb();l.yb(1),l.hc("ngIf",n.hubCache.canWrite)}}function as(e,t){if(1&e){var a=l.Pb();l.Ob(0,"dexih-button-new",12),l.Vb("click",(function(){return l.vc(a),l.Zb(2).new()})),l.Nb()}}function ns(e,t){if(1&e&&l.Dc(0,as,1,0,"dexih-button-new",13),2&e){var a=l.Zb();l.hc("ngIf",a.hubCache.canWrite)}}var is=function(e){return{"background-color":e,"margin-bottom":"0"}};function rs(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",14),l.Vb("click",(function(){l.vc(a);var e=t.item;return l.Zb().edit(e)})),l.Ob(1,"span",15),l.Fc(2),l.Nb(),l.Nb()}if(2&e){var n=t.item;l.hc("ngStyle",l.mc(2,is,n.color)),l.yb(2),l.Gc(n.name)}}function os(e,t){if(1&e){var a=l.Pb();l.Ob(0,"button",35),l.Vb("click",(function(){l.vc(a);var e=t.$implicit;return l.Zb(3).selectColor(e)})),l.Nb()}2&e&&l.Cc("background-color",t.$implicit.color)}function ss(e,t){if(1&e&&(l.Ob(0,"form",21),l.Ob(1,"div",22),l.Ob(2,"section",23),l.Lb(3,"form-input",24),l.Nb(),l.Ob(4,"section",25),l.Ob(5,"div"),l.Ob(6,"label",26),l.Fc(7,"Color"),l.Nb(),l.Ob(8,"div",27),l.Ob(9,"label",28),l.Lb(10,"input",29),l.Nb(),l.Lb(11,"form-input",30),l.Ob(12,"div",31),l.Dc(13,os,1,2,"button",32),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(14,"div",22),l.Ob(15,"section",33),l.Lb(16,"form-textarea",34),l.Nb(),l.Nb(),l.Nb()),2&e){var a=l.Zb(2);l.hc("formGroup",a.formsService.currentForm),l.yb(3),l.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),l.yb(6),l.Cc("background-color",a.formsService.currentForm.controls.color.value),l.yb(4),l.hc("ngForOf",a.colors),l.yb(3),l.hc("showMarkdown",!0)}}function cs(e,t){if(1&e){var a=l.Pb();l.Ob(0,"div",16),l.Ob(1,"div",17),l.Ob(2,"b"),l.Fc(3,"Add/Edit Tag"),l.Nb(),l.Nb(),l.Ob(4,"div",18),l.Dc(5,ss,17,7,"form",19),l.Nb(),l.Ob(6,"div",20),l.Ob(7,"dexih-button-save",12),l.Vb("click",(function(){return l.vc(a),l.Zb().save()})),l.Nb(),l.Ob(8,"dexih-button-cancel",12),l.Vb("click",(function(){return l.vc(a),l.Zb().cancel()})),l.Nb(),l.Nb(),l.Nb()}if(2&e){var n=l.Zb();l.hc("@slideDown",n.state),l.yb(5),l.hc("ngIf",n.formsService.currentForm)}}var ls,us,bs={path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"Detailed Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"Child Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"GrandChild Result"}}]}]}]},hs=[{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"table-new",data:{pageTitle:"New Table",action:"new"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"table-new/:connectionKey",data:{pageTitle:"New Table",action:"new"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Qt,data:{action:"new",pageTitle:"New Datalink"}},{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}}],ds=[{path:"datalink-edit",loadChildren:function(){return Promise.all([a.e(1),a.e(14)]).then(a.bind(null,"8Hfl")).then((function(e){return e.DatalinkEditModule}))}},{path:"datalink-preview/:datalinkKey/:previewUpdates",component:Xt,data:{pageTitle:"Preview Datalink"}},{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}},{path:"datalink-run/:datalinkKeys",component:Vr,data:{pageTitle:"Run Datalink"}},bs],fs={path:"tables",data:{pageTitle:"Tables"},children:[{path:"",pathMatch:"full",component:Wn,data:{pageTitle:"Tables"}},{path:"",children:hs},{path:"",children:ds}]},ms=[{path:"connection-edit/:connectionKey",component:Pe,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Connection"}},{path:"connection-import/:connectionKey",data:{pageTitle:"Import Tables"},children:[{path:"",pathMatch:"full",component:Be,data:{pageTitle:"Import Tables"}},{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Qt,data:{action:"new",pageTitle:"New Datalink"}}]},{path:"connection-new/:purpose",component:Pe,data:{action:"new",pageTitle:"New Connection"}},{path:"connection-copy/:connectionKey",component:Pe,data:{action:"copy",pageTitle:"New Connection"}}],vs=[{path:"",pathMatch:"full",component:cn,data:{pageTitle:"Remote Agents"}},{path:"agent-edit/:remoteAgentKey/:remoteAgentHubKey",component:vn,data:{pageTitle:"Edit Agent"}}],ps=[{path:"results",data:{pageTitle:"Execution Results"},children:[{path:"",pathMatch:"full",component:pn.a,data:{pageTitle:"Execution Results"}},bs]},bs],gs=[{path:"customFunction-edit/:customFunctionKey",component:xi,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Custom Function"}},{path:"customFunction-new",component:xi,data:{action:"new",pageTitle:"New Custom Function"}}],ys=[{path:"columnValidation-edit/:validationKey",component:W,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Validation"}},{path:"columnValidation-new",component:W,data:{action:"new",pageTitle:"New Validation"}}],Cs=[{path:"fileFormat-edit/:fileFormatKey",component:Yt.a,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit FileFormat"}},{path:"fileFormat-new",component:Yt.a,data:{action:"new",pageTitle:"New FileFormat"}}],ks=[{path:"view-edit/:viewKey",component:Bi.a,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit View"}},{path:"view-new",component:Bi.a,data:{action:"new",pageTitle:"New View"}}],ws=[{path:"dashboard-edit/:dashboardKey",data:{pageTitle:"Edit Dashboard",action:"edit"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}},{path:"dashboard-new",data:{pageTitle:"New Dashboard",action:"new"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}}],Ss=[{path:"listOfValues-edit/:listOfValuesKey",component:Zo,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit List Of Values"}},{path:"listOfValues-new",component:Zo,data:{action:"new",pageTitle:"New List of Values"}}],Ts=[{path:"api-edit/:apiKey",component:br,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Api"}},{path:"api-new",component:br,data:{action:"new",pageTitle:"New Api"}}],Os=[{path:"hubVariable-edit/:hubVariableKey",component:Ha,data:{action:"edit",pageTitle:"Edit Hub Variable"}},{path:"hubVariable-new",component:Ha,data:{action:"new",pageTitle:"New Hub Variable"}}],Ns=[{path:"datalinkTest-edit/:datalinkTestKey",data:{pageTitle:"Edit Datalink Test",action:"edit"},loadChildren:function(){return a.e(6).then(a.bind(null,"3ZyD")).then((function(e){return e.DatalinkTestEditModule}))}},{path:"datalinkTest-new",data:{pageTitle:"New Datalink Test",action:"new"},loadChildren:function(){return a.e(6).then(a.bind(null,"3ZyD")).then((function(e){return e.DatalinkTestEditModule}))}},{path:"datalinkTest-new/:datalinkKeys",component:qi,data:{pageTitle:"New Datalink Test",action:"new"}},bs],Ds=[{path:"manage",children:[{path:"",component:xa,data:{action:"edit",pageTitle:"Manage Files"}},{path:":tableKey",data:{action:"edit",pageTitle:"Manage Files"},children:[{path:"",component:xa,data:{action:"edit",pageTitle:"Manage Files"}},{path:"file-preview/:path/:fileName",component:Qn,data:{pageTitle:"Preview File"}}]}]},{path:"bulk-load",children:[{path:"",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:function(){return Promise.all([a.e(1),a.e(0),a.e(5)]).then(a.bind(null,"xgYh")).then((function(e){return e.FilesBulkLoadModule}))}},{path:":connectionKey",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:function(){return Promise.all([a.e(1),a.e(0),a.e(5)]).then(a.bind(null,"xgYh")).then((function(e){return e.FilesBulkLoadModule}))}}]}],xs=[{path:"datajob-edit/:datajobKey",data:{pageTitle:"Edit Data Job",action:"edit"},loadChildren:function(){return a.e(4).then(a.bind(null,"geWG")).then((function(e){return e.DatajobEditModule}))}},{path:"datajob-new",data:{pageTitle:"New Data Job",action:"new"},loadChildren:function(){return a.e(4).then(a.bind(null,"geWG")).then((function(e){return e.DatajobEditModule}))}},{path:"datajob-run/:datajobKeys",component:To,data:{pageTitle:"Run datajobs"}}],Fs=r.i.forChild([{path:"agents",data:{pageTitle:"Remote Agents"},children:vs},{path:"connections",data:{pageTitle:"Connections"},children:[{path:"",pathMatch:"full",component:tt,data:{pageTitle:"Connections"}},{path:"",children:ms},fs]},{path:"datalinks",data:{pageTitle:"Data Links"},children:[{path:"",pathMatch:"full",data:{pageTitle:"Data Links"},component:Pt},{path:"",children:ds},{path:"",children:ps}]},fs,{path:"datajobs",data:{pageTitle:"Data Jobs"},children:[{path:"",pathMatch:"full",component:Ot},{path:"",children:xs},{path:"",children:ps}]},{path:"columnValidations",data:{pageTitle:"Column Validations"},children:[{path:"",pathMatch:"full",component:O},{path:"",children:ys}]},{path:"customFunctions",data:{pageTitle:"Custom Functions"},children:[{path:"",pathMatch:"full",component:ni},{path:"",children:gs}]},{path:"fileFormats",data:{pageTitle:"File Formats"},children:[{path:"",pathMatch:"full",component:Yt.b},{path:"",children:Cs}]},{path:"views",data:{pageTitle:"Views"},children:[{path:"",pathMatch:"full",component:Ui.a},{path:"",children:ks}]},{path:"dashboards",data:{pageTitle:"Dashboards"},children:[{path:"",pathMatch:"full",component:po},{path:"",children:ws}]},{path:"listOfValues",data:{pageTitle:"List of Values"},children:[{path:"",pathMatch:"full",component:$o},{path:"",children:Ss}]},{path:"apis",data:{pageTitle:"Apis"},children:[{path:"",pathMatch:"full",component:yr},{path:"",children:Ts}]},{path:"hubVariables",data:{pageTitle:"Hub Variables"},children:[{path:"",pathMatch:"full",component:Ma},{path:"",children:Os}]},{path:"manage",children:[{path:"manage-users",component:Qa,data:{pageTitle:"Manage Users"}}]},{path:"import",children:[{path:"",pathMatch:"full",component:ht,data:{pageTitle:"Import Objects"}}]},{path:"export",children:[{path:"",pathMatch:"full",component:pt,data:{pageTitle:"Export Objects"}}]},{path:"sharedData",data:{pageTitle:"Shared Data"},children:[{path:"",pathMatch:"full",component:Vn},{path:"",children:[{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}},{path:"datalink-preview/:datalinkKey",component:Xt,data:{pageTitle:"Preview Datalink"}},{path:"dashboard-preview/:dashboardKey",data:{pageTitle:"Preview Dashboard",action:"edit"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}},{path:"view-preview/:viewKey",component:Bi.a,data:{pageTitle:"Preview View",action:"edit"}},{path:"api-preview/:apiKey",component:br,data:{pageTitle:"Preview Api",action:"edit"}}]}]},{path:"files",data:{pageTitle:"Files"},children:[{path:"",children:Ds}]},{path:"datalinkTests",data:{pageTitle:"Datalink Tests"},children:[{path:"",pathMatch:"full",component:Pi},{path:"",children:Ns},{path:"",children:ps}]},{path:"tags",component:(ls=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.formsService=i,this.route=r,this.state="hide",this.colors=[{name:"primary",color:"#3a5f8d"},{name:"secondary",color:"#89B3BF"},{name:"success",color:"#479762"},{name:"warning",color:"#c4872a"},{name:"danger",color:"#f44336"},{name:"yellow",color:"yellow"},{name:"pink",color:"pink"},{name:"purple",color:"purple"},{name:"dark",color:"#1F2624"}],this.columns=[{name:"name",title:"Name",footer:"description",format:"Md"}],this._tableData=new o.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(s.a)(this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.hubCache=t[1],a.key){var n=e.hubCache.hub.dexihTags.find((function(e){return e.key===+a.key}));if(n){var i=e.hubCache.hub.dexihTags.find((function(e){return e.key===n.key}));e.formsService.tag(i),e.state="show"}}e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"update",value:function(){if(this.hubCache&&this.hubCache.isLoaded()){var e=this.hubCache.hub.dexihTags.filter((function(e){return e.isValid})).map((function(e){return{key:e.key,name:e.name,description:e.description,color:e.color,updateDate:e.updateDate}}));this._tableData.next(e)}else this._tableData.next(null)}},{key:"new",value:function(){var e=new c.J;this.formsService.tag(e),this.state="show"}},{key:"edit",value:function(e){var t=this.hubCache.hub.dexihTags.find((function(t){return t.key===e.key}));this.formsService.tag(t),this.state="show",history.pushState&&this.router.navigateByUrl(window.location.pathname+"?key="+e.key),document.body.scrollTop=0,document.documentElement.scrollTop=0}},{key:"delete",value:function(e){this.hubService.deleteTags(e)}},{key:"save",value:function(){var e=this;this.formsService.save(!1).then((function(){e.hide()})).catch()}},{key:"cancel",value:function(){this.hide()}},{key:"hide",value:function(){this.state="hide",history.pushState&&window.location.search&&this.router.navigateByUrl(window.location.pathname)}},{key:"selectColor",value:function(e){this.formsService.currentForm.controls.color.setValue(e.color)}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddTag(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Tag - "+e[0].name+".json":"tags.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===c.dc.Tags&&e.update()}))}}]),e}(),ls.\u0275fac=function(e){return new(e||ls)(l.Kb(Yo.a),l.Kb(b.a),l.Kb(r.e),l.Kb(D.a),l.Kb(r.a))},ls.\u0275cmp=l.Eb({type:ls,selectors:[["tags"]],features:[l.xb([D.a])],decls:14,vars:6,consts:[[1,"container-fluid"],["title","Tags","iconClass","fa fa-lg fa-fw fa-tags",3,"showCloseButton","close"],["rowStatusHeading","Color",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["tableHeader",""],["title","Views","path","/assets/help/reference/tag.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"alert","p-1","text-center",3,"ngStyle","click"],[1,"blend-text","font-weight-bold"],[1,"card","mt-2",2,"width","100%"],[1,"card-header","text-white","bg-primary"],[1,"card-body"],[3,"formGroup",4,"ngIf"],[1,"card-footer"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-3"],["label","Tag Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],[1,"form-group","col-md-9"],[1,"mt-1"],[1,"input-group","m-0"],[1,"btn","mr-1",2,"height","38px","width","76px"],["formControlName","color","hidden","","type","color"],["formControlName","color","placeholder","color",1,"mr-3",2,"height","38px","width","90px"],["data-toggle","buttons",1,"btn-group-toggle"],["class","btn mr-1","style","height: '38px'; width: '38px'",3,"background-color","click",4,"ngFor","ngForOf"],[1,"col-md-12"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"btn","mr-1",2,"height","38px","width","38px",3,"click"]],template:function(e,t){1&e&&(l.Ob(0,"div",0),l.Ob(1,"dexih-widget",1),l.Vb("close",(function(){return t.close()})),l.Ob(2,"dexih-table",2),l.Vb("rowClick",(function(e){return t.edit(e)})),l.Dc(3,Jo,1,0,"ng-template",3,4,l.Ec),l.Dc(5,ts,2,1,"ng-template",5,6,l.Ec),l.Dc(7,ns,1,1,"ng-template",null,7,l.Ec),l.Dc(9,rs,3,4,"ng-template",8,9,l.Ec),l.Dc(11,cs,9,2,"ng-template",null,10,l.Ec),l.Nb(),l.Nb(),l.Lb(13,"dexih-help",11),l.Nb()),2&e&&(l.yb(1),l.hc("showCloseButton",!0),l.yb(1),l.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,$.a,h.j,h.u,v.t,h.g,h.o,v.w,h.t,h.b,n.I,n.t,n.l,h.D,n.s,n.j,n.c,v.s,h.H],encapsulation:2,data:{animation:[Object(Xo.j)("slideDown",[Object(Xo.g)("hide",Object(Xo.h)({height:0,overflow:"hidden"})),Object(Xo.g)("show",Object(Xo.h)({height:"*",overflow:"unset"})),Object(Xo.i)("hide <=> show",Object(Xo.e)("200ms ease-in"))])]}}),ls)},{path:"search",data:{pageTitle:"Search"},children:[{path:"",pathMatch:"full",redirectTo:"0/"},{path:":searchObject/:search",pathMatch:"full",component:co},{path:":searchObject/:search",loadChildren:function(){return Promise.resolve().then(a.bind(null,"e1St")).then((function(e){return e.HubBaseModule}))}}]},{path:"",children:ms},{path:"",children:ds},{path:"",children:hs},{path:"",children:xs},{path:"",children:ps},{path:"",children:gs},{path:"",children:ys},{path:"",children:Cs},{path:"",children:ks},{path:"",children:ws},{path:"",children:Ss},{path:"",children:Ts},{path:"",children:Os},{path:"",children:Ds},{path:"",children:vs},{path:"",children:Ns}]),Vs=a("mCXf"),Is=((us=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[u.a,Fi.a]}}}]),e}()).\u0275mod=l.Ib({type:us}),us.\u0275inj=l.Hb({factory:function(e){return new(e||us)},providers:[Fi.a],imports:[[i.a,Fs,n.C,lo.a,Vs.a,uo]]}),us)},mCXf:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("PCNd"),i=a("RRRx"),r=a("fXoL"),o=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[n.a,i.a]]}),e}()},wTS4:function(e,t,a){"use strict";a.d(t,"a",(function(){return N})),a.d(t,"b",(function(){return we}));var n=a("2Vo4"),i=a("itXk"),r=a("3WyZ"),o=a("soiQ"),s=a("fXoL"),c=a("4Y1E"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("3Pt+"),d=a("ofXK"),f=a("Npcx");function m(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",9),s.Ob(1,"div",10),s.Ob(2,"dexih-button-refresh",11),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(3,"input",12),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().rows=e})),s.Nb(),s.Nb(),s.Ob(4,"div",13),s.Ob(5,"form-select",14),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().auditType=e})),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.yb(3),s.hc("ngModel",n.rows),s.yb(2),s.hc("ngModel",n.auditType)("border",!1)("items",n.auditTypes)("enableTextEntry",!1)("allowNullSelect",!0)}}function v(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",17),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datalinks=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datalinks)("items",n.hubCache.hub.dexihDatalinks)("enableAddAll",!0)}}function p(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",18),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datajobs=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datajobs)("items",n.hubCache.hub.dexihDatajobs)("enableAddAll",!0)}}function g(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",19),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datalinkTests=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datalinkTests)("items",n.hubCache.hub.dexihDatalinkTests)("enableAddAll",!0)}}function y(e,t){if(1&e&&(s.Dc(0,v,2,3,"div",15),s.Dc(1,p,2,3,"div",15),s.Dc(2,g,2,3,"div",15)),2&e){var a=s.Zb();s.hc("ngIf","Datalink"===a.auditType),s.yb(1),s.hc("ngIf","Datajob"===a.auditType),s.yb(1),s.hc("ngIf","DatalinkTest"===a.auditType)}}var C=function(e,t){return[e,"datalink-edit","edit",t]},k=function(e,t){return["result-view",e,t]};function w(e,t){if(1&e&&(s.Lb(0,"dexih-button-edit",20),s.Lb(1,"dexih-button-view",21)),2&e){var a=t.item,n=s.Zb();s.hc("routerLink",s.nc(2,C,n.hubPath,a.referenceKey)),s.yb(1),s.hc("routerLink",s.nc(5,k,a.auditConnectionKey,a.auditKey))}}function S(e,t){1&e&&s.Lb(0,"datalink-status",22),2&e&&s.hc("writerResult",t.item)}var T,O,N=((T=function(){function e(t,a,i){_classCallCheck(this,e),this.hubService=t,this.router=a,this.route=i,this.rows=20,this.cancelToken=new r.a,this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"auditKey",title:"#",format:""},{name:"auditType",title:"Type",format:""},{name:"referenceName",title:"Name",format:""},{name:"rowsTotal",title:"Rows Total",format:""},{name:"startTime",title:"Start Date",format:"Calendar"},{name:"startTime",title:"Time",format:"Time"},{name:"endTime",title:"Finished At",format:"Time"},{name:"message",title:"Message",format:""}],this.auditTypes=["Datalink","Datajob","DatalinkTest"],this._tableData=new n.a(null),this.tableData=this._tableData.asObservable(),this.datalinks=[],this.datajobs=[],this.datalinkTests=[],this.auditType=null}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3];var n=t[4];if(e.showPage=!1,e.showPageMessage="Waiting for an active remote agent...",e.hubCache.isLoaded()&&n){e.hubPath=e.hubCache.getHubUrl();var i=a.datalinkKeys,r=a.datajobKeys,o=a.datalinkTestKeys;i&&(e.datalinks=(i+"").split(",").map((function(e){return+e})),e.auditType="Datalink"),r&&(e.datajobs=(r+"").split(",").map((function(e){return+e})),e.auditType="Datajob"),o&&(e.datalinkTests=(o+"").split(",").map((function(e){return+e})),e.auditType="DatalinkTest"),e.refresh(),e.showPage=!0,e.showPageMessage=""}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Results Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"showResult",value:function(e){this.router.navigate(["result-view",e.auditConnectionKey,e.auditKey],{relativeTo:this.route})}},{key:"refresh",value:function(){var e,t=this,a=[];switch(this.auditType){case"Datalink":e=this.datalinks,a=this.datalinks.map((function(e){return t.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e})).auditConnectionKey}));break;case"Datajob":e=this.datajobs,a=this.datajobs.map((function(e){return t.hubCache.hub.dexihDatajobs.find((function(t){return t.key===e})).auditConnectionKey}));break;case"DatalinkTest":e=this.datalinkTests,a=this.datalinkTests.map((function(e){return t.hubCache.hub.dexihDatalinkTests.find((function(t){return t.key===e})).auditConnectionKey}));break;default:e=null}var n=a.filter((function(e,t,a){return a.indexOf(e)===t}));0===n.length&&(n=this.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===o.jb.Managed})).map((function(e){return e.key}))),this.hubService.getAuditResults(this.auditType,n,e,!0,this.rows,this.cancelToken).then((function(e){t._tableData.next(e),t.watchChanges()}))}},{key:"watchChanges",value:function(){var e=this;this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe((function(t){var a=e._tableData.value;if(e.datalinks&&e.datalinks.findIndex((function(e){return e===t.referenceKey}))>=0){var n=a.find((function(e){return e.auditKey===t.auditKey}));n?(Object.assign(n,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}if(e.datajobs&&e.datajobs.findIndex((function(e){return e===t.referenceKey}))>=0){var i=a.find((function(e){return e.auditKey===t.auditKey}));i?(Object.assign(i,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}if(e.datalinkTests&&e.datalinkTests.findIndex((function(e){return e===t.referenceKey}))>=0){var r=a.find((function(e){return e.auditKey===t.auditKey}));r?(Object.assign(r,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}}))}}]),e}()).\u0275fac=function(e){return new(e||T)(s.Kb(c.a),s.Kb(l.e),s.Kb(l.a))},T.\u0275cmp=s.Eb({type:T,selectors:[["results-index"]],decls:11,vars:6,consts:[[1,"container-fluid"],["title","Execution Results","iconClass","fa fa-lg fa-fw fa-exchange"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","enableSaveCsv","rowClick"],["actions",""],["tableHeader",""],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],[1,"d-flex","flex-wrap"],[1,"input-group"],["text","Reload",1,"input-group-prepend",3,"click"],["type","number","placeholder","Maximum rows...","title","Specify the maximum rows to return",1,"form-control",2,"width","100%","max-width","100px",3,"ngModel","ngModelChange"],[1,"flex-fill","ml-1"],["labelLeft","Type","selectNullMessage","All types",1,"form-control","p-0",3,"ngModel","border","items","enableTextEntry","allowNullSelect","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[1,"d-flex","flex-wrap","pt-1"],["labelLeft","Datalinks","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","Datajobs","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","DatalinkTests","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["text","Edit Datalink",1,"mr-1",3,"routerLink"],["queryParamsHandling","merge",3,"routerLink"],[3,"writerResult"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"dexih-widget",1),s.Ob(2,"dexih-table",2),s.Vb("rowClick",(function(e){return t.showResult(e)})),s.Dc(3,m,6,6,"ng-template",null,3,s.Ec),s.Dc(5,y,3,3,"ng-template",null,4,s.Ec),s.Dc(7,w,2,8,"ng-template",5,6,s.Ec),s.Dc(9,S,1,1,"ng-template",7,8,s.Ec),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(2),s.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("enableSaveCsv",!0))},directives:[u.P,b.a,u.s,h.y,h.c,h.s,h.v,u.E,d.t,u.G,u.j,l.f,u.y,f.a],encapsulation:2}),T),D=a("ElCs"),x=a("zQsl"),F=function(e){return["progress-bar",e]},V=function(e){return{width:e}},I=((O=function(){function e(){_classCallCheck(this,e),this.percent="0%"}return _createClass(e,[{key:"ngOnInit",value:function(){if(0===this.value)this.percent="0%";else if(0===this.total)this.percent="100%";else{var e=100*this.value/this.total;e<0&&(e=0),e>100&&(e=100),this.percent=e.toString()+"%"}}}]),e}()).\u0275fac=function(e){return new(e||O)},O.\u0275cmp=s.Eb({type:O,selectors:[["result-progress"]],inputs:{value:"value",total:"total",caption:"caption",color:"color"},decls:8,vars:9,consts:[[1,""],[1,"text"],[1,"float-right"],[1,"progress",2,"width","100%"],[3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"span",1),s.Fc(2),s.Ob(3,"span",2),s.Fc(4),s.Nb(),s.Nb(),s.Ob(5,"div",3),s.Ob(6,"div",4),s.Fc(7,"\xa0"),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(2),s.Hc(" ",t.caption," "),s.yb(2),s.Ic("",t.value,"/",t.total,""),s.yb(2),s.hc("ngClass",s.mc(5,F,t.color))("ngStyle",s.mc(7,V,t.percent)))},directives:[d.q,d.w],encapsulation:2}),O),K=a("WrAK");function E(e,t){1&e&&(s.Ob(0,"li",27),s.Ob(1,"h5"),s.Fc(2,"Error encountered!"),s.Nb(),s.Nb())}function L(e,t){1&e&&(s.Ob(0,"li",28),s.Ob(1,"h5"),s.Fc(2,"Finished Successfully"),s.Nb(),s.Nb())}function _(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button",33),s.Vb("click",(function(){s.vc(a);var e=s.Zb(2);return e.exceptionHidden=!e.exceptionHidden})),s.Fc(1,"Details"),s.Nb()}}function P(e,t){if(1&e&&(s.Ob(0,"pre"),s.Fc(1),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.Gc(a.auditResult.exceptionDetails)}}function M(e,t){if(1&e&&(s.Ob(0,"li",5),s.Ob(1,"div",29),s.Fc(2),s.Ob(3,"div",30),s.Dc(4,_,2,0,"dexih-button",31),s.Nb(),s.Nb(),s.Ob(5,"div"),s.Dc(6,P,2,1,"pre",32),s.Nb(),s.Nb()),2&e){var a=s.Zb();s.yb(2),s.Hc(" ",a.auditResult.message," "),s.yb(2),s.hc("ngIf",a.auditResult.exceptionDetails),s.yb(2),s.hc("ngIf",!a.exceptionHidden&&a.auditResult.exceptionDetails)}}function A(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1,"Target Table"),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.Nb(),s.Lb(4,"div",10)),2&e){var a=s.Zb();s.yb(3),s.Gc(a.auditResult.targetTableName)}}function R(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1,"Scheduled Time"),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.ac(4,"calendar"),s.Nb(),s.Lb(5,"div",10)),2&e){var a=s.Zb();s.yb(3),s.Gc(s.bc(4,1,a.auditResult.scheduledTime))}}function j(e,t){1&e&&(s.Ob(0,"li",13),s.Ob(1,"h5"),s.Fc(2,"Child Results"),s.Nb(),s.Nb())}function Z(e,t){if(1&e&&(s.Ob(0,"div"),s.Ob(1,"div",35),s.Ob(2,"span",36),s.Fc(3),s.Nb(),s.Lb(4,"datalink-status",37),s.Nb(),s.Nb()),2&e){var a=t.$implicit;s.yb(3),s.Hc(" ","Table"===a.auditType?a.targetTableName:a.referenceName," "),s.yb(1),s.hc("writerResult",a)}}function H(e,t){if(1&e&&(s.Ob(0,"li",5),s.Dc(1,Z,5,2,"div",34),s.Nb()),2&e){var a=s.Zb();s.yb(1),s.hc("ngForOf",a.auditResult.childResults)}}function G(e,t){if(1&e&&s.Lb(0,"result-progress",38),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsReadPrimary)("total",a.auditResult.rowsReadPrimary+a.auditResult.rowsReadReference)}}function q(e,t){if(1&e&&s.Lb(0,"result-progress",39),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsReadReference)("total",a.auditResult.rowsReadPrimary+a.auditResult.rowsReadReference)}}function B(e,t){if(1&e&&s.Lb(0,"result-progress",40),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsCreated)("total",a.auditResult.rowsTotal)}}function U(e,t){if(1&e&&s.Lb(0,"result-progress",41),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsUpdated)("total",a.auditResult.rowsTotal)}}function z(e,t){if(1&e&&s.Lb(0,"result-progress",42),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsDeleted)("total",a.auditResult.rowsTotal)}}function W(e,t){if(1&e&&s.Lb(0,"result-progress",43),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsRejected)("total",a.auditResult.rowsTotal)}}function Q(e,t){if(1&e&&s.Lb(0,"result-progress",44),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsPreserved)("total",a.auditResult.rowsTotal)}}function $(e,t){if(1&e&&s.Lb(0,"result-progress",45),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsIgnored)("total",a.auditResult.rowsTotal)}}function X(e,t){if(1&e&&s.Lb(0,"result-progress",46),2&e){var a=s.Zb();s.hc("value",a.auditResult.passed)("total",a.auditResult.rowsTotal)}}function Y(e,t){if(1&e&&s.Lb(0,"result-progress",47),2&e){var a=s.Zb();s.hc("value",a.auditResult.failed)("total",a.auditResult.rowsTotal)}}function J(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.ac(4,"number"),s.Nb(),s.Lb(5,"div",10)),2&e){var a=t.$implicit;s.yb(1),s.Gc(a.transformName),s.yb(2),s.Hc("",0==a.seconds?"N/A":s.cc(4,2,a.rows/a.seconds,"1.2-2")," rows/second")}}var ee,te=((ee=function(){function e(t,a){_classCallCheck(this,e),this.route=t,this.router=a,this.exceptionHidden=!0,this.fail=!1,this.success=!1,this.eRunStatus=o.Yb,this.eTriggerMethod=o.oc}return _createClass(e,[{key:"ngOnInit",value:function(){switch(this.runTime=this.auditResult.endTime?(new Date(this.auditResult.endTime).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:this.auditResult.runStatus===o.Yb.Running||this.auditResult.runStatus===o.Yb.RunningErrors||this.auditResult.runStatus===o.Yb.Started?((new Date).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:null,this.auditResult.runStatus){case o.Yb.Abended:case o.Yb.Cancelled:case o.Yb.Failed:case o.Yb.FinishedErrors:this.fail=!0;break;case o.Yb.Finished:case o.Yb.Passed:this.success=!0}this.barChartData=[{name:"Reading",value:this.rowsPerSecond(this.auditResult.rowsReadPrimary+this.auditResult.rowsReadReference,this.auditResult.readTicks)},{name:"Processing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.processingTicks)},{name:"Writing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.writeTicks)}]}},{key:"numberWithCommas",value:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},{key:"rowsPerSecond",value:function(e,t){return 0===t?0:e/(t/1e7)}},{key:"openResult",value:function(e){this.router.navigate(["..",e],{relativeTo:this.route})}}]),e}()).\u0275fac=function(e){return new(e||ee)(s.Kb(l.a),s.Kb(l.e))},ee.\u0275cmp=s.Eb({type:ee,selectors:[["stats"]],inputs:{auditResult:"auditResult"},decls:75,vars:44,consts:[[1,"list-group"],["class","list-group-item list-group-item-danger",4,"ngIf"],["class","list-group-item list-group-item-success",4,"ngIf"],["class","list-group-item",4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],[1,"container"],[1,"row","rounded","text-white","bg-secondary"],[3,"ngIf"],[1,"col","border","border-white"],[1,"w-100"],["class","list-group-item list-group-item-info",4,"ngIf"],["class","list-group-item ",4,"ngIf"],[1,"list-group-item","list-group-item-info"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total",4,"ngIf"],["caption","Created","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Updated","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Deleted","color","bg-color-magenta",3,"value","total",4,"ngIf"],["caption","Rejected","color","bg-color-red",3,"value","total",4,"ngIf"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total",4,"ngIf"],["caption","Ignored","color","bg-color-grayDark",3,"value","total",4,"ngIf"],["caption","Passed","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Failed","color","bg-color-magenta",3,"value","total",4,"ngIf"],["ngFor","",3,"ngForOf"],[2,"display","grid"],["scheme","natural","yAxisLabel","rows/second","xAxisLabel","operation",3,"results","gradient","xAxis","yAxis","legend","showGridLines","showXAxisLabel","showYAxisLabel"],[1,"list-group-item","list-group-item-danger"],[1,"list-group-item","list-group-item-success"],[1,"d-flex","mb-2"],[1,"ml-auto"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],[4,"ngFor","ngForOf"],[1,""],[1,"text"],[3,"writerResult"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total"],["caption","Created","color","bg-color-greenDark",3,"value","total"],["caption","Updated","color","bg-color-blueDark",3,"value","total"],["caption","Deleted","color","bg-color-magenta",3,"value","total"],["caption","Rejected","color","bg-color-red",3,"value","total"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total"],["caption","Ignored","color","bg-color-grayDark",3,"value","total"],["caption","Passed","color","bg-color-greenDark",3,"value","total"],["caption","Failed","color","bg-color-magenta",3,"value","total"]],template:function(e,t){1&e&&(s.Ob(0,"ul",0),s.Dc(1,E,3,0,"li",1),s.Dc(2,L,3,0,"li",2),s.Dc(3,M,7,3,"li",3),s.Ob(4,"li",4),s.Ob(5,"h5"),s.Fc(6,"Running Time"),s.Nb(),s.Nb(),s.Ob(7,"li",5),s.Ob(8,"div",6),s.Ob(9,"div",7),s.Dc(10,A,5,1,"ng-template",8),s.Ob(11,"div",9),s.Fc(12,"Run Status"),s.Nb(),s.Ob(13,"div",9),s.Fc(14),s.Nb(),s.Lb(15,"div",10),s.Ob(16,"div",9),s.Fc(17,"Start Date"),s.Nb(),s.Ob(18,"div",9),s.Fc(19),s.ac(20,"calendar"),s.Nb(),s.Lb(21,"div",10),s.Dc(22,R,6,3,"ng-template",8),s.Ob(23,"div",9),s.Fc(24,"Initialized"),s.Nb(),s.Ob(25,"div",9),s.Fc(26),s.ac(27,"calendar"),s.Nb(),s.Lb(28,"div",10),s.Ob(29,"div",9),s.Fc(30,"Started"),s.Nb(),s.Ob(31,"div",9),s.Fc(32),s.ac(33,"calendar"),s.Nb(),s.Lb(34,"div",10),s.Ob(35,"div",9),s.Fc(36,"Finished"),s.Nb(),s.Ob(37,"div",9),s.Fc(38),s.ac(39,"calendar"),s.Nb(),s.Lb(40,"div",10),s.Ob(41,"div",9),s.Fc(42,"Run Time"),s.Nb(),s.Ob(43,"div",9),s.Fc(44),s.ac(45,"number"),s.Nb(),s.Lb(46,"div",10),s.Ob(47,"div",9),s.Fc(48,"Triggered By"),s.Nb(),s.Ob(49,"div",9),s.Fc(50),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Dc(51,j,3,0,"li",11),s.Dc(52,H,2,1,"li",12),s.Ob(53,"li",13),s.Ob(54,"h5"),s.Fc(55,"Row Distribution"),s.Nb(),s.Nb(),s.Ob(56,"li",5),s.Dc(57,G,1,2,"result-progress",14),s.Dc(58,q,1,2,"result-progress",15),s.Dc(59,B,1,2,"result-progress",16),s.Dc(60,U,1,2,"result-progress",17),s.Dc(61,z,1,2,"result-progress",18),s.Dc(62,W,1,2,"result-progress",19),s.Dc(63,Q,1,2,"result-progress",20),s.Dc(64,$,1,2,"result-progress",21),s.Dc(65,X,1,2,"result-progress",22),s.Dc(66,Y,1,2,"result-progress",23),s.Nb(),s.Ob(67,"li",13),s.Ob(68,"h5"),s.Fc(69,"Performance Estimates (rows/second)"),s.Nb(),s.Nb(),s.Ob(70,"li",5),s.Ob(71,"div",7),s.Dc(72,J,6,5,"ng-template",24),s.Nb(),s.Ob(73,"div",25),s.Lb(74,"ngx-charts-bar-vertical",26),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(1),s.hc("ngIf",t.fail),s.yb(1),s.hc("ngIf",t.success),s.yb(1),s.hc("ngIf",null==t.auditResult?null:t.auditResult.message),s.yb(7),s.hc("ngIf",t.auditResult.targetTableName),s.yb(4),s.Gc(t.eRunStatus[t.auditResult.runStatus]),s.yb(5),s.Gc(s.bc(20,33,t.auditResult.initializeTime)),s.yb(3),s.hc("ngIf",t.auditResult.scheduledTime),s.yb(4),s.Gc(s.bc(27,35,t.auditResult.initializeTime)),s.yb(6),s.Gc(s.bc(33,37,t.auditResult.startTime)),s.yb(6),s.Gc(s.bc(39,39,t.auditResult.endTime)),s.yb(6),s.Hc("",s.cc(45,41,t.runTime,"1.2-2")," seconds"),s.yb(6),s.Gc(t.eTriggerMethod[t.auditResult.triggerMethod]),s.yb(1),s.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),s.yb(1),s.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),s.yb(5),s.hc("ngIf",t.auditResult.rowsReadPrimary>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsReadReference>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsCreated>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsUpdated>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsDeleted>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsRejected>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsPreserved>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsIgnored>0),s.yb(1),s.hc("ngIf",t.auditResult.passed>0),s.yb(1),s.hc("ngIf",t.auditResult.failed>0),s.yb(6),s.hc("ngForOf",t.auditResult.performanceSummary),s.yb(2),s.hc("results",t.barChartData)("gradient",!0)("xAxis",!0)("yAxis",!0)("legend",!1)("showGridLines",!0)("showXAxisLabel",!0)("showYAxisLabel",!0))},directives:[d.t,d.s,x.p,u.f,f.a,I],pipes:[K.a,d.g],encapsulation:2}),ee);function ae(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-refresh",2),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(1,"dexih-button-download",3),s.Vb("click",(function(){return s.vc(a),s.Zb().download()})),s.Nb(),s.Ob(2,"div",4),s.Ob(3,"div",5),s.Ob(4,"form-checkbox",6),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().showDetailed=e}))("change",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.yb(4),s.hc("ngModel",n.showDetailed)("border",!0)}}var ne,ie=((ne=function(){function e(t,a){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.showDetailed=!1,this.cancelToken=new r.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.refresh()}},{key:"ngOnDestroy",value:function(){this.cancelToken.cancel()}},{key:"refresh",value:function(){var e=this;this.hubService.previewProfileData(this.auditResult,!this.showDetailed,this.cancelToken).then((function(t){e.columns=t.columns,e.data=t.data})).catch((function(e){}))}},{key:"download",value:function(){this.hubService.downloadProfileData(this.auditResult,this.cancelToken)}}]),e}()).\u0275fac=function(e){return new(e||ne)(s.Kb(D.a),s.Kb(c.a))},ne.\u0275cmp=s.Eb({type:ne,selectors:[["profile-results"]],inputs:{auditResult:"auditResult"},decls:3,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[1,"d-flex","flex-wrap"],[1,"flex-fill","pl-1"],["label","Show Detailed Results",3,"ngModel","border","ngModelChange","change"]],template:function(e,t){1&e&&(s.Ob(0,"dexih-table",0),s.Dc(1,ae,5,2,"ng-template",null,1,s.Ec),s.Nb()),2&e&&s.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[b.a,u.s,u.h,u.A,h.s,h.v],encapsulation:2}),ne),re=a("XNiG"),oe=a("RXlv");function se(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-refresh",3),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(1,"dexih-button-download",4),s.Vb("click",(function(){return s.vc(a),s.Zb().download()})),s.Nb()}}function ce(e,t){if(1&e){var a=s.Pb();s.Ob(0,"query-builder",5),s.Vb("onRefreshData",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb()}if(2&e){var n=s.Zb();s.hc("selectQuery",n.selectQuery)("columns",n.targetTable.dexihTableColumns)("inputColumns",n.inputColumns)("refreshEvent",n.refreshDataSubject.asObservable())}}var le,ue=((le=function(){function e(t){_classCallCheck(this,e),this.hubService=t,this.selectQuery=new o.V,this.refreshDataSubject=new re.a,this.cancelToken=new r.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe((function(t){switch(e.cache=t,e.auditResult.auditType){case"Table":e.targetTable=e.cache.getTable(e.auditResult.referenceKey),e.refresh();break;case"Datalink":case"DatalinkStep":var a=e.cache.hub.dexihDatalinks.find((function(t){return t.key===e.auditResult.referenceKey}));if(!a)return void e.hubService.addHubErrorMessage("The datalink with the key ".concat(e.auditResult.referenceKey," cannot be found."));if(!(a.dexihDatalinkTargets.length>=1))return void e.hubService.addHubErrorMessage("There is no target table for this datalink.");e.targetTable=e.cache.getTable(a.dexihDatalinkTargets[0].tableKey),e.refresh();break;case"DatalinkTestStep":var n=e.cache.getDatalinkTestStep(e.auditResult.referenceKey);if(!n)return void e.hubService.addHubErrorMessage("The test step with the key ".concat(e.auditResult.referenceKey," cannot be found."));var i=e.cache.hub.dexihDatalinks.find((function(e){return e.key===n.datalinkKey}));if(!(i.dexihDatalinkTargets.length>=1))return void e.hubService.addHubErrorMessage("There is no target table for this datalink.");var r=e.cache.getTable(i.dexihDatalinkTargets[0].tableKey),s=JSON.parse(JSON.stringify(r));s.name=n.errorTableName,s.schema=n.errorSchema,s.connectionKey=n.errorConnectionKey;var c,l=_createForOfIteratorHelper(s.dexihTableColumns);try{for(l.s();!(c=l.n()).done;)c.value.deltaType=o.qb.NonTrackingField}catch(d){l.e(d)}finally{l.f()}var u=new o.I;u.name="error_audit_key",u.dataType=o.pc.Int64,u.deltaType=o.qb.CreateAuditKey;var b=new o.I;b.name="error_operation",b.dataType=o.pc.CharArray,b.maxLength=1,b.deltaType=o.qb.DatabaseOperation;var h=new o.I;h.name="mismatch_reason",h.dataType=o.pc.String,h.deltaType=o.qb.UpdateReason,s.dexihTableColumns.push(u),s.dexihTableColumns.push(b),s.dexihTableColumns.push(h),e.targetTable=s,e.refresh()}}))}},{key:"ngOnDestroy",value:function(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this.runningQuery&&this.runningQuery.cancel(),this.cancelToken.cancel()}},{key:"createSelectQuery",value:function(){var e=this.targetTable.dexihTableColumns.find((function(e){return e.deltaType===o.qb.CreateAuditKey})),t=this.targetTable.dexihTableColumns.find((function(e){return e.deltaType===o.qb.UpdateAuditKey}));if(e||t){var a=JSON.parse(JSON.stringify(this.selectQuery));if(e){var n=new o.N;n.column1=new o.X,Object.assign(n.column1,e),n.operator=o.hb.IsEqual,n.value2=this.auditResult.auditKey,n.andOr=o.cb.Or,n.compareDataType=o.pc.Int64,a.filters.push(n)}if(t){var i=new o.N;i.column1=new o.X,Object.assign(i.column1,t),i.operator=o.hb.IsEqual,i.value2=this.auditResult.auditKey,i.andOr=o.cb.Or,i.compareDataType=o.pc.Int64,a.filters.push(i)}return a.rows=100,a}this.hubService.addHubErrorMessage("The table ".concat(this.targetTable.name," does not contain a create or update audit column which is required to connect to an audit."))}},{key:"refresh",value:function(){var e=this,t=this.createSelectQuery(),a=this.hubService.previewTableDataQuery(this.targetTable,!1,t,null,null,this.cancelToken);a.then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.data=t.data})).catch((function(){})),this.runningQuery=a}},{key:"download",value:function(){var e=this.createSelectQuery(),t=new o.M;t.objectKey=this.targetTable.key,t.objectType=o.lb.Table,t.query=e,this.hubService.downloadData([t],!1,o.rb.Csv,this.cancelToken)}}]),e}()).\u0275fac=function(e){return new(e||le)(s.Kb(c.a))},le.\u0275cmp=s.Eb({type:le,selectors:[["preview-results"]],inputs:{auditResult:"auditResult"},decls:5,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["tableHeader",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[3,"selectQuery","columns","inputColumns","refreshEvent","onRefreshData"]],template:function(e,t){1&e&&(s.Ob(0,"dexih-table",0),s.Dc(1,se,2,0,"ng-template",null,1,s.Ec),s.Dc(3,ce,1,4,"ng-template",null,2,s.Ec),s.Nb()),2&e&&s.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[b.a,u.s,u.h,oe.a],encapsulation:2}),le),be=function(){return{view:"Profile"}};function he(e,t){if(1&e&&(s.Ob(0,"li",7),s.Ob(1,"a",8),s.Lb(2,"i",12),s.Ob(3,"span",10),s.Fc(4,"Profile Data"),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(3);s.yb(1),s.Cb("active","Profile"==a.view),s.hc("queryParams",s.lc(3,be))}}var de=function(){return{view:"Preview"}};function fe(e,t){if(1&e&&(s.Ob(0,"li",7),s.Ob(1,"a",8),s.Lb(2,"i",13),s.Ob(3,"span",10),s.Fc(4,"Preview"),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(3);s.yb(1),s.Cb("active","Preview"==a.view),s.hc("queryParams",s.lc(3,de))}}var me=function(){return{view:"Stats"}};function ve(e,t){if(1&e&&(s.Ob(0,"ul",6),s.Ob(1,"li",7),s.Ob(2,"a",8),s.Lb(3,"i",9),s.Ob(4,"span",10),s.Fc(5,"Execution Stats"),s.Nb(),s.Nb(),s.Nb(),s.Dc(6,he,5,4,"li",11),s.Dc(7,fe,5,4,"li",11),s.Nb()),2&e){var a=s.Zb(2);s.yb(2),s.Cb("active","Stats"==a.view),s.hc("queryParams",s.lc(5,me)),s.yb(4),s.hc("ngIf",a.auditResult.profileTableName&&("DatalinkStep"==(null==a.auditResult?null:a.auditResult.auditType)||"Datalink"==(null==a.auditResult?null:a.auditResult.auditType))),s.yb(1),s.hc("ngIf","DatalinkStep"==(null==a.auditResult?null:a.auditResult.auditType)||"Datalink"==(null==a.auditResult?null:a.auditResult.auditType)||"Table"==(null==a.auditResult?null:a.auditResult.auditType)||"DatalinkTestStep"==(null==a.auditResult?null:a.auditResult.auditType))}}function pe(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"stats",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function ge(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"profile-results",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function ye(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"preview-results",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function Ce(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-widget",2),s.Vb("close",(function(){return s.vc(a),s.Zb().close()})),s.Dc(1,ve,8,6,"ng-template",null,3,s.Ec),s.Ob(3,"div",4),s.Dc(4,pe,2,1,"div",5),s.Dc(5,ge,2,1,"div",5),s.Dc(6,ye,2,1,"div",5),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.hc("title",null==n.auditResult?null:n.auditResult.referenceName)("showCloseButton",!0),s.yb(3),s.hc("ngSwitch",n.view),s.yb(1),s.hc("ngSwitchCase","Stats"),s.yb(1),s.hc("ngSwitchCase","Profile"),s.yb(1),s.hc("ngSwitchCase","Preview")}}var ke,we=((ke=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new r.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteAgentObservable(!0)).subscribe((function(t){var a=t[1],n=t[2];e.hubCache=t[3];var i=t[4],r=+a.auditConnectionKey,o=+a.auditKey;e.showPage=!1,e.showPageMessage="Waiting for an active remote agent...",e.view=n.view,e.view||(e.view="Stats"),i&&(e.showPage=!0,e.showPageMessage="",e.hubService.getResultDetail(r,o,e.cancelToken).then((function(t){e.auditResult=t[0]})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Results View")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"watchChanges",value:function(){var e=this;this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe((function(t){e.auditResult&&t.auditConnectionKey===e.auditResult.auditConnectionKey&&t.auditKey===e.auditResult.auditKey&&(e.auditResult=t)}))}}]),e}()).\u0275fac=function(e){return new(e||ke)(s.Kb(c.a),s.Kb(D.a),s.Kb(l.e),s.Kb(l.a))},ke.\u0275cmp=s.Eb({type:ke,selectors:[["results-view"]],decls:2,vars:1,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close"],["header",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"nav","nav-tabs","card-header-tabs"],[1,"nav-item"],["routerLink",".",1,"nav-link",3,"queryParams"],[1,"fa","fa-clock-o"],[1,"ml-1","d-none","d-md-inline"],["class","nav-item",4,"ngIf"],[1,"fa","fa-tachometer"],[1,"fa","fa-table"],[3,"auditResult"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Dc(1,Ce,7,6,"dexih-widget",1),s.Nb()),2&e&&(s.yb(1),s.hc("ngIf",t.auditResult))},directives:[d.t,u.P,d.x,d.y,l.h,te,ie,ue],encapsulation:2}),ke)},ynzd:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a("2Vo4"),i=a("itXk"),r=a("soiQ"),o=a("fXoL"),s=a("4Y1E"),c=a("ElCs"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("/pur"),d=a("mWX8"),f=a("VdXI"),m=a("axB7");function v(e,t){if(1&e&&o.Lb(0,"tags-update-button",9),2&e){var a=t.items,n=o.Zb();o.hc("objectType",n.eSharedObjectType.View)("objects",a)}}function p(e,t){if(1&e&&o.Lb(0,"dependent-items-button",10),2&e){var a=t.item,n=o.Zb();o.hc("key",a.key)("objectType",n.eSharedObjectType.View)}}function g(e,t){1&e&&o.Lb(0,"actions-view-button",11),2&e&&o.hc("views",t.items)}var y=function(){var e=function(){function e(t,a,i,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=i,this.route=o,this.eSharedObjectType=r.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"viewType",title:"Chart/Table"},{name:"sourceName",title:"Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new n.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateViews()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteViews",value:function(e){this.hubService.deleteViews(e)}},{key:"updateViews",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihViews.filter((function(e){return e.isValid})).map((function(t){var a="";switch(t.sourceType){case r.lb.Table:var n=e.hubCache.getTable(t.sourceTableKey);a=n?n.logicalName:"Error, not found";break;case r.lb.Datalink:var i=e.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t.sourceDatalinkKey}));a=i?"Datalink: "+i.name:"Error, not found"}return{key:t.key,name:t.name,tags:e.hubCache.getObjectTags(r.dc.View,t.key),viewType:r.rc[t.viewType],sourceName:a,updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editView",value:function(e){this.router.navigate(["view-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddView(e.key,a)})),this.hubService.exportHub(a,1===e.length?"View - "+e[0].name+".json":"views.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==r.dc.View&&t.changeClass!==r.dc.TagObjects||e.updateViews()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Kb(s.a),o.Kb(c.a),o.Kb(l.e),o.Kb(l.a))},e.\u0275cmp=o.Eb({type:e,selectors:[["views"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Views","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"views"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"dexih-widget",1),o.Vb("close",(function(){return t.close()})),o.Ob(2,"dexih-table",2),o.Vb("rowClick",(function(e){return t.editView(e)})),o.Dc(3,v,1,2,"ng-template",3,4,o.Ec),o.Dc(5,p,1,2,"ng-template",5,6,o.Ec),o.Dc(7,g,1,1,"ng-template",null,7,o.Ec),o.Nb(),o.Nb(),o.Lb(9,"dexih-help",8),o.Nb()),2&e&&(o.yb(1),o.hc("showCloseButton",!0),o.yb(1),o.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,b.a,h.a,d.a,f.a,m.a],encapsulation:2}),e}()}}]);
//# sourceMappingURL=11-es5.33015a32e2d353a57c9f.js.map