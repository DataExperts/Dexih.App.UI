(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"/fhR":function(e,t,i){"use strict";i.d(t,"a",(function(){return V}));var a=i("3WyZ"),n=i("itXk"),s=i("2v7R"),o=i("ElCs"),c=i("Xjf6"),r=i("cvPx"),l=i("soiQ"),b=i("fXoL"),h=i("tyNb"),u=i("3Pt+"),d=i("ofXK"),m=i("Wumg"),f=i("obiC"),p=i("H3K+"),g=function(e,t,i,a){return new(i||(i=Promise))((function(n,s){function o(e){try{r(a.next(e))}catch(t){s(t)}}function c(e){try{r(a.throw(e))}catch(t){s(t)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}r((a=a.apply(e,t||[])).next())}))};function v(e,t){if(1&e&&(b.Ob(0,"section"),b.Ob(1,"div",2),b.Fc(2," There are no files configured. Create a file based connection, and add at least one file definition. "),b.Lb(3,"hr"),b.Ob(4,"div"),b.Ob(5,"a",3),b.Fc(6,"New Connection"),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e){const e=b.Zb();b.yb(5),b.jc("routerLink","/hub/",e.hubCache.hub.hubKey,"/connections/connection-new/Source")}}function y(e,t){if(1&e&&(b.Ob(0,"section",16),b.Ob(1,"form-select",22),b.Ob(2,"a",13),b.Fc(3,"("),b.Lb(4,"i",14),b.Fc(5," New )"),b.Nb(),b.Nb(),b.Nb()),2&e){const e=b.Zb(4);b.yb(1),b.hc("items",e.hubCache.hub.dexihFileFormats)("enableFilter",!1)("allowNullSelect",!0),b.yb(1),b.jc("routerLink","/hub/",e.hubCache.hub.hubKey,"/fileFormats/fileFormat-new")}}function C(e,t){if(1&e&&(b.Ob(0,"form",10),b.Ob(1,"div",11),b.Ob(2,"section"),b.Ob(3,"form-select",12),b.Ob(4,"a",13),b.Fc(5,"("),b.Lb(6,"i",14),b.Fc(7," New )"),b.Nb(),b.Nb(),b.Nb(),b.Ob(8,"div",15),b.Ob(9,"section",16),b.Lb(10,"form-select",17),b.Nb(),b.Dc(11,y,6,4,"section",18),b.Nb(),b.Ob(12,"section"),b.Lb(13,"form-checkbox",19),b.Lb(14,"form-checkbox",20),b.Lb(15,"form-checkbox",21),b.Nb(),b.Nb(),b.Nb()),2&e){const e=b.Zb(3);b.hc("formGroup",e.bulkLoadForm),b.yb(3),b.hc("items",e.fileConnections),b.yb(1),b.jc("routerLink","//hub/",e.hubCache.hub.hubKey,"/connections/connection-new/Source"),b.yb(6),b.hc("items",e.formatTypes),b.yb(1),b.hc("ngIf",e.bulkLoadForm.controls.formatType.value==e.eTypeCode.Text)}}function w(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-button",38),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).uploadSelected(i)})),b.Fc(1,"Upload"),b.Nb(),b.Ob(2,"dexih-button-cancel",39),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).cancelSelected(i)})),b.Nb(),b.Ob(3,"dexih-button-delete",40),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).removeSelected(i)})),b.Nb()}}function S(e,t){if(1&e){const e=b.Pb();b.Ob(0,"div",41),b.Ob(1,"form-checkbox",42),b.Vb("ngModelChange",(function(t){return b.vc(e),b.Zb(4).automaticUpload=t})),b.Nb(),b.Nb()}if(2&e){const e=b.Zb(4);b.yb(1),b.hc("ngModel",e.automaticUpload)}}const k=function(e){return{width:e}};function O(e,t){if(1&e&&(b.Ob(0,"div",45),b.Lb(1,"div",46),b.Nb()),2&e){const e=b.Zb().item;b.yb(1),b.hc("ngStyle",b.mc(1,k,e.progress+"%"))}}const N=function(e,t,i){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":i}};function T(e,t){if(1&e&&(b.Dc(0,O,2,3,"div",43),b.Ob(1,"span"),b.Lb(2,"i",44),b.Fc(3),b.Nb()),2&e){const e=t.item,i=b.Zb(4);b.hc("ngIf",e.isRunning()),b.yb(2),b.hc("ngClass",b.oc(3,N,e.status===i.eFileStatus.Complete,e.status===i.eFileStatus.Error,e.status===i.eFileStatus.Cancelled)),b.yb(1),b.Gc(e.status)}}function D(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-button",47),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).saveTables(i)})),b.Fc(1,"Create Tables"),b.Nb(),b.Ob(2,"dexih-button",48),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).createDatalinks(i)})),b.Fc(3,"Create Datalinks"),b.Nb(),b.Ob(4,"dexih-button-delete",49),b.Vb("click",(function(){b.vc(e);const i=t.items;return b.Zb(4).discardTables(i)})),b.Nb()}}function x(e,t){if(1&e){const e=b.Pb();b.Ob(0,"ul",23),b.Ob(1,"dexih-widget-section",24),b.Ob(2,"div",25),b.Vb("dropFiles",(function(t){return b.vc(e),b.Zb(3).filesDrop(t)})),b.Fc(3," Drop Files to Load Here "),b.Ob(4,"div",26),b.Ob(5,"input",27),b.Vb("change",(function(t){return b.vc(e),b.Zb(3).uploadFile(t)})),b.Nb(),b.Ob(6,"label",28),b.Fc(7,"Choose files"),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(8,"dexih-widget-section",29),b.Ob(9,"dexih-table",30),b.Dc(10,w,4,0,"ng-template",31,32,b.Ec),b.Dc(12,S,2,1,"ng-template",null,33,b.Ec),b.Dc(14,T,4,7,"ng-template",34,35,b.Ec),b.Nb(),b.Nb(),b.Ob(16,"dexih-widget-section",36),b.Ob(17,"dexih-table",37),b.Vb("rowClick",(function(t){return b.vc(e),b.Zb(3).editTable(t)})),b.Dc(18,D,5,0,"ng-template",31,32,b.Ec),b.Nb(),b.Nb(),b.Nb()}if(2&e){const e=b.Zb(3);b.yb(1),b.hc("showExpandButton",!0),b.yb(1),b.hc("requireFiles",!0),b.yb(6),b.hc("showExpandButton",!0)("padding",!1),b.yb(1),b.hc("enableMultiSelect",!0)("columns",e.uploadColumns)("data",e.uploadedFiles),b.yb(7),b.hc("showExpandButton",!0)("padding",!1),b.yb(1),b.hc("enableMultiSelect",!0)("columns",e.tableColumns)("data",e.tables)}}function F(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-widget",7),b.Vb("close",(function(){return b.vc(e),b.Zb(2).close()})),b.Dc(1,C,16,5,"form",8),b.Dc(2,x,20,12,"ul",9),b.Nb()}if(2&e){const e=b.Zb(2);b.hc("title","Bulk Load: "+(null==e.connection?null:e.connection.name))("showCloseButton",!0),b.yb(1),b.hc("ngIf",e.bulkLoadForm),b.yb(1),b.hc("ngIf",e.connection)}}function I(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-button-apply",52),b.Vb("click",(function(){return b.vc(e),b.Zb(3).applyChanges()})),b.Nb(),b.Ob(1,"dexih-button-cancel",53),b.Vb("click",(function(){return b.vc(e),b.Zb(3).cancel()})),b.Nb()}}function K(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-widget",50),b.Vb("close",(function(){return b.vc(e),b.Zb(2).closeTable()})),b.Dc(1,I,2,0,"ng-template",null,51,b.Ec),b.Lb(3,"router-outlet"),b.Nb()}if(2&e){const e=b.Zb(2);b.hc("title","Edit table: "+e.formsService.currentForm.controls.name.value)("showCloseButton",!0)}}function E(e,t){if(1&e&&(b.Ob(0,"div",4),b.Dc(1,F,3,4,"dexih-widget",5),b.Dc(2,K,4,2,"dexih-widget",6),b.Nb()),2&e){const e=b.Zb();b.yb(1),b.hc("ngIf",!e.currentTable),b.yb(1),b.hc("ngIf",e.currentTable)}}let V=(()=>{class e{constructor(e,t,i,n,o,c){this.authService=e,this.hubService=t,this.route=i,this.router=n,this.formsService=o,this.fb=c,this.entityType="Table",this.canEdit=!1,this.formatTypes=s.m,this.eTypeCode=l.pc,this.eFileStatus=a.h,this.automaticUpload=!0,this.uploadedFiles=[],this.reference=null,this.tables=[],this.currentTable=null,this.cancelToken=new a.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.tableColumns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description"},{name:"name",title:"Table Name"}],this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}ngOnInit(){try{this._subscription=Object(n.a)(this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe(e=>{let t=e[0];this.hubCache=e[1];let i=e[2];this.fileConnections=this.hubCache.hub.dexihConnections.filter(e=>{let t=i.connections.find(t=>e.connectionAssemblyName===t.connectionAssemblyName&&e.connectionClassName===t.connectionClassName);return!!t&&(t.connectionCategory===l.ib.File||e.purpose!==l.jb.Source)});let a=+t.connectionKey;a||this.fileConnections.length>0&&(a=this.fileConnections[0].key),this.bulkLoadForm=this.fb.group({connectionKey:[a],formatType:[l.pc.Text],fileFormatKey:[],includeFileName:[!1],includeFileDate:[!1],includeFileRowNumber:[!1]}),this.updateConnection(a),this._connectionKeySubscription&&this._connectionKeySubscription.unsubscribe(),this._connectionKeySubscription=this.bulkLoadForm.controls.connectionKey.valueChanges.subscribe(e=>{this.updateConnection(e)})}),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._flatFilesSubscription=this.hubService.getFlatFilesObservable().subscribe(e=>{e.reference===this.reference&&(this.tables=e.tables)})}catch(e){this.hubService.addHubClientErrorMessage(e,"Files Manage")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._connectionKeySubscription&&this._connectionKeySubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}updateConnection(e){this.connection=this.hubCache.getConnection(e),!this.connection&&e?this.hubService.addHubErrorMessage(`The connection with the key ${e} could not be found.`):this.connection&&(this.pageTitle="Load files for "+this.connection.name,this.showPage=!0)}uploadFile(e){return this.doUpload(e.srcElement.files),!1}filesDrop(e){this.doUpload(e)}doUpload(e){Array.prototype.forEach.call(e,e=>{let t=this.bulkLoadForm.value;this.hubService.bulkUploadFiles(t.connectionKey,t.fileFormatKey,t.formatType,t.includeFileName,t.includeFileDate,t.includeFileRowNumber,e.name,this.cancelToken).then(t=>{let i=t.url;this.reference=t.reference;let n=new a.d(e,i);this.uploadedFiles=this.uploadedFiles.concat(n),this.automaticUpload&&this.authService.upload(n).then(t=>{t.success?this.hubService.addHubSuccessMessage(e.name+" uploaded."):this.hubService.addHubMessage(t)}).catch(e=>{this.hubService.addHubMessage(e)})}).catch(e=>{this.hubService.addHubMessage(e)})})}editTable(e){this.currentTable=e,this.formsService.table(e),this.router.navigate(["table-edit"],{relativeTo:this.route})}applyChanges(){this.formsService.hasChanged&&Object.assign(this.currentTable,this.formsService.currentForm.value),this.currentTable=null,this.authService.navigateUp()}cancel(){this.currentTable=null,this.authService.navigateUp()}saveTables(e){return g(this,void 0,void 0,(function*(){let t=Object.assign([],this.tables),i=[];for(let a=0;a<e.length;a++){let n=e[a],s=yield this.hubService.saveTables([n]);i.push(s[0].key);let o=this.tables.findIndex(e=>n.key===e.key);t.splice(o,1)}return this.tables=t,i}))}createDatalinks(e){return g(this,void 0,void 0,(function*(){let t=(yield this.saveTables(e)).join("|");this.router.navigate(["/hub",this.hubCache.hub.hubKey,"tables","datalink-new",t,0],{relativeTo:this.route.root})}))}discardTables(e){let t=Object.assign([],this.tables);for(let i=0;i<e.length;i++){let a=e[i],n=this.tables.findIndex(e=>a.key===e.key);t.splice(n,1)}this.tables=t}uploadSelected(e){e.forEach(e=>{this.authService.upload(e).then(e=>{this.hubService.addHubMessage(e)}).catch(e=>{this.hubService.addHubMessage(e)})})}removeSelected(e){e.forEach(e=>{let t=this.uploadedFiles.findIndex(t=>t.id===e.id);t>=0&&this.uploadedFiles.splice(t,1)})}cancelSelected(e){e.forEach(e=>e.cancel())}canDeactivate(){return new Promise(e=>{this.tables.length>0?this.authService.confirmDialog("Unsaved tables!","Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.tables.length>0&&(e.returnValue="Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(b.Kb(o.a),b.Kb(c.a),b.Kb(h.a),b.Kb(h.e),b.Kb(r.a),b.Kb(u.g))},e.\u0275cmp=b.Eb({type:e,selectors:[["files-bulk-load"]],hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},decls:2,vars:2,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],[1,"btn","btn-sm","btn-primary","text-white",3,"routerLink","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close",4,"ngIf"],[3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close"],[3,"formGroup",4,"ngIf"],["class","list-group",4,"ngIf"],[3,"formGroup"],[1,"m-3"],["label","Connection","formControlName","connectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","The connection where the files will be uploaded to.",3,"items"],[3,"routerLink"],[1,"fa","fa-sticky-note-o"],[1,"form-row"],[1,"col-md-6"],["label","Format Type","formControlName","formatType","itemKey","key","itemName","name","iconClass","fa fa-text","note","The format of data.",3,"items"],["class","col-md-6",4,"ngIf"],["label","Include file name field","formControlName","includeFileName"],["label","Include file date field","formControlName","includeFileDate"],["label","Include file row field","formControlName","includeFileRowNumber"],["label","File Format","formControlName","fileFormatKey","placeholder","File Format","itemKey","key","itemName","name","note","Specify the file format to use, if not specified, a csv (command separated) format will be used.","selectNullMessage","Use default (csv) format",3,"items","enableFilter","allowNullSelect"],[1,"list-group"],["title","Drop Files to Load",3,"showExpandButton"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],["title","Upload Queues",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Tables Created",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data","rowClick"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],[1,"d-flex","align-items-center","h-100"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],["iconClass","fa fa-table","title","Save the selected tables.",1,"ml-1",3,"click"],["iconClass","fa fa-exchange","title","Save the selected tables, and create datalinks to load them into a staging area.",1,"ml-1",3,"click"],["title","Discard the selected tables.","text","Discard",1,"ml-1",3,"click"],[3,"title","showCloseButton","close"],["header",""],[3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){1&e&&(b.Dc(0,v,7,1,"section",0),b.Dc(1,E,3,2,"div",1)),2&e&&(b.hc("ngIf",(null==t.hubCache?null:t.hubCache.hub)&&(!t.fileConnections||0===t.fileConnections.length)),b.yb(1),b.hc("ngIf",t.fileConnections&&t.fileConnections.length>0))},directives:[d.t,h.h,m.P,u.I,u.t,u.l,m.E,u.s,u.j,m.A,m.T,f.a,p.a,m.f,m.b,m.g,u.v,d.q,d.w,h.j,m.a],encapsulation:2}),e})()},LyCD:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var a=i("4Y1E"),n=i("itXk"),s=i("cvPx"),o=i("ElCs"),c=i("3WyZ"),r=i("2v7R"),l=i("soiQ"),b=i("fXoL"),h=i("tyNb"),u=i("Wumg"),d=i("iFLP"),m=i("ofXK"),f=i("79jk"),p=i("64E1"),g=i("oLr2");const v=["dashboardItem"];function y(e,t){if(1&e){const e=b.Pb();b.Ob(0,"li"),b.Ob(1,"a",8),b.Vb("click",(function(){b.vc(e);const i=t.$implicit;return b.Zb(2).add(i.key)})),b.Fc(2),b.Nb(),b.Nb()}if(2&e){const e=t.$implicit;b.yb(2),b.Gc(e.name)}}function C(e,t){if(1&e&&b.Lb(0,"save-button",13),2&e){const e=b.Zb(2);b.hc("formsService",e.formsService)}}function w(e,t){if(1&e){const e=b.Pb();b.Ob(0,"dexih-invalid-form-details",3),b.Vb("click",(function(){return b.vc(e),b.Zb().formsService.showErrors()})),b.Nb(),b.Ob(1,"dexih-button-edit",4),b.Vb("click",(function(){return b.vc(e),b.Zb().toggleEdit()})),b.Nb(),b.Ob(2,"dexih-button",5),b.Vb("click",(function(){return b.vc(e),b.Zb().toggleLock()})),b.Nb(),b.Ob(3,"dexih-button-refresh",6),b.Vb("click",(function(){return b.vc(e),b.Zb().refresh()})),b.Nb(),b.Ob(4,"dexih-button-dropdown",7),b.Ob(5,"a",8),b.Vb("click",(function(){return b.vc(e),b.Zb().newView()})),b.Fc(6,"(New View)"),b.Nb(),b.Dc(7,y,3,1,"li",9),b.Nb(),b.Ob(8,"download-button",10),b.Vb("download",(function(t){return b.vc(e),b.Zb().download(t)})),b.Nb(),b.Dc(9,C,1,1,"save-button",11),b.Lb(10,"cancel-button",12)}if(2&e){const e=b.Zb();b.hc("control",e.formsService.currentForm),b.yb(1),b.hc("text",null!=e.formsService.currentForm&&e.formsService.currentForm.controls.runTime.value.showEdit?"Hide Edit":"Edit"),b.yb(1),b.hc("iconClass",null!=e.formsService.currentForm&&e.formsService.currentForm.controls.runTime.value.lock?"fa fa-lock":"fa fa-unlock")("text",null!=e.formsService.currentForm&&e.formsService.currentForm.controls.runTime.value.lock?"Unlock":"Lock"),b.yb(5),b.hc("ngForOf",e.views),b.yb(2),b.hc("ngIf",e.hubCache.canWrite),b.yb(1),b.hc("formsService",e.formsService)}}let S=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.isLoaded=!1,this.isRefreshing=!1,this.refreshComplete=!1,this.cancelToken=new c.a}ngOnInit(){try{this._subscription=Object(n.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.remoteAgent=e[3],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===r.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.views=this.hubCache.hub.dexihViews,this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Dashboard Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}load(){if(this.isLoaded=!0,"edit"===this.action)if(this.dashboardKey=+this.params.dashboardKey,this.dashboardKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){let e=this.hubCache.hub.dexihDashboards.find(e=>e.key===this.dashboardKey);e=JSON.parse(JSON.stringify(e)),this.formsService.dashboard(e)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no dashboard specified to edit.");if("new"===this.action){this.refreshComplete=!0;let e=new l.i;e.minCols=4,e.maxCols=100,e.minRows=4,e.maxRows=100,e.autoRefresh=!0,this.formsService.dashboard(e),this.formsService.currentForm.controls.runTime.value.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/dashboard-new","/dashboard-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}this.formsService.currentForm.controls.autoRefresh.value&&this.remoteAgent&&!this.refreshComplete&&(this.refreshComplete=!0,this.refresh())}refresh(){this.hubService.previewDashboard(this.formsService.currentForm.value,this.formsService.currentForm.value.parameters,this.cancelToken).then(e=>{let t=this.formsService.currentForm.controls.dexihDashboardItems;e.forEach(e=>{let i=t.controls.find(t=>t.controls.key.value===e.dashboardItemKey);if(i){let t=i.controls.runTime.value.data;t.isRefreshing=!0,this.hubService.getRemoteResponse(e.dataKey,this.cancelToken).then(e=>{e.columns=this.authService.constructDataTableColumns(e.columns),t.data.next(e),t.isRefreshing=!1}).catch()}})})}toggleEdit(){let e=this.formsService.currentForm.controls.runTime.value;e.showEdit=!e.showEdit,this.formsService.currentForm.controls.runTime.setValue(e)}toggleLock(){let e=this.formsService.currentForm.controls.runTime.value;e.lock=!e.lock,this.formsService.currentForm.controls.runTime.setValue(e)}add(e){let t=this.hubCache.hub.dexihViews.find(t=>t.key===e);if(!t)return;let i=this.formsService.currentForm,a=i.controls.dexihDashboardItems,n=new l.j;n.key=this.hubCache.getNextSequence(),n.cols=1,n.rows=1,n.x=-1,n.y=-1;e:for(let o=0;o<i.controls.maxRows.value;o++)for(let e=0;e<i.controls.maxCols.value;e++){let t=!1;for(let i=0;i<a.controls.length;i++){let n=a.controls[i].value;if(n.x<=e&&n.x+n.cols>e&&n.y<=o&&n.y+n.rows>o){t=!0;break}}if(!t){n.x=e,n.y=o;break e}}n.viewKey=e,n.name=t.name;let s=this.formsService.dashboardItem(n);this.formsService.updateDashboardItemView(s),a.push(s)}newView(){this.router.navigate(["view-new"],{relativeTo:this.route})}download(e){let t=this.formsService.currentForm.controls.dexihDashboardItems.value.filter(e=>e.viewKey).map(e=>{let t=this.hubCache.hub.dexihViews.find(t=>t.key===e.viewKey),i=new l.M;return t.sourceType===l.lb.Datalink&&(i.objectKey=t.sourceDatalinkKey,i.objectType=l.lb.Datalink),t.sourceType===l.lb.Table&&(i.objectKey=t.sourceTableKey,i.objectType=l.lb.Table),i.query=t.selectQuery,i});this.hubService.downloadData(t,!1,e,this.cancelToken)}canDeactivate(){return new Promise(e=>{this.formsService.hasChanged?this.authService.confirmDialog("The dashboard has not been saved","The dashboard changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.formsService.hasChanged&&(e.returnValue="The dashboard changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(b.Kb(a.a),b.Kb(o.a),b.Kb(s.a),b.Kb(h.a),b.Kb(h.e))},e.\u0275cmp=b.Eb({type:e,selectors:[["dexih-dashboard-edit-form"]],viewQuery:function(e,t){var i;1&e&&b.Kc(v,!0),2&e&&b.rc(i=b.Wb())&&(t.dashboardItems=i)},hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},features:[b.xb([s.a])],decls:5,vars:3,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-pie-chart",3,"title","showCloseButton","padding","close"],["header",""],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"text","click"],[1,"mr-1",3,"iconClass","text","click"],[1,"mr-1",3,"click"],["iconClass","fa fa-plus","text","Add",1,"mr-1"],[1,"dropdown-item",3,"click"],[4,"ngFor","ngForOf"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,w,11,7,"ng-template",null,2,b.Ec),b.Lb(4,"router-outlet"),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.jc("title","Dashboard - ",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.name.value,""),b.hc("showCloseButton",!0)("padding",!1))},directives:[u.P,h.j,d.a,u.j,u.f,u.s,u.i,m.s,f.a,m.t,p.a,g.a],encapsulation:2}),e})()},MbvK:function(e,t,i){"use strict";i.d(t,"a",(function(){return z}));var a=i("4Y1E"),n=i("XNiG"),s=i("itXk"),o=i("VRyK"),c=i("cvPx"),r=i("ElCs"),l=i("Z+eP"),b=i("3WyZ"),h=i("2v7R"),u=i("soiQ"),d=i("fXoL"),m=i("tyNb"),f=i("ofXK"),p=i("Wumg"),g=i("PMKX"),v=i("/pur"),y=i("iFLP"),C=i("79jk"),w=i("64E1"),S=i("oLr2"),k=i("YcGA"),O=i("3Pt+"),N=i("+F4M"),T=i("hJJo"),D=i("RXlv"),x=i("H3K+"),F=i("kzgk");function I(e,t){if(1&e&&d.Lb(0,"save-button",23),2&e){const e=d.Zb(3);d.hc("formsService",e.formsService)}}const K=function(e){return{active:e}};function E(e,t){if(1&e){const e=d.Pb();d.Ob(0,"dexih-invalid-form-details",10),d.Vb("click",(function(){return d.vc(e),d.Zb(2).formsService.showErrors()})),d.Nb(),d.Ob(1,"dexih-button-refresh",11),d.Vb("click",(function(){return d.vc(e),d.Zb(2).refresh()})),d.Nb(),d.Ob(2,"download-button",12),d.Vb("download",(function(t){return d.vc(e),d.Zb(2).download(t)})),d.Nb(),d.Ob(3,"div",13),d.Ob(4,"label",14),d.Ob(5,"input",15),d.Vb("click",(function(){return d.vc(e),d.Zb(2).toggleChart()})),d.Nb(),d.Lb(6,"i",16),d.Nb(),d.Ob(7,"label",17),d.Ob(8,"input",18),d.Vb("click",(function(){return d.vc(e),d.Zb(2).toggleChart()})),d.Nb(),d.Lb(9,"i",19),d.Nb(),d.Nb(),d.Dc(10,I,1,1,"save-button",20),d.Ob(11,"dexih-button-edit",21),d.Vb("click",(function(){return d.vc(e),d.Zb(2).toggleEdit()})),d.Nb(),d.Lb(12,"cancel-button",22)}if(2&e){const e=d.Zb(2);d.hc("control",e.formsService.currentForm),d.yb(4),d.hc("ngClass",d.mc(6,K,!1===e.showChart)),d.yb(3),d.hc("ngClass",d.mc(8,K,!0===e.showChart)),d.yb(3),d.hc("ngIf",e.hubCache.canWrite),d.yb(1),d.hc("text",e.showEdit?"Hide Edit":"Edit"),d.yb(1),d.hc("formsService",e.formsService)}}function V(e,t){if(1&e&&(d.Ob(0,"section",32),d.Ob(1,"form-select",37),d.Lb(2,"table-edit-button",38),d.Nb(),d.Nb()),2&e){const e=d.Zb(4);d.yb(1),d.hc("errors",null==e.errors?null:e.errors.sourceTableKey)("items",e.connectionTables),d.yb(1),d.hc("key",e.formsService.currentForm.controls.sourceTableKey.value)}}function L(e,t){if(1&e){const e=d.Pb();d.Ob(0,"section",32),d.Ob(1,"form-select",39),d.Lb(2,"datalink-edit-button",38),d.Nb(),d.Ob(3,"dexih-button-refresh",40),d.Vb("click",(function(){return d.vc(e),d.Zb(4).refreshDatalink()})),d.Nb(),d.Nb()}if(2&e){const e=d.Zb(4);d.yb(1),d.hc("errors",null==e.errors?null:e.errors.sourceDatalinkKey)("items",e.datalinks),d.yb(1),d.hc("key",e.formsService.currentForm.controls.sourceDatalinkKey.value)}}function P(e,t){if(1&e&&(d.Ob(0,"form",28),d.Ob(1,"fieldset"),d.Ob(2,"section"),d.Lb(3,"form-input",29),d.Nb(),d.Ob(4,"section"),d.Lb(5,"form-textarea",30),d.Nb(),d.Ob(6,"section"),d.Ob(7,"div",31),d.Ob(8,"section",32),d.Lb(9,"form-select",33),d.Nb(),d.Dc(10,V,3,3,"section",34),d.Dc(11,L,4,3,"section",34),d.Nb(),d.Lb(12,"form-checkbox",35),d.Lb(13,"form-checkbox",36),d.Nb(),d.Nb(),d.Nb()),2&e){const e=d.Zb(3);d.hc("formGroup",e.formsService.currentForm),d.yb(3),d.hc("autocapitalize",e.on)("errors",e.formsService.formErrors.name),d.yb(2),d.hc("showMarkdown",!0),d.yb(4),d.hc("items",e.sourceTypes)("enableFilter",!1),d.yb(1),d.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eDataObjectType.Table),d.yb(1),d.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eDataObjectType.Datalink)}}function j(e,t){if(1&e){const e=d.Pb();d.Ob(0,"div",41),d.Ob(1,"dexih-button-refresh",42),d.Vb("click",(function(){return d.vc(e),d.Zb(3).refresh()})),d.Nb(),d.Nb()}2&e&&(d.yb(1),d.hc("autoCompact",!1))}function A(e,t){if(1&e){const e=d.Pb();d.Ob(0,"dexih-widget-section",24),d.Dc(1,P,14,8,"form",25),d.Ob(2,"input-parameters",26),d.Vb("onRefreshData",(function(){return d.vc(e),d.Zb(2).refresh()}))("onChange",(function(){return d.vc(e),d.Zb(2).parameterChange()})),d.Nb(),d.Dc(3,j,2,1,"div",27),d.Nb()}if(2&e){const e=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("ngIf",e.showEdit),d.yb(1),d.hc("showEdit",e.showEdit)("parameters",null==e.formsService.currentForm?null:e.formsService.currentForm.controls.parameters)("formsService",e.formsService)("refreshEvent",e.refreshDataSubject.asObservable()),d.yb(1),d.hc("ngIf",!e.data||0===e.data.length)}}function M(e,t){if(1&e){const e=d.Pb();d.Ob(0,"span",45),d.Ob(1,"div",46),d.Ob(2,"div",47),d.Fc(3),d.Nb(),d.Nb(),d.Ob(4,"form-input",48),d.Vb("ngModelChange",(function(i){return d.vc(e),t.$implicit.value=i})),d.Nb(),d.Nb()}if(2&e){const e=t.$implicit,i=t.index;d.yb(3),d.Hc(" ",e.logicalName," "),d.yb(1),d.jc("name","column",i,""),d.hc("placeholder","Enter "+e.logicalName)("ngModel",e.value)}}function R(e,t){if(1&e&&(d.Ob(0,"dexih-widget-section",43),d.Dc(1,M,5,4,"span",44),d.Nb()),2&e){const e=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("ngForOf",e.inputColumns)}}function Z(e,t){if(1&e){const e=d.Pb();d.Ob(0,"dexih-widget-section",49),d.Ob(1,"query-builder",50),d.Vb("hasChanged",(function(){return d.vc(e),d.Zb(2).hasChanged()}))("onRefreshData",(function(){return d.vc(e),d.Zb(2).refresh()})),d.Nb(),d.Nb()}if(2&e){const e=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("selectQuery",e.formsService.currentForm.controls.selectQuery.value)("columns",e.tableColumns)("inputColumns",e.inputColumns)("parameters",e.formsService.currentForm.controls.parameters.value)("refreshEvent",e.refreshDataSubject.asObservable())}}function _(e,t){if(1&e){const e=d.Pb();d.Ob(0,"dexih-button-refresh",11),d.Vb("click",(function(){return d.vc(e),d.Zb(4).refresh()})),d.Nb()}}function H(e,t){if(1&e&&(d.Ob(0,"dexih-table",53),d.Dc(1,_,1,0,"ng-template",null,54,d.Ec),d.Nb()),2&e){const e=d.Zb(3);d.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",e.columns)("data",e.data)("hideTable",e.showChart)}}function B(e,t){if(1&e){const e=d.Pb();d.Ob(0,"div"),d.Ob(1,"chart-builder",55),d.Vb("hasChanged",(function(){return d.vc(e),d.Zb(3).hasChanged()})),d.Nb(),d.Nb()}if(2&e){const e=d.Zb(3);d.yb(1),d.hc("title",e.formsService.currentForm.controls.name.value)("columns",e.columns)("data",e.data)("config",e.formsService.currentForm.controls.chartConfig.value)("showEdit",e.showEdit)}}function U(e,t){if(1&e&&(d.Dc(0,H,3,5,"dexih-table",51),d.Dc(1,B,2,5,"div",52)),2&e){const e=d.Zb(2);d.hc("ngIf",!e.showChart),d.yb(1),d.hc("ngIf",e.showChart)}}function q(e,t){if(1&e){const e=d.Pb();d.Ob(0,"div",1),d.Ob(1,"dexih-widget",2),d.Vb("close",(function(){return d.vc(e),d.Zb().close()})),d.Dc(2,E,13,10,"ng-template",null,3,d.Ec),d.Dc(4,A,4,7,"dexih-widget-section",4),d.Dc(5,R,2,2,"dexih-widget-section",5),d.Ob(6,"series-animate",6),d.Vb("hasChanged",(function(){return d.vc(e),d.Zb().hasChanged()}))("dataChange",(function(t){return d.vc(e),d.Zb().data=t})),d.Nb(),d.Dc(7,Z,2,6,"dexih-widget-section",7),d.Dc(8,U,2,2,"ng-template",8),d.Nb(),d.Lb(9,"dexih-help",9),d.Nb()}if(2&e){const e=d.Zb();d.yb(1),d.hc("showCloseButton",!0)("padding",!1),d.yb(3),d.hc("ngIf",e.formsService.currentForm&&(e.showEdit||(null==e.formsService.currentForm?null:e.formsService.currentForm.controls.parameters.length)>0||(null==e.datalinkParameters?null:e.datalinkParameters.length)>0)),d.yb(1),d.hc("ngIf",e.inputColumns&&e.inputColumns.length>0),d.yb(1),d.hc("showEdit",e.showEdit)("animateConfig",e.animateConfig)("columns",e.columns)("baseData",e.baseData)("data",e.data),d.yb(1),d.hc("ngIf",e.showEdit),d.yb(1),d.hc("ngIf",(null==e.columns?null:e.columns.length)>0&&(null==e.data?null:e.data.length)>0)}}let z=(()=>{class e{constructor(e,t,i,a,s){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=s,this.showEdit=!1,this.hasEdited=!1,this.refreshDataSubject=new n.a,this.sourceTypes=[{key:u.lb.Datalink,name:"Datalink"},{key:u.lb.Table,name:"Table"}],this.eViewType=u.rc,this.eDataObjectType=u.lb,this.connectionTables=[],this.datalinks=[],this.showChart=!1,this.isLoaded=!1,this.firstLoad=!0,this.dialogOpen=!1,this.animationValues=[],this.animationPaused=!1,this.cancelToken=new b.a}get animateConfig(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.animateConfig.value}set animateConfig(e){var t,i;null===(i=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===i||i.controls.animateConfig.setValue(e)}get selectQuery(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.selectQuery.value}set selectQuery(e){var t,i;null===(i=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===i||i.controls.selectQuery.setValue(e)}ngOnInit(){try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.remoteAgent=e[3],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===h.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(()=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Edit")}}load(){if(this.isLoaded=!0,this.hubCache&&this.hubCache.isLoaded()&&(this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks),"edit"===this.action)if(this.viewKey=+this.params.viewKey,this.viewKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){let e=this.hubCache.hub.dexihViews.find(e=>e.key===this.viewKey);e=JSON.parse(JSON.stringify(e)),null==e.selectQuery&&(e.selectQuery=new u.V),null==e.animateConfig&&(e.animateConfig=new u.a),this.inputColumns=e.inputValues,this.showChart=e.viewType===u.rc.Chart,this.formsService.view(e),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no view specified to edit.");if("new"===this.action){let e=new u.L;e.selectQuery=new u.V,e.animateConfig=new u.a,this.formsService.view(e),this.watchChanges(),this.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/view-new","/view-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}this.remoteAgent&&(this.firstLoad?this.formsService.currentForm.controls.autoRefresh.value&&this.refresh():this.dialogOpen||(this.dialogOpen=!0,this.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then(e=>{e&&this.refresh(),this.dialogOpen=!1})))}watchChanges(){this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(o.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe(()=>{this.reset(),this.selectQuery=new u.V,this.animateConfig=new u.a,this.getColumns(),this.refreshDatalink(),this.refresh()})}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}toggleChart(){this.showChart?(this.showChart=!1,this.formsService.currentForm.controls.viewType.setValue(u.rc.Table)):(this.showChart=!0,null==this.formsService.currentForm.controls.chartConfig.value&&this.formsService.currentForm.controls.chartConfig.setValue(new u.b),this.formsService.currentForm.controls.viewType.setValue(u.rc.Chart))}getColumns(){let e=this.formsService.currentForm,t=e.controls.inputValues.value;if(e.controls.sourceType.value===u.lb.Table&&e.controls.sourceTableKey.value>0){let i=this.hubCache.getTable(e.controls.sourceTableKey.value);if(i)return this.inputColumns=i.dexihTableColumns.filter(e=>e.isInput).map(e=>(t.find(t=>t.name===e.name),{datalinkKey:0,datalinkName:"",name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue,defaultValue:e.defaultValue})),void(this.tableColumns=i.dexihTableColumns);this.reset()}else this.reset();if(e.controls.sourceType.value===u.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){let i=this.datalinks.find(t=>t.key===e.controls.sourceDatalinkKey.value);if(i){const e=new l.b;e.buildInputOutput(this.hubCache,i),this.tableColumns=e.getDatalinkOutputColumns(i),this.inputColumns=i.sourceDatalinkTable.dexihDatalinkColumns.filter(e=>e.isInput).map(e=>{let a=t.find(t=>t.name===e.name),n=null;return n=a?a.value:e.defaultValue,{datalinkKey:i.key,datalinkName:i.name,name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:n,defaultValue:e.defaultValue}})}else this.reset()}else this.reset()}reset(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null,this.baseData=null}refreshDatalink(){let e=this.formsService.currentForm,t=this.formsService.currentForm.controls.parameters;for(let i=t.controls.length-1;i>=0;i--)t.controls[i].value.datalinkParameterKey&&t.removeAt(i);if(e.controls.sourceType.value===u.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){let i=this.datalinks.find(t=>t.key===e.controls.sourceDatalinkKey.value);if(i){let e=i.parameters;for(let i of e){let e=Object.assign({},i);e.datalinkParameterKey=i.key,e.key=this.hubCache.getNextSequence();let a=this.formsService.parameter(e);t.push(a)}}}}refresh(){let e=this.formsService.currentForm,t=[],i=this.formsService.currentForm.controls.parameters.getRawValue();i&&(t=t.concat(i));let a=e.value;a.selectQuery=e.controls.selectQuery.value,a.animateConfig=e.controls.animateConfig.value,(a.sourceType===u.lb.Table&&a.sourceTableKey>0||a.sourceType===u.lb.Datalink&&a.sourceDatalinkKey>0)&&this.hubService.previewView(a,this.inputColumns,t,this.cancelToken).then(e=>{this.refreshDataSubject.next(),this.columns=e.columns,this.baseData=e.data,this.animateConfig.seriesColumn||(this.data=this.baseData)}).catch(()=>{})}download(e){let t=this.formsService.currentForm.value,i=new u.M;t.sourceType===u.lb.Datalink&&(i.objectKey=t.sourceDatalinkKey,i.objectType=u.lb.Datalink),t.sourceType===u.lb.Table&&(i.objectKey=t.sourceTableKey,i.objectType=u.lb.Table),i.query=this.selectQuery,this.hubService.downloadData([i],!1,e,this.cancelToken)}hasChanged(){this.formsService.markAsChanged()}parameterChange(){this.formsService.currentForm.controls.autoRefresh.value&&this.refresh()}toggleEdit(){this.showEdit=!this.showEdit,this.hasEdited=!0}canDeactivate(){return new Promise(e=>{this.hasEdited&&this.formsService.hasChanged?this.authService.confirmDialog("The view has not been saved","The view changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.hasEdited&&this.formsService.hasChanged&&(e.returnValue="The view changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(a.a),d.Kb(r.a),d.Kb(c.a),d.Kb(m.a),d.Kb(m.e))},e.\u0275cmp=d.Eb({type:e,selectors:[["dexih-view-edit-form"]],hostBindings:function(e,t){1&e&&d.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,d.uc)},features:[d.xb([c.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit View","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton",4,"ngIf"],["title","InputColumns",3,"showExpandButton",4,"ngIf"],[3,"showEdit","animateConfig","columns","baseData","data","hasChanged","dataChange"],["title","Query Configuration",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"mr-1",3,"control","click"],["text","Reload",1,"mr-1",3,"click"],[1,"mr-1",3,"download"],["data-toggle","buttons","title","Table",1,"btn-group","btn-group-toggle","mr-1"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","table","autocomplete","off",3,"click"],[1,"fa","fa-table"],["title","Chart",1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","chart","autocomplete","off",3,"click"],[1,"fa","fa-bar-chart"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"mr-1",3,"text","click"],[3,"formsService"],[1,"mr-1",3,"formsService"],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],[3,"showEdit","parameters","formsService","refreshEvent","onRefreshData","onChange"],["class","mt-3",4,"ngIf"],[3,"formGroup"],["label","View Name","formControlName","name","placeholder","Enter the view name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["formControlName","autoRefresh","label","Automatically refresh data when view is opened"],["label","View is shared in the catalog to users with read access.","formControlName","isShared"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["text","Refresh Parameters",3,"click"],[1,"mt-3"],["text","Reload",1,"mr-1",3,"autoCompact","click"],["title","InputColumns",3,"showExpandButton"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable",4,"ngIf"],[4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable"],["actions",""],[3,"title","columns","data","config","showEdit","hasChanged"]],template:function(e,t){1&e&&d.Dc(0,q,10,11,"div",0),2&e&&d.hc("ngIf",t.formsService)},directives:[f.t,p.P,g.a,v.a,y.a,p.s,C.a,f.q,p.j,w.a,S.a,p.T,k.a,O.I,O.t,O.l,p.D,O.s,O.j,p.H,p.E,p.A,N.a,T.a,f.s,O.v,D.a,x.a,F.a],encapsulation:2}),e})()},NUI7:function(e,t,i){"use strict";i.d(t,"b",(function(){return S})),i.d(t,"a",(function(){return L}));var a=i("4Y1E"),n=i("ElCs"),s=i("2Vo4"),o=i("itXk"),c=i("soiQ"),r=i("fXoL"),l=i("tyNb"),b=i("Wumg"),h=i("H3K+"),u=i("/pur"),d=i("ofXK"),m=i("EjXd"),f=i("mWX8");const p=function(){return["fileFormat-new"]};function g(e,t){1&e&&r.Lb(0,"dexih-button-new",10),2&e&&r.hc("routerLink",r.lc(1,p))}function v(e,t){if(1&e&&r.Dc(0,g,1,2,"dexih-button-new",9),2&e){const e=r.Zb();r.hc("ngIf",e.hubCache.canWrite)}}function y(e,t){1&e&&r.Lb(0,"actions-fileFormat-button",11),2&e&&r.hc("fileFormat",t.item)}function C(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button-delete",15),r.Vb("click",(function(){r.vc(e);const t=r.Zb().items;return r.Zb().deleteFileFormats(t)})),r.Nb()}}function w(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button-save-local",12),r.Vb("click",(function(){r.vc(e);const i=t.items;return r.Zb().export(i)})),r.Nb(),r.Dc(1,C,1,0,"dexih-button-delete",13),r.Lb(2,"tags-update-button",14)}if(2&e){const e=t.items,i=r.Zb();r.yb(1),r.hc("ngIf",i.hubCache.canWrite),r.yb(1),r.hc("objectType",i.eSharedObjectType.FileFormat)("objects",e)}}let S=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[2],this.updateFileFormats()})}catch(e){this.hubService.addHubClientErrorMessage(e,"File Format Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}deleteFileFormats(e){this.hubService.deleteFileFormats(e)}updateFileFormats(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihFileFormats.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(c.dc.FileFormat,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}editFileFormat(e){this.router.navigate(["fileFormat-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach(e=>{this.hubCache.cacheAddFileFormat(e.key,t)}),this.hubService.exportHub(t,1===e.length?"FileFormat - "+e[0].name+".json":"fileFormats.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==c.dc.FileFormat&&e.changeClass!==c.dc.TagObjects||this.updateFileFormats()})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(n.a),r.Kb(l.e),r.Kb(l.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["fileFormats"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","File Formats","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],["class","mr-1","title","Create a new file format",3,"routerLink",4,"ngIf"],["title","Create a new file format",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"fileFormat"],[1,"mr-1",3,"click"],["title","Delete selected file formats",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["title","Delete selected file formats",3,"click"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Ob(1,"dexih-widget",1),r.Vb("close",(function(){return t.close()})),r.Ob(2,"dexih-table",2),r.Vb("rowClick",(function(e){return t.editFileFormat(e)})),r.Dc(3,v,1,1,"ng-template",null,3,r.Ec),r.Dc(5,y,1,1,"ng-template",4,5,r.Ec),r.Dc(7,w,3,3,"ng-template",6,7,r.Ec),r.Nb(),r.Nb(),r.Lb(9,"dexih-help",8),r.Nb()),2&e&&(r.yb(1),r.hc("showCloseButton",!0),r.yb(1),r.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[b.P,h.a,u.a,d.t,b.o,l.f,m.a,b.u,f.a,b.g],encapsulation:2}),e})();var k=i("cvPx"),O=i("2v7R"),N=i("iFLP"),T=i("64E1"),D=i("oLr2"),x=i("3Pt+");function F(e,t){if(1&e&&r.Lb(0,"save-button",8),2&e){const e=r.Zb(2);r.hc("formsService",e.formsService)}}function I(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-invalid-form-details",5),r.Vb("click",(function(){return r.vc(e),r.Zb().formsService.showErrors()})),r.Nb(),r.Dc(1,F,1,1,"save-button",6),r.Lb(2,"cancel-button",7)}if(2&e){const e=r.Zb();r.hc("control",e.formsService.currentForm),r.yb(1),r.hc("ngIf",e.hubCache.canWrite),r.yb(1),r.hc("formsService",e.formsService)}}function K(e,t){if(1&e&&(r.Ob(0,"div"),r.Lb(1,"form-input",32),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.hc("errors",e.formsService.formErrors.comment)}}function E(e,t){if(1&e&&(r.Ob(0,"div"),r.Lb(1,"form-input",33),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.hc("maxlength",1)("errors",e.formsService.formErrors.quote)}}function V(e,t){if(1&e&&(r.Ob(0,"form",9),r.Ob(1,"fieldset"),r.Ob(2,"section"),r.Lb(3,"form-input",10),r.Nb(),r.Ob(4,"section"),r.Lb(5,"form-textarea",11),r.Nb(),r.Ob(6,"div",12),r.Ob(7,"section",13),r.Lb(8,"form-input",14),r.Nb(),r.Lb(9,"section",13),r.Nb(),r.Ob(10,"div",12),r.Ob(11,"section",13),r.Lb(12,"form-input",15),r.Nb(),r.Ob(13,"section",13),r.Lb(14,"form-input",16),r.Nb(),r.Nb(),r.Ob(15,"div",12),r.Ob(16,"section",13),r.Lb(17,"form-checkbox",17),r.Nb(),r.Ob(18,"section",13),r.Lb(19,"form-checkbox",18),r.Nb(),r.Nb(),r.Ob(20,"div",12),r.Ob(21,"section",13),r.Lb(22,"form-checkbox",19),r.Nb(),r.Ob(23,"section",13),r.Lb(24,"form-checkbox",20),r.Nb(),r.Nb(),r.Ob(25,"div",12),r.Ob(26,"section",13),r.Lb(27,"form-checkbox",21),r.Dc(28,K,2,1,"div",22),r.Nb(),r.Ob(29,"section",13),r.Lb(30,"form-checkbox",23),r.Dc(31,E,2,2,"div",22),r.Nb(),r.Nb(),r.Ob(32,"div",12),r.Ob(33,"section",13),r.Lb(34,"form-checkbox",24),r.Nb(),r.Ob(35,"section",13),r.Lb(36,"form-checkbox",25),r.Nb(),r.Nb(),r.Ob(37,"div",12),r.Ob(38,"section",13),r.Lb(39,"form-checkbox",26),r.Nb(),r.Ob(40,"section",13),r.Lb(41,"form-checkbox",27),r.Nb(),r.Nb(),r.Ob(42,"div",12),r.Ob(43,"section",13),r.Lb(44,"form-checkbox",28),r.Nb(),r.Ob(45,"section",13),r.Lb(46,"form-checkbox",29),r.Nb(),r.Nb(),r.Ob(47,"div",12),r.Ob(48,"section",13),r.Lb(49,"form-checkbox",30),r.Nb(),r.Ob(50,"section",13),r.Lb(51,"form-checkbox",31),r.Nb(),r.Nb(),r.Nb(),r.Nb()),2&e){const e=r.Zb();r.hc("formGroup",e.formsService.currentForm),r.yb(3),r.hc("errors",e.formsService.formErrors.name)("autocapitalize",!0),r.yb(2),r.hc("showMarkdown",!0),r.yb(3),r.hc("errors",e.formsService.formErrors.delimiter),r.yb(4),r.hc("errors",e.formsService.formErrors.bufferSize),r.yb(2),r.hc("errors",e.formsService.formErrors.skipHeaderRows),r.yb(14),r.hc("ngIf",e.formsService.currentForm.controls.allowComments.value),r.yb(3),r.hc("ngIf",!e.formsService.currentForm.controls.ignoreQuotes.value)}}let L=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.isLoaded=!1}ngOnInit(){try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===O.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"File Format Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe()}load(){if(this.hubCache.isLoaded()){if(!this.hubCache||this.hubCache.status!==O.j.Loaded||this.isLoaded)return;if(this.isLoaded=!0,"edit"===this.action)if(this.fileFormatKey=+this.params.fileFormatKey,this.fileFormatKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){let e=this.hubCache.hub.dexihFileFormats.find(e=>e.key===this.fileFormatKey);this.formsService.fileFormat(e)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no file format specified to edit.");if("new"===this.action){let e=new c.y;this.formsService.fileFormat(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/fileFormat-new","/fileFormat-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}}}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(n.a),r.Kb(k.a),r.Kb(l.a),r.Kb(l.e))},e.\u0275cmp=r.Eb({type:e,selectors:[["dexih-fileFormat-edit-form"]],features:[r.xb([k.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Format","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","File Format Name","formControlName","name","placeholder","Enter the file format name.","iconClass","fa fa-list",3,"errors","autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Delimiter","formControlName","delimiter","placeholder","Enter the delimiter","iconClass","fa fa-list","note","The field delimiter (use \\t=tab, \\n=new line, \\r=carriage return).",3,"errors"],["type","number","label","Buffer Size","formControlName","bufferSize","placeholder","Enter buffer size","iconClass","fa fa-list","note","The size of the internal buffer that is used when reader or writing data.",3,"errors"],["type","number","label","Skip Header Rows Count","formControlName","skipHeaderRows","placeholder","Enter row count","iconClass","fa fa-list","note","The number of rows at the start of the file that will be ignored.",3,"errors"],["label","Has Header Record","formControlName","hasHeaderRecord","note","Tells the reader/writer if there is a header row in the CSV file."],["label","Ignore Header White Space","formControlName","ignoreHeaderWhiteSpace","note","Tells the reader to ignore white space in the headers when matching the columns to the properties by name."],["label","Match to Column to Header","formControlName","matchHeaderRecord","note","Tells the reader to use the column heading name to load the data.  If unchecked, columns will be read into fields in the order specified in the table columns."],["label","Set White Space Cells to Null ","formControlName","setWhiteSpaceCellsToNull","note","Set empty cells or cells containing only white spaces to null."],["label","Allow Comments","formControlName","allowComments"],[4,"ngIf"],["label","Ignore Quotes","formControlName","ignoreQuotes"],["label","Quote All Fields","formControlName","quoteAllFields","note","Tells the writer whether all fields written should have quotes around them; regardless if the field contains anything that should be escaped."],["label","Quote No Fields","formControlName","quoteNoFields","note","Tells the writer whether all fields written should not have quotes around them; regardless if the field contains anything that should be escaped."],["label","Trim Fields","formControlName","trimFields","note","Tells the reader to trim whitespace from the beginning and ending of the field value when reading."],["label","Trim Headers","formControlName","trimHeaders","note","Tells the reader to ignore white space from the beginning and ending of the headers when matching the columns to the properties by name."],["label","Detect Column Count Changes","formControlName","detectColumnCountChanges","note","Check for changes in the number of column from row to row.  If true, the job will abend."],["label","Ignore Reading Exceptions","formControlName","ignoreReadingExceptions","note","Tells the reader to ignore any issues when parsing the file.  Issues mean the file is bad in some way, and the parser isn't able to recover."],["label","Will Abend On Missing Field","formControlName","willThrowOnMissingField","note","Indicates if the job should be abended if reading and an expected field is missing."],["label","Skip Empty Records","formControlName","skipEmptyRecords","note","Tells the reader a record should be skipped when reading if it's empty. A record is considered empty if all fields are empty."],["label","Comment","formControlName","comment","placeholder","Enter comment character","iconClass","fa fa-list","note","The value used to denote a line that is commented out.",3,"errors"],["label","Quote","formControlName","quote","placeholder","Enter the quote","iconClass","fa fa-list","note","The value used to escape fields that contain a delimiter, quote, or line ending.",3,"maxlength","errors"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Ob(1,"dexih-widget",1),r.Vb("close",(function(){return t.close()})),r.Dc(2,I,3,3,"ng-template",null,2,r.Ec),r.Dc(4,V,52,9,"form",3),r.Nb(),r.Lb(5,"dexih-help",4),r.Nb()),2&e&&(r.yb(1),r.hc("showCloseButton",!0)("padding",!0),r.yb(3),r.hc("ngIf",t.formsService.currentForm))},directives:[b.P,d.t,u.a,N.a,T.a,D.a,x.I,x.t,x.l,b.D,x.s,x.j,b.H,b.A,x.o],encapsulation:2}),e})()},NbKI:function(e,t,i){"use strict";i.d(t,"a",(function(){return H}));var a=i("fXoL"),n=i("Xjf6"),s=i("XNiG"),o=i("itXk"),c=i("cvPx"),r=i("3WyZ"),l=i("soiQ"),b=i("ElCs"),h=i("Wumg"),u=i("ofXK"),d=i("3Pt+"),m=i("YcGA"),f=i("PMKX"),p=i("HjvC"),g=i("l2bN"),v=i("H3K+"),y=i("g8Ys");const C=["widget"];function w(e,t){if(1&e){const e=a.Pb();a.Ob(0,"dexih-button-edit",10),a.Vb("click",(function(){return a.vc(e),a.Zb().toggleEdit()})),a.Nb()}2&e&&a.hc("compact",!0)}function S(e,t){if(1&e){const e=a.Pb();a.Ob(0,"dexih-button-preview",10),a.Vb("click",(function(){return a.vc(e),a.Zb().toggleEdit()})),a.Nb()}2&e&&a.hc("compact",!0)}function k(e,t){if(1&e){const e=a.Pb();a.Ob(0,"dexih-button",14),a.Vb("click",(function(){return a.vc(e),a.Zb().maximise()})),a.Nb()}}function O(e,t){if(1&e){const e=a.Pb();a.Ob(0,"dexih-button",15),a.Vb("click",(function(){return a.vc(e),a.Zb().maximise()})),a.Nb()}}function N(e,t){if(1&e){const e=a.Pb();a.Ob(0,"span",20),a.Ob(1,"div",21),a.Ob(2,"div",22),a.Fc(3),a.Nb(),a.Nb(),a.Ob(4,"form-input",23),a.Vb("ngModelChange",(function(i){return a.vc(e),t.$implicit.value=i})),a.Nb(),a.Nb()}if(2&e){const e=t.$implicit,i=t.index;a.yb(3),a.Hc(" ",e.logicalName," "),a.yb(1),a.jc("name","column",i,""),a.hc("placeholder","Enter "+e.logicalName)("ngModel",e.value)}}function T(e,t){if(1&e&&(a.Ob(0,"div",18),a.Dc(1,N,5,4,"span",19),a.Nb()),2&e){const e=a.Zb(2);a.yb(1),a.hc("ngForOf",e.inputColumns)}}function D(e,t){if(1&e){const e=a.Pb();a.Ob(0,"div",18),a.Ob(1,"input-parameters",24),a.Vb("onRefreshData",(function(){return a.vc(e),a.Zb(2).refresh()})),a.Nb(),a.Nb()}if(2&e){const e=a.Zb(2);a.yb(1),a.hc("showEdit",!1)("parameters",e.item.controls.parameters)("formsService",e.formsService)("parentParameters",e.parentParameters)("refreshEvent",e.refreshDataSubject.asObservable())}}function x(e,t){if(1&e){const e=a.Pb();a.Ob(0,"div",25),a.Ob(1,"series-animate",26),a.Vb("hasChanged",(function(){return a.vc(e),a.Zb(2).hasChanged()}))("dataChange",(function(t){return a.vc(e),a.Zb(2).dataRows=t})),a.Nb(),a.Nb()}if(2&e){const e=a.Zb(2);a.yb(1),a.hc("showEdit",!1)("showFrame",!1)("animateConfig",null==e.dataResult?null:e.dataResult.viewConfig.animateConfig)("columns",null==e.dataResult?null:e.dataResult.columns)("baseData",null==e.dataResult?null:e.dataResult.data)("data",e.dataRows)}}function F(e,t){if(1&e&&(a.Ob(0,"div"),a.Dc(1,T,2,1,"div",16),a.Dc(2,D,2,5,"div",16),a.Dc(3,x,2,6,"div",17),a.Nb()),2&e){const e=a.Zb();a.yb(1),a.hc("ngIf",e.inputColumns&&e.inputColumns.length>0),a.yb(1),a.hc("ngIf",e.item.controls.parameters.length>0),a.yb(1),a.hc("ngIf",!(null!=e.data&&e.data.isRefreshing)&&(null==e.dataResult||null==e.dataResult.columns?null:e.dataResult.columns.length)>0&&(null==e.dataResult?null:e.dataResult.viewConfig)&&(null==e.dataResult?null:e.dataResult.data))}}function I(e,t){if(1&e){const e=a.Pb();a.Ob(0,"div",27),a.Ob(1,"form",28),a.Ob(2,"section"),a.Lb(3,"form-input",29),a.Nb(),a.Ob(4,"section"),a.Lb(5,"form-textarea",30),a.Nb(),a.Ob(6,"section"),a.Ob(7,"form-select",31),a.Lb(8,"view-edit-button",32),a.Nb(),a.Nb(),a.Ob(9,"section"),a.Lb(10,"form-checkbox",33),a.Lb(11,"form-checkbox",34),a.Nb(),a.Nb(),a.Ob(12,"input-parameters",35),a.Vb("onRefreshData",(function(){return a.vc(e),a.Zb().refresh()})),a.Nb(),a.Nb()}if(2&e){const e=a.Zb();a.yb(1),a.hc("formGroup",e.item),a.yb(2),a.hc("autocapitalize",e.on),a.yb(2),a.hc("showMarkdown",!0),a.yb(2),a.hc("items",e.views),a.yb(1),a.hc("key",e.item.controls.viewKey.value),a.yb(4),a.hc("showEdit",e.showEdit)("allowAddRemove",!1)("parameters",e.item.controls.parameters)("formsService",e.formsService)("parentParameters",e.parentParameters)("refreshEvent",e.refreshDataSubject.asObservable())}}function K(e,t){1&e&&(a.Ob(0,"div",40),a.Lb(1,"div",41),a.Fc(2," Refreshing, please wait... "),a.Nb())}function E(e,t){if(1&e&&(a.Ob(0,"div",46),a.Ob(1,"div",47),a.Ob(2,"b"),a.Fc(3),a.Nb(),a.Nb(),a.Nb()),2&e){const e=a.Zb(4);a.yb(3),a.Gc(e.item.controls.name.value)}}function V(e,t){if(1&e&&(a.Ob(0,"div",48),a.Ob(1,"div",18),a.Lb(2,"ngx-md",49),a.Nb(),a.Nb()),2&e){const e=a.Zb(4);a.yb(2),a.hc("data",e.item.controls.description.value)}}function L(e,t){if(1&e&&a.Lb(0,"dexih-table",54),2&e){const e=a.Zb(5);a.hc("enableMultiSelect",!1)("enableResponsive",!1)("enableSaveCsv",!1)("enableFilter",!1)("columns",e.dataResult.columns)("data",e.dataRows)}}function P(e,t){if(1&e&&a.Lb(0,"chart-view",55),2&e){const e=a.Zb(5);a.hc("responsive",!0)("columns",e.dataResult.columns)("data",e.dataRows)("config",e.view.chartConfig)}}function j(e,t){if(1&e&&(a.Ob(0,"div",50),a.Dc(1,L,1,6,"dexih-table",51),a.Ob(2,"div",52),a.Dc(3,P,1,4,"chart-view",53),a.Nb(),a.Nb()),2&e){const e=a.Zb(4);a.yb(1),a.hc("ngIf",e.view.viewType==e.eViewType.Table),a.yb(2),a.hc("ngIf",e.view.viewType==e.eViewType.Chart)}}function A(e,t){if(1&e){const e=a.Pb();a.Ob(0,"div",56),a.Vb("click",(function(){return a.vc(e),a.Zb(4).refresh()})),a.Lb(1,"i",57),a.Fc(2," Select to refresh the view. "),a.Nb()}}function M(e,t){if(1&e&&(a.Dc(0,E,4,1,"div",42),a.Dc(1,V,3,1,"div",43),a.Dc(2,j,4,2,"div",44),a.Dc(3,A,3,0,"ng-template",null,45,a.Ec)),2&e){const e=a.sc(4),t=a.Zb(3);a.hc("ngIf",t.item.controls.header.value),a.yb(1),a.hc("ngIf",t.item.controls.description.value),a.yb(1),a.hc("ngIf",!(null!=t.data&&t.data.isRefreshing)&&(null==t.dataResult||null==t.dataResult.columns?null:t.dataResult.columns.length)>0&&(null==t.dataResult||null==t.dataResult.data?null:t.dataResult.data.length)>0)("ngIfElse",e)}}const R=function(e){return{overflow:e}};function Z(e,t){if(1&e&&(a.Ob(0,"div",37),a.Dc(1,K,3,0,"div",38),a.Dc(2,M,5,4,"ng-template",null,39,a.Ec),a.Nb()),2&e){const e=a.sc(3),t=a.Zb(2);a.hc("ngStyle",a.mc(3,R,t.item.controls.scrollable.value?"scroll":"hidden")),a.yb(1),a.hc("ngIf",null==t.data?null:t.data.isRefreshing)("ngIfElse",e)}}function _(e,t){if(1&e&&a.Dc(0,Z,4,5,"div",36),2&e){const e=a.Zb();a.hc("ngIf",!e.showPreview&&e.view)}}let H=(()=>{class e{constructor(e,t,i){this.authService=e,this.hubService=t,this.formsService=i,this.showEdit=!0,this.showPreview=!1,this.isMaximized=!1,this.onRemove=new a.n,this.onMaximize=new a.n,this.eViewType=l.rc,this.firstLoad=!0,this.dialogOpen=!1,this.dataRows=[],this.refreshDataSubject=new s.a,this.cancelToken=new r.a}ngOnInit(){try{this._subscription=Object(o.a)(this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{var t;this.hubCache=e[0],this.remoteAgent=e[1],this.hubService.isHubCacheLoaded&&(this.views=this.hubCache.hub.dexihViews,(null===(t=this.item)||void 0===t?void 0:t.controls.viewKey)&&(this.view=this.hubCache.hub.dexihViews.find(e=>e.key===this.item.controls.viewKey.value),this.data=this.item.controls.runTime.value.data,this.data?this._refreshDataSubscription=this.data.data.subscribe(e=>{e&&(this.dataResult=e,e.viewConfig.animateConfig||(this.dataRows=this.dataResult.data),e.status&&this.hubService.addHubMessage(e.status,!1,this.view.name))}):this.remoteAgent&&(this.firstLoad?this.refresh():this.dialogOpen||(this.dialogOpen=!0,this.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then(e=>{e&&this.refresh(),this.dialogOpen=!1})),this.firstLoad=!1)),this.parentParameters=this.formsService.currentForm.controls.parameters.value,this._parametersSubscription&&this._parametersSubscription.unsubscribe(),this._parametersSubscription=this.formsService.currentForm.controls.parameters.valueChanges.subscribe(e=>{this.parentParameters=e}))})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._refreshDataSubscription&&this._refreshDataSubscription.unsubscribe(),this._parametersSubscription&&this._parametersSubscription.unsubscribe(),this.cancelToken.cancel()}ngOnChanges(e){let t=e.item;if(t){let e=t.currentValue;this.views&&e.value&&(this.view=this.hubCache.hub.dexihViews.find(t=>t.key===e.value)),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._viewKeySubscription=e.controls.viewKey.valueChanges.subscribe(t=>{this.formsService.updateDashboardItemView(e)})}}refresh(){let e=this.hubService.previewViewKey(this.item.controls.viewKey.value,null,this.formsService.currentForm.controls.parameters.value,this.item.controls.parameters.value,this.cancelToken);this.data=this.item.controls.runTime.value.data,this.data.refresh(e),e.then(e=>{this.refreshDataSubject.next(),this.dataResult=e,this.dataResult.viewConfig.animateConfig||(this.dataRows=this.dataResult.data)}).catch(e=>{this.hubService.addHubMessage(e)})}parameterChange(){this.refresh()}toggleEdit(){this.showEdit=!this.showEdit}removeItem(e){e.preventDefault(),e.stopPropagation(),this.onRemove.emit()}maximise(){this.onMaximize.emit(this.item)}}return e.\u0275fac=function(t){return new(t||e)(a.Kb(b.a),a.Kb(n.a),a.Kb(c.a))},e.\u0275cmp=a.Eb({type:e,selectors:[["dashboard-item"]],viewQuery:function(e,t){var i;1&e&&a.Bc(C,!0),2&e&&a.rc(i=a.Wb())&&(t.widget=i.first)},inputs:{item:"item",showEdit:"showEdit",showPreview:"showPreview",refreshData:"refreshData",isMaximized:"isMaximized"},outputs:{onRemove:"onRemove",onMaximize:"onMaximize"},features:[a.wb],decls:16,vars:9,consts:[[1,"side-menu"],[1,"side-menu-content"],[1,"spin-icon"],[1,"fa","fa-cog","fa-spin"],[1,"side-menu-box"],[1,"bg-light","rounded","p-1"],[3,"compact","click"],["class","ml-1",3,"compact","click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",3,"click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",3,"click",4,"ngIf"],[1,"ml-1",3,"compact","click"],[4,"ngIf"],["class","p-3 gridster-item-content",4,"ngIf"],[3,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",1,"ml-1",3,"click"],["buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",1,"ml-1",3,"click"],["class","m-1",4,"ngIf"],["class","m-1","style","z-index: 99999;",4,"ngIf"],[1,"m-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"showEdit","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],[1,"m-1",2,"z-index","99999"],[3,"showEdit","showFrame","animateConfig","columns","baseData","data","hasChanged","dataChange"],[1,"p-3","gridster-item-content"],[3,"formGroup"],["label","Item Name","formControlName","name","placeholder","Enter the dashboard item name.","iconClass","fa fa-list",3,"autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Select View","formControlName","viewKey","itemKey","key","itemName","name",3,"items"],[3,"key"],["label","Show Header","formControlName","header"],["label","Allow Scrolling","formControlName","scrollable"],[3,"showEdit","allowAddRemove","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],["class","box",3,"ngStyle",4,"ngIf"],[1,"box",3,"ngStyle"],["class","p-3",4,"ngIf","ngIfElse"],["notRefreshing",""],[1,"p-3"],[1,"dexih-loader"],["class","box-header bg-secondary text-white",4,"ngIf"],["class","box-header",4,"ngIf"],["class","box-content",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"box-header","bg-secondary","text-white"],[1,"m-3"],[1,"box-header"],[3,"data"],[1,"box-content"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data",4,"ngIf"],[1,"h-100"],[3,"responsive","columns","data","config",4,"ngIf"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data"],[3,"responsive","columns","data","config"],[1,"alert","alert-info",3,"click"],[1,"fa","fa-warning"]],template:function(e,t){1&e&&(a.Ob(0,"div",0),a.Ob(1,"div",1),a.Ob(2,"div",2),a.Lb(3,"i",3),a.Nb(),a.Ob(4,"div",4),a.Ob(5,"div",5),a.Ob(6,"div"),a.Ob(7,"dexih-button-refresh",6),a.Vb("click",(function(){return t.refresh()})),a.Nb(),a.Dc(8,w,1,1,"dexih-button-edit",7),a.Dc(9,S,1,1,"dexih-button-preview",7),a.Dc(10,k,1,0,"dexih-button",8),a.Dc(11,O,1,0,"dexih-button",9),a.Ob(12,"dexih-button-delete",10),a.Vb("click",(function(e){return t.removeItem(e)})),a.Nb(),a.Nb(),a.Dc(13,F,4,3,"div",11),a.Nb(),a.Nb(),a.Nb(),a.Nb(),a.Dc(14,I,13,11,"div",12),a.Dc(15,_,1,1,"ng-template",13)),2&e&&(a.yb(7),a.hc("compact",!0),a.yb(1),a.hc("ngIf",!t.showEdit),a.yb(1),a.hc("ngIf",t.showEdit),a.yb(1),a.hc("ngIf",!t.isMaximized),a.yb(1),a.hc("ngIf",t.isMaximized),a.yb(1),a.hc("compact",!0),a.yb(1),a.hc("ngIf",!t.showEdit&&!t.showPreview&&t.view),a.yb(1),a.hc("ngIf",t.showEdit),a.yb(1),a.hc("ngIf",!t.showEdit))},directives:[h.s,u.t,h.g,h.j,h.q,h.f,u.s,h.D,d.s,d.v,m.a,f.a,d.I,d.t,d.l,d.j,h.H,h.E,p.a,h.A,u.w,g.a,v.a,y.a],styles:[".dashboard-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;overflow:auto}"]}),e})()},e1St:function(e,t,i){"use strict";i.r(t),i.d(t,"HubBaseModule",(function(){return Go}));var a=i("3Pt+"),n=i("PCNd"),s=i("tyNb"),o=i("4Y1E"),c=i("ElCs"),r=i("2Vo4"),l=i("itXk"),b=i("soiQ"),h=i("fXoL"),u=i("Wumg"),d=i("H3K+"),m=i("MI/1"),f=i("VdXI"),p=i("ofXK"),g=i("mWX8");function v(e,t){if(1&e&&(h.Lb(0,"actions-columnValidation-button",8),h.Lb(1,"dependent-items-button",9)),2&e){const e=t.item,i=h.Zb();h.hc("columnValidation",e),h.yb(1),h.hc("key",e.key)("objectType",i.eSharedObjectType.ColumnValidation)}}function y(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",10),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().deleteValidations(t)})),h.Nb()}}function C(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",10),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb(),h.Dc(1,y,1,0,"dexih-button-delete",11),h.Lb(2,"tags-update-button",12)}if(2&e){const e=t.items,i=h.Zb();h.yb(1),h.hc("ngIf",i.hubCache.canWrite),h.yb(1),h.hc("objectType",i.eSharedObjectType.ColumnValidation)("objects",e)}}const w=function(){return["columnValidation-new"]};function S(e,t){1&e&&h.Lb(0,"dexih-button-new",14),2&e&&h.hc("routerLink",h.lc(1,w))}function k(e,t){if(1&e&&h.Dc(0,S,1,2,"dexih-button-new",13),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}let O=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[0],this.updateValidations()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Column Validation Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}deleteValidations(e){this.hubService.deleteColumnValidations(e)}updateValidations(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihColumnValidations.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(b.dc.ColumnValidation,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}edit(e){this.router.navigate(["columnValidation-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach(e=>{this.hubCache.cacheAddColumnValidation(e.key,t)}),this.hubService.exportHub(t,1===e.length?"ColumnValidation - "+e[0].name+".json":"columnValidations.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.ColumnValidation&&e.changeClass!==b.dc.TagObjects||this.updateValidations()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["columnValidations"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Validation Rules","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"mr-1",3,"columnValidation"],[1,"mr-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,v,2,3,"ng-template",3,4,h.Ec),h.Dc(5,C,3,3,"ng-template",5,6,h.Ec),h.Dc(7,k,1,1,"ng-template",null,7,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,m.a,f.a,u.u,p.t,g.a,u.g,u.o,s.f],encapsulation:2}),e})();var N=i("2v7R"),T=i("cvPx"),D=i("1qMd"),x=i("3WyZ"),F=i("64E1"),I=i("iFLP"),K=i("oLr2");function E(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div"),h.Ob(1,"div",10),h.Ob(2,"div",11),h.Ob(3,"button",12),h.Vb("click",(function(){return h.vc(e),h.Zb(3).test()})),h.Lb(4,"i",13),h.Nb(),h.Nb(),h.Ob(5,"input",14),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb(3).testValue=t})),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(3);h.yb(5),h.hc("ngModel",e.testValue)}}function V(e,t){if(1&e&&h.Lb(0,"save-button",6),2&e){const e=h.Zb(3);h.hc("formsService",e.formsService)}}function L(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-invalid-form-details",7),h.Vb("click",(function(){return h.vc(e),h.Zb(2).formsService.showErrors()})),h.Nb(),h.Dc(1,E,6,1,"div",8),h.Dc(2,V,1,1,"save-button",9)}if(2&e){const e=h.Zb(2);h.hc("control",e.formsService.currentForm),h.yb(1),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("ngIf",e.hubCache.canWrite)}}function P(e,t){if(1&e&&(h.Ob(0,"div",4),h.Dc(1,L,3,3,"ng-template",5),h.Lb(2,"cancel-button",6),h.Nb()),2&e){const e=h.Zb();h.yb(1),h.hc("ngIf",e.hubCache&&e.hubCache.status===e.eCacheStatus.Loaded),h.yb(1),h.hc("formsService",e.formsService)}}function j(e,t){if(1&e&&(h.Ob(0,"div"),h.Fc(1),h.Nb()),2&e){const e=h.Zb(3);h.yb(1),h.Hc("Cleaned Value = ",e.testResult.cleanedValue," ")}}function A(e,t){if(1&e&&(h.Ob(0,"div"),h.Fc(1),h.Nb()),2&e){const e=h.Zb(3);h.yb(1),h.Hc("Reject Reason = ",e.testResult.rejectReason," ")}}function M(e,t){if(1&e&&(h.Ob(0,"section"),h.Ob(1,"div",30),h.Fc(2),h.Dc(3,j,2,1,"div",8),h.Dc(4,A,2,1,"div",8),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.Cb("alert-danger",0==e.testResult.success)("alert-success",1==e.testResult.success),h.yb(1),h.Hc(" Test Result = ",e.testResult.success," "),h.yb(1),h.hc("ngIf",e.testResult.cleanedValue),h.yb(1),h.hc("ngIf",e.testResult.rejectReason)}}function R(e,t){if(1&e&&(h.Ob(0,"section",17),h.Lb(1,"form-select",31),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("items",e.cleanActions)}}function Z(e,t){1&e&&(h.Ob(0,"section"),h.Lb(1,"form-input",32),h.Nb())}function _(e,t){1&e&&(h.Ob(0,"div",16),h.Ob(1,"section",17),h.Lb(2,"form-input",33),h.Nb(),h.Ob(3,"section",17),h.Lb(4,"form-input",34),h.Nb(),h.Nb())}function H(e,t){1&e&&(h.Ob(0,"section"),h.Lb(1,"form-input",35),h.Nb())}function B(e,t){1&e&&(h.Ob(0,"section"),h.Lb(1,"form-input",36),h.Nb())}function U(e,t){1&e&&(h.Ob(0,"div",16),h.Ob(1,"section",17),h.Lb(2,"form-input",37),h.Nb(),h.Ob(3,"section",17),h.Lb(4,"form-input",38),h.Nb(),h.Nb())}function q(e,t){if(1&e&&(h.Ob(0,"form",15),h.Ob(1,"fieldset"),h.Dc(2,M,5,7,"section",8),h.Ob(3,"div",16),h.Ob(4,"section",17),h.Lb(5,"form-input",18),h.Nb(),h.Ob(6,"section",17),h.Lb(7,"form-select",19),h.Nb(),h.Nb(),h.Ob(8,"section"),h.Lb(9,"form-textarea",20),h.Nb(),h.Ob(10,"div",16),h.Ob(11,"section",17),h.Lb(12,"form-select",21),h.Nb(),h.Dc(13,R,2,1,"section",22),h.Nb(),h.Dc(14,Z,2,0,"section",8),h.Ob(15,"section"),h.Lb(16,"form-checkbox",23),h.Nb(),h.Dc(17,_,5,0,"div",24),h.Dc(18,H,2,0,"section",8),h.Dc(19,B,2,0,"section",8),h.Dc(20,U,5,0,"div",24),h.Ob(21,"section"),h.Lb(22,"form-tags",25),h.Nb(),h.Ob(23,"section"),h.Lb(24,"form-tags",26),h.Nb(),h.Ob(25,"section"),h.Lb(26,"form-select",27),h.Nb(),h.Ob(27,"section"),h.Lb(28,"form-checkbox",28),h.Nb(),h.Ob(29,"section"),h.Lb(30,"form-checkbox",29),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(2),h.hc("ngIf",e.testResult),h.yb(3),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("items",e.typeCodes),h.yb(2),h.hc("showMarkdown",!0),h.yb(3),h.hc("items",e.InvalidActions),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.invalidAction==e.eInvalidAction.Clean||e.formsService.currentForm.value.invalidAction==e.eInvalidAction.RejectClean),h.yb(1),h.hc("ngIf",(e.formsService.currentForm.value.invalidAction==e.eInvalidAction.RejectClean||e.formsService.currentForm.value.invalidAction==e.eInvalidAction.Clean)&&e.formsService.currentForm.value.cleanAction==e.eCleanAction.CleanValue),h.yb(3),h.hc("ngIf",e.formsService.currentForm.value.dataType==e.eTypeCode.String||e.formsService.currentForm.value.dataType==e.eTypeCode.Char),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.dataType==e.eTypeCode.String||e.formsService.currentForm.value.dataType==e.eTypeCode.Char),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.dataType==e.eTypeCode.String||e.formsService.currentForm.value.dataType==e.eTypeCode.Char),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.dataType!=e.eTypeCode.String&&e.formsService.currentForm.value.dataType!=e.eTypeCode.Char),h.yb(6),h.hc("items",e.connections)("allowNullSelect",!0)}}let z=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.eInvalidAction=b.Fb,this.eCleanAction=b.fb,this.eTypeCode=b.pc,this.InvalidActions=N.g,this.CleanActions=N.a,this.typeCodes=D.a,this.invalidActions=N.g,this.cleanActions=N.a,this.lookupColumnValue="",this.isLoaded=!1,this.eCacheStatus=N.j,this.cancelToken=new x.a}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Column Validation")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this.cancelToken.cancel()}load(){if(this.connections=this.hubCache.getConnectionTables(),"edit"===this.action)if(this.columnValidationKey=+this.params.validationKey,this.columnValidationKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){let e=this.hubCache.hub.dexihColumnValidations.find(e=>e.key===this.columnValidationKey);this.formsService.validation(e)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no validation specified to edit.");if("new"===this.action){let e=new b.e;this.formsService.validation(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/columnValidation-new","/columnValidation-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}this.isLoaded=!0,this.getValidationLookupColumn(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this._lookupColumnSubscription=this.formsService.currentForm.controls.lookupColumnKey.valueChanges.subscribe(()=>{this.getValidationLookupColumn()})}getValidationLookupColumn(){let e=this.formsService.currentForm.controls.lookupColumnKey.value;if(e){let t=this.hubCache.getColumn(e);if(t){let e=this.hubCache.getTable(t.tableKey);this.lookupColumnValue="Exists in table:"+e.name+", column:"+t.name}else this.lookupColumnValue="Column not found.  Re-select a valid column."}else this.lookupColumnValue=""}test(){this.hubService.testColumnValidation(this.formsService.currentForm.value,this.testValue,this.cancelToken).then(e=>{this.testResult=e})}close(){this.authService.navigateUp()}canDeactivate(){return new Promise(e=>{this.formsService.hasChanged?this.authService.confirmDialog("The view has not been saved","The column validation changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.formsService.hasChanged&&(e.returnValue="The column validation changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-columnValidation-edit-form"]],hostBindings:function(e,t){1&e&&h.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,h.uc)},features:[h.xb([T.a])],decls:5,vars:3,consts:[[1,"container"],["title","Edit Validation","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],[1,"d-inline-flex"],[3,"ngIf"],[1,"mr-1",3,"formsService"],[1,"mr-1",3,"control","click"],[4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"input-group","mr-1"],[1,"input-group-prepend"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-check-circle-o"],["type","text","placeholder","Test value","aria-label","","aria-describedby","basic-addon1",1,"form-control",2,"max-width","100px",3,"ngModel","ngModelChange"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Column Validation Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Data Type","formControlName","dataType","itemKey","key","itemName","name",3,"items"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Validation Fail Action","formControlName","invalidAction","itemKey","key","itemName","name","note","Action to take when the validation fails.",3,"items"],["class","form-group col-md-6",4,"ngIf"],["label","Ignore null values.","formControlName","allowDbNull"],["class","form-row",4,"ngIf"],["label","Restrict to list of values","formControlName","listOfValues","placeholder","Provide a list of values which are valid."],["label","Excluded list of values","formControlName","listOfNotValues","placeholder","Provide a list of values which are valid."],["label","Restrict to values that exist in a lookup table column","formControlName","lookupColumnKey","grandParentName","name","parentName","name","itemKey","key","itemName","name","childItems","dexihTables","grandChildItems","dexihTableColumns","note","Checks the selected table column, and ensures the value contains at least one match.",3,"items","allowNullSelect"],["label","Only lookup values where the 'is current' column is true.","formControlName","lookupIsValid"],["label","Allow valid when lookup returns multiple rows.","formControlName","lookupMultipleRecords"],[1,"alert"],["label","Clean Action","formControlName","cleanAction","itemKey","key","itemName","name","note","Clean Action to apply",3,"items"],["label","Clean Value","formControlName","cleanValue","placeholder","Enter the clean value.","iconClass","fa fa-list"],["label","Minimum String Length","formControlName","minLength","placeholder","Enter the minimum string length","type","number","iconClass","fa fa-list"],["label","Maximum String Length","formControlName","maxLength","placeholder","Enter the maximum string length","type","number","iconClass","fa fa-list"],["label","Simple Pattern Match","formControlName","patternMatch","placeholder","Provide a match string","iconClass","fa fa-list","note","Simple pattern match, use the format - A=Upper, a=Lower, Z=Any Character, 9=numeric.  (For example: AA999 matches AS123)"],["label","Regular Expression Match","formControlName","regexMatch","placeholder","Provide a regular expression","iconClass","fa fa-list","note","Use a standard regular expression to validate.  For example [A-Za-z0-9] will ensure string only contains characters and numbers."],["label","Minimum Value","formControlName","minValue","placeholder","Enter the minimum value","type","number","iconClass","fa fa-list"],["label","Maximum Value","formControlName","maxValue","placeholder","Enter the maximum value","type","number","iconClass","fa fa-list"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,P,3,2,"ng-template",null,2,h.Ec),h.Dc(4,q,31,15,"form",3),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(3),h.hc("ngIf",t.formsService.currentForm))},directives:[u.P,p.t,F.a,I.a,a.c,a.s,a.v,K.a,a.I,a.t,a.l,u.D,a.j,u.E,u.H,u.A,u.F],encapsulation:2}),e})();var W=i("rgmq"),G=i("/pur"),Q=i("l2bN"),$=function(e,t,i,a){return new(i||(i=Promise))((function(n,s){function o(e){try{r(a.next(e))}catch(t){s(t)}}function c(e){try{r(a.throw(e))}catch(t){s(t)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}r((a=a.apply(e,t||[])).next())}))};function X(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",10),h.Vb("click",(function(){h.vc(e);const t=h.Zb(2);return!t.refreshingConnection&&t.refreshConnection()})),h.Fc(1,"Test"),h.Nb()}if(2&e){const e=h.Zb(2);h.hc("busy",e.refreshingConnection)}}function Y(e,t){if(1&e&&h.Lb(0,"save-button",11),2&e){const e=h.Zb(2);h.hc("formsService",e.formsService)}}const J=function(e){return["../../connection-import",e]};function ee(e,t){if(1&e&&(h.Ob(0,"dexih-button",13),h.Fc(1,"Import Tables"),h.Nb()),2&e){const e=h.Zb(4);h.hc("routerLink",h.mc(1,J,e.formsService.currentForm.controls.key.value))}}function te(e,t){if(1&e&&h.Dc(0,ee,2,3,"dexih-button",12),2&e){const e=h.Zb(3);h.hc("ngIf",e.formsService.currentForm.controls.key.value)}}const ie=function(e){return["../../../tables","table-new",e]};function ae(e,t){if(1&e&&(h.Ob(0,"dexih-button",13),h.Fc(1,"New File"),h.Nb()),2&e){const e=h.Zb(4);h.hc("routerLink",h.mc(1,ie,e.formsService.currentForm.controls.key.value))}}function ne(e,t){if(1&e&&h.Dc(0,ae,2,3,"dexih-button",12),2&e){const e=h.Zb(3);h.hc("ngIf",e.formsService.currentForm.controls.key.value)}}function se(e,t){if(1&e&&(h.Ob(0,"dexih-button",13),h.Fc(1,"New WebService"),h.Nb()),2&e){const e=h.Zb(4);h.hc("routerLink",h.mc(1,ie,e.formsService.currentForm.controls.key.value))}}function oe(e,t){if(1&e&&h.Dc(0,se,2,3,"dexih-button",12),2&e){const e=h.Zb(3);h.hc("ngIf",e.formsService.currentForm.controls.key.value)}}function ce(e,t){if(1&e&&(h.Dc(0,te,1,1,"ng-template",8),h.Dc(1,ne,1,1,"ng-template",8),h.Dc(2,oe,1,1,"ng-template",8)),2&e){const e=h.Zb(2);h.hc("ngIf",e.connectionReference.connectionCategory==e.eConnectionCategory.SqlDatabase||e.connectionReference.connectionCategory==e.eConnectionCategory.DatabaseFile||e.connectionReference.connectionCategory==e.eConnectionCategory.NoSqlDatabase||e.connectionReference.connectionCategory==e.eConnectionCategory.Hub),h.yb(1),h.hc("ngIf",e.connectionReference.connectionCategory==e.eConnectionCategory.File),h.yb(1),h.hc("ngIf",e.connectionReference.connectionCategory==e.eConnectionCategory.WebService)}}function re(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-invalid-form-details",5),h.Vb("click",(function(){return h.vc(e),h.Zb().formsService.showErrors()})),h.Nb(),h.Dc(1,X,2,1,"dexih-button",6),h.Dc(2,Y,1,1,"save-button",7),h.Dc(3,ce,3,3,"ng-template",8),h.Lb(4,"cancel-button",9)}if(2&e){const e=h.Zb();h.hc("control",e.formsService.currentForm),h.yb(1),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("ngIf",e.hubCache.canWrite&&e.connectionReference),h.yb(1),h.hc("formsService",e.formsService)}}function le(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",33),h.Vb("click",(function(){return h.vc(e),h.Zb(7).revealConnectionString()})),h.Lb(1,"i",34),h.Fc(2," Reveal "),h.Nb()}}function be(e,t){1&e&&(h.Ob(0,"span"),h.Lb(1,"i",35),h.Fc(2," Revealing... please wait "),h.Nb())}function he(e,t){if(1&e&&(h.Ob(0,"span"),h.Fc(1," ("),h.Dc(2,le,3,0,"a",32),h.Dc(3,be,3,0,"span",23),h.Fc(4,")"),h.Nb()),2&e){const e=h.Zb(6);h.yb(2),h.hc("ngIf",0==e.revealingConnectionString),h.yb(1),h.hc("ngIf",1==e.revealingConnectionString)}}function ue(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form-input",31),h.Vb("keydown",(function(){return h.vc(e),h.Zb(5).connectionStringChanged()})),h.Dc(1,he,5,2,"span",23),h.Nb()}if(2&e){const e=h.Zb(5);h.hc("errors",e.formsService.formErrors.connectionStringDisplay),h.yb(1),h.hc("ngIf",!e.formsService.formErrors.connectionStringRaw)}}function de(e,t){if(1&e&&h.Lb(0,"form-select",36),2&e){const e=h.Zb(5);h.hc("items",e.variables)("sortItems",!0)("enableTextEntry",!0)}}function me(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section"),h.Dc(1,ue,2,2,"form-input",28),h.Dc(2,de,1,3,"form-select",29),h.Ob(3,"form-checkbox",30),h.Vb("click",(function(){return h.vc(e),h.Zb(4).clearConnectionString()})),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(4);h.yb(1),h.hc("ngIf",!e.formsService.currentForm.controls.useConnectionStringVariable.value),h.yb(1),h.hc("ngIf",e.formsService.currentForm.controls.useConnectionStringVariable.value)}}function fe(e,t){if(1&e&&(h.Ob(0,"span"),h.Ob(1,"section"),h.Lb(2,"form-checkbox",27),h.Nb(),h.Dc(3,me,4,2,"section",23),h.Nb()),2&e){const e=h.Zb(3);h.yb(3),h.hc("ngIf",1==e.formsService.currentForm.controls.useConnectionString.value)}}function pe(e,t){1&e&&(h.Ob(0,"section"),h.Lb(1,"form-checkbox",40),h.Nb())}function ge(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form-input",45),h.Vb("keydown",(function(){return h.vc(e),h.Zb(5).passwordChanged()})),h.Nb()}if(2&e){const e=h.Zb(5);h.hc("errors",e.formsService.formErrors.password)}}function ve(e,t){if(1&e&&h.Lb(0,"form-select",46),2&e){const e=h.Zb(5);h.hc("items",e.variables)("sortItems",!0)("enableTextEntry",!0)}}function ye(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",18),h.Ob(1,"section",19),h.Lb(2,"form-select",41),h.Nb(),h.Ob(3,"section",19),h.Dc(4,ge,1,1,"form-input",42),h.Dc(5,ve,1,3,"form-select",43),h.Ob(6,"form-checkbox",44),h.Vb("click",(function(){return h.vc(e),h.Zb(4).clearPassword()})),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(4);h.yb(2),h.hc("enableTextEntry",!0)("errors",e.formsService.formErrors.username)("items",e.variables)("enableFilter",!0),h.yb(2),h.hc("ngIf",0==e.formsService.currentForm.controls.usePasswordVariable.value),h.yb(1),h.hc("ngIf",e.formsService.currentForm.controls.usePasswordVariable.value)}}function Ce(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form-input",50),h.Vb("keydown",(function(){return h.vc(e),h.Zb(5).passwordChanged()})),h.Nb()}if(2&e){const e=h.Zb(5);h.hc("errors",e.formsService.formErrors.password)}}function we(e,t){if(1&e&&h.Lb(0,"form-select",51),2&e){const e=h.Zb(5);h.hc("items",e.variables)("sortItems",!0)("enableTextEntry",!0)}}function Se(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",18),h.Ob(1,"section",19),h.Dc(2,Ce,1,1,"form-input",47),h.Dc(3,we,1,3,"form-select",48),h.Ob(4,"form-checkbox",49),h.Vb("click",(function(){return h.vc(e),h.Zb(4).clearPassword()})),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(4);h.yb(2),h.hc("ngIf",0==e.formsService.currentForm.controls.usePasswordVariable.value),h.yb(1),h.hc("ngIf",e.formsService.currentForm.controls.usePasswordVariable.value)}}function ke(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",33),h.Vb("click",(function(){return h.vc(e),h.Zb(5).refreshConnection()})),h.Lb(1,"i",34),h.Fc(2," Refresh "),h.Nb()}}function Oe(e,t){1&e&&(h.Ob(0,"span"),h.Lb(1,"i",35),h.Fc(2," Refreshing... please wait "),h.Nb())}function Ne(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",33),h.Vb("click",(function(){return h.vc(e),h.Zb(5).createDatabase()})),h.Lb(1,"i",54),h.Fc(2," New Database "),h.Nb()}}function Te(e,t){1&e&&(h.Ob(0,"span"),h.Lb(1,"i",35),h.Fc(2," Creating database... please wait "),h.Nb())}function De(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section",52),h.Ob(1,"form-select",53),h.Vb("textValueChange",(function(t){return h.vc(e),h.Zb(4).newDatabaseName(t)})),h.Fc(2," ("),h.Dc(3,ke,3,0,"a",32),h.Dc(4,Oe,3,0,"span",23),h.Fc(5,") ( "),h.Dc(6,Ne,3,0,"a",32),h.Dc(7,Te,3,0,"span",23),h.Fc(8,") "),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(4);h.yb(1),h.hc("label",e.connectionReference.databaseDescription)("items",e.databases)("defaultItem",e.formsService.currentForm.value.defaultDatabase)("sortItems",!0)("enableTextEntry",!0),h.yb(2),h.hc("ngIf",0==e.refreshingConnection),h.yb(1),h.hc("ngIf",1==e.refreshingConnection),h.yb(2),h.hc("ngIf",0==e.creatingDatabase),h.yb(1),h.hc("ngIf",1==e.creatingDatabase)}}function xe(e,t){if(1&e&&(h.Ob(0,"span"),h.Ob(1,"section"),h.Lb(2,"form-select",37),h.Nb(),h.Dc(3,pe,2,0,"section",23),h.Dc(4,ye,7,6,"div",38),h.Dc(5,Se,5,2,"div",38),h.Dc(6,De,9,9,"section",39),h.Nb()),2&e){const e=h.Zb(3);h.yb(2),h.hc("enableTextEntry",!0)("label",e.connectionReference.serverDescription)("errors",e.formsService.formErrors.server)("items",e.variables)("enableFilter",!0)("note",e.connectionReference.serverHelp),h.yb(1),h.hc("ngIf",1==e.connectionReference.allowsWindowsAuth),h.yb(1),h.hc("ngIf",e.connectionReference.allowsUserPassword&&(0==e.formsService.currentForm.controls.useWindowsAuth.value||0==e.connectionReference.allowsWindowsAuth)),h.yb(1),h.hc("ngIf",e.connectionReference.allowsToken&&(0==e.formsService.currentForm.controls.useWindowsAuth.value||0==e.connectionReference.allowsWindowsAuth)),h.yb(1),h.hc("ngIf",e.connectionReference.requiresDatabase)}}function Fe(e,t){if(1&e&&(h.Ob(0,"section"),h.Lb(1,"form-checkbox",55),h.Nb()),2&e){const e=h.Zb(3);h.yb(1),h.hc("errors",e.formsService.formErrors.embedTableKey)}}function Ie(e,t){if(1&e){const e=h.Pb();h.Ob(0,"span"),h.Ob(1,"section"),h.Ob(2,"markdown",24),h.Vb("click",(function(t){return h.vc(e),h.Zb(2).getRoute(t)})),h.Nb(),h.Nb(),h.Dc(3,fe,4,1,"span",23),h.Dc(4,xe,7,10,"span",23),h.Ob(5,"div",18),h.Ob(6,"section",19),h.Lb(7,"form-input",25),h.Nb(),h.Ob(8,"section",19),h.Lb(9,"form-input",26),h.Nb(),h.Nb(),h.Dc(10,Fe,2,1,"section",23),h.Nb()}if(2&e){const e=h.Zb(2);h.yb(2),h.hc("data",e.connectionReference.description),h.yb(1),h.hc("ngIf",1==e.connectionReference.allowsConnectionString),h.yb(1),h.hc("ngIf",0==e.formsService.currentForm.controls.useConnectionString.value),h.yb(3),h.hc("errors",e.formsService.formErrors.connectionTimeout),h.yb(2),h.hc("errors",e.formsService.formErrors.commandTimeout),h.yb(1),h.hc("ngIf","Managed"==e.formsService.currentForm.controls.purpose.value)}}const Ke=function(){return{standalone:!0}};function Ee(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form",14),h.Lb(1,"input",15),h.Lb(2,"input",16),h.Ob(3,"fieldset"),h.Ob(4,"section"),h.Lb(5,"form-select",17),h.Nb(),h.Ob(6,"div",18),h.Ob(7,"section",19),h.Lb(8,"form-input",20),h.Nb(),h.Ob(9,"section",19),h.Ob(10,"form-select",21),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb().connectionReference=t}))("ngModelChange",(function(t){return h.vc(e),h.Zb().selectDatabaseType(t)})),h.Nb(),h.Nb(),h.Nb(),h.Ob(11,"section"),h.Lb(12,"form-textarea",22),h.Nb(),h.Dc(13,Ie,11,6,"span",23),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(5),h.hc("items",e.eConnectionPurposeItems)("enableFilter",!1)("errors",e.formsService.formErrors.purpose),h.yb(3),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("ngModel",e.connectionReference)("ngModelOptions",h.lc(14,Ke))("items",e.connectionTypes)("enableKeySelect",!1)("sortItems",!0),h.yb(2),h.hc("showMarkdown",!0)("errors",e.formsService.formErrors.description),h.yb(1),h.hc("ngIf",e.connectionReference)}}let Ve=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.savingConnection=!1,this.refreshingConnection=!1,this.revealingConnectionString=!1,this.creatingDatabase=!1,this.databases=[],this.eConnectionPurposeItems=b.kb.filter(e=>e.key>0),this.eConnectionPurpose=b.jb,this.eConnectionCategory=b.ib,this.cancelToken=new x.a,this.isLoaded=!1,this.variables=[],this.logger=new W.a("connection-edit")}ngOnInit(){this.logger.LogC(()=>"OnInit",W.b.Trace);try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteLibrariesObservable()).subscribe(e=>$(this,void 0,void 0,(function*(){let t=e[0];this.params=e[1],this.hubCache=e[2],this.remoteLibraries=e[3],this.action=t.action,this.pageTitle=t.pageTitle,this.variables=this.hubCache.hub.dexihHubVariables.map(e=>"{"+e.name+"}"),this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>$(this,void 0,void 0,(function*(){e&&(yield this.load())}))).catch(e=>{}):yield this.load()))})))}catch(e){this.hubService.addHubClientErrorMessage(e,"Connection Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this.cancelToken.cancel()}load(){return $(this,void 0,void 0,(function*(){if(this.isLoaded=!0,"edit"===this.action)if(this.connectionKey=+this.params.connectionKey,this.logger.LogC(()=>`edit connection key ${this.connectionKey}.`,W.b.Trace),this.connectionKey)if(this.hubCache.hub&&this.hubCache.hub.dexihConnections){let e=this.hubCache.hub.dexihConnections.find(e=>e.key===this.connectionKey);e?(this.updateDatabaseTypes(e.purpose),this.connectionReference=yield this.hubService.GetConnectionReference(e),this.formsService.connection(e),e.defaultDatabase&&(this.databases=[e.defaultDatabase]),this.logger.LogC(()=>"edit connection, form loaded.",W.b.Trace)):(this.hubService.addHubErrorMessage("The specified connection could not be found."),this.logger.LogC(()=>`edit connection with key ${this.connectionKey} not found.`,W.b.Warning))}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no connection specified to edit.");if("new"===this.action){let e=new b.f;e.purpose=+this.params.purpose,this.logger.LogC(()=>`new connection, purpose ${e.purpose}.`,W.b.Trace),this.updateDatabaseTypes(e.purpose),this.formsService.connection(e),this.updateUrl(),this.logger.LogC(()=>"new connection, form loaded.",W.b.Trace)}if("copy"===this.action){let e=new b.f,t=+this.params.connectionKey,i=this.hubCache.hub.dexihConnections.find(e=>e.key===t);Object.assign(e,i),e.name+=" (copy)",e.key=null,this.connectionReference=yield this.hubService.GetConnectionReference(e),this.logger.LogC(()=>`copy connection, connectionKey ${t}.`,W.b.Trace),this.updateDatabaseTypes(e.purpose),this.formsService.connection(e),this.updateUrl(),this.logger.LogC(()=>"new connection, form loaded.",W.b.Trace)}this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this._purposeSubscription=this.formsService.currentForm.controls.purpose.valueChanges.subscribe(e=>{this.updateDatabaseTypes(e)})}))}updateUrl(){this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname,i=e.indexOf("/connection-new");if(i>0){let a=e.substr(0,i)+"/connection-edit/"+t;this.router.navigateByUrl(a)}this._formChangeSubscription.unsubscribe()}})}updateDatabaseTypes(e){this.connectionTypes=this.remoteLibraries.connections.filter(t=>e===b.jb.Source&&t.allowsSourceConnection||e===b.jb.Managed&&t.allowsManagedConnection||e===b.jb.Target&&t.allowsTargetConnection)}selectDatabaseType(e){return $(this,void 0,void 0,(function*(){if(this.formsService.currentForm.controls.connectionClassName.setValue(e.connectionClassName),this.formsService.currentForm.controls.connectionAssemblyName.setValue(e.connectionAssemblyName),this.connectionReference.connectionCategory===b.ib.Hub){if(!this.formsService.currentForm.controls.server.value){const e=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");this.formsService.currentForm.controls.server.setValue(e)}if(!this.formsService.currentForm.controls.username.value){const e=this.authService.getUser();e&&this.formsService.currentForm.controls.username.setValue(e.email)}}}))}connectionStringChanged(){this.logger.LogC(()=>"connectionStringChanged.",W.b.Trace),this.formsService.currentForm.controls.connectionString.value&&(this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue(""))}clearConnectionString(){this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue("")}revealConnectionString(){this.logger.LogC(()=>"revealConnectionString.",W.b.Trace),this.revealingConnectionString=!0,this.hubService.decrypt(this.formsService.currentForm.controls.connectionString.value,this.cancelToken).then(e=>{this.formsService.currentForm.controls.connectionStringDisplay.setValue(e),this.revealingConnectionString=!1}).catch(e=>{this.hubService.addHubMessage(e),this.revealingConnectionString=!1})}passwordChanged(){this.logger.LogC(()=>"passwordChanged.",W.b.Trace),this.formsService.currentForm.controls.password.value&&(this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue(""))}clearPassword(){this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue("")}refreshConnection(){return $(this,void 0,void 0,(function*(){this.logger.LogC(()=>"refreshConnection.",W.b.Trace),yield this.encryptConnection(),this.refreshingConnection=!0,this.hubService.refreshConnection(this.formsService.currentForm.value,this.cancelToken).then(e=>{this.hubService.addHubSuccessMessage("The connection was successful."),this.databases=e,this.refreshingConnection=!1}).catch(e=>{this.hubService.addHubMessage(e),this.refreshingConnection=!1})}))}newDatabaseName(e){this.formsService.currentForm.controls.defaultDatabase.setValue(e)}createDatabase(){this.creatingDatabase=!0,this.authService.promptDialog("Create Database","Enter the name for the new database?").then(e=>$(this,void 0,void 0,(function*(){if(e){yield this.encryptConnection();let t=Object.assign({},this.formsService.currentForm.value);t.defaultDatabase=e,this.hubService.createDatabase(t,this.cancelToken).then(()=>{this.hubService.addHubSuccessMessage("The database was created successfully."),this.databases=[e],this.formsService.currentForm.controls.defaultDatabase.setValue(e),this.creatingDatabase=!1}).catch(e=>{this.hubService.addHubMessage(e),this.creatingDatabase=!1})}else this.creatingDatabase=!1}))).catch(()=>{this.creatingDatabase=!1})}encryptConnection(){return $(this,void 0,void 0,(function*(){let e=this.formsService.currentForm,t=e.controls.passwordRaw.value;if(t){let i=yield this.hubService.encrypt(t,this.cancelToken);e.controls.password.setValue(i),e.controls.passwordRaw.setValue(null)}let i=e.controls.connectionStringRaw.value;if(i){let t=yield this.hubService.encrypt(i,this.cancelToken);e.controls.connectionString.setValue(t),e.controls.connectionStringRaw.setValue(null)}}))}save(){return $(this,void 0,void 0,(function*(){yield this.encryptConnection(),yield this.formsService.save()}))}close(){this.authService.navigateUp()}canDeactivate(){return new Promise(e=>{this.formsService.hasChanged?this.authService.confirmDialog("The connection has not been saved","The connection changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}getRoute(e){this.authService.getRoute(e)}unloadNotification(e){this.formsService.hasChanged&&(e.returnValue="The connection changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-connection-edit-form"]],hostBindings:function(e,t){1&e&&h.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,h.uc)},features:[h.xb([T.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Connection","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1","buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",3,"busy","click",4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"ngIf"],[3,"formsService"],["buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",1,"mr-1",3,"busy","click"],[1,"mr-1",3,"formsService"],["class","mr-1","iconClass","fa fa-plus",3,"routerLink",4,"ngIf"],["iconClass","fa fa-plus",1,"mr-1",3,"routerLink"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["label","Purpose","formControlName","purpose","placeholder","Connection purpose","iconClass","fa fa-database","itemName","name","itemKey","key",3,"items","enableFilter","errors"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Name","formControlName","name","placeholder","Enter a name for the connection","iconClass","fa fa-database",3,"autocapitalize","errors"],["label","Database Type","itemName","name","itemKey","name","iconClass","fa fa-database",3,"ngModel","ngModelOptions","items","enableKeySelect","sortItems","ngModelChange"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown","errors"],[4,"ngIf"],[3,"data","click"],["type","number","label","Connection Timeout","formControlName","connectionTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will wait to establish a connection.",3,"errors"],["type","number","label","Command Timeout","formControlName","commandTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will for a command to start returning a result.",3,"errors"],["label","Use a connection string","formControlName","useConnectionString"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown",4,"ngIf"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for connection string","formControlName","useConnectionStringVariable",3,"click"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],[1,"fa","fa-refresh"],[1,"fa","fa-spin","fa-refresh"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry"],["formControlName","server","placeholder","Enter the details.","iconClass","fa fa-server",3,"enableTextEntry","label","errors","items","enableFilter","note"],["class","form-row",4,"ngIf"],["ng-disabled","refreshingConnection || creatingDatabase",4,"ngIf"],["label","Use windows authentication","formControlName","useWindowsAuth"],["label","User Name","formControlName","username","placeholder","Enter user name","iconClass","fa fa-user",3,"enableTextEntry","errors","items","enableFilter"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for password","formControlName","usePasswordVariable",3,"click"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for token","formControlName","usePasswordVariable",3,"click"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["ng-disabled","refreshingConnection || creatingDatabase"],["formControlName","defaultDatabase","iconClass","fa fa-database","textEntryNote","Enter the database name",3,"label","items","defaultItem","sortItems","enableTextEntry","textValueChange"],[1,"fa","fa-edit"],["label","Multi-use Managed Database (table keys will be added to table names to allow multiple hubs to use same database)","formControlName","embedTableKey",3,"errors"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,re,5,5,"ng-template",null,2,h.Ec),h.Dc(4,Ee,14,15,"form",3),h.Nb(),h.Lb(5,"dexih-help",4),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(3),h.hc("ngIf",t.formsService.currentForm))},directives:[u.P,p.t,G.a,I.a,F.a,u.f,K.a,s.f,a.I,a.t,a.l,u.E,a.s,a.j,u.D,a.v,u.H,Q.a,u.A],encapsulation:2}),e})();function Le(e,t){}function Pe(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-splitdropdown",12),h.Vb("buttonClick",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().importSelected(t)})),h.Ob(1,"a",13),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().newDatalinks(t)})),h.Fc(2,"Import & Create Datalinks"),h.Nb(),h.Nb()}}function je(e,t){if(1&e){const e=h.Pb();h.Dc(0,Pe,3,0,"dexih-button-splitdropdown",10),h.Ob(1,"dexih-button-delete",11),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().deleteSelected(i)})),h.Nb()}if(2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}const Ae=function(e){return["table-edit",e]};function Me(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-edit",15),h.Vb("click",(function(){h.vc(e);const t=h.Zb(2);return t.deleteSelected(t.items)})),h.Nb()}if(2&e){const e=h.Zb().item;h.hc("routerLink",h.mc(1,Ae,e.key))}}function Re(e,t){1&e&&h.Dc(0,Me,1,3,"dexih-button-edit",14),2&e&&h.hc("ngIf",t.item.key)}function Ze(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-dropdown",16),h.Ob(1,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setTableFilter("All")})),h.Fc(2,"All"),h.Nb(),h.Ob(3,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setTableFilter("Imported")})),h.Fc(4,"Imported"),h.Nb(),h.Ob(5,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setTableFilter("NonImported")})),h.Fc(6,"Non Imported"),h.Nb(),h.Nb(),h.Ob(7,"dexih-button-dropdown",18),h.Ob(8,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setViewFilter("All")})),h.Fc(9,"All"),h.Nb(),h.Ob(10,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setViewFilter("Tables")})),h.Fc(11,"Tables"),h.Nb(),h.Ob(12,"a",17),h.Vb("click",(function(){return h.vc(e),h.Zb().setViewFilter("Views")})),h.Fc(13,"Views"),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("text",e.tableFilter)("pullRight",!0),h.yb(1),h.Cb("active","All"==e.tableFilter),h.yb(2),h.Cb("active","Imported"==e.tableFilter),h.yb(2),h.Cb("active","NonImported"==e.tableFilter),h.yb(2),h.hc("text",e.viewFilter)("pullRight",!0),h.yb(1),h.Cb("active","All"==e.viewFilter),h.yb(2),h.Cb("active","Imported"==e.viewFilter),h.yb(2),h.Cb("active","NonImported"==e.viewFilter)}}let _e=(()=>{class e{constructor(e,t,i,a){this.authService=e,this.hubService=t,this.router=i,this.route=a,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new x.a,this.columns=[{name:"schema",title:"Schema",format:""},{name:"name",title:"Name",format:""},{name:"tableType",title:"Type",enum:b.ic,format:"Enum"},{name:"entityStatus.message",title:"Latest Status"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable(),this.tableFilter="All",this.viewFilter="Tables"}ngOnInit(){this.showPageMessage="Querying source database tables.  Please wait...";try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{return t=this,void 0,a=function*(){let t=e[1];this.hubCache=e[2];let i=e[3];this.connectionKey=+t.connectionKey,this.connectionKey?this.hubCache.isLoaded()&&(this.connection=this.hubCache.hub.dexihConnections.find(e=>e.key===this.connectionKey),this.connectionReference=yield this.hubService.GetConnectionReference(this.connection),this.showPage=!1,i?this.connection?this.getTables(this.connection):(this.hubService.addHubErrorMessage("The connection could not be found."),this.close()):this.showPageMessage="Waiting for an active remote agent..."):(this.hubService.addHubErrorMessage("There was no connection specified to import tables."),this.close())},new((i=void 0)||(i=Promise))((function(e,n){function s(e){try{c(a.next(e))}catch(t){n(t)}}function o(e){try{c(a.throw(e))}catch(t){n(t)}}function c(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(e){e(a)}))).then(s,o)}c((a=a.apply(t,[])).next())}));var t,i,a})}catch(e){this.hubService.addHubClientErrorMessage(e,"Connection Import")}this.watchChanges()}setTableFilter(e){this.tableFilter=e,this.updateFilter()}setViewFilter(e){this.viewFilter=e,this.updateFilter()}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}updateFilter(){let e;switch(this.tableFilter){case"Imported":e=this.tables.filter(e=>e.key>0);break;case"NonImported":e=this.tables.filter(e=>0===e.key||!e.key);break;default:e=this.tables}switch(this.viewFilter){case"Views":e=e.filter(e=>e.tableType===b.ic.View);break;case"Tables":e=e.filter(e=>e.tableType===b.ic.Table)}this._tableData.next(e)}getTables(e){this.showPage=!1,this.showPageMessage="Importing tables from remote database...",this.hubService.getDatabaseTableNames(e,this.cancelToken).then(t=>{this.tables=t;let i=this.hubCache.hub.dexihTables.filter(t=>t.connectionKey===e.key);for(let a=0;a<t.length;a++){let n=null,s=t[a];i&&(n=i.find(e=>e.name===s.name&&e.schema===s.schema),!n&&this.connectionReference&&this.connectionReference.defaultSchema===s.schema&&(n=i.find(e=>e.name===s.name&&!e.schema))),n?this.tables[a]=n:(s.connectionKey=e.key,s.tableType=s.tableType,s.entityStatus=new N.c)}this.showPage=!0,this.showPageMessage="",this.updateFilter()}).catch(e=>{this.hubService.addHubMessage(e)})}import(e){this.hubService.importTables([e],!0,this.cancelToken).then(e=>{this.mergeTables(e)}).catch(t=>{e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=b.hc.Error,e.entityStatus.message=t.message})}deleteTable(e){this.hubService.deleteTables([e]).then(t=>{e.entityStatus.isBusy=!1}).catch(t=>{e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=b.hc.Error,e.entityStatus.message=t.message})}importSelected(e){let t=e.filter(e=>!e.entityStatus.isBusy);t.forEach(e=>e.entityStatus.isBusy=!0),this.hubService.importTables(t,!0,this.cancelToken).then(e=>{this.mergeTables(e)}).catch(e=>{t.forEach(e=>e.entityStatus.isBusy=!1)})}mergeTables(e){e&&(e.forEach(e=>{let t=this.tables.findIndex(t=>t.name===e.name&&t.schema===e.schema);t>=0&&(this.tables[t]=e)}),this.updateFilter())}deleteSelected(e){let t=e.filter(e=>!e.entityStatus.isBusy&&e.key>0);0===t.length&&this.authService.informationDialog("Can not delete","None of the selected tables can be deleted, as they are either busy, or have not been imported."),t.forEach(e=>e.entityStatus.isBusy=!0),this.hubService.deleteTables(t).then(e=>{t.forEach(e=>e.entityStatus.isBusy=!1)}).catch(e=>{t.forEach(e=>e.entityStatus.isBusy=!1)})}editTable(e){e&&e.key&&this.router.navigate(["table-edit",e.key],{relativeTo:this.route.parent})}newDatalinks(e){let t=e.filter(e=>!e.entityStatus.isBusy);t.forEach(e=>e.entityStatus.isBusy=!0),this.hubService.importTables(t,!0,this.cancelToken).then(e=>{this.mergeTables(e);let t=e.map(e=>e.key).join("|");this.router.navigate(["datalink-new",t,0],{relativeTo:this.route.parent})}).catch(e=>{t.forEach(e=>e.entityStatus.isBusy=!1)})}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{if(e.changeClass===b.dc.Table){if(e.changeType===b.Eb.Replace||e.changeType===b.Eb.New){let t=e.data;if(t.connectionKey===this.connectionKey){let e=this.tables.findIndex(e=>e.name===t.name&&e.schema===t.schema);e>=0&&(this.tables[e]=t,this.updateFilter())}}if(e.changeType===b.Eb.Delete){let t=e.data;if(t.connectionKey===this.connectionKey){let e=this.tables.find(e=>e.key===t.key);e&&(e.key=null,e.entityStatus.isBusy=!1,e.updateDate=null,e.createDate=null,this.updateFilter())}}}})}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(c.a),h.Kb(o.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:11,vars:10,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-database",3,"title","showIf","loadingMessage","showCloseButton","padding","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["select","filter"],["filter",""],["class","mr-1","text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",3,"buttonClick",4,"ngIf"],["title","Delete selected tables",3,"click"],["text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",1,"mr-1",3,"buttonClick"],["title","Import tables and create default staging datalinks",1,"dropdown-item",3,"click"],["class","mr-1","queryParamsHandling","","preserveFragment","","title","Edit this table",3,"routerLink","click",4,"ngIf"],["queryParamsHandling","","preserveFragment","","title","Edit this table",1,"mr-1",3,"routerLink","click"],["buttonClass","btn-primary","iconClass","fa fa-download","title","Filter by import status",1,"mr-1",3,"text","pullRight"],[1,"dropdown-item",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-table","title","Filter by tables/views",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Le,0,0,"ng-template",null,2,h.Ec),h.Ob(4,"dexih-table",3),h.Vb("rowClick",(function(e){return t.editTable(e)})),h.Dc(5,je,2,1,"ng-template",4,5,h.Ec),h.Dc(7,Re,1,1,"ng-template",6,7,h.Ec),h.Dc(9,Ze,14,16,"ng-template",8,9,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("title","Import Tables for "+(null==t.connection?null:t.connection.name))("showIf",t.showPage)("loadingMessage",t.showPageMessage)("showCloseButton",!0)("padding",!1),h.yb(3),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[u.P,d.a,p.t,u.g,u.w,u.j,s.f,u.i],encapsulation:2}),e})();var He=i("Ifnz"),Be=i("965U");function Ue(e,t){1&e&&h.Lb(0,"actions-connection-button",9),2&e&&h.hc("connections",t.items)}function qe(e,t){if(1&e&&h.Lb(0,"tags-update-button",10),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.Connection)("objects",e)}}const ze=function(e){return{purposeFilter:e}};function We(e,t){if(1&e&&(h.Ob(0,"a",14),h.Fc(1),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(2);h.Cb("active",i.purposeFilter==e.key),h.hc("queryParams",h.mc(5,ze,e.key))("title",e.name),h.yb(1),h.Gc(e.name)}}const Ge=function(){return{purposeFilter:"All"}};function Qe(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",11),h.Ob(1,"a",12),h.Fc(2,"All"),h.Nb(),h.Dc(3,We,2,7,"a",13),h.ac(4,"gtFilter"),h.Nb()),2&e){const e=h.Zb();h.hc("autoCompact",!1)("text",e.eConnectionPurpose[e.purposeFilter])("pullRight",!0),h.yb(1),h.Cb("active","All"==e.purposeFilter),h.hc("queryParams",h.lc(11,Ge)),h.yb(2),h.hc("ngForOf",h.dc(4,7,e.eConnectionPurposeItems,"key",0))}}let $e=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eConnectionPurpose=b.jb,this.eConnectionPurposeItems=b.kb,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{name:"purpose",title:"Purpose",format:""},{name:"type",title:"Type",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[2];this.hubCache=e[3],this.purposeFilter=+t.purposeFilter,this.purposeFilter||(this.purposeFilter=0),this.pageTitle=b.jb[this.purposeFilter]+" Connections",this.updateConnections()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Connection Index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}close(){this.authService.navigateUp()}deleteConnection(e){this.hubService.deleteConnections([e]).catch(e=>{})}deleteConnections(e){this.hubService.deleteConnections(e)}editConnection(e){this.router.navigate(["connection-edit",e.key],{relativeTo:this.route})}updateConnections(){var e,t,i,a,n;return i=this,void 0,n=function*(){if(this.hubCache&&this.hubCache.isLoaded()){let s;s=0!==this.purposeFilter&&this.purposeFilter?this.hubCache.hub.dexihConnections.filter(e=>e.purpose===this.purposeFilter):this.hubCache.hub.dexihConnections;let o=[];try{for(var i,a=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(i){t[i]=e[i]&&function(t){return new Promise((function(a,n){!function(e,t,i,a){Promise.resolve(a).then((function(t){e({value:t,done:i})}),t)}(a,n,(t=e[i](t)).done,t.value)}))}}}(s);!(i=yield a.next()).done;){const e=i.value;let t=yield this.hubService.GetConnectionReference(e);o.push({key:e.key,connectionAssemblyName:e.connectionAssemblyName,connectionClassName:e.connectionClassName,purpose:b.jb[e.purpose],type:t?t.name:"Unknown ("+e.connectionClassName+")",name:e.name,tags:this.hubCache.getObjectTags(b.dc.Connection,e.key),description:e.description,updateDate:e.updateDate})}}catch(n){e={error:n}}finally{try{i&&!i.done&&(t=a.return)&&(yield t.call(a))}finally{if(e)throw e.error}}this._tableData.next(o)}else this._tableData.next(null)},new((a=void 0)||(a=Promise))((function(e,t){function s(e){try{c(n.next(e))}catch(i){t(i)}}function o(e){try{c(n.throw(e))}catch(i){t(i)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(s,o)}c((n=n.apply(i,[])).next())}))}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach(e=>{this.hubCache.cacheAddConnection(e.key,t)}),this.hubService.exportHub(t,1===e.length?"Connection - "+e[0].name+".json":"connections.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Connection&&e.changeClass!==b.dc.TagObjects||this.updateConnections()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Connections","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[3,"connections"],[1,"ml-1",3,"objectType","objects"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.editConnection(e)})),h.Dc(3,Ue,1,1,"ng-template",null,3,h.Ec),h.Dc(5,qe,1,2,"ng-template",4,5,h.Ec),h.Dc(7,Qe,5,12,"ng-template",6,7,h.Ec),h.Nb(),h.Nb(),h.Lb(9,"dexih-help",8),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,He.a,g.a,u.i,s.h,p.s],pipes:[Be.a],encapsulation:2}),e})();var Xe=i("obiC");const Ye=["fileInput"];function Je(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section",9),h.Ob(1,"form-select",16),h.Vb("ngModelChange",(function(i){return h.vc(e),t.$implicit.action=i})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit,i=h.Zb(2);h.yb(1),h.jc("label","",i.eSharedObjectType[e.objectType]," Action"),h.jc("note","Action when importing ",i.eSharedObjectType[e.objectType],""),h.hc("ngModel",e.action)("items",i.importActions)}}function et(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-widget",3),h.Vb("close",(function(){return h.vc(e),h.Zb().close()})),h.Ob(1,"ul",4),h.Ob(2,"li",5),h.Ob(3,"h5"),h.Fc(4,"Drop Export Files"),h.Nb(),h.Nb(),h.Ob(5,"li",6),h.Ob(6,"div",7),h.Vb("dropFiles",(function(t){return h.vc(e),h.Zb().filesDrop(t)})),h.Ob(7,"div",8),h.Ob(8,"section",9),h.Fc(9," Drop import files "),h.Nb(),h.Ob(10,"section",9),h.Ob(11,"div",10),h.Ob(12,"input",11,12),h.Vb("change",(function(t){return h.vc(e),h.Zb().uploadFile(t)})),h.Nb(),h.Ob(14,"label",13),h.Fc(15,"Choose file"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(16,"li",14),h.Ob(17,"h5"),h.Fc(18,"Import Options"),h.Nb(),h.Nb(),h.Ob(19,"li",6),h.Ob(20,"fieldset"),h.Ob(21,"div",8),h.Dc(22,Je,2,4,"section",15),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("showCloseButton",!0),h.yb(6),h.hc("requireFiles",!0),h.yb(16),h.hc("ngForOf",e.importOptions)}}function tt(e,t){if(1&e&&(h.Ob(0,"ul",25),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.yb(1),h.Hc(" Warning: ",e," ")}}function it(e,t){if(1&e&&(h.Ob(0,"div",23),h.Dc(1,tt,2,1,"ul",24),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("ngForOf",e.import.warnings)}}function at(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",26),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(2).importSelected(i)})),h.Nb()}}function nt(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",27),h.Vb("click",(function(){return h.vc(e),h.Zb(2).importAll()})),h.Nb(),h.Ob(1,"dexih-button-close",28),h.Vb("click",(function(){return h.vc(e),h.Zb(2).reset()})),h.Nb()}}function st(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-widget",17),h.Vb("close",(function(){return h.vc(e),h.Zb().reset()})),h.Dc(1,it,2,1,"div",18),h.Ob(2,"dexih-table",19),h.Dc(3,at,1,0,"ng-template",20,21,h.Ec),h.Dc(5,nt,2,0,"ng-template",null,22,h.Ec),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("showCloseButton",!0),h.yb(1),h.hc("ngIf",(null==e.import||null==e.import.warnings?null:e.import.warnings.length)>0),h.yb(1),h.hc("enableMultiSelect",!0)("columns",e.columns)("dataObservable",e.tableData)}}let ot=(()=>{class e{constructor(e,t,i){this.authService=e,this.hubService=t,this.hubFormsService=i,this.automaticUpload=!0,this.pageTitle="Import Objects",this.showPage=!1,this.showPageMessage="Loading...",this.importActions=N.o,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",format:"Md",description:"description"},{name:"objectType",title:"Type",format:""},{name:"importAction",title:"Action",format:"Enum",enum:b.Eb}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.importOptions=N.u.map(e=>({action:b.Eb.Replace,objectType:e.type})),this._hubCacheChangeSubscription=this.hubService.getHubCacheObservable().subscribe(e=>{this.hubCache=e})}ngOnDestroy(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}close(){this.authService.navigateUp()}doImport(e){const t=new FormData;t.append("file",e,e.name),t.append("hubKey",this.hubCache.hub.hubKey.toString());for(let i=0;i<this.importOptions.length;i++)t.append(`ImportActions[${i}].Action`,this.importOptions[i].action.toString()),t.append(`ImportActions[${i}].ObjectType`,this.importOptions[i].objectType.toString());this.authService.postForm("/api/Hub/ImportPlan",t).then(e=>{this.import=e,this.refreshImport()})}uploadFile(e){this.doImport(e.srcElement.files[0])}filesDrop(e){this.doImport(e[0])}refreshImport(){let e=[];N.u.forEach(t=>{this.import[t.property].forEach(i=>{e.push({objectType:t.property,name:i.item.name,importAction:i.importAction,item:i})})}),this._tableData.next(e)}reset(){this._tableData.next(null)}importSelected(e){let t=new b.P;e.forEach(e=>{t[e.objectType]||(t[e.objectType]=[]),t[e.objectType].push(e.item)}),this.hubService.importPackage(t).then(()=>{this.authService.navigateUp()})}importAll(){this.hubService.importPackage(this.import).then(()=>{this.authService.navigateUp()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(c.a),h.Kb(o.a),h.Kb(T.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["import"]],viewQuery:function(e,t){var i;1&e&&h.Bc(Ye,!0),2&e&&h.rc(i=h.Wb())&&(t.fileInput=i.first)},features:[h.xb([T.a])],decls:5,vars:6,consts:[[1,"container"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],[1,"list-group"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"form-row"],[1,"form-group","col-md-6"],[1,"custom-file","w-auto","pull-right"],["type","file",1,"custom-file-input",3,"change"],["fileInput",""],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","list-group-item-info"],["class","form-group col-md-6",4,"ngFor","ngForOf"],["itemKey","key","itemName","name",3,"label","ngModel","items","note","ngModelChange"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],["class","alert alert-warning",4,"ngIf"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"alert","alert-warning"],["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],["iconClass","fa fa-upload","buttonClass","btn-primary","text","Import Selected",1,"ml-1",3,"click"],["iconClass","fa fa-cloud-upload","buttonClass","btn-primary","text","Import All",3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){if(1&e&&(h.Ob(0,"div",0),h.Dc(1,et,23,3,"dexih-widget",1),h.ac(2,"async"),h.Dc(3,st,7,5,"dexih-widget",2),h.ac(4,"async"),h.Nb()),2&e){var i;const e=!(null!=(i=h.bc(2,2,t.tableData))&&i.length);var a;const n=(null==(a=h.bc(4,4,t.tableData))?null:a.length)>0;h.yb(1),h.hc("ngIf",e),h.yb(2),h.hc("ngIf",n)}},directives:[p.t,u.P,Xe.a,p.s,u.E,a.s,a.v,d.a,u.f,u.d],pipes:[p.b],encapsulation:2}),e})();function ct(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",8),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb()}}function rt(e,t){}function lt(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",9),h.Vb("click",(function(){return h.vc(e),h.Zb().exportAll()})),h.Nb()}}let bt=(()=>{class e{constructor(e,t){this.hubService=e,this.authService=t,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"label",title:"Item Type"},{name:"updateDate",title:"Last Modified",format:"Calendar"}]}ngOnInit(){try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{if(this.hubCache=e[0],!this.hubCache.isLoaded())return;let t=this.hubCache.getSharedObjects();this.data=t})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Index")}}exportAll(){this.export(this.data)}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach(e=>{this.hubCache.cacheAddObject(e.type,e.item,t)}),this.hubService.exportHub(t,1===e.length?`${e[0].label}-${e[0].type}.json`:`hub-${this.hubCache.hub.name}.json`)}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["export"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Export","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","data","tags"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["text","Export Selected",1,"mr-1",3,"click"],["text","Export All",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Dc(3,ct,1,0,"ng-template",3,4,h.Ec),h.Dc(5,rt,0,0,"ng-template",5,6,h.Ec),h.Dc(7,lt,1,0,"ng-template",null,7,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("data",t.data)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,u.u],encapsulation:2}),e})();var ht=i("Npcx"),ut=i("mL+N");function dt(e,t){if(1&e&&h.Lb(0,"dependent-items-button",11),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.Datajob)}}function mt(e,t){if(1&e&&h.Lb(0,"datalink-status",12),2&e){const e=t.item;h.hc("datajobKey",null==e?null:e.key)}}function ft(e,t){if(1&e&&h.Lb(0,"tags-update-button",13),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.Datajob)("objects",e)}}function pt(e,t){1&e&&h.Lb(0,"actions-datajob-button",14),2&e&&h.hc("datajobs",t.items)}let gt=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[2],this.updateDatajobs()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datajob Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}updateDatajobs(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihDatajobs.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(b.dc.Datajob,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}editDatajob(e){this.router.navigate(["datajob-edit",e.key],{relativeTo:this.route})}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Datajob&&e.changeClass!==b.dc.TagObjects||this.updateDatajobs()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datajobs"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Data Jobs","iconClass","fa fa-lg fa-fw fa-calendar",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Datalinks","path","/assets/help/reference/datajob.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[3,"datajobKey"],[1,"ml-1",3,"objectType","objects"],[3,"datajobs"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.editDatajob(e)})),h.Dc(3,dt,1,2,"ng-template",3,4,h.Ec),h.Dc(5,mt,1,1,"ng-template",5,6,h.Ec),h.Dc(7,ft,1,2,"ng-template",7,8,h.Ec),h.Dc(9,pt,1,1,"ng-template",null,9,h.Ec),h.Nb(),h.Nb(),h.Lb(11,"dexih-help",10),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,f.a,ht.a,g.a,ut.a],encapsulation:2}),e})();var vt=i("A4o/");function yt(e,t){1&e&&h.Lb(0,"actions-datalink-button",13),2&e&&h.hc("datalinks",t.items)}const Ct=function(e){return{typeFilter:e}};function wt(e,t){if(1&e&&(h.Ob(0,"a",17),h.Fc(1),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(2);h.Cb("active",i.typeFilter==e.key),h.hc("queryParams",h.mc(5,Ct,e.key))("title",e.name),h.yb(1),h.Gc(e.name)}}const St=function(){return{typeFilter:"All"}};function kt(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",14),h.Ob(1,"a",15),h.Fc(2,"All"),h.Nb(),h.Dc(3,wt,2,7,"a",16),h.ac(4,"gtFilter"),h.Nb()),2&e){const e=h.Zb();h.hc("autoCompact",!1)("text",e.eDatalinkType[e.typeFilter])("pullRight",!0),h.yb(1),h.Cb("active","All"==e.typeFilter),h.hc("queryParams",h.lc(11,St)),h.yb(2),h.hc("ngForOf",h.dc(4,7,e.eDatalinkTypeItems,"key",0))}}function Ot(e,t){if(1&e&&h.Lb(0,"tags-update-button",18),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.Datalink)("objects",e)}}function Nt(e,t){if(1&e&&h.Lb(0,"datalink-status",19),2&e){const e=t.item;h.hc("datalinkKey",null==e?null:e.key)}}function Tt(e,t){if(1&e&&h.Lb(0,"dependent-items-button",20),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.Datalink)}}let Dt=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.eDatalinkType=b.nb,this.eDatalinkTypeItems=b.ob,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"datalinkType",title:"Datalink Type",format:""},{name:"sourceName",title:"Source",format:""},{name:"targetName",title:"Target",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[2];this.hubCache=e[3],this.hubCache.isLoaded()&&(this.typeFilter=+t.typeFilter,this.typeFilter||(this.typeFilter=0),this.updateDatalinks())})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink Index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}close(){this.authService.navigateUp()}updateDatalinks(){let e;if(this.hubCache.isLoaded())if(this.hubCache.hub.dexihDatalinks){e=0!==this.typeFilter&&this.typeFilter?this.hubCache.hub.dexihDatalinks.filter(e=>e.datalinkType===this.typeFilter):this.hubCache.hub.dexihDatalinks;let t=new Array;e.forEach(e=>{let i="",a="";switch(e.sourceDatalinkTable.sourceType){case b.gc.Table:let t=this.hubCache.getTable(e.sourceDatalinkTable.sourceTableKey);i=t?t.logicalName:"Error, not found";break;case b.gc.Datalink:let a=this.hubCache.hub.dexihDatalinks.find(t=>t.key===e.sourceDatalinkTable.sourceDatalinkKey);i=a?"Datalink: "+a.name:"Error, not found";break;case b.gc.Rows:i="Static Rows"}a=e.isQuery?"None specified.":e.dexihDatalinkTargets.filter(e=>e.isValid).map(e=>{let t=this.hubCache.getTable(e.tableKey);return t&&t.logicalName||"Error, not found"}).join(", "),t.push({key:e.key,datalinkType:this.eDatalinkType[e.datalinkType],name:e.name,tags:this.hubCache.getObjectTags(b.dc.Datalink,e.key),description:e.description,sourceName:i,targetName:a,updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"})}),this._tableData.next(t)}else this._tableData.next(new Array)}editDatalink(e){this.router.navigate(["datalink-edit","edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}watchChanges(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Datalink&&e.changeClass!==b.dc.TagObjects||this.updateDatalinks()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datalink-index"]],decls:14,vars:7,consts:[[1,"container-fluid"],["title","Datalinks","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],["tableClass","table table-striped table-hover m-0",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/datalink.md",1,"m-3"],[3,"datalinks"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Datalinks",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkKey"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.editDatalink(e)})),h.Dc(3,yt,1,1,"ng-template",null,3,h.Ec),h.Dc(5,kt,5,12,"ng-template",4,5,h.Ec),h.Dc(7,Ot,1,2,"ng-template",6,7,h.Ec),h.Dc(9,Nt,1,1,"ng-template",8,9,h.Ec),h.Dc(11,Tt,1,2,"ng-template",10,11,h.Ec),h.Nb(),h.Nb(),h.Lb(13,"dexih-help",12),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,vt.a,u.i,s.h,p.s,g.a,ht.a,f.a],pipes:[Be.a],encapsulation:2}),e})();var xt=i("1mVc");function Ft(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save",6),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return!t.savingDatalink&&t.saveDatalink()})),h.Nb(),h.Ob(1,"dexih-button-cancel",7),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return!t.savingDatalink&&t.cancel()})),h.Nb()}if(2&e){const e=h.Zb();h.hc("busy",e.savingDatalink),h.yb(1),h.hc("busy",e.savingDatalink)}}function It(e,t){if(1&e&&(h.Ob(0,"span",11),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.yb(1),h.Hc(" ",e.name," ")}}function Kt(e,t){if(1&e&&(h.Ob(0,"label",8),h.Fc(1,"Create datalinks for the following source table(s):"),h.Nb(),h.Ob(2,"div"),h.Ob(3,"div",9),h.Dc(4,It,2,1,"span",10),h.ac(5,"fieldSort"),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.yb(4),h.hc("ngForOf",h.cc(5,1,e.sourceTables,"name"))}}function Et(e,t){if(1&e&&h.Lb(0,"form-input",20),2&e){const e=h.Zb(2);h.hc("autocapitalize",!0)("errors",e.formErrors.name)}}function Vt(e,t){1&e&&h.Lb(0,"form-input",21)}function Lt(e,t){if(1&e&&(h.Ob(0,"form",12),h.Ob(1,"fieldset"),h.Ob(2,"div",13),h.Ob(3,"section",14),h.Dc(4,Et,1,2,"form-input",15),h.Dc(5,Vt,1,0,"form-input",16),h.Nb(),h.Ob(6,"section",14),h.Lb(7,"form-select",17),h.Nb(),h.Nb(),h.Ob(8,"div",13),h.Ob(9,"section",14),h.Lb(10,"form-select",18),h.Nb(),h.Ob(11,"section",14),h.Lb(12,"form-select",19),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.mainForm),h.yb(4),h.hc("ngIf",1==e.sourceTables.length),h.yb(1),h.hc("ngIf",e.sourceTables.length>1),h.yb(2),h.hc("items",e.eDatalinkTypeItems)("errors",e.formErrors.datalinkType),h.yb(3),h.hc("items",e.managedConnections)("errors",e.formErrors.targetConnectionKey)("allowNullSelect",!0),h.yb(2),h.hc("items",e.managedConnections)("errors",e.formErrors.auditConnectionKey)("allowNullSelect",!0)}}const Pt=function(){return{standalone:!0}};function jt(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section",14),h.Ob(1,"form-checkbox",26),h.Vb("ngModelChange",(function(i){return h.vc(e),t.$implicit.value=i})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit;h.yb(1),h.hc("label",e.name)("ngModel",e.value)("ngModelOptions",h.lc(3,Pt))}}function At(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form"),h.Ob(1,"fieldset"),h.Ob(2,"section"),h.Ob(3,"div",13),h.Ob(4,"section",22),h.Lb(5,"form-checkbox",23),h.Nb(),h.Nb(),h.Ob(6,"div",13),h.Ob(7,"section",22),h.Ob(8,"label",8),h.Fc(9," Specify the audit columns (in addition to source columns) to be included in the target table. "),h.Nb(),h.Ob(10,"form-checkbox",24),h.Vb("ngModelChange",(function(){return h.vc(e),h.Zb().selectAllAuditColumns()})),h.Nb(),h.Nb(),h.Nb(),h.Ob(11,"div",13),h.Dc(12,jt,2,4,"section",25),h.Nb(),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.yb(5),h.hc("ngModel",e.addSourceColumns),h.yb(5),h.hc("ngModel",e.allAuditColumns),h.yb(2),h.hc("ngForOf",e.auditColumnTypes)}}let Mt=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.route=t,this.router=i,this.location=a,this.fb=n,this.hasChanged=!1,this.showAllErrors=!1,this.addSourceColumns=!0,this.eConnectionPurpose=b.jb,this.auditColumnTypes=[{key:b.qb.AutoIncrement,name:"Auto Incrementing Key",value:!1},{key:b.qb.IsCurrentField,name:"Is Current Flag",value:!1},{key:b.qb.Version,name:"Record Version",value:!1},{key:b.qb.ValidFromDate,name:"Valid From Date",value:!1},{key:b.qb.ValidToDate,name:"Valid To Date",value:!1},{key:b.qb.CreateDate,name:"Created Date",value:!1},{key:b.qb.UpdateDate,name:"Updated Date",value:!1},{key:b.qb.CreateAuditKey,name:"Created by AuditKey Reference",value:!1},{key:b.qb.UpdateAuditKey,name:"Updated by AuditKey Reference",value:!1}],this.allAuditColumns=!1,this.eDatalinkTypeItems=b.ob,this.savingDatalink=!1,this.formErrors={name:"",targetConnectionKey:"",auditConnectionKey:"",datalinkType:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},targetConnectionKey:{},auditConnectionKey:{},datalinkType:{required:"Datalink Type is required."}}}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[1];if(this.hubCache=e[2],this.managedTargetConnections=this.hubCache.hub.dexihConnections.filter(e=>e.purpose===b.jb.Managed||e.purpose===b.jb.Target),this.managedConnections=this.hubCache.hub.dexihConnections.filter(e=>e.purpose===b.jb.Managed),this.tableKeys=t.sourceTableKeys.split("|").map(e=>+e),this.hubCache.status===N.j.Loaded){if(this.updateTables(),this.targetConnectionKey=+t.targetConnectionKey,!this.targetConnectionKey){let e=this.hubCache.hub.dexihConnections.find(e=>e.purpose===b.jb.Managed);e&&(this.targetConnectionKey=e.key)}this.auditConnectionKey=this.targetConnectionKey,this.datalinkType=b.nb.General,this.buildForm(),this.watchChanges()}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink New")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}updateTables(){this.sourceTableKeys=new Array,this.sourceTables=new Array,this.tableKeys&&this.hubCache.hub.dexihConnections&&this.hubCache.hub.dexihTables.forEach(e=>{this.tableKeys.findIndex(t=>t===e.key)>=0&&(this.sourceTableKeys.push(e.key),this.sourceTables.push(e))})}buildForm(){this.mainForm=this.fb.group({name:[this.name,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],datalinkType:[this.datalinkType,[a.G.required]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe(e=>this.onValueChanged()),this.onValueChanged(),this.hasChanged=!1}onValueChanged(){if(!this.mainForm)return;const e=this.mainForm;this.hasChanged=!0;for(const t of Object.keys(this.formErrors)){this.formErrors[t]="";const i=e.get(t);if(i&&(i.dirty||this.showAllErrors)&&!i.valid){const e=this.validationMessages[t];for(const a of Object.keys(i.errors))this.formErrors[t]+=e[a]+" "}}}selectAllAuditColumns(){this.allAuditColumns=!this.allAuditColumns,this.auditColumnTypes.forEach(e=>e.value=this.allAuditColumns)}saveDatalink(){if(this.mainForm.valid){let e=this.mainForm.value;this.savingDatalink=!0;let t=this.auditColumnTypes.filter(e=>e.value).map(e=>e.key);this.hubService.createDatalinks(this.sourceTableKeys,e.name,e.datalinkType,e.targetConnectionKey,null,null,e.auditConnectionKey,this.addSourceColumns,t).then(e=>{this.savingDatalink=!1,1===e.length?this.openDatalink(e[0].key):this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinks"],{relativeTo:this.route.root})}).catch(()=>{this.savingDatalink=!1})}else this.showAllErrors=!0,this.onValueChanged()}cancel(){this.location.back()}openDatalink(e,t=0){t>=10&&this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinks"],{relativeTo:this.route.root}),setTimeout(()=>{this.hubCache.hub.dexihDatalinks.findIndex(t=>t.key===e)>=0?this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinks","datalink-edit","edit",e],{relativeTo:this.route.root}):this.openDatalink(e,t++)},500)}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass===b.dc.Table&&this.updateTables()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(s.a),h.Kb(s.e),h.Kb(p.n),h.Kb(a.g))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-datalink-new-form"]],decls:8,vars:4,consts:[[1,"container"],["title","New Datalink(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors",4,"ngIf"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment",4,"ngIf"],["formControlName","datalinkType","label","Type","itemKey","key","itemName","description",3,"items","errors"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for the target table.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],["formControlName","auditConnectionKey","label","Audit Connection","itemKey","key","itemName","name","note","Specify the connection to store execution results.","selectNullMessage","No datalink auditing",3,"items","errors","allowNullSelect"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment"],[1,"col","col-11"],["label","Include source columns in target table","name","addSourceColumns",3,"ngModel"],["label","Select All/None","name","selectAllAuditColumns",3,"ngModel","ngModelChange"],["class","form-group col-md-6",4,"ngFor","ngForOf"],[3,"label","ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return!t.savingDatalink&&t.cancel()})),h.Dc(2,Ft,2,2,"ng-template",null,2,h.Ec),h.Dc(4,Kt,6,4,"ng-template",null,3,h.Ec),h.Dc(6,Lt,13,11,"form",4),h.Dc(7,At,13,3,"form",5),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(5),h.hc("ngIf",t.sourceTableKeys),h.yb(1),h.hc("ngIf",t.sourceTableKeys))},directives:[u.P,p.t,u.t,u.b,p.s,a.I,a.t,a.l,u.E,a.s,a.j,u.D,a.u,u.A,a.v],pipes:[xt.a],encapsulation:2}),e})();var Rt=i("NHAS");let Zt=(()=>{class e{constructor(e,t,i){this.hubService=e,this.authService=t,this.route=i,this.eDataObjectType=b.lb}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params).subscribe(e=>{let t=e[0],i=e[1];this.action=t.action,this.pageTitle=t.pageTitle,this.key=+i.datalinkKey,this.previewUpdates="true"===i.previewUpdates})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink Preview")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datalink-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["title","Preview Datalink","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],[3,"key","previewUpdates","viewSource"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Lb(2,"preview-data",2),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("key",t.key)("previewUpdates",t.previewUpdates)("viewSource",t.eDataObjectType.Datalink))},directives:[u.P,Rt.a],encapsulation:2}),e})();var _t=i("NUI7");function Ht(e,t){if(1&e&&(h.Ob(0,"dexih-button",5),h.Fc(1),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(2);h.kc("routerLink","/hub/",null==i.hubCache?null:i.hubCache.hub.hubKey,"/connections/tables/table-new/",e.key,""),h.hc("autoCompact",!1),h.yb(1),h.Hc("New Table (",e.name,")")}}function Bt(e,t){if(1&e&&(h.Ob(0,"div",2),h.Fc(1," There are no files configured. Create a file based connection, and add at least one file definition. "),h.Lb(2,"hr"),h.Ob(3,"div"),h.Lb(4,"dexih-button-new",3),h.Dc(5,Ht,2,4,"dexih-button",4),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.yb(4),h.jc("routerLink","/hub/",null==e.hubCache?null:e.hubCache.hub.hubKey,"/connections/connection-new/Source"),h.hc("autoCompact",!1),h.yb(1),h.hc("ngForOf",e.fileConnections)}}function Ut(e,t){if(1&e&&(h.Ob(0,"a",13),h.Fc(1),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(3);h.kc("routerLink","/hub/",null==i.hubCache?null:i.hubCache.hub.hubKey,"/connections/tables/table-new/",e.key,""),h.yb(1),h.Gc(e.name)}}const qt=function(e,t){return{tableKey:e,path:t}};function zt(e,t){if(1&e&&(h.Ob(0,"a",16),h.Lb(1,"i",17),h.Fc(2),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(4);h.Cb("active","item.name"==i.path),h.hc("queryParams",h.nc(4,qt,i.tableKey,e.key)),h.yb(2),h.Gc(e.name)}}function Wt(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",14),h.Dc(1,zt,3,7,"a",15),h.Nb()),2&e){const e=h.Zb(3);h.hc("text",e.eFlatFilePath[e.path])("pullRight",!0),h.yb(1),h.hc("ngForOf",e.eFlatFilePathItems)}}function Gt(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",10),h.Dc(1,Ut,2,3,"a",11),h.Nb(),h.Dc(2,Wt,2,3,"dexih-button-dropdown",12)),2&e){const e=h.Zb(2);h.yb(1),h.hc("ngForOf",e.fileConnections),h.yb(1),h.hc("ngIf",(null==e.connectionReference?null:e.connectionReference.allowFlatFiles)&&(null==e.table?null:e.table.autoManageFiles))}}const Qt=function(){return{standalone:!0}};function $t(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section"),h.Ob(1,"form-select",35),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb(3).updateStrategy=t})),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(3);h.yb(1),h.hc("ngModel",e.updateStrategy)("ngModelOptions",h.lc(3,Qt))("items",e.updateStrategies)}}function Xt(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",36),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(3).uploadSelected(i)})),h.Fc(1,"Upload"),h.Nb(),h.Ob(2,"dexih-button-cancel",37),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(3).cancelSelected(i)})),h.Nb(),h.Ob(3,"dexih-button-delete",38),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(3).removeSelected(i)})),h.Nb()}}function Yt(e,t){if(1&e){const e=h.Pb();h.Ob(0,"section"),h.Ob(1,"form-checkbox",39),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb(3).automaticUpload=t})),h.Nb(),h.Nb()}if(2&e){const e=h.Zb(3);h.yb(1),h.hc("ngModel",e.automaticUpload)}}const Jt=function(e){return{width:e}};function ei(e,t){if(1&e&&(h.Ob(0,"div",42),h.Lb(1,"div",43),h.Nb()),2&e){const e=h.Zb().item;h.yb(1),h.hc("ngStyle",h.mc(1,Jt,e.progress+"%"))}}const ti=function(e,t,i){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":i}};function ii(e,t){if(1&e&&(h.Dc(0,ei,2,3,"div",40),h.Ob(1,"span"),h.Lb(2,"i",41),h.Fc(3),h.Nb()),2&e){const e=t.item,i=h.Zb(3);h.hc("ngIf",e.isRunning()),h.yb(2),h.hc("ngClass",h.oc(3,ti,e.status===i.eFileStatus.Complete,e.status===i.eFileStatus.Error,e.status===i.eFileStatus.Cancelled)),h.yb(1),h.Gc(e.status)}}function ai(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",50),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items,i=h.Zb(4);return i.moveSelected(t,i.eFlatFilePath.Incoming)})),h.Fc(1,"To Incoming"),h.Nb()}}function ni(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",50),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items,i=h.Zb(4);return i.moveSelected(t,i.eFlatFilePath.Outgoing)})),h.Fc(1,"To Processed"),h.Nb()}}function si(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",50),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items,i=h.Zb(4);return i.moveSelected(t,i.eFlatFilePath.Processed)})),h.Fc(1,"To Processed"),h.Nb()}}function oi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",50),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items,i=h.Zb(4);return i.moveSelected(t,i.eFlatFilePath.Rejected)})),h.Fc(1,"To Rejected"),h.Nb()}}function ci(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",37),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(4).deleteSelected(i)})),h.Nb(),h.Ob(1,"dexih-button-download",37),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb(4).downloadSelected(i)})),h.Nb(),h.Ob(2,"dexih-button-dropdown",48),h.Dc(3,ai,2,0,"a",49),h.Dc(4,ni,2,0,"a",49),h.Dc(5,si,2,0,"a",49),h.Dc(6,oi,2,0,"a",49),h.Nb()}if(2&e){const e=h.Zb(4);h.yb(2),h.hc("pullRight",!0),h.yb(1),h.hc("ngIf",e.path!=e.eFlatFilePath.Incoming),h.yb(1),h.hc("ngIf",e.path!=e.eFlatFilePath.Outgoing),h.yb(1),h.hc("ngIf",e.path!=e.eFlatFilePath.Processed),h.yb(1),h.hc("ngIf",e.path!=e.eFlatFilePath.Rejected)}}const ri=function(e,t,i,a){return["/hub",e,"summary","files","manage",t,"file-preview",i,a]};function li(e,t){if(1&e&&h.Lb(0,"dexih-button-preview",51),2&e){const e=t.item,i=h.Zb(4);h.hc("routerLink",h.pc(1,ri,null==i.hubCache?null:i.hubCache.hub.hubKey,i.tableKey,i.path,e.fileName))}}function bi(e,t){if(1&e&&(h.Ob(0,"a",16),h.Lb(1,"i",17),h.Fc(2),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(6);h.Cb("active","item.name"==i.path),h.hc("queryParams",h.nc(4,qt,i.tableKey,e.key)),h.yb(2),h.Gc(e.name)}}function hi(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",54),h.Dc(1,bi,3,7,"a",15),h.Nb()),2&e){const e=h.Zb(5);h.hc("text",e.eFlatFilePath[e.path])("pullRight",!0),h.yb(1),h.hc("ngForOf",e.eFlatFilePathItems)}}function ui(e,t){if(1&e){const e=h.Pb();h.Dc(0,hi,2,3,"dexih-button-dropdown",52),h.Ob(1,"dexih-button-refresh",53),h.Vb("click",(function(){return h.vc(e),h.Zb(4).refreshFiles()})),h.Nb()}if(2&e){const e=h.Zb(4);h.hc("ngIf",null==e.table?null:e.table.autoManageFiles)}}function di(e,t){if(1&e&&(h.Ob(0,"li",22),h.Ob(1,"h5"),h.Fc(2,"Files (Local directory: "),h.Ob(3,"a",44),h.Fc(4),h.Nb(),h.Fc(5,")"),h.Nb(),h.Nb(),h.Ob(6,"li",27),h.Ob(7,"dexih-table",45),h.Dc(8,ci,7,5,"ng-template",29,30,h.Ec),h.Dc(10,li,1,6,"ng-template",46,47,h.Ec),h.Dc(12,ui,2,1,"ng-template",null,31,h.Ec),h.Nb(),h.Nb()),2&e){const e=h.Zb(3);h.yb(3),h.jc("href","file://///",e.localPath,"",h.xc),h.yb(1),h.Gc(e.localPath),h.yb(3),h.hc("enableMultiSelect",!0)("columns",e.columns)("dataObservable",e.tableData)}}function mi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"ul",18),h.Ob(1,"li",19),h.Ob(2,"section"),h.Ob(3,"form-select",20),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb(2).tableKey=t}))("ngModelChange",(function(t){return h.vc(e),h.Zb(2).updateTable(t)})),h.Nb(),h.Nb(),h.Dc(4,$t,2,4,"section",21),h.Nb(),h.Ob(5,"li",22),h.Ob(6,"h5"),h.Fc(7,"Drop Files to Upload"),h.Nb(),h.Nb(),h.Ob(8,"li",19),h.Ob(9,"div",23),h.Vb("dropFiles",(function(t){return h.vc(e),h.Zb(2).filesDrop(t)})),h.Fc(10," Drop Files to Upload Here "),h.Ob(11,"div",24),h.Ob(12,"input",25),h.Vb("change",(function(t){return h.vc(e),h.Zb(2).uploadFile(t)})),h.Nb(),h.Ob(13,"label",26),h.Fc(14,"Choose files"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(15,"li",22),h.Ob(16,"h5"),h.Fc(17,"Upload Queue"),h.Nb(),h.Nb(),h.Ob(18,"li",27),h.Ob(19,"dexih-table",28),h.Dc(20,Xt,4,0,"ng-template",29,30,h.Ec),h.Dc(22,Yt,2,1,"ng-template",null,31,h.Ec),h.Dc(24,ii,4,7,"ng-template",32,33,h.Ec),h.Nb(),h.Nb(),h.Dc(26,di,14,5,"ng-template",34),h.Nb()}if(2&e){const e=h.Zb(2);h.yb(3),h.hc("ngModel",e.tableKey)("ngModelOptions",h.lc(9,Qt))("items",e.connectionTables),h.yb(1),h.hc("ngIf",!(null!=e.connectionReference&&e.connectionReference.allowFlatFiles)),h.yb(5),h.hc("requireFiles",!0),h.yb(10),h.hc("enableMultiSelect",!0)("columns",e.uploadColumns)("data",e.uploadedFiles),h.yb(7),h.hc("ngIf",null==e.connectionReference?null:e.connectionReference.allowFlatFiles)}}function fi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",6),h.Ob(1,"dexih-widget",7),h.Vb("close",(function(){return h.vc(e),h.Zb().close()})),h.Dc(2,Gt,3,2,"ng-template",null,8,h.Ec),h.Dc(4,mi,27,10,"ul",9),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.yb(1),h.hc("title","Manage Files: "+(null==e.table?null:e.table.name))("showCloseButton",!0),h.yb(3),h.hc("ngIf",e.table)}}let pi=(()=>{class e{constructor(e,t,i,a){this.authService=e,this.hubService=t,this.route=i,this.router=a,this.entityType="Table",this.canEdit=!1,this.updateStrategy=b.qc.Reload,this.updateStrategies=N.y,this.path=b.zb.None,this.eFlatFilePath=b.zb,this.eFlatFilePathItems=b.Ab.filter(e=>e.key>0),this.eFileStatus=x.h,this.automaticUpload=!0,this.uploadedFiles=[],this.cancelToken=new x.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"fileName",title:"File Name",format:""},{name:"length",title:"Size",format:""},{name:"lastModified",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable(),this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}ngOnInit(){try{this._subscription=Object(l.a)(this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe(e=>{let t=e[1];this.hubCache=e[2],this.remoteLibraries=e[3],this.fileConnections=this.hubCache.hub.dexihConnections.filter(e=>{let t=this.remoteLibraries.connections.find(t=>e.connectionAssemblyName===t.connectionAssemblyName&&e.connectionClassName===t.connectionClassName);return!!t&&(t.connectionCategory===b.ib.File||e.purpose!==b.jb.Source)});let i=this.hubCache.getConnectionTables();this.connectionTables=i.filter(e=>{if(e.dexihTables.length>0)return null!=this.fileConnections.find(t=>e.key===t.key)});let a=!1;if(this.tableKey=+t.tableKey,this.tableKey||this.connectionTables.length>0&&this.connectionTables[0].dexihTables.length>0&&(this.tableKey=this.connectionTables[0].dexihTables[0].key,a=!0),this.path=+t.path,this.path||(this.path=b.zb.Incoming,a=!0),a)return void this.router.navigate([],{relativeTo:this.route,queryParams:{tableKey:this.tableKey,path:this.path},queryParamsHandling:"merge"});this.table=this.hubCache.getTable(this.tableKey);let n=this.hubCache.getConnection(this.table.connectionKey);this.connectionReference=this.remoteLibraries.connections.find(e=>n.connectionAssemblyName===e.connectionAssemblyName&&n.connectionClassName===e.connectionClassName),!this.table&&this.tableKey?this.hubService.addHubErrorMessage(`The table with the key ${this.tableKey} could not be found.`):this.table&&(this.pageTitle="Manage files for "+this.table.name,this.showPage=!0,this.refreshFiles())})}catch(e){this.hubService.addHubClientErrorMessage(e,"Files Manage")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}updateTable(e){this.router.navigate([],{relativeTo:this.route,queryParams:{tableKey:e,path:"incoming"},queryParamsHandling:"merge"})}refreshFiles(){this.connectionReference.allowsFlatFiles&&this.hubService.getFileList(this.table,this.path,this.cancelToken).then(e=>{this._tableData.next(e)}).catch(e=>{this._tableData.next([])})}uploadSelected(e){e.forEach(e=>{this.authService.upload(e).then(t=>{t.success?(this.hubService.addHubSuccessMessage(`File ${e.file.name} uploaded successfully.`),this.refreshFiles()):this.hubService.addHubMessage(t)}).catch(e=>{this.hubService.addHubMessage(e)})})}removeSelected(e){e.forEach(e=>{let t=this.uploadedFiles.findIndex(t=>t.id===e.id);t>=0&&this.uploadedFiles.splice(t,1)})}cancelSelected(e){e.forEach(e=>e.cancel())}deleteSelected(e){let t=e.map(e=>e.fileName);this.hubService.deleteFiles(this.table,this.path,t,this.cancelToken).then(e=>{e&&this.refreshFiles()}).catch()}moveSelected(e,t){let i=e.map(e=>e.fileName);this.hubService.moveFiles(this.table,this.path,t,i,this.cancelToken).then(e=>{e&&this.refreshFiles()}).catch(e=>{this.hubService.addHubMessage(status)})}downloadSelected(e){let t=e.map(e=>e.fileName);this.hubService.downloadFiles(this.table,this.path,t,this.cancelToken).then(e=>{e&&this.refreshFiles()}).catch()}preview(e){this.router.navigate(["hub",this.hubCache.hub.hubKey,"summary","files","manage",this.tableKey,this.path,e.fileName])}close(){this.authService.navigateUp()}uploadFile(e){return this.doUpload(e.srcElement.files),!1}doUpload(e){Array.prototype.forEach.call(e,e=>{this.hubService.uploadFile(this.table,this.path,this.updateStrategy,e.name,this.cancelToken).then(t=>{let i=new x.d(e,t);this.automaticUpload&&this.authService.upload(i).then(t=>{t.success?(this.hubService.addHubSuccessMessage(`File ${e.name} uploaded successfully.`),this.refreshFiles()):this.hubService.addHubMessage(t)}).catch(e=>{this.hubService.addHubMessage(e)}),this.uploadedFiles.push(i),this.uploadedFiles=[...this.uploadedFiles]}).catch(e=>{this.hubService.addHubMessage(e)})})}filesDrop(e){this.doUpload(e)}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(c.a),h.Kb(o.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["files-manage"]],decls:2,vars:2,consts:[["class","alert alert-danger m-3",4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],["text","New Connection",3,"routerLink","autoCompact"],[3,"routerLink","autoCompact","title",4,"ngFor","ngForOf"],[3,"routerLink","autoCompact","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","close"],["header",""],["class","list-group",4,"ngIf"],["iconClass","fa fa-file-o","text","New File",1,"mr-1"],["class","dropdown-item",3,"routerLink","title",4,"ngFor","ngForOf"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[1,"dropdown-item",3,"routerLink","title"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight"],["class","dropdown-item","routerLinkActive","active","data-toggle","tab","routerLink",".",3,"active","queryParams",4,"ngFor","ngForOf"],["routerLinkActive","active","data-toggle","tab","routerLink",".",1,"dropdown-item",3,"queryParams"],[1,"fa","fa-elipsis-h"],[1,"list-group"],[1,"list-group-item"],["label","Flat File","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the flat file to manage",3,"ngModel","ngModelOptions","items","ngModelChange"],[4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","p-0"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],[3,"ngIf"],["label","Update Strategy","itemKey","key","itemName","description","iconClass","fa fa-database","note","Specify how records should be inserted/updated in the target table.",3,"ngModel","ngModelOptions","items","ngModelChange"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],[3,"href"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemAction"],["selectedItemAction",""],["iconClass","fa fa-mail-forward","text","Move",1,"mr-1",3,"pullRight"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[3,"routerLink"],["class","mr-1","buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[3,"click"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(h.Dc(0,Bt,6,3,"div",0),h.Dc(1,fi,5,3,"div",1)),2&e&&(h.hc("ngIf",!t.connectionTables||0===t.connectionTables.length),h.yb(1),h.hc("ngIf",t.connectionTables&&t.connectionTables.length>0))},directives:[p.t,u.o,s.f,p.s,u.f,u.P,u.i,s.h,s.g,u.E,a.s,a.v,Xe.a,d.a,u.b,u.g,u.A,p.q,p.w,u.h,u.q,u.s],encapsulation:2}),e})();i("/fhR");const gi=function(e){return["hubVariable-edit",e]};function vi(e,t){1&e&&h.Lb(0,"dexih-button-edit",9),2&e&&h.hc("routerLink",h.mc(1,gi,t.item.key))}function yi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",10),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().deleteHubVariables(t)})),h.Nb()}}function Ci(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",10),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb(),h.Dc(1,yi,1,0,"dexih-button-delete",11),h.Lb(2,"tags-update-button",12)}if(2&e){const e=t.items,i=h.Zb();h.yb(1),h.hc("ngIf",i.hubCache.canWrite),h.yb(1),h.hc("objectType",i.eSharedObjectType.HubVariable)("objects",e)}}const wi=function(){return["hubVariable-new"]};function Si(e,t){1&e&&h.Lb(0,"dexih-button-new",14),2&e&&h.hc("routerLink",h.lc(1,wi))}function ki(e,t){if(1&e&&h.Dc(0,Si,1,2,"dexih-button-new",13),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}let Oi=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"value",title:"Value",format:""},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[0],this.updateVariables()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Hub Variables Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}deleteHubVariables(e){this.hubService.deleteHubVariables(e)}updateVariables(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihHubVariables.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,value:e.isEncrypted?"(Encrypted)":e.value,isEncrypted:e.isEncrypted,tags:this.hubCache.getObjectTags(b.dc.HubVariable,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}edit(e){this.router.navigate(["hubVariable-edit",e.key],{relativeTo:this.route})}export(e){let t=this.hubCache.hub.dexihHubVariables.filter(t=>e.findIndex(e=>e.key===t.key)>=0);const i=this.hubService.createHub(this.hubCache.hub.hubKey,"");i.dexihHubVariables=t,this.hubService.exportHub(i,"hub_variables.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.HubVariable&&e.changeClass!==b.dc.TagObjects||this.updateVariables()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["hubVariable"]],decls:10,vars:7,consts:[[1,"container-fluid"],["title","Hub Variables","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,vi,1,3,"ng-template",3,4,h.Ec),h.Dc(5,Ci,3,3,"ng-template",5,6,h.Ec),h.Dc(7,ki,1,1,"ng-template",null,7,h.Ec),h.Nb(),h.Nb(),h.Lb(9,"dexih-help",8),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,u.j,s.f,u.u,p.t,g.a,u.g,u.o],encapsulation:2}),e})();function Ni(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save",7),h.Vb("click",(function(){return h.vc(e),h.Zb(2).save()})),h.Nb()}}function Ti(e,t){if(1&e&&(h.Dc(0,Ni,1,0,"dexih-button-save",5),h.Lb(1,"cancel-button",6)),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("formsService",e.formsService)}}function Di(e,t){if(1&e&&(h.Ob(0,"form",8),h.Lb(1,"input",9),h.Lb(2,"input",10),h.Ob(3,"fieldset"),h.Ob(4,"div",11),h.Ob(5,"section",12),h.Lb(6,"form-input",13),h.Nb(),h.Ob(7,"section",12),h.Lb(8,"form-input",14),h.Nb(),h.Nb(),h.Ob(9,"section"),h.Lb(10,"form-checkbox",15),h.Nb(),h.Ob(11,"section"),h.Lb(12,"form-checkbox",16),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(6),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("label",e.formsService.currentForm.controls.isEnvironmentVariable.value?"Environment Variable Name":"Hub Variable Value")("type",e.formsService.currentForm.controls.isEncrypted.value?"password":"text")("errors",e.formsService.formErrors.value)}}let xi=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.isLoaded=!1,this.cancelToken=new x.a}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.pageTitle=t.pageTitle,this.action=t.action,this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Edit Variables")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._isEncryptedSubscription&&this._isEncryptedSubscription.unsubscribe(),this.cancelToken.cancel()}load(){if(this.isLoaded=!0,"edit"===this.action)if(this.hubVariableKey=+this.params.hubVariableKey,this.hubVariableKey)if(this.hubCache.hub&&this.hubCache.hub.dexihHubVariables){let e=this.hubCache.hub.dexihHubVariables.find(e=>e.key===this.hubVariableKey);this.formsService.hubVariable(e)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no variable specified to edit.");if("new"===this.action){let e=new b.C;e.value="",e.name="",this.formsService.hubVariable(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/hubVariable-new","/hubVariable-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}this._isEncryptedSubscription=this.formsService.currentForm.controls.isEncrypted.valueChanges.subscribe(e=>{e||this.formsService.currentForm.controls.valueRaw.setValue("")})}save(){return e=this,void 0,i=function*(){let e=this.formsService.currentForm;if(e.controls.isEncrypted.value){let t=e.controls.valueRaw.value;if(t){let i=yield this.hubService.encrypt(t,this.cancelToken);e.controls.value.setValue(i),e.controls.valueRaw.setValue(null)}}else e.controls.value.setValue(e.controls.valueRaw.value);yield this.formsService.save()},new((t=void 0)||(t=Promise))((function(a,n){function s(e){try{c(i.next(e))}catch(t){n(t)}}function o(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var i;e.done?a(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,o)}c((i=i.apply(e,[])).next())}));var e,t,i}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-hubVariable-edit-form"]],features:[h.xb([T.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Variable","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["class","mr-1",3,"click",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"click"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Hub Variable Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["formControlName","valueRaw","placeholder","Enter the value.","iconClass","fa fa-list","autocomplete","off",3,"label","type","errors"],["label","Encrypt value","formControlName","isEncrypted"],["label","Use an environment variable on the remote agent","formControlName","isEnvironmentVariable"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Ti,2,2,"ng-template",null,2,h.Ec),h.Dc(4,Di,13,6,"form",3),h.Nb(),h.Lb(5,"dexih-help",4),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(3),h.hc("ngIf",t.formsService.currentForm))},directives:[u.P,p.t,G.a,F.a,u.t,a.I,a.t,a.l,u.D,a.s,a.j,u.A],encapsulation:2}),e})();var Fi=i("24Dg");const Ii=["DexihMessage"];function Ki(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save",12),h.Vb("click",(function(){return h.vc(e),h.Zb().addUsers()})),h.Nb()}if(2&e){const e=h.Zb();h.hc("disabled",0==e.emails.length)}}function Ei(e,t){if(1&e){const e=h.Pb();h.Ob(0,"a",17),h.Vb("click",(function(){h.vc(e);const i=t.$implicit,a=h.Zb().items;return h.Zb().setPermission(i.key,a)})),h.Fc(1),h.Nb()}if(2&e){const e=t.$implicit;h.yb(1),h.Gc(e.name)}}function Vi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",13),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().deleteUsers(i)})),h.Nb(),h.Ob(1,"dexih-button-dropdown",14),h.Dc(2,Ei,2,1,"a",15),h.Nb(),h.Ob(3,"dexih-button-dropdown",16),h.Ob(4,"a",17),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().setUserAlert(!0,i)})),h.Fc(5,"Receive alert emails"),h.Nb(),h.Ob(6,"a",17),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().setUserAlert(!1,i)})),h.Fc(7,"Do not receive alert emails."),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.yb(2),h.hc("ngForOf",e.ePermissionItems)}}let Li=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.columns=[{name:"userName",title:"User Name",format:""},{name:"firstName",title:"First Name",format:""},{name:"lastName",title:"Last Name",format:""},{name:"permission",title:"Permission",enum:b.Wb,format:"Enum"},{name:"receiveAlerts",title:"Receives Alert Emails",format:"Boolean"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable(),this.ePermission=b.Wb,this.ePermissionItems=b.Xb,this.permission=b.Wb.PublishReader,this.emails=[],this.sendInvites=!0}ngOnInit(){this.refreshUsers()}ngOnDestroy(){}refreshUsers(){this.hubService.getHubUsers().then(e=>{this._tableData.next(e)})}setPermission(e,t){const i=t.map(e=>e.userName);this.authService.confirmDialog("Confirm Permission Change",`This action will change the selected user(s) hub permission to ${b.Wb[this.permission]}.  Proceed?`).then(t=>{t&&this.hubService.setUserPermissions(i,e,!1).then(e=>{this.dexihMessage.addSuccessMessage("The specified user(s) permission have been updated."),this.refreshUsers()})})}setUserAlert(e,t){const i=t.map(e=>e.id);this.hubService.setUserAlerts(i,e,!1).then(e=>{this.dexihMessage.addSuccessMessage("The specified user(s) alert email status have been updated."),this.refreshUsers()})}deleteUsers(e){const t=e.map(e=>e.userName);this.authService.confirmDialog("Confirm Delete Users","This action will delete the selected user(s) from using this hub.  Proceed?").then(e=>{e&&this.hubService.removeUsers(t).then(e=>{this.dexihMessage.addSuccessMessage("The specified users have been removed from the hub."),this.refreshUsers()})})}addUsers(){this.emails.length>0&&this.permission&&this.authService.confirmDialog("Add Users",`This action will added users with the specified emails to this hub with permission ${b.Wb[this.permission]}.  Proceed?`).then(e=>{e&&this.hubService.setUserPermissions(this.emails,this.permission,this.sendInvites).then(e=>{this.emails=[],this.dexihMessage.addSuccessMessage("The specified users have been added to the hub."),this.refreshUsers()})})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["users"]],viewQuery:function(e,t){var i;1&e&&h.Bc(Ii,!0),2&e&&h.rc(i=h.Wb())&&(t.dexihMessage=i.first)},decls:19,vars:9,consts:[[1,"p-3"],["DexihMessage",""],[1,"container-fluid"],["title","Invite Users","iconClass","fa fa-lg fa-fw fa-birthday-cake",3,"padding"],["subHeader",""],["label","Permission","name","permission","itemKey","key","itemName","name","note","Permission level to grant to emails",3,"ngModel","items","enableFilter","ngModelChange"],["label","Email Addresses / User names","name","emails","note","Provide a list of user names or email addresses of users to join the hub.",3,"ngModel","ngModelChange"],["label","Send invites","name","sendInvites","note","Emails which are not registered to use the integration hub will be sent an invite to join.",3,"ngModel","ngModelChange"],["title","Current Users","iconClass","fa fa-lg fa-fw fa-group"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["text","Add User(s)",3,"disabled","click"],[1,"mr-1",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-lock","text","Set Permission"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["buttonClass","btn-primary","iconClass","fa fa-bell","text","Set User Alert",1,"ml-1"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(h.Lb(0,"dexih-message",0,1),h.Ob(2,"div",2),h.Ob(3,"dexih-widget-vertical"),h.Ob(4,"dexih-widget",3),h.Dc(5,Ki,1,1,"ng-template",null,4,h.Ec),h.Ob(7,"form"),h.Ob(8,"fieldset"),h.Ob(9,"section"),h.Ob(10,"form-select",5),h.Vb("ngModelChange",(function(e){return t.permission=e})),h.Nb(),h.Nb(),h.Ob(11,"section"),h.Ob(12,"form-tags",6),h.Vb("ngModelChange",(function(e){return t.emails=e})),h.Nb(),h.Nb(),h.Ob(13,"section"),h.Ob(14,"form-checkbox",7),h.Vb("ngModelChange",(function(e){return t.sendInvites=e})),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(15,"dexih-widget",8),h.Ob(16,"dexih-table",9),h.Dc(17,Vi,8,1,"ng-template",10,11,h.Ec),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(4),h.hc("padding",!0),h.yb(6),h.hc("ngModel",t.permission)("items",t.ePermissionItems)("enableFilter",!1),h.yb(2),h.hc("ngModel",t.emails),h.yb(2),h.hc("ngModel",t.sendInvites),h.yb(2),h.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[Fi.a,u.S,u.P,a.I,a.t,a.u,u.E,a.s,a.v,u.F,u.A,d.a,u.t,u.g,u.i,p.s],encapsulation:2}),e})();const Pi=function(){return{statusFilter:"All"}},ji=function(){return{statusFilter:"Ready"}},Ai=function(){return{statusFilter:"Offline"}},Mi=function(){return{statusFilter:"Unauthorized"}};function Ri(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",9),h.Ob(1,"a",10),h.Fc(2,"All"),h.Nb(),h.Ob(3,"a",11),h.Fc(4,"Ready"),h.Nb(),h.Ob(5,"a",12),h.Fc(6,"Offline"),h.Nb(),h.Ob(7,"a",13),h.Fc(8,"Unauthorized"),h.Nb(),h.Nb(),h.Fc(9,"\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")),2&e){const e=h.Zb();h.hc("text",e.statusFilter)("pullRight",!0),h.yb(1),h.Cb("active","All"==e.statusFilter),h.hc("queryParams",h.lc(14,Pi)),h.yb(2),h.Cb("active","Ready"==e.statusFilter),h.hc("queryParams",h.lc(15,ji)),h.yb(2),h.Cb("active","Offline"==e.statusFilter),h.hc("queryParams",h.lc(16,Ai)),h.yb(2),h.Cb("active","Unauthorized"==e.statusFilter),h.hc("queryParams",h.lc(17,Mi))}}function Zi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",14),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().deleteSelected(i)})),h.Nb(),h.Ob(1,"dexih-button",15),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().authorize(i)})),h.Fc(2,"Authorize"),h.Nb(),h.Ob(3,"dexih-button",16),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().deAuthorize(i)})),h.Fc(4,"De-Authorize"),h.Nb()}}const _i=function(e,t){return["agent-edit",e,t]};function Hi(e,t){if(1&e&&h.Lb(0,"dexih-button-edit",17),2&e){const e=t.item;h.hc("routerLink",h.nc(1,_i,e.remoteAgentKey,e.remoteAgentHubKey))}}const Bi=function(){return["/hubs/index/agents/download"]};function Ui(e,t){1&e&&h.Lb(0,"dexih-button-download",18),2&e&&h.hc("routerLink",h.lc(1,Bi))}let qi=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.columns=[{name:"name",title:"Name",format:""},{name:"connected",title:"Connected",format:"Boolean"},{name:"isAuthorized",title:"Authorized?",format:"Boolean"},{name:"user",title:"User",format:""},{name:"dataPrivacyStatus",title:"Data Privacy",format:"Enum",enum:b.mb},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"ipAddress",title:"Current IP Address",format:""},{name:"remoteAgentId",title:"Id",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"},{name:"lastLoginDateTime",title:"Last Login",format:"Calendar"},{name:"lastLoginIpAddress",title:"Last IP Address",format:""}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.queryParams,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[0];this.hubCache=e[1],this.remoteAgents=e[2],this.hubCache.isLoaded()&&(this.statusFilter=t.statusFilter,this.statusFilter||(this.statusFilter="All"),this.updateRemoteAgents())})}catch(e){this.hubService.addHubClientErrorMessage(e,"Remote Agent index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}close(){this.authService.navigateUp()}updateRemoteAgents(){if(!this.hubCache||!this.hubCache.hub)return;let e=this.hubCache.hub.dexihRemoteAgentHubs.map(e=>{let t=this.remoteAgents?this.remoteAgents.find(t=>t.remoteAgentKey===e.remoteAgentKey):null,i=t&&t.activeAgents&&t.activeAgents.length>0?t.activeAgents[0]:null;return{remoteAgentHubKey:e.remoteAgentHubKey,connected:null!==i,isAuthorized:e.isAuthorized,name:i?i.name:t?t.name:"Unknown",user:i?i.user:"",dataPrivacyStatus:i?i.dataPrivacyStatus:"",isEncrypted:i?i.isEncrypted:"",ipAddress:i?i.ipAddress:"",remoteAgentKey:e.remoteAgentKey,updateDate:e.updateDate,lastLoginDateTime:t?t.lastLoginDateTime:"",lastLoginIpAddress:t?t.lastLoginIpAddress:"",remoteAgentId:t?t.remoteAgentId:""}});this.remoteAgents&&this.remoteAgents.forEach(t=>{let i=t.activeAgents&&t.activeAgents.length>0?t.activeAgents[0]:null;i&&e.findIndex(e=>e.remoteAgentKey===t.remoteAgentKey)<0&&e.push({remoteAgentHubKey:0,connected:!0,isAuthorized:!1,name:i.name,user:i.user,dataPrivacyStatus:i.dataPrivacyStatus,isEncrypted:i.isEncrypted,ipAddress:i.ipAddress,remoteAgentKey:t.remoteAgentKey,remoteAgentId:t.remoteAgentId,updateDate:""})}),this._tableData.next(e)}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass===b.dc.RemoteAgent&&this.updateRemoteAgents()})}authorize(e){var t,i,a,n,s,o,c;return s=this,void 0,c=function*(){try{for(t=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(i){t[i]=e[i]&&function(t){return new Promise((function(a,n){!function(e,t,i,a){Promise.resolve(a).then((function(t){e({value:t,done:i})}),t)}(a,n,(t=e[i](t)).done,t.value)}))}}}(e);!(i=yield t.next()).done;){const e=i.value;if(!e.isAuthorized){let t;e.remoteAgentHubKey?(t=this.hubCache.hub.dexihRemoteAgentHubs.find(t=>t.remoteAgentHubKey===e.remoteAgentHubKey),t.isAuthorized=!0):(t={hubKey:this.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:e.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null},t.allowExternalConnect=!0,t.isSelected=!1),yield this.hubService.saveRemoteAgent(t)}}}catch(s){a={error:s}}finally{try{i&&!i.done&&(n=t.return)&&(yield n.call(t))}finally{if(a)throw a.error}}},new((o=void 0)||(o=Promise))((function(e,t){function i(e){try{n(c.next(e))}catch(i){t(i)}}function a(e){try{n(c.throw(e))}catch(i){t(i)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}n((c=c.apply(s,[])).next())}))}deAuthorize(e){e.forEach(e=>{if(e.isAuthorized&&e.remoteAgentHubKey){let t=this.hubCache.hub.dexihRemoteAgentHubs.find(t=>t.remoteAgentHubKey===e.remoteAgentHubKey);t&&(t.isAuthorized=!1,this.hubService.saveRemoteAgent(t))}})}deleteSelected(e){e.forEach(e=>{if(e.remoteAgentHubKey){let t=this.hubCache.hub.dexihRemoteAgentHubs.find(t=>t.remoteAgentHubKey===e.remoteAgentHubKey);t&&(t.isAuthorized=!1,this.hubService.deleteRemoteAgent(t))}})}edit(e){this.router.navigate(["agent-edit",e.remoteAgentKey,e.remoteAgentHubKey],{relativeTo:this.route})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["remoteagents"]],inputs:{hubKey:"hubKey"},decls:11,vars:6,consts:[[1,"container-fluid"],["title","Hub Remote Agents","iconClass","fa fa-lg fa-fw fa-wifi",3,"showCloseButton","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["buttonClass","btn btn-sm btn-outline-secondary","iconClass","fa fa-filter","title","Filter by a status",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Ready",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Offline Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Unauthorized Items",1,"dropdown-item",3,"queryParams"],["title","Delete selected remote agents",1,"mr-1",3,"click"],["iconClass","fa fa-check","buttonClass","btn-primary","title","Authorize the selected agents for this hub",1,"mr-1",3,"click"],["iconClass","fa fa-times","buttonClass","btn-danger","title","De-Authorize the selected agents",1,"mr-1",3,"click"],[1,"mr-1",3,"routerLink"],["iconClass","fa fa-download","text","Download Agent",1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Ri,10,18,"ng-template",null,2,h.Ec),h.Ob(4,"dexih-table",3),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(5,Zi,5,0,"ng-template",4,5,h.Ec),h.Dc(7,Hi,1,4,"ng-template",6,7,h.Ec),h.Dc(9,Ui,1,2,"ng-template",null,8,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(3),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[u.P,d.a,u.i,s.h,u.g,u.f,u.j,s.f,u.h],encapsulation:2}),e})();const zi=function(e){return["/hubs","index","agents","edit",e]};function Wi(e,t){if(1&e){const e=h.Pb();h.Lb(0,"dexih-button-edit",6),h.Ob(1,"dexih-button-save",7),h.Vb("click",(function(){return h.vc(e),h.Zb().save()})),h.Nb(),h.Lb(2,"cancel-button",8)}if(2&e){const e=h.Zb();h.hc("routerLink",h.mc(3,zi,e.remoteAgentKey)),h.yb(1),h.hc("disabled",!e.formsService.hasChanged),h.yb(1),h.hc("formsService",e.formsService)}}function Gi(e,t){1&e&&h.Fc(0," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")}function Qi(e,t){1&e&&(h.Ob(0,"div",9),h.Fc(1," Creating a new hub -> remote agent authorization "),h.Nb())}const $i=function(){return{standalone:!0}};function Xi(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form",10),h.Ob(1,"fieldset"),h.Ob(2,"section"),h.Ob(3,"form-input",11),h.Vb("ngModelChange",(function(t){return h.vc(e),h.Zb().name=t})),h.Nb(),h.Nb(),h.Ob(4,"section"),h.Lb(5,"form-checkbox",12),h.Nb(),h.Ob(6,"section"),h.Lb(7,"form-checkbox",13),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(3),h.hc("disabled",!0)("ngModel",e.name)("ngModelOptions",h.lc(4,$i))}}let Yi=(()=>{class e{constructor(e,t,i,a,n){this.authService=e,this.hubService=t,this.formsService=i,this.router=a,this.route=n,this.isNew=!1}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable()).subscribe(e=>{let t=e[1];if(this.hubCache=e[2],this.remoteAgents=e[3],this.hubCache.isLoaded()&&this.remoteAgents)if(this.remoteAgentKey=+t.remoteAgentKey,this.remoteAgentHubKey=+t.remoteAgentHubKey,this.remoteAgentKey){let e=this.remoteAgents.find(e=>e.remoteAgentKey===this.remoteAgentKey),t=e.activeAgents&&e.activeAgents.length>0?e.activeAgents[0]:null;this.name=t?t.name:"",this.ipAddress=t?t.ipAddress:null,this.remoteAgentHub=this.hubCache.hub.dexihRemoteAgentHubs.find(e=>e.remoteAgentHubKey===this.remoteAgentHubKey),this.remoteAgentHub||(this.remoteAgentHub={hubKey:this.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:e.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null},this.remoteAgentHub.allowExternalConnect=!0,this.remoteAgentHub.isSelected=!1,this.isNew=!0),this.formsService.remoteAgent(this.remoteAgentHub),0===this.remoteAgentHub.remoteAgentHubKey&&(this.formsService.hasChanged=!0)}else this.hubService.addHubErrorMessage("There was no remote agent specified to edit.")})}catch(e){this.hubService.addHubClientErrorMessage(e,"Remote Agent Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}addCurrentIp(){if(this.ipAddress){let e=this.formsService.currentForm.controls.ipAddresses,t=e.value;t.findIndex(e=>e===this.ipAddress)<0&&(t.push(this.ipAddress),e.setValue(t))}}save(){this.hubService.saveRemoteAgent(this.formsService.currentForm.value).then(e=>{e&&(this.hubService.addHubSuccessMessage("The remote agent updated successfully."),this.authService.navigateUp())})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(c.a),h.Kb(o.a),h.Kb(T.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["remote-agents"]],inputs:{hubKey:"hubKey"},features:[h.xb([T.a])],decls:11,vars:4,consts:[["DexihMessage",""],[1,"container"],["title","Edit Hub Remote Agent","iconClass","fa fa-lg fa-fw fa-database",3,"padding","showCloseButton","close"],["header",""],["class","alert alert-primary",4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"routerLink"],[1,"pl-1",3,"disabled","click"],[1,"pl-1",3,"formsService"],[1,"alert","alert-primary"],[3,"formGroup"],["label","Agent name","note","This can be changed in the agents appsettings.json config file.","iconClass","fa fa-comment",3,"disabled","ngModel","ngModelOptions","ngModelChange"],["label","Is default agent for this Hub","formControlName","isDefault"],["label","Is Authorized for this Hub.","formControlName","isAuthorized"]],template:function(e,t){1&e&&(h.Lb(0,"dexih-message",null,0),h.Ob(2,"div",1),h.Ob(3,"dexih-widget",2),h.Vb("close",(function(){return t.close()})),h.Dc(4,Wi,3,5,"ng-template",null,3,h.Ec),h.Fc(6," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"),h.Dc(7,Gi,1,0,"ng-template",null,3,h.Ec),h.Dc(9,Qi,2,0,"div",4),h.Dc(10,Xi,8,5,"form",5),h.Nb(),h.Nb()),2&e&&(h.yb(3),h.hc("padding",!0)("showCloseButton",!0),h.yb(6),h.hc("ngIf",t.isNew),h.yb(1),h.hc("ngIf",t.formsService.currentForm))},directives:[Fi.a,u.P,p.t,u.j,s.f,u.t,F.a,a.I,a.t,a.l,u.D,a.s,a.v,u.A,a.j],encapsulation:2}),e})();var Ji=i("wTS4");function ea(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-preview",11),h.Vb("click",(function(){h.vc(e);const i=t.item;return h.Zb().preview(i)})),h.Nb()}}function ta(e,t){}function ia(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-private",11),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().unshareSelectedTables(t)})),h.Nb()}}function aa(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-download",12),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().downloadData(i)})),h.Nb(),h.Dc(1,ia,1,0,"dexih-button-private",13)}if(2&e){const e=h.Zb();h.yb(1),h.hc("ngIf",e.hubCache.canWrite)}}const na=function(){return{typeFilter:"All"}},sa=function(){return{typeFilter:"Datalink"}},oa=function(){return{typeFilter:"Table"}},ca=function(){return{typeFilter:"View"}},ra=function(){return{typeFilter:"Dashboard"}},la=function(){return{typeFilter:"Api"}};function ba(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",14),h.Ob(1,"a",15),h.Fc(2,"All"),h.Nb(),h.Ob(3,"a",16),h.Fc(4,"Datalinks"),h.Nb(),h.Ob(5,"a",17),h.Fc(6,"Tables"),h.Nb(),h.Ob(7,"a",18),h.Fc(8,"Views"),h.Nb(),h.Ob(9,"a",19),h.Fc(10,"Dashboards"),h.Nb(),h.Ob(11,"a",20),h.Fc(12,"Apis"),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("text",e.typeFilter)("pullRight",!0),h.yb(1),h.Cb("active","All"==e.typeFilter),h.hc("queryParams",h.lc(20,na)),h.yb(2),h.Cb("active","Datalink"==e.typeFilter),h.hc("queryParams",h.lc(21,sa)),h.yb(2),h.Cb("active","Table"==e.typeFilter),h.hc("queryParams",h.lc(22,oa)),h.yb(2),h.Cb("active","View"==e.typeFilter),h.hc("queryParams",h.lc(23,ca)),h.yb(2),h.Cb("active","Dashboard"==e.typeFilter),h.hc("queryParams",h.lc(24,ra)),h.yb(2),h.Cb("active","Api"==e.typeFilter),h.hc("queryParams",h.lc(25,la))}}let ha=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.cancelToken=new x.a,this.eSharedObjectType=b.dc,this.columns=[{name:"objectTypeName",title:"Type",format:""},{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:"Md"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[2];this.hubCache=e[3],this.watchChanges(),this.typeFilter=t.typeFilter,this.typeFilter||(this.typeFilter="All"),this.route.snapshot.data.pageTitle=this.typeFilter,this.updateSharedData()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Shared Data Index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}updateSharedData(){let e=new Array;this.hubCache&&this.hubCache.isLoaded()&&(this.hubCache.hub.dexihDatalinks||this.hubCache.hub.dexihConnections?("All"!==this.typeFilter&&"Datalink"!==this.typeFilter||this.hubCache.hub.dexihDatalinks.filter(e=>e.isShared).forEach(t=>{e.push({objectKey:t.key,objectTypeName:b.lb[b.lb.Datalink],objectType:b.lb.Datalink,name:t.name,description:t.description,updateDate:t.updateDate,tags:this.hubCache.getObjectTags(b.dc.Datalink,t.key)})}),"All"!==this.typeFilter&&"Table"!==this.typeFilter||this.hubCache.hub.dexihTables.filter(e=>e.isShared).forEach(t=>{e.push({objectKey:t.key,objectTypeName:b.lb[b.lb.Table],objectType:b.lb.Table,name:t.logicalName+" ("+t.name+")",description:t.description,updateDate:t.updateDate,tags:this.hubCache.getObjectTags(b.dc.TagObjects,t.key)})}),"All"!==this.typeFilter&&"View"!==this.typeFilter||this.hubCache.hub.dexihViews.filter(e=>e.isShared).forEach(t=>{e.push({objectKey:t.key,objectTypeName:b.lb[b.lb.View],objectType:b.lb.View,name:t.name,description:t.description,updateDate:t.updateDate,tags:this.hubCache.getObjectTags(b.dc.View,t.key)})}),"All"!==this.typeFilter&&"Dashboard"!==this.typeFilter||this.hubCache.hub.dexihDashboards.filter(e=>e.isShared).forEach(t=>{e.push({objectKey:t.key,objectTypeName:b.lb[b.lb.Dashboard],objectType:b.lb.Dashboard,name:t.name,description:t.description,updateDate:t.updateDate,tags:this.hubCache.getObjectTags(b.dc.Dashboard,t.key)})}),"All"!==this.typeFilter&&"Api"!==this.typeFilter||this.hubCache.hub.dexihApis.filter(e=>e.isShared).forEach(t=>{e.push({objectKey:t.key,objectTypeName:b.lb[b.lb.Api],objectType:b.lb.Api,name:t.name,description:t.description,updateDate:t.updateDate,tags:this.hubCache.getObjectTags(b.dc.Api,t.key)})}),this._tableData.next(e)):this._tableData.next(new Array))}downloadData(e){this.hubService.downloadData(e,!0,b.rb.Csv,this.cancelToken).then(()=>{this.hubService.addHubSuccessMessage("The specified data is being downloaded.")}).catch(()=>{})}preview(e){e.objectType===b.lb.Table&&this.router.navigate(["table-preview",e.objectKey],{relativeTo:this.route}),e.objectType===b.lb.Datalink&&this.router.navigate(["datalink-preview",e.objectKey],{relativeTo:this.route}),e.objectType===b.lb.View&&this.router.navigate(["view-preview",e.objectKey],{relativeTo:this.route}),e.objectType===b.lb.Dashboard&&this.router.navigate(["dashboard-preview",e.objectKey],{relativeTo:this.route}),e.objectType===b.lb.Api&&this.router.navigate(["api-preview",e.objectKey],{relativeTo:this.route})}unshareSelectedTables(e){let t=e.filter(e=>e.objectType===b.lb.Datalink).map(e=>e.objectKey);t.length>0&&this.hubService.shareItems(t,b.lb.Datalink,!1);let i=e.filter(e=>e.objectType===b.lb.Table).map(e=>e.objectKey);i.length>0&&this.hubService.shareItems(i,b.lb.Table,!1)}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Datalink&&e.changeClass!==b.dc.Table||this.updateSharedData()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["sharedData-index"]],decls:11,vars:8,consts:[[1,"container-fluid"],["title","Shared Data","iconClass","fa fa-lg fa-fw fa-newspaper-o",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],[3,"click"],[1,"mr-1",3,"click"],[3,"click",4,"ngIf"],["buttonClass","btn-primary mr-1","iconClass","fa fa-filter","title","Filter by a purpose",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Datalinks",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Tables",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Views",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Dashboards",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Apis",1,"dropdown-item",3,"queryParams"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.preview(e)})),h.Dc(3,ea,1,0,"ng-template",3,4,h.Ec),h.Dc(5,ta,0,0,"ng-template",5,6,h.Ec),h.Dc(7,aa,2,1,"ng-template",7,8,h.Ec),h.Dc(9,ba,13,26,"ng-template",9,10,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!1),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,u.q,u.h,p.t,u.r,u.i,s.h],encapsulation:2}),e})();var ua=i("Wz3H"),da=i("47Fv"),ma=function(e,t,i,a){return new(i||(i=Promise))((function(n,s){function o(e){try{r(a.next(e))}catch(t){s(t)}}function c(e){try{r(a.throw(e))}catch(t){s(t)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}r((a=a.apply(e,t||[])).next())}))};function fa(e,t){}function pa(e,t){1&e&&h.Lb(0,"actions-table-button",14),2&e&&h.hc("tables",t.items)("refreshTables",!0)}function ga(e,t){if(1&e&&h.Lb(0,"datalink-status",15),2&e){const e=t.item;h.hc("tableKey",null==e?null:e.key)}}const va=function(e){return{connectionKey:e}};function ya(e,t){if(1&e&&(h.Ob(0,"a",22),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.hc("queryParams",h.mc(2,va,e.key)),h.yb(1),h.Gc(e.name)}}function Ca(e,t){if(1&e&&(h.Ob(0,"dexih-button-dropdown",20),h.Dc(1,ya,2,4,"a",21),h.ac(2,"equalFilter"),h.Nb()),2&e){const e=h.Zb(2);h.hc("autoCompact",!1)("text",e.connectionName)("pullRight",!0),h.yb(1),h.hc("ngForOf",h.dc(2,4,e.hubCache.hub.dexihConnections,"isValid",!0))}}const wa=function(e){return{purposeFilter:e}};function Sa(e,t){if(1&e&&(h.Ob(0,"a",23),h.Fc(1),h.Nb()),2&e){const e=t.$implicit,i=h.Zb(2);h.Cb("active",i.purposeFilter==e.key),h.hc("queryParams",h.mc(5,wa,e.key))("title",e.name),h.yb(1),h.Gc(e.name)}}const ka=function(){return{purposeFilter:"All"}};function Oa(e,t){if(1&e&&(h.Dc(0,Ca,3,8,"dexih-button-dropdown",16),h.Ob(1,"dexih-button-dropdown",17),h.Ob(2,"a",18),h.Fc(3,"All"),h.Nb(),h.Dc(4,Sa,2,7,"a",19),h.ac(5,"gtFilter"),h.Nb()),2&e){const e=h.Zb();h.hc("ngIf",null==e.hubCache?null:e.hubCache.hub),h.yb(1),h.hc("autoCompact",!1)("text",e.eConnectionPurpose[e.purposeFilter])("pullRight",!0),h.yb(1),h.Cb("active","0"==e.purposeFilter),h.hc("queryParams",h.lc(12,ka)),h.yb(2),h.hc("ngForOf",h.dc(5,8,e.eConnectionPurposeItems,"key",0))}}function Na(e,t){if(1&e&&h.Lb(0,"tags-update-button",24),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.Table)("objects",e)}}function Ta(e,t){if(1&e&&h.Lb(0,"dependent-items-button",25),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.Table)}}let Da=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eConnectionPurposeItems=b.kb,this.eConnectionPurpose=b.jb,this.eSharedObjectType=b.dc,this.columns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"tableType",title:"Table Type",format:"Enum",enum:b.ic},{name:"connectionName",title:"Connection",footer:"connectionType",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe(e=>ma(this,void 0,void 0,(function*(){let t=e[2];if(this.hubCache=e[3],this.hubCache.isLoaded()){if(this.purposeFilter=t.purposeFilter,this.purposeFilter||(this.purposeFilter="All"),this.connectionKey=+t.connectionKey,this.connectionKey){let e=this.hubCache.hub.dexihConnections.find(e=>e.key===this.connectionKey);e&&(this.connectionName=e.name)}else this.connectionName="All";yield this.updateTableData()}})))}catch(e){this.hubService.addHubClientErrorMessage(e,"Table Index")}this.watchChanges()}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}close(){this.authService.navigateUp()}updateTableData(){var e,t;return ma(this,void 0,void 0,(function*(){if(this.title="Tables ",this.connectionName="All",this.purposeFilter&&"All"!==this.purposeFilter&&(this.title+=": "+b.jb[this.purposeFilter]),this.hubCache&&this.hubCache.isLoaded()){let s=[];try{for(var i,a=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(i){t[i]=e[i]&&function(t){return new Promise((function(a,n){!function(e,t,i,a){Promise.resolve(a).then((function(t){e({value:t,done:i})}),t)}(a,n,(t=e[i](t)).done,t.value)}))}}}(this.hubCache.hub.dexihTables);!(i=yield a.next()).done;){const e=i.value;let t=this.hubCache.hub.dexihConnections.find(t=>t.key===e.connectionKey),a=yield this.hubService.GetConnectionReference(t);if(("All"===this.purposeFilter||!this.purposeFilter||t&&t.purpose.toString()===this.purposeFilter)&&(!this.connectionKey||e.connectionKey===this.connectionKey)){let i,n;i=e.tableType===b.ic.Query?"(Sql Query)":e.schema?e.schema+"."+e.name:e.name,n=this.hubCache.defaultTableLogicalName(e.schema,e.name)===e.logicalName?e.logicalName:`${e.logicalName} (${e.name})`;let o="";e.logicalName!==e.name&&(o="Name: "+e.name),o&&(o+="<br>"),e.description&&(o+=e.description),s.push({key:e.key,connectionType:t?b.jb[t.purpose]:"undefined",connectionName:t?t.name:"undefined",description:o,tableType:e.tableType,name:i,logicalName:e.logicalName,tags:this.hubCache.getObjectTags(b.dc.Table,e.key),updateDate:e.updateDate,connectionKey:t?t.key:"",isFile:!!a&&a.connectionCategory===b.ib.File,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"})}}}catch(n){e={error:n}}finally{try{i&&!i.done&&(t=a.return)&&(yield t.call(a))}finally{if(e)throw e.error}}if(this.connectionKey){let e=this.hubCache.hub.dexihConnections.find(e=>e.key===this.connectionKey);e&&(this.connectionName=e.name,this.title+=" for connection - "+e.name)}this._tableData.next(s)}else this._tableData.next(null)}))}routeSibling(e){this.router.navigate(["..",e])}editTable(e){this.router.navigate(["table-edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}getConnection(e){return this.hubCache.hub.dexihConnections.find(t=>t.key===e)}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Table&&e.changeClass!==b.dc.TagObjects||this.updateTableData()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["table-index"]],decls:16,vars:9,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","showIf","close"],["header",""],[3,"enableMultiSelect","columns","dataObservable","tags","enableStickyToolbar","toolbarZIndex","rowClick"],["actions",""],["select","rowStatus"],["rowStatus",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/table.md",1,"m-3"],[3,"tables","refreshTables"],[3,"tableKey"],["class","mr-1","buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",3,"autoCompact","text","pullRight",4,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",1,"mr-1",3,"autoCompact","text","pullRight"],["class","dropdown-item","routerLink",".",3,"queryParams",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,fa,0,0,"ng-template",null,2,h.Ec),h.Ob(4,"dexih-table",3),h.Vb("rowClick",(function(e){return t.editTable(e)})),h.Dc(5,pa,1,2,"ng-template",null,4,h.Ec),h.Dc(7,ga,1,1,"ng-template",5,6,h.Ec),h.Dc(9,Oa,6,13,"ng-template",7,8,h.Ec),h.Dc(11,Na,1,2,"ng-template",9,10,h.Ec),h.Dc(13,Ta,1,2,"ng-template",11,12,h.Ec),h.Nb(),h.Nb(),h.Lb(15,"dexih-help",13),h.Nb()),2&e&&(h.yb(1),h.hc("title",t.title)("showCloseButton",!0)("showIf",null==t.hubCache?null:t.hubCache.hub),h.yb(3),h.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags)("enableStickyToolbar",!0)("toolbarZIndex",100))},directives:[u.P,d.a,G.a,ua.a,ht.a,p.t,u.i,s.h,p.s,g.a,f.a],pipes:[Be.a,da.a],encapsulation:2}),e})(),xa=(()=>{class e{constructor(e,t,i){this.hubService=e,this.authService=t,this.route=i,this.eDataObjectType=b.lb,this.title="Preview Table"}ngOnInit(){try{this._subscription=Object(l.a)(this.route.params,this.hubService.getHubCacheObservable(!0)).subscribe(e=>{let t=e[1];this.key=+e[0].tableKey;let i=t.getTable(this.key);i&&(this.title="Preview Table - "+i.logicalName)})}catch(e){this.hubService.addHubClientErrorMessage(e,"Table Preview Data")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["table-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-exchange",3,"title","showCloseButton","close"],[3,"key","viewSource"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Lb(2,"preview-data",2),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("title",t.title)("showCloseButton",!0),h.yb(1),h.hc("key",t.key)("viewSource",t.eDataObjectType.Table))},directives:[u.P,Rt.a],encapsulation:2}),e})();function Fa(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",7),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().deleteCustomFunctions(t)})),h.Nb()}}function Ia(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",7),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb(),h.Dc(1,Fa,1,0,"dexih-button-delete",8),h.Lb(2,"tags-update-button",9)}if(2&e){const e=t.items,i=h.Zb();h.yb(1),h.hc("ngIf",i.hubCache.canWrite),h.yb(1),h.hc("objectType",i.eSharedObjectType.CustomFunction)("objects",e)}}const Ka=function(){return["customFunction-new"]};function Ea(e,t){1&e&&h.Lb(0,"dexih-button-new",11),2&e&&h.hc("routerLink",h.lc(1,Ka))}function Va(e,t){if(1&e&&h.Dc(0,Ea,1,2,"dexih-button-new",10),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}let La=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[0],this.updateCustomFunctions()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Column Validation Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}deleteCustomFunctions(e){this.hubService.deleteCustomFunctions(e)}updateCustomFunctions(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihCustomFunctions.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(b.dc.CustomFunction,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}edit(e){this.router.navigate(["customFunction-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach(e=>{this.hubCache.cacheAddCustomFunction(e.key,t)}),this.hubService.exportHub(t,1===e.length?"CustomFunction - "+e[0].name+".json":"customFunctions.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.CustomFunction&&e.changeClass!==b.dc.TagObjects||this.updateCustomFunctions()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["customFunction"]],inputs:{hubKey:"hubKey"},decls:8,vars:8,consts:[[1,"container-fluid"],["title","Custom Functions","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,Ia,3,3,"ng-template",3,4,h.Ec),h.Dc(5,Va,1,1,"ng-template",null,5,h.Ec),h.Nb(),h.Nb(),h.Lb(7,"dexih-help",6),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!1),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,u.u,p.t,g.a,u.g,u.o,s.f],encapsulation:2}),e})(),Pa=(()=>{class e{constructor(){this.customFunctionParameterForm=null,this.addParameter=new h.n,this.removeParameter=new h.n,this.eBasicType=D.c,this.typeCodes=D.a,this.ignoreChanges=!1}ngOnInit(){}ngOnDestroy(){}add(){this.addParameter.emit(this.customFunctionParameterForm)}remove(){this.removeParameter.emit(this.customFunctionParameterForm)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Eb({type:e,selectors:[["customFunction-parameter"]],inputs:{customFunctionParameterForm:"customFunctionParameterForm"},outputs:{addParameter:"addParameter",removeParameter:"removeParameter"},decls:15,vars:3,consts:[[1,"mb-1",3,"formGroup"],[1,"input-group"],["type","text","formControlName","name","placeholder","Enter a name for the parameter",1,"form-control"],["formControlName","dataType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],[1,"input-group-append"],[1,"input-group-text","p-0"],[1,"p-1"],["type","number","formControlName","rank",1,"mx-1"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"]],template:function(e,t){1&e&&(h.Ob(0,"form",0),h.Ob(1,"div",1),h.Lb(2,"input",2),h.Lb(3,"form-select",3),h.Ob(4,"div",4),h.Ob(5,"div",5),h.Ob(6,"span",6),h.Fc(7,"Array Dimensions (0-non array)"),h.Nb(),h.Lb(8,"input",7),h.Nb(),h.Ob(9,"div",5),h.Ob(10,"button",8),h.Vb("click",(function(){return t.add()})),h.Lb(11,"i",9),h.Nb(),h.Nb(),h.Ob(12,"div",5),h.Ob(13,"button",10),h.Vb("click",(function(){return t.remove()})),h.Lb(14,"i",11),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.hc("formGroup",t.customFunctionParameterForm),h.yb(3),h.hc("border",!1)("items",t.typeCodes))},directives:[a.I,a.t,a.l,a.c,a.s,a.j,u.E,a.y],encapsulation:2}),e})();function ja(e,t){if(1&e&&h.Lb(0,"save-button",13),2&e){const e=h.Zb(2);h.hc("formsService",e.formsService)}}function Aa(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-invalid-form-details",10),h.Vb("click",(function(){return h.vc(e),h.Zb().formsService.showErrors()})),h.Nb(),h.Dc(1,ja,1,1,"save-button",11),h.Lb(2,"cancel-button",12)}if(2&e){const e=h.Zb();h.hc("control",e.formsService.currentForm),h.yb(1),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("formsService",e.formsService)}}function Ma(e,t){if(1&e&&(h.Ob(0,"div"),h.Fc(1),h.Nb()),2&e){const e=h.Zb(3);h.yb(1),h.Hc("Cleaned Value = ",e.testResult.cleanedValue," ")}}function Ra(e,t){if(1&e&&(h.Ob(0,"div"),h.Fc(1),h.Nb()),2&e){const e=h.Zb(3);h.yb(1),h.Hc("Reject Reason = ",e.testResult.rejectReason," ")}}function Za(e,t){if(1&e&&(h.Ob(0,"section"),h.Ob(1,"div",20),h.Fc(2),h.Dc(3,Ma,2,1,"div",15),h.Dc(4,Ra,2,1,"div",15),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.Cb("alert-danger",0==e.testResult.success)("alert-success",1==e.testResult.success),h.yb(1),h.Hc(" Test Result = ",e.testResult.success," "),h.yb(1),h.hc("ngIf",e.testResult.cleanedValue),h.yb(1),h.hc("ngIf",e.testResult.rejectReason)}}function _a(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",24),h.Ob(1,"dexih-button",25),h.Vb("click",(function(){h.vc(e);const t=h.Zb(3);return t.addParameter(null,t.eParameterDirection.Input)})),h.Fc(2,"Add Parameter "),h.Nb(),h.Nb()}}const Ha=function(e){return{"z-index":e,position:"relative"}};function Ba(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",26),h.Ob(1,"customFunction-parameter",27),h.Vb("addParameter",(function(t){h.vc(e);const i=h.Zb(3);return i.addParameter(t,i.eParameterDirection.Input)}))("removeParameter",(function(t){return h.vc(e),h.Zb(3).removeParameter(t)})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit;h.hc("ngStyle",h.mc(2,Ha,200-t.index)),h.yb(1),h.hc("customFunctionParameterForm",e)}}function Ua(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div"),h.Ob(1,"dexih-button",25),h.Vb("click",(function(){h.vc(e);const t=h.Zb(4);return t.addParameter(null,t.eParameterDirection.Output)})),h.Fc(2,"Add Parameter"),h.Nb(),h.Nb()}}function qa(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",26),h.Ob(1,"customFunction-parameter",27),h.Vb("addParameter",(function(t){h.vc(e);const i=h.Zb(4);return i.addParameter(t,i.eParameterDirection.Output)}))("removeParameter",(function(t){return h.vc(e),h.Zb(4).removeParameter(t)})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit;h.hc("ngStyle",h.mc(2,Ha,100-t.index)),h.yb(1),h.hc("customFunctionParameterForm",e)}}const za=function(){return{"z-index":101,position:"relative"}};function Wa(e,t){if(1&e&&(h.Ob(0,"div"),h.Ob(1,"div",21),h.Fc(2," Output Parameters "),h.Nb(),h.Ob(3,"div",26),h.Ob(4,"section"),h.Ob(5,"div",28),h.Lb(6,"input",29),h.Lb(7,"form-select",30),h.Nb(),h.Nb(),h.Dc(8,Ua,3,0,"div",15),h.Dc(9,qa,2,4,"div",7),h.Nb(),h.Lb(10,"br"),h.Nb()),2&e){const e=h.Zb(3);h.yb(3),h.hc("ngStyle",h.lc(5,za)),h.yb(4),h.hc("border",!1)("items",e.typeCodes),h.yb(1),h.hc("ngIf",0===e.outputParameters.length),h.yb(1),h.hc("ngForOf",e.outputParameters)}}function Ga(e,t){if(1&e&&(h.Ob(0,"div"),h.Ob(1,"div",21),h.Fc(2," Input Parameters "),h.Nb(),h.Dc(3,_a,3,0,"div",22),h.Dc(4,Ba,2,4,"div",7),h.Nb(),h.Dc(5,Wa,11,6,"div",15),h.Fc(6," Function Code "),h.Lb(7,"textarea",23)),2&e){const e=h.Zb(2);h.yb(3),h.hc("ngIf",0===e.inputParameters.length),h.yb(1),h.hc("ngForOf",e.inputParameters),h.yb(1),h.hc("ngIf",e.functionType!=e.eFunctionType.Condition)}}function Qa(e,t){if(1&e&&(h.Ob(0,"form",14),h.Ob(1,"fieldset"),h.Dc(2,Za,5,7,"section",15),h.Ob(3,"section"),h.Lb(4,"form-select",16),h.Nb(),h.Ob(5,"section"),h.Lb(6,"form-input",17),h.Nb(),h.Ob(7,"section"),h.Lb(8,"form-textarea",18),h.Nb(),h.Dc(9,Ga,8,3,"ng-template",19),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(2),h.hc("ngIf",e.testResult),h.yb(2),h.hc("items",e.functionTypes),h.yb(2),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("showMarkdown",!0),h.yb(1),h.hc("ngIf",e.functionType)}}function $a(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",31),h.Vb("click",(function(){return h.vc(e),h.Zb().test()})),h.Fc(1,"Syntax Check"),h.Nb(),h.Ob(2,"dexih-button",31),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return t.test(t.inputParameterValues)})),h.Fc(3,"Run"),h.Nb(),h.Ob(4,"dexih-button-save-local",32),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return t.downloadCode(t.inputParameterValues)})),h.Nb()}}function Xa(e,t){1&e&&(h.Ob(0,"div",33),h.Fc(1," Input Parameters "),h.Nb())}function Ya(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div"),h.Ob(1,"div",37),h.Ob(2,"div",38),h.Fc(3),h.Nb(),h.Ob(4,"form-input",39),h.Vb("ngModelChange",(function(i){h.vc(e);const a=t.index,n=h.Zb(2).index;return h.Zb().inputParameterValues[n][a]=i})),h.Nb(),h.Ob(5,"div",40),h.Ob(6,"button",41),h.Vb("click",(function(){h.vc(e);const i=t.index,a=h.Zb(2).index;return h.Zb().addParameterValue(a,i)})),h.Lb(7,"i",42),h.Nb(),h.Nb(),h.Ob(8,"div",40),h.Ob(9,"button",43),h.Vb("click",(function(){h.vc(e);const i=t.index,a=h.Zb(2).index;return h.Zb().removeParameterValue(a,i)})),h.Lb(10,"i",44),h.Nb(),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=t.index,i=h.Zb(2),a=i.$implicit,n=i.index,s=h.Zb();h.yb(3),h.Hc(" ",a.controls.name.value+"["+e+"]"," "),h.yb(1),h.hc("border",!1)("ngModel",s.inputParameterValues[n][e])("name","inputParameterValues-"+n+"-"+e)}}function Ja(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div"),h.Ob(1,"div"),h.Ob(2,"dexih-button",25),h.Vb("click",(function(){h.vc(e);const t=h.Zb().index;return h.Zb().addParameterValue(t)})),h.Fc(3),h.Nb(),h.Nb(),h.Dc(4,Ya,11,4,"div",36),h.Nb()}if(2&e){const e=h.Zb(),t=e.$implicit,i=e.index,a=h.Zb();h.yb(3),h.Hc(" Add ",t.controls.name.value," value "),h.yb(1),h.hc("ngForOf",a.inputParameterValues[i])}}function en(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form-input",45),h.Vb("ngModelChange",(function(t){h.vc(e);const i=h.Zb().index;return h.Zb().inputParameterValues[i]=t})),h.Nb()}if(2&e){const e=h.Zb(),t=e.$implicit,i=e.index,a=h.Zb();h.hc("label",t.controls.name.value)("ngModel",a.inputParameterValues[i])("name","inputParameterValues"+i)}}function tn(e,t){if(1&e&&(h.Ob(0,"div",26),h.Dc(1,Ja,5,2,"div",34),h.Dc(2,en,1,3,"ng-template",null,35,h.Ec),h.Nb()),2&e){const e=t.$implicit,i=t.index,a=h.sc(3);h.hc("ngStyle",h.mc(3,Ha,200-i)),h.yb(1),h.hc("ngIf",e.controls.rank.value>0)("ngIfElse",a)}}function an(e,t){1&e&&(h.Ob(0,"div",33),h.Fc(1," Outputs Parameters "),h.Nb())}function nn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",26),h.Ob(1,"form-input",46),h.Vb("ngModelChange",(function(i){h.vc(e);const a=t.index;return h.Zb().outputParameterValues[a]=i})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit,i=t.index,a=h.Zb();h.hc("ngStyle",h.mc(5,Ha,200-i)),h.yb(1),h.hc("disabled",!0)("label",e.controls.name.value)("ngModel",a.outputParameterValues[i])("name","outputParameterValues"+i)}}let sn=(()=>{class e{constructor(e,t,i,a,n,s){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.location=s,this.typeCodes=D.a,this.eParameterDirection=b.Vb,this.outputParameters=[],this.inputParameters=[],this.outputParameterValues=[],this.inputParameterValues=[],this.functionTypes=D.d,this.eFunctionType=b.Cb,this.lookupColumnValue="",this.isLoaded=!1,this.cancelToken=new x.a}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Column Validation")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._functionTypeSubscription&&this._functionTypeSubscription.unsubscribe(),this.cancelToken.cancel()}load(){if(this.isLoaded=!0,"edit"===this.action)if(this.customFunctionKey=+this.params.customFunctionKey,this.customFunctionKey)if(this.hubCache.hub&&this.hubCache.hub.dexihCustomFunctions){let e=this.hubCache.hub.dexihCustomFunctions.find(e=>e.key===this.customFunctionKey);this.formsService.customFunction(e),this.functionType=this.formsService.currentForm.controls.functionType.value}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no custom function specified to edit.");if("new"===this.action){let e=new b.g;e.key=this.hubCache.getNextSequence(),this.formsService.customFunction(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t>=0&&history.pushState){let e=window.location.pathname.replace("/customFunction-new","/customFunction-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}}),this.functionType=this.formsService.currentForm.controls.functionType.value}this._functionTypeSubscription=this.formsService.currentForm.controls.functionType.valueChanges.subscribe(e=>{this.functionType=e,this.functionType!==b.Cb.Condition&&this.functionType!==b.Cb.JoinCondition&&this.functionType!==b.Cb.Validate||(this.formsService.currentForm.controls.returnType.setValue(b.pc.Boolean),this.updateParameters())}),this.updateParameters()}canDeactivate(){return new Promise(e=>{this.formsService.currentForm&&!this.formsService.currentForm.pristine?this.authService.confirmDialog("Function has changed","The function has changed.  Would you like to discard the changes and return to the previous screen?").then(t=>{e(t)}).catch(t=>{e(!1)}):e(!0)})}parametersArray(){return this.formsService.currentForm.controls.dexihCustomFunctionParameters}updateParameters(){let e=this.parametersArray();this.inputParameters=e.controls.sort((e,t)=>e.value.position-t.value.position).filter(e=>e.value.direction===b.Vb.Input),this.outputParameters=e.controls.sort((e,t)=>e.value.position-t.value.position).filter(e=>e.value.direction===b.Vb.Output),this.inputParameterValues.length=this.inputParameters.length,this.outputParameterValues.length=this.outputParameters.length}addParameter(e,t){try{let i=new b.h;if(e){let t=e.value;i.dataType=t.dataType,i.name=t.name,i.position=t.position+1}i.key=this.hubCache.getNextSequence(),i.name="",i.direction=t,i.rank=0,i.isValid=!0;let a=this.parametersArray(),n=this.formsService.customFunctionParametersFormGroup(i);a.push(n),a.controls.sort((e,t)=>e.value.position-t.value.position).forEach((e,t)=>{e.controls.position.setValue(10*t)}),this.updateParameters()}catch(i){this.hubService.addHubClientErrorMessage(i,"Edit Custom Function, add parameter")}}addParameterValue(e,t){Array.isArray(this.inputParameterValues[e])?this.inputParameterValues[e].splice(t+1,0,""):this.inputParameterValues[e]=new Array(1)}removeParameterValue(e,t){this.inputParameterValues[e].splice(t,1)}removeParameter(e){try{let t=this.parametersArray(),i=t.controls.indexOf(e);i>-1&&t.removeAt(i),this.updateParameters()}catch(t){this.hubService.addHubClientErrorMessage(t,"Edit Custom Function, remove parameter")}}downloadCode(e=null){let t=this.createDataTransformItem();this.hubService.downloadCustomFunction(t,e)}test(e=null){let t=this.createDataTransformItem();this.hubService.testCustomFunction(t,e,this.cancelToken).then(e=>{this.syntaxMessage=new x.e(!0,"The function has successfully compiled.",null,null),e&&e.length>0?e.forEach((e,t)=>{0===t?this.returnParameterValue=e:this.outputParameterValues[t-1]=e}):(this.returnParameterValue=null,this.outputParameterValues.forEach(e=>null))}).catch(e=>{let t=e;e.stack&&(t=new x.e(!1,"Client Error: "+e.message,e.stack,"")),this.syntaxMessage=t,this.returnParameterValue=null,this.outputParameterValues.forEach(e=>null)})}createDataTransformItem(){let e=this.formsService.currentForm.value,t=new b.x;t.functionCode=e.methodCode,t.functionResultCode=e.resultCode,t.transformItemType=b.kc.CustomFunction;let i=[];e.dexihCustomFunctionParameters.sort((e,t)=>e.position-t.position).forEach((e,t)=>{if(e){let a=new b.A;a.key=0,a.datalinkTransformItemKey=0,a.name=e.name,a.rank=e.rank,a.direction=e.direction,a.dataType=e.dataType,a.position=t,a.isValid=!0,i.push(a)}});let a=new b.A;return a.key=0,a.datalinkTransformItemKey=0,a.name="Return",a.rank=0,a.direction=b.Vb.ReturnValue,a.dataType=e.returnType,a.position=0,a.isValid=!0,i.push(a),t.dexihFunctionParameters=i,t}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e),h.Kb(p.n))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-customFunction-edit-form"]],features:[h.xb([T.a])],decls:19,vars:11,consts:[[1,"container"],["title","Edit Function","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Test Function","iconClass","fa fa-lg fa-fw fa-code",3,"padding"],[3,"message"],["class","label",4,"ngIf"],[3,"ngStyle",4,"ngFor","ngForOf"],["label","Return Value","name","returnParameterValue","type","text",3,"disabled","ngModel","ngModelChange"],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],[4,"ngIf"],["label","Function Type","formControlName","functionType","itemKey","key","itemName","name","iconClass","fa fa-question",3,"items"],["label","Custom Function Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[3,"ngIf"],[1,"alert"],[1,"label","mb-1"],["class","mb-1",4,"ngIf"],["rows","20","width","100%","spellcheck","false","formControlName","methodCode",1,"form-control"],[1,"mb-1"],["iconClass","fa fa-plus-square-o","title","Click to add a parameter",3,"click"],[3,"ngStyle"],[3,"customFunctionParameterForm","addParameter","removeParameter"],[1,"input-group","mb-1"],["readonly","","value","Return Data Type",1,"form-control"],["formControlName","returnType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],["buttonClass","btn btn-success",1,"mr-1",3,"click"],["text","Sample Code",3,"click"],[1,"label"],[4,"ngIf","ngIfElse"],["showValue",""],[4,"ngFor","ngForOf"],[1,"input-group"],[1,"form-control"],["type","text","placeholder","Enter a test value for the parameter",1,"form-control","p-0",3,"border","ngModel","name","ngModelChange"],[1,"input-group-text","p-0"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"],["type","text","placeholder","Enter a test value for the parameter",3,"label","ngModel","name","ngModelChange"],["type","text",3,"disabled","label","ngModel","name","ngModelChange"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget-vertical"),h.Ob(2,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(3,Aa,3,3,"ng-template",null,2,h.Ec),h.Dc(5,Qa,10,7,"form",3),h.Nb(),h.Ob(6,"dexih-widget",4),h.Dc(7,$a,5,0,"ng-template",null,2,h.Ec),h.Lb(9,"dexih-message",5),h.Ob(10,"form"),h.Ob(11,"fieldset"),h.Ob(12,"div"),h.Dc(13,Xa,2,0,"div",6),h.Dc(14,tn,4,5,"div",7),h.Ob(15,"form-input",8),h.Vb("ngModelChange",(function(e){return t.returnParameterValue=e})),h.Nb(),h.Dc(16,an,2,0,"div",6),h.Dc(17,nn,2,7,"div",7),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Lb(18,"dexih-help",9),h.Nb(),h.Nb()),2&e&&(h.yb(2),h.hc("showCloseButton",!0)("padding",!0),h.yb(3),h.hc("ngIf",t.formsService.currentForm),h.yb(1),h.hc("padding",!0),h.yb(3),h.hc("message",t.syntaxMessage),h.yb(4),h.hc("ngIf",t.inputParameters.length>0),h.yb(1),h.hc("ngForOf",t.inputParameters),h.yb(1),h.hc("disabled",!0)("ngModel",t.returnParameterValue),h.yb(1),h.hc("ngIf",t.outputParameters.length>0),h.yb(1),h.hc("ngForOf",t.outputParameters))},directives:[u.S,u.P,p.t,Fi.a,a.I,a.t,a.u,p.s,u.D,a.s,a.v,G.a,I.a,F.a,K.a,a.l,u.E,a.j,u.H,a.c,u.f,p.w,Pa,u.u],encapsulation:2}),e})();var on=i("bK5D"),cn=i("crXl");function rn(e,t){if(1&e&&h.Lb(0,"dependent-items-button",11),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.DatalinkTest)}}function ln(e,t){if(1&e&&h.Lb(0,"tags-update-button",12),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.DatalinkTest)("objects",e)}}function bn(e,t){1&e&&h.Lb(0,"actions-datalinkTest-button",13),2&e&&h.hc("datalinkTests",t.items)}function hn(e,t){if(1&e&&h.Lb(0,"datalink-status",14),2&e){const e=t.item;h.hc("datalinkTestKey",null==e?null:e.key)}}let un=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.cancelToken=new x.a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[0],this.update()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink Tests Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}delete(e){this.hubService.deleteDatalinkTests(e)}snapshot(e){this.hubService.runDatalinkTestSnapshot(e,this.cancelToken)}run(e){let t=e.map(e=>e.key);this.hubService.runDatalinkTests(t,this.cancelToken)}update(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihDatalinkTests.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(b.dc.DatalinkTest,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}edit(e){this.router.navigate(["datalinkTest-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubService.createHub(this.hubCache.hub.hubKey,"");t.dexihDatalinkTests=e,this.hubService.exportHub(t,"datalink_tests.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.DatalinkTest&&e.changeClass!==b.dc.TagObjects||this.update()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datalink-test"]],decls:12,vars:5,consts:[[1,"container-fluid"],["title","Datalink Tests","iconClass","fa fa-lg fa-fw fa-flag-checkered",3,"showCloseButton","close"],[3,"enableMultiSelect","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Datalink Test","path","/assets/help/reference/datalinkTest.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkTests"],[3,"datalinkTestKey"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,rn,1,2,"ng-template",3,4,h.Ec),h.Dc(5,ln,1,2,"ng-template",5,6,h.Ec),h.Dc(7,bn,1,1,"ng-template",null,7,h.Ec),h.Dc(9,hn,1,1,"ng-template",8,9,h.Ec),h.Nb(),h.Nb(),h.Lb(11,"dexih-help",10),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,f.a,g.a,cn.a,ht.a],encapsulation:2}),e})();function dn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save",5),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return!t.saving&&t.save()})),h.Nb(),h.Ob(1,"dexih-button-cancel",6),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return!t.saving&&t.cancel()})),h.Nb()}if(2&e){const e=h.Zb();h.hc("busy",e.saving),h.yb(1),h.hc("busy",e.saving)}}function mn(e,t){if(1&e&&(h.Ob(0,"span",10),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.yb(1),h.Hc(" ",e.name," ")}}function fn(e,t){if(1&e&&(h.Ob(0,"label",7),h.Fc(1,"Create automatic tests for the following datalink(s):"),h.Nb(),h.Ob(2,"div"),h.Ob(3,"div",8),h.Dc(4,mn,2,1,"span",9),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.yb(4),h.hc("ngForOf",e.sourceDatalinks)}}function pn(e,t){if(1&e&&h.Lb(0,"form-input",21),2&e){const e=h.Zb(2);h.hc("errors",e.formErrors.name)}}function gn(e,t){1&e&&h.Lb(0,"form-input",22)}function vn(e,t){if(1&e&&(h.Ob(0,"form",11),h.Ob(1,"fieldset"),h.Ob(2,"div",12),h.Ob(3,"section",13),h.Dc(4,pn,1,1,"form-input",14),h.Dc(5,gn,1,0,"form-input",15),h.Nb(),h.Ob(6,"section",13),h.Lb(7,"form-select",16),h.Nb(),h.Nb(),h.Ob(8,"div",12),h.Ob(9,"section",13),h.Lb(10,"form-select",17),h.Nb(),h.Ob(11,"section",13),h.Lb(12,"form-select",18),h.Nb(),h.Nb(),h.Nb(),h.Ob(13,"fieldset"),h.Ob(14,"section"),h.Ob(15,"div",12),h.Ob(16,"section",19),h.Lb(17,"form-checkbox",20),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.mainForm),h.yb(4),h.hc("ngIf",1==e.sourceDatalinks.length),h.yb(1),h.hc("ngIf",e.sourceDatalinks.length>1),h.yb(2),h.hc("items",e.hubCache.hub.dexihConnections)("errors",e.formErrors.auditConnectionKey),h.yb(3),h.hc("items",e.managedConnections)("errors",e.formErrors.sourceConnectionKey)("allowNullSelect",!0),h.yb(2),h.hc("items",e.managedConnections)("errors",e.formErrors.targetConnectionKey)("allowNullSelect",!0)}}let yn=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.route=t,this.router=i,this.location=a,this.fb=n,this.cancelToken=new x.a,this.hasChanged=!1,this.showAllErrors=!1,this.saving=!1,this.formErrors={name:"",auditConnectionKey:"",sourceConnectionKey:"",targetConnectionKey:"",snapshotData:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},auditConnectionKey:{},targetConnectionKey:{},sourceConnectionKey:{},snapshotData:{}}}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[1];if(this.hubCache=e[2],this.managedConnections=this.hubCache.hub.dexihConnections.filter(e=>e.purpose===b.jb.Managed),this.hubCache.status===N.j.Loaded){let e=t.datalinkKeys;if(this.sourceDatalinkKeys=new Array,this.sourceDatalinks=new Array,e&&this.hubCache.hub.dexihConnections){let t=e.split("|");this.hubCache.hub.dexihDatalinks.forEach(e=>{t.findIndex(t=>t===e.key.toString())>=0&&(this.sourceDatalinkKeys.push(e.key),this.sourceDatalinks.push(e))})}let i=this.hubCache.hub.dexihConnections.find(e=>e.purpose===b.jb.Managed);i&&(this.targetConnectionKey=i.key),this.sourceConnectionKey=this.targetConnectionKey,this.auditConnectionKey=this.targetConnectionKey,this.buildForm()}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink New")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this.cancelToken.cancel()}buildForm(){this.mainForm=this.fb.group({name:[this.name,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],sourceConnectionKey:[this.sourceConnectionKey>0?this.sourceConnectionKey:null,[]],snapshotData:[!0,[]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe(e=>this.onValueChanged(e)),this.onValueChanged(),this.hasChanged=!1}onValueChanged(e){if(!this.mainForm)return;const t=this.mainForm;this.hasChanged=!0;for(const i of Object.keys(this.formErrors)){this.formErrors[i]="";const e=t.get(i);if(e&&(e.dirty||this.showAllErrors)&&!e.valid){const t=this.validationMessages[i];for(const a of Object.keys(e.errors))this.formErrors[i]+=t[a]+" "}}}save(){if(this.mainForm.valid){let e=this.mainForm.value;this.saving=!0,this.hubService.newDatalinkTest(this.name,this.sourceDatalinkKeys,e.auditConnectionKey,e.targetConnectionKey,e.sourceConnectionKey).then(t=>{return i=this,void 0,n=function*(){e.snapshotData&&(yield this.hubService.runDatalinkTestSnapshot([t],this.cancelToken)),this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinkTests","datalinkTest-edit",t.key],{relativeTo:this.route.root})},new((a=void 0)||(a=Promise))((function(e,t){function s(e){try{c(n.next(e))}catch(i){t(i)}}function o(e){try{c(n.throw(e))}catch(i){t(i)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(s,o)}c((n=n.apply(i,[])).next())}));var i,a,n}).catch(e=>{this.saving=!1})}else this.showAllErrors=!0,this.onValueChanged()}cancel(){this.location.back()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(s.a),h.Kb(s.e),h.Kb(p.n),h.Kb(a.g))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-datalinkTest-new-form"]],decls:7,vars:3,consts:[[1,"container"],["title","New Datalink Test(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"list-group","d-inline-block"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors",4,"ngIf"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment",4,"ngIf"],["label","Audit Connection","formControlName","auditConnectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","Connection where test results are stored.",3,"items","errors"],["formControlName","sourceConnectionKey","label","Input Connection","itemKey","key","itemName","name","note","Specify the connection to use for any datalink source data.","selectNullMessage","No source table",3,"items","errors","allowNullSelect"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for target data.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],[1,"col","col-11"],["label","Snapshot and copy current source/target data into the test connections.","formControlName","snapshotData","name","snapshotData"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return!t.saving&&t.cancel()})),h.Dc(2,dn,2,2,"ng-template",null,2,h.Ec),h.Dc(4,fn,5,1,"ng-template",null,3,h.Ec),h.Dc(6,vn,18,11,"form",4),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(5),h.hc("ngIf",t.sourceDatalinkKeys))},directives:[u.P,p.t,u.t,u.b,p.s,a.I,a.t,a.l,u.E,a.s,a.j,u.A,u.D],encapsulation:2}),e})();var Cn=i("MbvK"),wn=i("ynzd"),Sn=i("XNiG"),kn=i("VRyK"),On=i("Z+eP"),Nn=i("RXlv"),Tn=i("79jk"),Dn=i("+F4M"),xn=i("hJJo"),Fn=i("YcGA");function In(e,t){if(1&e&&h.Lb(0,"save-button",16),2&e){const e=h.Zb(2);h.hc("formsService",e.formsService)}}function Kn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-invalid-form-details",12),h.Vb("click",(function(){return h.vc(e),h.Zb().formsService.showErrors()})),h.Nb(),h.Ob(1,"download-button",13),h.Vb("download",(function(t){return h.vc(e),h.Zb().download(t)})),h.Nb(),h.Dc(2,In,1,1,"save-button",14),h.Lb(3,"cancel-button",15)}if(2&e){const e=h.Zb();h.hc("control",e.formsService.currentForm),h.yb(2),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("formsService",e.formsService)}}function En(e,t){if(1&e&&(h.Ob(0,"section",21),h.Ob(1,"form-select",28),h.Lb(2,"table-edit-button",29),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("errors",null==e.errors?null:e.errors.sourceTableKey)("items",e.connectionTables),h.yb(1),h.hc("key",e.formsService.currentForm.controls.sourceTableKey.value)}}function Vn(e,t){if(1&e&&(h.Ob(0,"section",21),h.Ob(1,"form-select",30),h.Lb(2,"datalink-edit-button",29),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("errors",null==e.errors?null:e.errors.sourceDatalinkKey)("items",e.datalinks),h.yb(1),h.hc("key",e.formsService.currentForm.controls.sourceDatalinkKey.value)}}function Ln(e,t){if(1&e&&(h.Ob(0,"form",17),h.Ob(1,"fieldset"),h.Ob(2,"section"),h.Lb(3,"form-input",18),h.Nb(),h.Ob(4,"section"),h.Lb(5,"form-textarea",19),h.Nb(),h.Ob(6,"section"),h.Ob(7,"div",20),h.Ob(8,"section",21),h.Lb(9,"form-checkbox",22),h.Nb(),h.Ob(10,"section",21),h.Lb(11,"form-input",23),h.Nb(),h.Nb(),h.Nb(),h.Ob(12,"section"),h.Ob(13,"div",20),h.Ob(14,"section",21),h.Lb(15,"form-checkbox",24),h.Nb(),h.Ob(16,"section",21),h.Lb(17,"form-time",25),h.Nb(),h.Nb(),h.Nb(),h.Ob(18,"section"),h.Ob(19,"div",20),h.Ob(20,"section",21),h.Lb(21,"form-select",26),h.Nb(),h.Dc(22,En,3,3,"section",27),h.Dc(23,Vn,3,3,"section",27),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.formsService.currentForm),h.yb(3),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("showMarkdown",!0),h.yb(6),h.hc("errors",e.formsService.formErrors.logDirectory),h.yb(6),h.hc("errors",e.formsService.formErrors.resetCacheInterval),h.yb(4),h.hc("items",e.sourceTypes)("enableFilter",!1),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eSourceType.Table),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eSourceType.Datalink)}}function Pn(e,t){if(1&e&&(h.Ob(0,"dexih-widget-section",31),h.Lb(1,"input-parameters",32),h.Nb()),2&e){const e=h.Zb();h.hc("showExpandButton",!0)("padding",!0),h.yb(1),h.hc("showEdit",!0)("parameters",e.formsService.currentForm.controls.parameters)("formsService",e.formsService)}}function jn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"span",35),h.Ob(1,"div",36),h.Ob(2,"div",37),h.Fc(3),h.Nb(),h.Nb(),h.Ob(4,"form-input",38),h.Vb("ngModelChange",(function(i){return h.vc(e),t.$implicit.value=i})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit,i=t.index;h.yb(3),h.Hc(" ",e.logicalName," "),h.yb(1),h.jc("name","column",i,""),h.hc("placeholder","Enter "+e.logicalName)("ngModel",e.value)}}function An(e,t){if(1&e&&(h.Ob(0,"div",33),h.Dc(1,jn,5,4,"span",34),h.Nb()),2&e){const e=h.Zb();h.yb(1),h.hc("ngForOf",e.inputColumns)}}function Mn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-refresh",39),h.Vb("click",(function(){return h.vc(e),h.Zb().refresh()})),h.Nb()}}let Rn=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.refreshDataSubject=new Sn.a,this.sourceTypes=[{key:b.gc.Datalink,name:"Datalink"},{key:b.gc.Table,name:"Table"}],this.eSourceType=b.gc,this.connectionTables=[],this.datalinks=[],this.selectQuery=new b.V,this.data=[],this.isLoaded=!1,this.cancelToken=new x.a}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];if(this.params=e[1],this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.hubCache&&this.hubCache.isLoaded()&&(this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks),(!this.isLoaded||"new"!==this.action)&&(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load(),this.hubCache.isLoaded()))){if(!this.hubCache||this.hubCache.status!==N.j.Loaded||this.isLoaded)return;this.isLoaded=!0}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Api Edit")}}load(){if("edit"===this.action)if(this.apiKey=+this.params.apiKey,this.apiKey)if(this.hubCache.hub&&this.hubCache.hub.dexihApis){let e=this.hubCache.hub.dexihApis.find(e=>e.key===this.apiKey);this.selectQuery=e.selectQuery,this.selectQuery||(this.selectQuery=new b.V),this.formsService.api(e),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no api specified to edit.");if("new"===this.action){let e=new b.d;this.formsService.api(e),this.watchChanges(),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/api-new","/api-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}}watchChanges(){this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(kn.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe(()=>{this.reset(),this.selectQuery=new b.V,this.getColumns()})}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}getColumns(){let e=this.formsService.currentForm;if(e.controls.sourceType.value===b.gc.Table&&e.controls.sourceTableKey.value>0){let t=this.hubCache.getTable(e.controls.sourceTableKey.value);if(t)return this.tableColumns=t.dexihTableColumns,void(this.inputColumns=this.getInputColumns(t.dexihTableColumns));this.reset()}else this.reset();if(e.controls.sourceType.value===b.gc.Datalink&&e.controls.sourceDatalinkKey.value>0){let t=this.datalinks.find(t=>t.key===e.controls.sourceDatalinkKey.value);if(t){const e=new On.b;e.buildInputOutput(this.hubCache,t),this.tableColumns=e.getDatalinkOutputColumns(t),this.inputColumns=this.getInputColumns(t.sourceDatalinkTable.dexihDatalinkColumns)}else this.reset()}else this.reset()}getInputColumns(e){return e.filter(e=>e.isInput).map(e=>({name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue}))}reset(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null}refresh(){let e=this.formsService.currentForm;e.controls.sourceType.value===b.gc.Datalink&&this.hubService.previewDatalinkKeyData(e.controls.sourceDatalinkKey.value,!1,this.selectQuery,this.inputColumns,e.controls.parameters.value,this.cancelToken).then(e=>{this.refreshDataSubject.next(),this.columns=e.columns,this.data=e.data}).catch(()=>{}),e.controls.sourceType.value===b.gc.Table&&this.hubService.previewTableKeyData(e.controls.sourceTableKey.value,!1,this.selectQuery,this.inputColumns,e.controls.parameters.value,this.cancelToken).then(e=>{this.columns=e.columns,this.data=e.data}).catch(()=>{})}download(e){let t=this.formsService.currentForm.value,i=new b.M;t.sourceType===b.gc.Table&&(i.objectKey=t.sourceDatalinkKey,i.objectType=b.lb.Datalink),t.sourceType===b.gc.Table&&(i.objectKey=t.sourceTableKey,i.objectType=b.lb.Table),i.query=this.selectQuery,this.hubService.downloadData([i],!1,e,this.cancelToken)}canDeactivate(){return new Promise(e=>{this.formsService.hasChanged?this.authService.confirmDialog("The api has not been saved","The api changes have not been saved.  Do you want to discard the changes and exit?").then(t=>{e(t)}).catch(()=>{e(!1)}):e(!0)})}unloadNotification(e){this.formsService.hasChanged&&(e.returnValue="The api changes have not been saved.  Do you want to discard the changes and exit?")}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-api-edit-form"]],hostBindings:function(e,t){1&e&&h.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,h.uc)},features:[h.xb([T.a])],decls:17,vars:16,consts:[[1,"container"],["title","Edit API","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],["title","Parameters",3,"showExpandButton","padding",4,"ngIf"],["title","Data",3,"showExpandButton"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","Api Name","formControlName","name","placeholder","Enter the api name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Auto Start","formControlName","autoStart","note","Re-start the API when the remote agent is restarted."],["label","Log Directory","formControlName","logDirectory","placeholder","Enter a directory to log api updates.","iconClass","fa fa-list","note","Directory to create detailed logs of API calls.  Leave blank to exclude file logging.",3,"errors"],["label","Cache Queries","formControlName","cacheQueries","note","Cache API called to improve performance"],["label","Reset Cache Interval","formControlName","cacheResetInterval","note","The interval to reset the cache (forcing a reload of new data).",3,"errors"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["title","Parameters",3,"showExpandButton","padding"],[3,"showEdit","parameters","formsService"],[1,"d-flex","flex-wrap","pt-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Kn,4,3,"ng-template",null,2,h.Ec),h.Ob(4,"dexih-widget-section",3),h.Dc(5,Ln,24,10,"form",4),h.Nb(),h.Dc(6,Pn,2,5,"dexih-widget-section",5),h.Ob(7,"dexih-widget-section",6),h.Dc(8,An,2,1,"div",7),h.Ob(9,"section"),h.Ob(10,"h5"),h.Fc(11,"Data Configuration"),h.Nb(),h.Ob(12,"query-builder",8),h.Vb("onRefreshData",(function(){return t.refresh()})),h.Nb(),h.Nb(),h.Ob(13,"dexih-table",9),h.Dc(14,Mn,1,0,"ng-template",null,10,h.Ec),h.Nb(),h.Nb(),h.Nb(),h.Lb(16,"dexih-help",11),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!1),h.yb(3),h.hc("showExpandButton",!0),h.yb(1),h.hc("ngIf",t.formsService.currentForm),h.yb(1),h.hc("ngIf",t.formsService.currentForm),h.yb(1),h.hc("showExpandButton",!0),h.yb(1),h.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),h.yb(4),h.hc("selectQuery",t.selectQuery)("columns",t.tableColumns)("inputColumns",t.inputColumns)("parameters",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.parameters.value)("refreshEvent",t.refreshDataSubject.asObservable()),h.yb(1),h.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",t.columns)("data",t.data))},directives:[u.P,u.T,p.t,Nn.a,d.a,G.a,I.a,Tn.a,F.a,K.a,a.I,a.t,a.l,u.D,a.s,a.j,u.H,u.A,u.I,u.E,Dn.a,xn.a,Fn.a,p.s,a.v,u.s],encapsulation:2}),e})();var Zn=i("7q3d"),_n=i("Eg12");function Hn(e,t){if(1&e&&h.Lb(0,"tags-update-button",11),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.ColumnValidation)("objects",e)}}function Bn(e,t){if(1&e&&h.Lb(0,"dependent-items-button",12),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.Api)}}function Un(e,t){1&e&&h.Lb(0,"actions-api-button",13),2&e&&h.hc("apis",t.items)}function qn(e,t){if(1&e&&h.Lb(0,"api-status",14),2&e){const e=t.item;h.hc("apiKey",null==e?null:e.key)}}let zn=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"apiSource",title:"Api Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[2],this.updateApis()})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}editApi(e){this.router.navigate(["api-edit",e.key],{relativeTo:this.route})}updateApis(){if(this.hubCache.isLoaded()){let e;e=this.hubCache.hub.dexihApis.filter(e=>e.isValid);let t=e.map(e=>({key:e.key,name:e.name,apiSource:this.getSourceDetails(e),updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private",tags:this.hubCache.getObjectTags(b.dc.ColumnValidation,e.key)}));this._tableData.next(t)}else this._tableData.next(null)}getSourceDetails(e){if(e.sourceType===b.gc.Table){let t=this.hubCache.getTable(e.sourceTableKey);return t?"Table: "+t.name:"Error: Table not found"}{let t=this.hubCache.hub.dexihDatalinks.find(t=>t.key===e.sourceDatalinkKey);return t?"Datalink: "+t.name:"Error: Datalink not found"}}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Api&&e.changeClass!==b.dc.TagObjects||this.updateApis()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["apis"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Api's","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"apis"],[3,"apiKey"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.editApi(e)})),h.Dc(3,Hn,1,2,"ng-template",3,4,h.Ec),h.Dc(5,Bn,1,2,"ng-template",5,6,h.Ec),h.Dc(7,Un,1,1,"ng-template",null,7,h.Ec),h.Dc(9,qn,1,1,"ng-template",8,9,h.Ec),h.Nb(),h.Nb(),h.Lb(11,"dexih-help",10),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,g.a,f.a,Zn.a,_n.a],encapsulation:2}),e})();var Wn=i("v6kC");function Gn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-refresh",11),h.Vb("click",(function(){return h.vc(e),h.Zb().runDatalinks()})),h.Nb(),h.Ob(1,"dexih-button-cancel",12),h.Vb("click",(function(){return h.vc(e),h.Zb().cancel()})),h.Nb()}}function Qn(e,t){if(1&e&&(h.Ob(0,"div",16),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.yb(1),h.Hc(" ",e.name," ")}}function $n(e,t){if(1&e&&(h.Ob(0,"label",13),h.Fc(1,"Run the following datalink(s):"),h.Nb(),h.Ob(2,"div",14),h.Dc(3,Qn,2,1,"div",15),h.ac(4,"fieldSort"),h.Nb()),2&e){const e=h.Zb();h.yb(3),h.hc("ngForOf",h.cc(4,1,e.datalinks,"name"))}}function Xn(e,t){if(1&e){const e=h.Pb();h.Ob(0,"span",20),h.Ob(1,"div",21),h.Ob(2,"div",18),h.Fc(3),h.Nb(),h.Nb(),h.Ob(4,"form-input",22),h.Vb("ngModelChange",(function(i){return h.vc(e),t.$implicit.value=i})),h.Nb(),h.Nb()}if(2&e){const e=t.$implicit,i=t.index;h.yb(3),h.Hc(" ",e.logicalName," "),h.yb(1),h.jc("name","column",i,""),h.hc("placeholder",e.logicalName)("ngModel",e.value)}}function Yn(e,t){if(1&e&&(h.Ob(0,"div",17),h.Ob(1,"div",18),h.Fc(2," Input Values "),h.Nb(),h.Dc(3,Xn,5,4,"span",19),h.Nb()),2&e){const e=h.Zb();h.yb(3),h.hc("ngForOf",e.inputColumns)}}function Jn(e,t){if(1&e&&(h.Ob(0,"div"),h.Ob(1,"label",13),h.Fc(2,"Parameters:"),h.Nb(),h.Lb(3,"input-parameters-view",23),h.Nb()),2&e){const e=h.Zb();h.yb(3),h.hc("parameters",e.parameters)}}const es=function(){return{standalone:!0}};let ts=(()=>{class e{constructor(e,t,i){this.hubService=e,this.authService=t,this.route=i,this.cancelToken=new x.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[0],i=e[1];if(this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache.isLoaded()){let e=i.datalinkKeys;this.datalinks=new Array,e&&(this.inputColumns=[],this.parameters=[],e.split("|").map(e=>+e).forEach(e=>{let t=this.hubCache.hub.dexihDatalinks.find(t=>t.key===e);this.datalinks.push(t),t.sourceDatalinkTable.dexihDatalinkColumns.filter(e=>e.isInput).forEach(i=>{this.inputColumns.push({datalinkKey:e,datalinkName:t.name,name:i.name,logicalName:i.logicalName,dataType:i.dataType,rank:i.rank,value:i.defaultValue,defaultValue:i.defaultValue})}),t.parameters.forEach(e=>{this.parameters.findIndex(t=>t.name===e.name)<0&&this.parameters.push(e)})}))}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datalink Preview")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}runDatalinks(){this.hubService.runDatalinks(this.datalinks.map(e=>e.key),this.truncateTable,this.resetIncremental,this.resetValue,this.inputColumns,this.parameters,this.cancelToken),this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datalink-run"]],decls:20,vars:13,consts:[[1,"container"],["title","Datalink Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"d-flex","flex-wrap"],["class","alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"parameters"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Gn,2,0,"ng-template",null,2,h.Ec),h.Dc(4,$n,5,4,"ng-template",null,3,h.Ec),h.Ob(6,"form"),h.Ob(7,"fieldset"),h.Ob(8,"section"),h.Ob(9,"div",4),h.Ob(10,"section",5),h.Ob(11,"form-checkbox",6),h.Vb("ngModelChange",(function(e){return t.truncateTable=e})),h.Nb(),h.Nb(),h.Nb(),h.Ob(12,"div",4),h.Ob(13,"section",5),h.Ob(14,"form-checkbox",7),h.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),h.Nb(),h.Nb(),h.Nb(),h.Ob(15,"div",4),h.Ob(16,"section",5),h.Ob(17,"form-input",8),h.Vb("ngModelChange",(function(e){return t.resetValue=e})),h.Nb(),h.Nb(),h.Nb(),h.Dc(18,Yn,4,1,"div",9),h.Dc(19,Jn,4,1,"div",10),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(10),h.hc("ngModel",t.truncateTable)("ngModelOptions",h.lc(10,es)),h.yb(3),h.hc("ngModel",t.resetIncremental)("ngModelOptions",h.lc(11,es)),h.yb(3),h.hc("ngModel",t.resetValue)("ngModelOptions",h.lc(12,es)),h.yb(1),h.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),h.yb(1),h.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[u.P,a.I,a.t,a.u,u.A,a.s,a.v,u.D,p.t,u.s,u.b,p.s,Wn.a],pipes:[xt.a],encapsulation:2}),e})();var is=i("Kj3r"),as=i("nlsZ"),ns=i("bRjT"),ss=i("eOAR"),os=i("OO45"),cs=i("mj3h"),rs=i("0oH3"),ls=i("qKhg"),bs=i("OWar"),hs=i("5Av2"),us=i("cSor"),ds=i("Hd2u"),ms=i("awqr");let fs=(()=>{class e{transform(e){return N.h.find(t=>t.key===e).name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=h.Jb({name:"objectTypeName",type:e,pure:!0}),e})();function ps(e,t){if(1&e&&(h.Ob(0,"form",8),h.Ob(1,"fieldset"),h.Ob(2,"div",9),h.Ob(3,"section",10),h.Lb(4,"form-input",11),h.Nb(),h.Ob(5,"section",10),h.Lb(6,"form-select",12),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.hc("formGroup",e.searchForm),h.yb(6),h.hc("items",e.searchObjectTypes)}}function gs(e,t){1&e&&(h.Ob(0,"div",5),h.Ob(1,"h5"),h.Fc(2,"No search results available."),h.Nb(),h.Nb())}function vs(e,t){if(1&e&&h.Lb(0,"datajob-view",27),2&e){const e=h.Zb().$implicit;h.hc("datajob",e.object)}}function ys(e,t){if(1&e&&h.Lb(0,"datalink-view",28),2&e){const e=h.Zb().$implicit;h.hc("datalink",e.object)}}function Cs(e,t){if(1&e&&h.Lb(0,"connection-view",29),2&e){const e=h.Zb().$implicit;h.hc("connection",e.object)}}function ws(e,t){if(1&e&&h.Lb(0,"table-view",30),2&e){const e=h.Zb().$implicit;h.hc("connection",e.objectParent)("table",e.object)}}function Ss(e,t){if(1&e&&h.Lb(0,"table-column-view",31),2&e){const e=h.Zb().$implicit;h.hc("table",e.objectParent)("column",e.object)}}function ks(e,t){if(1&e&&h.Lb(0,"columnValidation-view",32),2&e){const e=h.Zb().$implicit;h.hc("columnValidation",e.object)}}function Os(e,t){if(1&e&&h.Lb(0,"fileFormat-view",33),2&e){const e=h.Zb().$implicit;h.hc("fileFormat",e.object)}}function Ns(e,t){if(1&e&&h.Lb(0,"view-view",34),2&e){const e=h.Zb().$implicit;h.hc("view",e.object)}}function Ts(e,t){if(1&e&&h.Lb(0,"api-view",35),2&e){const e=h.Zb().$implicit;h.hc("api",e.object)}}function Ds(e,t){if(1&e&&h.Lb(0,"dashboard-view",36),2&e){const e=h.Zb().$implicit;h.hc("dashboard",e.object)}}function xs(e,t){if(1&e&&h.Lb(0,"listOfValues-view",37),2&e){const e=h.Zb().$implicit;h.hc("listOfValues",e.object)}}function Fs(e,t){if(1&e&&h.Lb(0,"datalinkTest-view",38),2&e){const e=h.Zb().$implicit;h.hc("datalinkTest",e.object)}}function Is(e,t){if(1&e&&(h.Ob(0,"li",13),h.Ob(1,"div"),h.Ob(2,"h5"),h.Fc(3),h.ac(4,"objectTypeName"),h.Nb(),h.Nb(),h.Ob(5,"div",14),h.Dc(6,vs,1,1,"datajob-view",15),h.Dc(7,ys,1,1,"datalink-view",16),h.Dc(8,Cs,1,1,"connection-view",17),h.Dc(9,ws,1,2,"table-view",18),h.Dc(10,Ss,1,2,"table-column-view",19),h.Dc(11,ks,1,1,"columnValidation-view",20),h.Dc(12,Os,1,1,"fileFormat-view",21),h.Dc(13,Ns,1,1,"view-view",22),h.Dc(14,Ts,1,1,"api-view",23),h.Dc(15,Ds,1,1,"dashboard-view",24),h.Dc(16,xs,1,1,"listOfValues-view",25),h.Dc(17,Fs,1,1,"datalinkTest-view",26),h.Nb(),h.Nb()),2&e){const e=t.$implicit,i=h.Zb();h.yb(3),h.Gc(h.bc(4,14,e.objectType)),h.yb(2),h.hc("ngSwitch",e.objectType),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Datajob),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Datalink),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Connection),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Table),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.TableColumn),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.ColumnValidation),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.FileFormat),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.View),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Api),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.Dashboard),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.ListOfValues),h.yb(1),h.hc("ngSwitchCase",i.eSearchObjectType.DatalinkTest)}}let Ks=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.route=i,this.router=a,this.fb=n,this.searchObjectTypes=N.h,this.eSearchObjectType=N.l,this.isFirst=!1}ngOnInit(){try{this._subscription=Object(l.a)(this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];if(this.hubCache=e[1],!this.isFirst){this.isFirst=!1;let e=+t.searchObject;e||(e=0),this.searchForm=this.fb.group({searchString:[t.search,[]],searchObject:[e,[]]}),this.updateSearch(),this._searchSubscription&&this._searchSubscription.unsubscribe(),this._searchSubscription=this.searchForm.valueChanges.pipe(Object(is.a)(500)).subscribe(e=>{this.updateSearch()})}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Search")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._searchSubscription&&this._searchSubscription.unsubscribe()}close(){this.authService.navigateUp()}updateSearch(){if(this.hubCache.isLoaded()&&(this.searchResults=this.hubCache.search(this.searchForm.value.searchString,this.searchForm.value.searchObject),history.pushState)){let e=this.hubCache.getHubUrl()+"/search",t=this.searchForm.value.searchString,i=this.searchForm.value.searchObject;t&&(e+="/"+i+"/"+t),this.router.navigateByUrl(e)}}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.a),h.Kb(s.e),h.Kb(a.g))},e.\u0275cmp=h.Eb({type:e,selectors:[["search"]],decls:8,vars:5,consts:[[1,"container-fluid"],["title","Search Results","iconClass","fa fa-lg fa-fw fa-search",3,"showCloseButton","padding","close"],[3,"formGroup",4,"ngIf"],["role","content"],["class","well",4,"ngIf"],[1,"well"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Search Term","formControlName","searchString","placeholder","Search...","iconClass","fa fa-search"],["label","Restrict to","formControlName","searchObject","itemKey","key","itemName","name",3,"items"],[1,"list-group-item"],[1,"col-xs-9",3,"ngSwitch"],[3,"datajob",4,"ngSwitchCase"],[3,"datalink",4,"ngSwitchCase"],[3,"connection",4,"ngSwitchCase"],[3,"connection","table",4,"ngSwitchCase"],[3,"table","column",4,"ngSwitchCase"],[3,"columnValidation",4,"ngSwitchCase"],[3,"fileFormat",4,"ngSwitchCase"],[3,"view",4,"ngSwitchCase"],[3,"api",4,"ngSwitchCase"],[3,"dashboard",4,"ngSwitchCase"],[3,"listOfValues",4,"ngSwitchCase"],[3,"datalinkTest",4,"ngSwitchCase"],[3,"datajob"],[3,"datalink"],[3,"connection"],[3,"connection","table"],[3,"table","column"],[3,"columnValidation"],[3,"fileFormat"],[3,"view"],[3,"api"],[3,"dashboard"],[3,"listOfValues"],[3,"datalinkTest"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,ps,7,2,"form",2),h.Ob(3,"div",3),h.Dc(4,gs,3,0,"div",4),h.Ob(5,"div",5),h.Ob(6,"ul",6),h.Dc(7,Is,18,16,"li",7),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(1),h.hc("ngIf",t.searchForm),h.yb(2),h.hc("ngIf",!t.searchResults||0==(null==t.searchResults?null:t.searchResults.length)),h.yb(3),h.hc("ngForOf",t.searchResults))},directives:[u.P,p.t,p.s,a.I,a.t,a.l,u.D,a.s,a.j,u.E,p.x,p.y,as.a,ns.a,ss.a,os.a,cs.a,rs.a,ls.a,bs.a,hs.a,us.a,ds.a,ms.a],pipes:[fs],encapsulation:2}),e})();var Es=i("RRRx");let Vs=(()=>{class e{}return e.\u0275mod=h.Ib({type:e}),e.\u0275inj=h.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[n.a,Es.a,a.C]]}),e})();var Ls=i("SmOL");function Ps(e,t){if(1&e&&h.Lb(0,"dependent-items-button",9),2&e){const e=t.item,i=h.Zb();h.hc("key",e.key)("objectType",i.eSharedObjectType.Dashboard)}}function js(e,t){if(1&e&&h.Lb(0,"tags-update-button",10),2&e){const e=t.items,i=h.Zb();h.hc("objectType",i.eSharedObjectType.Dashboard)("objects",e)}}function As(e,t){1&e&&h.Lb(0,"actions-dashboard-button",11),2&e&&h.hc("dashboards",t.items)}let Ms=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[2],this.updateDashboards()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Dashboard Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}delete(e){this.hubService.deleteDashboards(e)}updateDashboards(){if(this.hubCache&&this.hubCache.isLoaded()){let e;e=this.hubCache.hub.dexihDashboards.filter(e=>e.isValid);let t=e.map(e=>({key:e.key,name:e.name,tags:this.hubCache.getObjectTags(b.dc.Dashboard,e.key),updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"}));this._tableData.next(t)}else this._tableData.next(null)}edit(e){this.router.navigate(["dashboard-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubCache,i=this.hubService.createHub(t.hub.hubKey,"");e.forEach(e=>{t.cacheAddDashboard(e.key,i)}),this.hubService.exportHub(i,1===e.length?"Dashboard - "+e[0].name+".json":"dashboards.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.Dashboard&&e.changeClass!==b.dc.TagObjects||this.updateDashboards()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["dashboards"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Dashboards","iconClass","fa fa-lg fa-fw fa-pie-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Dashboards","path","/assets/help/reference/dashboard.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"dashboards"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,Ps,1,2,"ng-template",3,4,h.Ec),h.Dc(5,js,1,2,"ng-template",5,6,h.Ec),h.Dc(7,As,1,1,"ng-template",null,7,h.Ec),h.Nb(),h.Nb(),h.Lb(9,"dexih-help",8),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,G.a,f.a,g.a,Ls.a],encapsulation:2}),e})();function Rs(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-refresh",10),h.Vb("click",(function(){return h.vc(e),h.Zb().run()})),h.Nb(),h.Ob(1,"dexih-button-refresh",11),h.Vb("click",(function(){return h.vc(e),h.Zb().activate()})),h.Nb(),h.Ob(2,"dexih-button-cancel",12),h.Vb("click",(function(){return h.vc(e),h.Zb().cancel()})),h.Nb()}}function Zs(e,t){if(1&e&&(h.Ob(0,"span",16),h.Fc(1),h.Nb()),2&e){const e=t.$implicit;h.yb(1),h.Hc(" ",e.name," ")}}function _s(e,t){if(1&e&&(h.Ob(0,"label",13),h.Fc(1,"Run the following datajobs(s):"),h.Nb(),h.Ob(2,"div"),h.Ob(3,"div",14),h.Dc(4,Zs,2,1,"span",15),h.ac(5,"fieldSort"),h.Nb(),h.Nb()),2&e){const e=h.Zb();h.yb(4),h.hc("ngForOf",h.cc(5,1,e.datajobs,"name"))}}function Hs(e,t){if(1&e&&(h.Ob(0,"div",17),h.Ob(1,"div",18),h.Fc(2," Input Parameters "),h.Nb(),h.Lb(3,"input-parameters-view",19),h.Nb()),2&e){const e=h.Zb();h.yb(3),h.hc("parameters",e.parameters)}}i("LyCD"),i("NbKI");const Bs=function(){return{standalone:!0}};let Us=(()=>{class e{constructor(e,t,i){this.hubService=e,this.authService=t,this.route=i,this.cancelToken=new x.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[0],i=e[1];if(this.hubCache=e[2],this.action=t.action,this.pageTitle=t.pageTitle,this.hubCache.isLoaded()){let e=i.datajobKeys;this.datajobs=new Array,e&&(this.parameters=[],e.split("|").map(e=>+e).forEach(e=>{let t=this.hubCache.hub.dexihDatajobs.find(t=>t.key===e);this.datajobs.push(t),t.parameters.forEach(e=>{this.parameters.findIndex(t=>e.name===t.name)<0&&this.parameters.push({name:e.name,value:e.value,rank:e.rank})})}))}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Datajob Run")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}run(){this.hubService.runDatajobs(this.datajobs,this.truncateTable,this.resetIncremental,this.resetValue,this.parameters,this.cancelToken),this.authService.navigateUp()}activate(){this.hubService.activateDatajobs(this.datajobs,this.parameters,this.cancelToken),this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["datajob-run"]],decls:19,vars:12,consts:[[1,"container"],["title","Datajob Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],["text","Activate Triggers",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],[3,"parameters"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Dc(2,Rs,3,0,"ng-template",null,2,h.Ec),h.Dc(4,_s,6,4,"ng-template",null,3,h.Ec),h.Ob(6,"form"),h.Ob(7,"fieldset"),h.Ob(8,"section"),h.Ob(9,"div",4),h.Ob(10,"section",5),h.Ob(11,"form-checkbox",6),h.Vb("ngModelChange",(function(e){return t.truncateTable=e})),h.Nb(),h.Nb(),h.Nb(),h.Ob(12,"div",4),h.Ob(13,"section",5),h.Ob(14,"form-checkbox",7),h.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),h.Nb(),h.Nb(),h.Nb(),h.Ob(15,"div",4),h.Ob(16,"section",5),h.Ob(17,"form-input",8),h.Vb("ngModelChange",(function(e){return t.resetValue=e})),h.Nb(),h.Nb(),h.Nb(),h.Dc(18,Hs,4,1,"div",9),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0)("padding",!0),h.yb(10),h.hc("ngModel",t.truncateTable)("ngModelOptions",h.lc(9,Bs)),h.yb(3),h.hc("ngModel",t.resetIncremental)("ngModelOptions",h.lc(10,Bs)),h.yb(3),h.hc("ngModel",t.resetValue)("ngModelOptions",h.lc(11,Bs)),h.yb(1),h.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[u.P,a.I,a.t,a.u,u.A,a.s,a.v,u.D,p.t,u.s,u.b,p.s,Wn.a],pipes:[xt.a],encapsulation:2}),e})();function qs(e,t){if(1&e&&h.Lb(0,"save-button",17),2&e){const e=h.Zb(3);h.hc("formsService",e.formsService)}}function zs(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-invalid-form-details",14),h.Vb("click",(function(){return h.vc(e),h.Zb(2).formsService.showErrors()})),h.Nb(),h.Dc(1,qs,1,1,"save-button",15),h.Lb(2,"cancel-button",16)}if(2&e){const e=h.Zb(2);h.hc("control",e.formsService.currentForm),h.yb(1),h.hc("ngIf",e.hubCache.canWrite),h.yb(1),h.hc("formsService",e.formsService)}}function Ws(e,t){if(1&e&&(h.Ob(0,"section",8),h.Ob(1,"form-select",18),h.Lb(2,"table-edit-button",19),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("errors",null==e.errors?null:e.errors.sourceTableKey)("items",e.connectionTables),h.yb(1),h.hc("key",e.formsService.currentForm.controls.sourceTableKey.value)}}function Gs(e,t){if(1&e&&(h.Ob(0,"section",8),h.Ob(1,"form-select",20),h.Lb(2,"datalink-edit-button",19),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(1),h.hc("errors",null==e.errors?null:e.errors.sourceDatalinkKey)("items",e.datalinks),h.yb(1),h.hc("key",e.formsService.currentForm.controls.sourceDatalinkKey.value)}}function Qs(e,t){if(1&e&&(h.Ob(0,"div",7),h.Ob(1,"section",21),h.Lb(2,"form-select",22),h.Nb(),h.Ob(3,"section",21),h.Lb(4,"form-select",23),h.Nb(),h.Ob(5,"section",21),h.Lb(6,"form-select",24),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(2),h.hc("items",e.tableColumns)("allowNullSelect",!0)("enableFilter",!1),h.yb(2),h.hc("items",e.tableColumns)("allowNullSelect",!0)("enableFilter",!1),h.yb(2),h.hc("items",e.tableColumns)("allowNullSelect",!0)("enableFilter",!1)}}function $s(e,t){1&e&&h.Lb(0,"form-input",29)}function Xs(e,t){if(1&e&&(h.Ob(0,"div",7),h.Ob(1,"section",25),h.Ob(2,"div",26),h.Lb(3,"form-checkbox",27),h.Dc(4,$s,1,0,"form-input",28),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.yb(3),h.hc("border",!0),h.yb(1),h.hc("ngIf",e.formsService.currentForm.controls.cache.value)}}function Ys(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button",32),h.Vb("click",(function(){return h.vc(e),h.Zb(3).add(-1)})),h.Fc(1,"Insert Item"),h.Nb(),h.Ob(2,"dexih-button-delete",33),h.Vb("click",(function(){return h.vc(e),h.Zb(3).clear()})),h.Nb()}}function Js(e,t){if(1&e){const e=h.Pb();h.Ob(0,"form",34),h.Ob(1,"div",35),h.Ob(2,"div",36),h.Lb(3,"form-input",37),h.Nb(),h.Ob(4,"div",36),h.Lb(5,"form-input",38),h.Nb(),h.Ob(6,"div",36),h.Lb(7,"form-input",39),h.Nb(),h.Ob(8,"div",40),h.Ob(9,"button",41),h.Vb("click",(function(){h.vc(e);const i=t.index;return h.Zb(3).add(i)})),h.Lb(10,"i",42),h.Nb(),h.Ob(11,"button",43),h.Vb("click",(function(){h.vc(e);const i=t.index;return h.Zb(3).remove(i)})),h.Lb(12,"i",44),h.Nb(),h.Nb(),h.Nb(),h.Nb()}2&e&&(h.hc("formGroup",t.$implicit),h.yb(3),h.hc("border",!1),h.yb(2),h.hc("border",!1),h.yb(2),h.hc("border",!1))}function eo(e,t){if(1&e&&(h.Ob(0,"dexih-widget-section",30),h.Dc(1,Ys,3,0,"ng-template",null,3,h.Ec),h.Dc(3,Js,13,4,"form",31),h.Nb()),2&e){const e=h.Zb(2);h.hc("showExpandButton",!0),h.yb(3),h.hc("ngForOf",e.formsService.currentForm.controls.staticData.controls)}}function to(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",49),h.Ob(1,"dexih-button-refresh",50),h.Vb("click",(function(){return h.vc(e),h.Zb(3).refreshData()})),h.Nb(),h.Nb()}2&e&&(h.yb(1),h.hc("autoCompact",!1))}function io(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-refresh",53),h.Vb("click",(function(){return h.vc(e),h.Zb(4).refreshData()})),h.Nb()}}function ao(e,t){if(1&e&&(h.Ob(0,"dexih-table",51),h.Dc(1,io,1,0,"ng-template",null,52,h.Ec),h.Nb()),2&e){const e=h.Zb(3);h.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",e.columns)("data",e.data)}}function no(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-widget-section",45),h.Ob(1,"query-builder",46),h.Vb("hasChanged",(function(){return h.vc(e),h.Zb(2).hasChanged()}))("onRefreshData",(function(){return h.vc(e),h.Zb(2).refreshData()})),h.Nb(),h.Nb(),h.Dc(2,to,2,1,"div",47),h.Dc(3,ao,3,4,"dexih-table",48)}if(2&e){const e=h.Zb(2);h.hc("showExpandButton",!0),h.yb(1),h.hc("selectQuery",e.formsService.currentForm.controls.selectQuery.value)("columns",e.tableColumns)("inputColumns",e.inputColumns)("parameters",null)("refreshEvent",e.refreshDataSubject.asObservable()),h.yb(1),h.hc("ngIf",!e.data),h.yb(1),h.hc("ngIf",e.data)}}function so(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",1),h.Ob(1,"dexih-widget",2),h.Vb("close",(function(){return h.vc(e),h.Zb().close()})),h.Dc(2,zs,3,3,"ng-template",null,3,h.Ec),h.Ob(4,"form",4),h.Ob(5,"fieldset"),h.Ob(6,"section"),h.Lb(7,"form-input",5),h.Nb(),h.Ob(8,"section"),h.Lb(9,"form-textarea",6),h.Nb(),h.Ob(10,"section"),h.Ob(11,"div",7),h.Ob(12,"section",8),h.Lb(13,"form-select",9),h.Nb(),h.Dc(14,Ws,3,3,"section",10),h.Dc(15,Gs,3,3,"section",10),h.Nb(),h.Dc(16,Qs,7,9,"div",11),h.Dc(17,Xs,5,2,"div",11),h.Nb(),h.Nb(),h.Nb(),h.Dc(18,eo,4,2,"dexih-widget-section",12),h.Dc(19,no,4,8,"ng-template",13),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.yb(1),h.hc("showCloseButton",!0)("padding",!1),h.yb(3),h.hc("formGroup",e.formsService.currentForm),h.yb(3),h.hc("autocapitalize",e.on)("errors",e.formsService.formErrors.name),h.yb(2),h.hc("showMarkdown",!0),h.yb(4),h.hc("items",e.sourceTypes)("enableFilter",!1),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eLOVObjectType.Table),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eLOVObjectType.Datalink),h.yb(1),h.hc("ngIf",e.tableColumns),h.yb(1),h.hc("ngIf",e.tableColumns),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType==e.eLOVObjectType.Static),h.yb(1),h.hc("ngIf",e.formsService.currentForm.value.sourceType!==e.eLOVObjectType.Static)}}let oo=(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.formsService=i,this.route=a,this.router=n,this.isLoaded=!1,this.refreshDataSubject=new Sn.a,this.cancelToken=new x.a,this.eLOVObjectType=b.Qb,this.connectionTables=[],this.datalinks=[],this.sourceTypes=b.Rb.filter(e=>e.key>0),this.columns=[{name:"key",title:"Key"},{name:"name",title:"Name"},{name:"description",title:"Description"}]}ngOnInit(){try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];this.params=e[1],this.hubCache=e[2],this.pageTitle=t.pageTitle,this.action=t.action,this.hubCache&&this.hubCache.status===N.j.Loaded&&(this.isLoaded&&"new"===this.action||(this.isLoaded&&this.formsService.hasChanged?this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then(e=>{e&&this.load()}).catch(e=>{}):this.load()))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Edit List Of Values")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._sourceChangeSubscription&&this._sourceChangeSubscription.unsubscribe(),this.cancelToken.cancel()}load(){if(this.isLoaded=!0,this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks,"edit"===this.action)if(this.listOfValuesKey=+this.params.listOfValuesKey,this.listOfValuesKey)if(this.hubCache.hub&&this.hubCache.hub.dexihListOfValues){let e=this.hubCache.hub.dexihListOfValues.find(e=>e.key===this.listOfValuesKey);e.selectQuery||(e.selectQuery=new b.V),this.formsService.listOfValues(e)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no list of values specified to edit.");if("new"===this.action){let e=new b.E;e.selectQuery=new b.V,this.formsService.listOfValues(e),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{let t=e.controls.key.value;if(t&&history.pushState){let e=window.location.pathname.replace("/listOfValues-new","/listOfValues-edit/"+t);this.router.navigateByUrl(e),this._formChangeSubscription.unsubscribe()}})}this.refreshColumns();let e=this.formsService.currentForm;this._sourceChangeSubscription=Object(kn.a)(e.controls.sourceType.valueChanges,e.controls.sourceTableKey.valueChanges,e.controls.sourceDatalinkKey.valueChanges).subscribe(()=>{this.refreshColumns()})}refreshColumns(){let e=this.formsService.currentForm;switch(e.controls.sourceType.value){case b.Qb.Datalink:let t=e.controls.sourceDatalinkKey.value,i=this.hubCache.hub.dexihDatalinks.find(e=>e.key===t);if(i){const e=new On.b;e.buildInputOutput(this.hubCache,i),this.tableColumns=e.getDatalinkOutputColumns(i)}else t>0&&this.hubService.addHubErrorMessage(`The datalink with the key ${t} could not be found.`),this.tableColumns=null;break;case b.Qb.Table:let a=e.controls.sourceTableKey.value,n=this.hubCache.hub.dexihTables.find(e=>e.key===a);n?this.tableColumns=n.dexihTableColumns:(a>0&&this.hubService.addHubErrorMessage(`The table with the key ${a} could not be found.`),this.tableColumns=null)}}refreshData(){this.hubService.previewListOfValues(this.formsService.currentForm.value,!0,this.cancelToken).then(e=>{this.data=e,this.refreshDataSubject.next()}).catch(e=>{this.hubService.addHubMessage(e)})}hasChanged(){}add(e){let t=this.formsService.currentForm,i=this.formsService.listOfValuesItem(new b.R);t.controls.staticData.insert(e+1,i)}remove(e){this.formsService.currentForm.controls.staticData.removeAt(e)}clear(){let e=this.formsService.currentForm.controls.staticData;for(;e.controls.length>0;)e.removeAt(0)}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(T.a),h.Kb(s.a),h.Kb(s.e))},e.\u0275cmp=h.Eb({type:e,selectors:[["dexih-listOfValues-edit-form"]],features:[h.xb([T.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit List of Values","iconClass","fa fa-lg fa-list-alt",3,"showCloseButton","padding","close"],["header",""],[1,"m-3",3,"formGroup"],["label","List of Values","formControlName","name","placeholder","Enter the list of values name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["class","form-row",4,"ngIf"],["title","Static Values",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],[1,"form-group","col-md-4"],["label","Key Column","formControlName","keyColumn","itemKey","name","itemName","name","iconClass","fa fa-key",3,"items","allowNullSelect","enableFilter"],["label","Name Column","formControlName","nameColumn","itemKey","name","itemName","name","iconClass","fa fa-circle-o",3,"items","allowNullSelect","enableFilter"],["label","Description Column","formControlName","descriptionColumn","itemKey","name","itemName","name","iconClass","fa fa-comment-o",3,"items","allowNullSelect","enableFilter"],[1,"form-group","col-md-12"],[1,"d-flex","flex-wrap","pt-1"],["label","Cache Lookup","formControlName","cache",1,"input-group-prepend",3,"border"],["type","number","class","pl-1","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",4,"ngIf"],["type","number","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",1,"pl-1"],["title","Static Values",3,"showExpandButton"],["class","flex-fill",3,"formGroup",4,"ngFor","ngForOf"],["iconClass","fa fa-plus",1,"mr-1",3,"click"],["text","Clear All",3,"click"],[1,"flex-fill",3,"formGroup"],[1,"input-group"],[1,"form-control","p-0"],["formControlName","key","type","text","placeholder","Key Value",3,"border"],["formControlName","name","type","text","placeholder","Item name",3,"border"],["formControlName","key","type","text","placeholder","Description",3,"border"],[1,"input-group-append","flex-shrink-1","ml-1"],["type","button","value","Add",1,"btn","btn-light",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-light",3,"click"],[1,"fa","fa-minus-square-o"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],["class","m-3",4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data",4,"ngIf"],[1,"m-3"],["text","Reload",3,"autoCompact","click"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&h.Dc(0,so,20,14,"div",0),2&e&&h.hc("ngIf",t.formsService.currentForm)},directives:[p.t,u.P,a.I,a.t,a.l,u.D,a.s,a.j,u.H,u.E,I.a,F.a,K.a,Dn.a,xn.a,u.A,u.T,p.s,u.f,u.g,Nn.a,u.s,d.a],encapsulation:2}),e})();const co=function(e){return["listOfValues-edit",e]};function ro(e,t){if(1&e&&(h.Lb(0,"dexih-button-edit",8),h.Lb(1,"dependent-items-button",9)),2&e){const e=t.item,i=h.Zb();h.hc("routerLink",h.mc(3,co,e.key)),h.yb(1),h.hc("key",e.key)("objectType",i.eSharedObjectType.ListOfValues)}}function lo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",10),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().delete(t)})),h.Nb()}}function bo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",10),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb(),h.Dc(1,lo,1,0,"dexih-button-delete",11),h.Lb(2,"tags-update-button",12)}if(2&e){const e=t.items,i=h.Zb();h.yb(1),h.hc("ngIf",i.hubCache.canWrite),h.yb(1),h.hc("objectType",i.eSharedObjectType.ListOfValues)("objects",e)}}const ho=function(){return["listOfValues-new"]};function uo(e,t){1&e&&h.Lb(0,"dexih-button-new",14),2&e&&h.hc("routerLink",h.lc(1,ho))}function mo(e,t){if(1&e&&h.Dc(0,uo,1,2,"dexih-button-new",13),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}let fo=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=b.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"sourceType",title:"Source Type",format:"Enum",enum:b.Qb},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[0],this.update()})}catch(e){this.hubService.addHubClientErrorMessage(e,"Hub List of Values Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}delete(e){this.hubService.deleteListOfValues(e)}update(){if(this.hubCache&&this.hubCache.isLoaded()){let e=this.hubCache.hub.dexihListOfValues.filter(e=>e.isValid).map(e=>({key:e.key,name:e.name,description:e.description,updateDate:e.updateDate,tags:this.hubCache.getObjectTags(b.dc.ListOfValues,e.key)}));this._tableData.next(e)}else this._tableData.next(null)}edit(e){this.router.navigate(["listOfValues-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubCache,i=this.hubService.createHub(t.hub.hubKey,"");i.dexihListOfValues=e,e.forEach(e=>{t.getListOfValuesCache(e,i)}),this.hubService.exportHub(i,"list_of_values.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==b.dc.ListOfValues&&e.changeClass!==b.dc.TagObjects||this.update()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(c.a),h.Kb(s.e),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["listOfValues"]],decls:9,vars:7,consts:[[1,"container-fluid"],["title","List Of Values","iconClass","fa fa-lg fa-fw fa-list-alt",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"ml-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,ro,2,5,"ng-template",3,4,h.Ec),h.Dc(5,bo,3,3,"ng-template",5,6,h.Ec),h.Dc(7,mo,1,1,"ng-template",null,7,h.Ec),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,d.a,u.j,s.f,f.a,u.u,p.t,g.a,u.g,u.o],encapsulation:2}),e})();var po=i("Xjf6"),go=i("R0Ic");function vo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-edit",12),h.Vb("click",(function(){h.vc(e);const t=h.Zb();return t.edit(t.item)})),h.Nb()}}function yo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-delete",12),h.Vb("click",(function(){h.vc(e);const t=h.Zb().items;return h.Zb().delete(t)})),h.Nb()}}function Co(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-save-local",12),h.Vb("click",(function(){h.vc(e);const i=t.items;return h.Zb().export(i)})),h.Nb(),h.Dc(1,yo,1,0,"dexih-button-delete",13)}if(2&e){const e=h.Zb();h.yb(1),h.hc("ngIf",e.hubCache.canWrite)}}function wo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"dexih-button-new",12),h.Vb("click",(function(){return h.vc(e),h.Zb(2).new()})),h.Nb()}}function So(e,t){if(1&e&&h.Dc(0,wo,1,0,"dexih-button-new",13),2&e){const e=h.Zb();h.hc("ngIf",e.hubCache.canWrite)}}const ko=function(e){return{"background-color":e,"margin-bottom":"0"}};function Oo(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",14),h.Vb("click",(function(){h.vc(e);const i=t.item;return h.Zb().edit(i)})),h.Ob(1,"span",15),h.Fc(2),h.Nb(),h.Nb()}if(2&e){const e=t.item;h.hc("ngStyle",h.mc(2,ko,e.color)),h.yb(2),h.Gc(e.name)}}function No(e,t){if(1&e){const e=h.Pb();h.Ob(0,"button",35),h.Vb("click",(function(){h.vc(e);const i=t.$implicit;return h.Zb(3).selectColor(i)})),h.Nb()}2&e&&h.Cc("background-color",t.$implicit.color)}function To(e,t){if(1&e&&(h.Ob(0,"form",21),h.Ob(1,"div",22),h.Ob(2,"section",23),h.Lb(3,"form-input",24),h.Nb(),h.Ob(4,"section",25),h.Ob(5,"div"),h.Ob(6,"label",26),h.Fc(7,"Color"),h.Nb(),h.Ob(8,"div",27),h.Ob(9,"label",28),h.Lb(10,"input",29),h.Nb(),h.Lb(11,"form-input",30),h.Ob(12,"div",31),h.Dc(13,No,1,2,"button",32),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(14,"div",22),h.Ob(15,"section",33),h.Lb(16,"form-textarea",34),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.Zb(2);h.hc("formGroup",e.formsService.currentForm),h.yb(3),h.hc("autocapitalize",!0)("errors",e.formsService.formErrors.name),h.yb(6),h.Cc("background-color",e.formsService.currentForm.controls.color.value),h.yb(4),h.hc("ngForOf",e.colors),h.yb(3),h.hc("showMarkdown",!0)}}function Do(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",16),h.Ob(1,"div",17),h.Ob(2,"b"),h.Fc(3,"Add/Edit Tag"),h.Nb(),h.Nb(),h.Ob(4,"div",18),h.Dc(5,To,17,7,"form",19),h.Nb(),h.Ob(6,"div",20),h.Ob(7,"dexih-button-save",12),h.Vb("click",(function(){return h.vc(e),h.Zb().save()})),h.Nb(),h.Ob(8,"dexih-button-cancel",12),h.Vb("click",(function(){return h.vc(e),h.Zb().cancel()})),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Zb();h.hc("@slideDown",e.state),h.yb(5),h.hc("ngIf",e.formsService.currentForm)}}const xo={path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:Ji.b,data:{pageTitle:"Detailed Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:Ji.b,data:{pageTitle:"Child Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:Ji.b,data:{pageTitle:"GrandChild Result"}}]}]}]},Fo=[{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:()=>Promise.all([i.e(1),i.e(0)]).then(i.bind(null,"gQFH")).then(e=>e.TableEditModule)},{path:"table-new",data:{pageTitle:"New Table",action:"new"},loadChildren:()=>Promise.all([i.e(1),i.e(0)]).then(i.bind(null,"gQFH")).then(e=>e.TableEditModule)},{path:"table-new/:connectionKey",data:{pageTitle:"New Table",action:"new"},loadChildren:()=>Promise.all([i.e(1),i.e(0)]).then(i.bind(null,"gQFH")).then(e=>e.TableEditModule)},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Mt,data:{action:"new",pageTitle:"New Datalink"}},{path:"table-preview/:tableKey",component:xa,data:{pageTitle:"Preview Table"}}],Io=[{path:"datalink-edit",loadChildren:()=>Promise.all([i.e(1),i.e(14)]).then(i.bind(null,"8Hfl")).then(e=>e.DatalinkEditModule)},{path:"datalink-preview/:datalinkKey/:previewUpdates",component:Zt,data:{pageTitle:"Preview Datalink"}},{path:"table-preview/:tableKey",component:xa,data:{pageTitle:"Preview Table"}},{path:"datalink-run/:datalinkKeys",component:ts,data:{pageTitle:"Run Datalink"}},xo],Ko={path:"tables",data:{pageTitle:"Tables"},children:[{path:"",pathMatch:"full",component:Da,data:{pageTitle:"Tables"}},{path:"",children:Fo},{path:"",children:Io}]},Eo=[{path:"connection-edit/:connectionKey",component:Ve,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit Connection"}},{path:"connection-import/:connectionKey",data:{pageTitle:"Import Tables"},children:[{path:"",pathMatch:"full",component:_e,data:{pageTitle:"Import Tables"}},{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:()=>Promise.all([i.e(1),i.e(0)]).then(i.bind(null,"gQFH")).then(e=>e.TableEditModule)},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Mt,data:{action:"new",pageTitle:"New Datalink"}}]},{path:"connection-new/:purpose",component:Ve,data:{action:"new",pageTitle:"New Connection"}},{path:"connection-copy/:connectionKey",component:Ve,data:{action:"copy",pageTitle:"New Connection"}}],Vo=[{path:"",pathMatch:"full",component:qi,data:{pageTitle:"Remote Agents"}},{path:"agent-edit/:remoteAgentKey/:remoteAgentHubKey",component:Yi,data:{pageTitle:"Edit Agent"}}],Lo=[{path:"results",data:{pageTitle:"Execution Results"},children:[{path:"",pathMatch:"full",component:Ji.a,data:{pageTitle:"Execution Results"}},xo]},xo],Po=[{path:"customFunction-edit/:customFunctionKey",component:sn,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit Custom Function"}},{path:"customFunction-new",component:sn,data:{action:"new",pageTitle:"New Custom Function"}}],jo=[{path:"columnValidation-edit/:validationKey",component:z,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit Validation"}},{path:"columnValidation-new",component:z,data:{action:"new",pageTitle:"New Validation"}}],Ao=[{path:"fileFormat-edit/:fileFormatKey",component:_t.a,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit FileFormat"}},{path:"fileFormat-new",component:_t.a,data:{action:"new",pageTitle:"New FileFormat"}}],Mo=[{path:"view-edit/:viewKey",component:Cn.a,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit View"}},{path:"view-new",component:Cn.a,data:{action:"new",pageTitle:"New View"}}],Ro=[{path:"dashboard-edit/:dashboardKey",data:{pageTitle:"Edit Dashboard",action:"edit"},loadChildren:()=>Promise.all([i.e(0),i.e(3)]).then(i.bind(null,"DN8j")).then(e=>e.DashboardEditModule)},{path:"dashboard-new",data:{pageTitle:"New Dashboard",action:"new"},loadChildren:()=>Promise.all([i.e(0),i.e(3)]).then(i.bind(null,"DN8j")).then(e=>e.DashboardEditModule)}],Zo=[{path:"listOfValues-edit/:listOfValuesKey",component:oo,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit List Of Values"}},{path:"listOfValues-new",component:oo,data:{action:"new",pageTitle:"New List of Values"}}],_o=[{path:"api-edit/:apiKey",component:Rn,canDeactivate:[on.a],data:{action:"edit",pageTitle:"Edit Api"}},{path:"api-new",component:Rn,data:{action:"new",pageTitle:"New Api"}}],Ho=[{path:"hubVariable-edit/:hubVariableKey",component:xi,data:{action:"edit",pageTitle:"Edit Hub Variable"}},{path:"hubVariable-new",component:xi,data:{action:"new",pageTitle:"New Hub Variable"}}],Bo=[{path:"datalinkTest-edit/:datalinkTestKey",data:{pageTitle:"Edit Datalink Test",action:"edit"},loadChildren:()=>i.e(6).then(i.bind(null,"3ZyD")).then(e=>e.DatalinkTestEditModule)},{path:"datalinkTest-new",data:{pageTitle:"New Datalink Test",action:"new"},loadChildren:()=>i.e(6).then(i.bind(null,"3ZyD")).then(e=>e.DatalinkTestEditModule)},{path:"datalinkTest-new/:datalinkKeys",component:yn,data:{pageTitle:"New Datalink Test",action:"new"}},xo],Uo=[{path:"manage",children:[{path:"",component:pi,data:{action:"edit",pageTitle:"Manage Files"}},{path:":tableKey",data:{action:"edit",pageTitle:"Manage Files"},children:[{path:"",component:pi,data:{action:"edit",pageTitle:"Manage Files"}},{path:"file-preview/:path/:fileName",component:xa,data:{pageTitle:"Preview File"}}]}]},{path:"bulk-load",children:[{path:"",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:()=>Promise.all([i.e(1),i.e(0),i.e(5)]).then(i.bind(null,"xgYh")).then(e=>e.FilesBulkLoadModule)},{path:":connectionKey",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:()=>Promise.all([i.e(1),i.e(0),i.e(5)]).then(i.bind(null,"xgYh")).then(e=>e.FilesBulkLoadModule)}]}],qo=[{path:"datajob-edit/:datajobKey",data:{pageTitle:"Edit Data Job",action:"edit"},loadChildren:()=>i.e(4).then(i.bind(null,"geWG")).then(e=>e.DatajobEditModule)},{path:"datajob-new",data:{pageTitle:"New Data Job",action:"new"},loadChildren:()=>i.e(4).then(i.bind(null,"geWG")).then(e=>e.DatajobEditModule)},{path:"datajob-run/:datajobKeys",component:Us,data:{pageTitle:"Run datajobs"}}],zo=s.i.forChild([{path:"agents",data:{pageTitle:"Remote Agents"},children:Vo},{path:"connections",data:{pageTitle:"Connections"},children:[{path:"",pathMatch:"full",component:$e,data:{pageTitle:"Connections"}},{path:"",children:Eo},Ko]},{path:"datalinks",data:{pageTitle:"Data Links"},children:[{path:"",pathMatch:"full",data:{pageTitle:"Data Links"},component:Dt},{path:"",children:Io},{path:"",children:Lo}]},Ko,{path:"datajobs",data:{pageTitle:"Data Jobs"},children:[{path:"",pathMatch:"full",component:gt},{path:"",children:qo},{path:"",children:Lo}]},{path:"columnValidations",data:{pageTitle:"Column Validations"},children:[{path:"",pathMatch:"full",component:O},{path:"",children:jo}]},{path:"customFunctions",data:{pageTitle:"Custom Functions"},children:[{path:"",pathMatch:"full",component:La},{path:"",children:Po}]},{path:"fileFormats",data:{pageTitle:"File Formats"},children:[{path:"",pathMatch:"full",component:_t.b},{path:"",children:Ao}]},{path:"views",data:{pageTitle:"Views"},children:[{path:"",pathMatch:"full",component:wn.a},{path:"",children:Mo}]},{path:"dashboards",data:{pageTitle:"Dashboards"},children:[{path:"",pathMatch:"full",component:Ms},{path:"",children:Ro}]},{path:"listOfValues",data:{pageTitle:"List of Values"},children:[{path:"",pathMatch:"full",component:fo},{path:"",children:Zo}]},{path:"apis",data:{pageTitle:"Apis"},children:[{path:"",pathMatch:"full",component:zn},{path:"",children:_o}]},{path:"hubVariables",data:{pageTitle:"Hub Variables"},children:[{path:"",pathMatch:"full",component:Oi},{path:"",children:Ho}]},{path:"manage",children:[{path:"manage-users",component:Li,data:{pageTitle:"Manage Users"}}]},{path:"import",children:[{path:"",pathMatch:"full",component:ot,data:{pageTitle:"Import Objects"}}]},{path:"export",children:[{path:"",pathMatch:"full",component:bt,data:{pageTitle:"Export Objects"}}]},{path:"sharedData",data:{pageTitle:"Shared Data"},children:[{path:"",pathMatch:"full",component:ha},{path:"",children:[{path:"table-preview/:tableKey",component:xa,data:{pageTitle:"Preview Table"}},{path:"datalink-preview/:datalinkKey",component:Zt,data:{pageTitle:"Preview Datalink"}},{path:"dashboard-preview/:dashboardKey",data:{pageTitle:"Preview Dashboard",action:"edit"},loadChildren:()=>Promise.all([i.e(0),i.e(3)]).then(i.bind(null,"DN8j")).then(e=>e.DashboardEditModule)},{path:"view-preview/:viewKey",component:Cn.a,data:{pageTitle:"Preview View",action:"edit"}},{path:"api-preview/:apiKey",component:Rn,data:{pageTitle:"Preview Api",action:"edit"}}]}]},{path:"files",data:{pageTitle:"Files"},children:[{path:"",children:Uo}]},{path:"datalinkTests",data:{pageTitle:"Datalink Tests"},children:[{path:"",pathMatch:"full",component:un},{path:"",children:Bo},{path:"",children:Lo}]},{path:"tags",component:(()=>{class e{constructor(e,t,i,a,n){this.hubService=e,this.authService=t,this.router=i,this.formsService=a,this.route=n,this.state="hide",this.colors=[{name:"primary",color:"#3a5f8d"},{name:"secondary",color:"#89B3BF"},{name:"success",color:"#479762"},{name:"warning",color:"#c4872a"},{name:"danger",color:"#f44336"},{name:"yellow",color:"yellow"},{name:"pink",color:"pink"},{name:"purple",color:"purple"},{name:"dark",color:"#1F2624"}],this.columns=[{name:"name",title:"Name",footer:"description",format:"Md"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(l.a)(this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe(e=>{let t=e[0];if(this.hubCache=e[1],t.key){let e=this.hubCache.hub.dexihTags.find(e=>e.key===+t.key);if(e){let t=this.hubCache.hub.dexihTags.find(t=>t.key===e.key);this.formsService.tag(t),this.state="show"}}this.update()})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}update(){if(this.hubCache&&this.hubCache.isLoaded()){let e;e=this.hubCache.hub.dexihTags.filter(e=>e.isValid);let t=e.map(e=>({key:e.key,name:e.name,description:e.description,color:e.color,updateDate:e.updateDate}));this._tableData.next(t)}else this._tableData.next(null)}new(){let e=new b.J;this.formsService.tag(e),this.state="show"}edit(e){let t=this.hubCache.hub.dexihTags.find(t=>t.key===e.key);this.formsService.tag(t),this.state="show",history.pushState&&this.router.navigateByUrl(window.location.pathname+"?key="+e.key),document.body.scrollTop=0,document.documentElement.scrollTop=0}delete(e){this.hubService.deleteTags(e)}save(){this.formsService.save(!1).then(()=>{this.hide()}).catch()}cancel(){this.hide()}hide(){this.state="hide",history.pushState&&window.location.search&&this.router.navigateByUrl(window.location.pathname)}selectColor(e){this.formsService.currentForm.controls.color.setValue(e.color)}export(e){const t=this.hubCache,i=this.hubService.createHub(t.hub.hubKey,"");e.forEach(e=>{t.cacheAddTag(e.key,i)}),this.hubService.exportHub(i,1===e.length?"Tag - "+e[0].name+".json":"tags.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass===b.dc.Tags&&this.update()})}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(po.a),h.Kb(c.a),h.Kb(s.e),h.Kb(T.a),h.Kb(s.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["tags"]],features:[h.xb([T.a])],decls:14,vars:6,consts:[[1,"container-fluid"],["title","Tags","iconClass","fa fa-lg fa-fw fa-tags",3,"showCloseButton","close"],["rowStatusHeading","Color",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["tableHeader",""],["title","Views","path","/assets/help/reference/tag.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"alert","p-1","text-center",3,"ngStyle","click"],[1,"blend-text","font-weight-bold"],[1,"card","mt-2",2,"width","100%"],[1,"card-header","text-white","bg-primary"],[1,"card-body"],[3,"formGroup",4,"ngIf"],[1,"card-footer"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-3"],["label","Tag Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],[1,"form-group","col-md-9"],[1,"mt-1"],[1,"input-group","m-0"],[1,"btn","mr-1",2,"height","38px","width","76px"],["formControlName","color","hidden","","type","color"],["formControlName","color","placeholder","color",1,"mr-3",2,"height","38px","width","90px"],["data-toggle","buttons",1,"btn-group-toggle"],["class","btn mr-1","style","height: '38px'; width: '38px'",3,"background-color","click",4,"ngFor","ngForOf"],[1,"col-md-12"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"btn","mr-1",2,"height","38px","width","38px",3,"click"]],template:function(e,t){1&e&&(h.Ob(0,"div",0),h.Ob(1,"dexih-widget",1),h.Vb("close",(function(){return t.close()})),h.Ob(2,"dexih-table",2),h.Vb("rowClick",(function(e){return t.edit(e)})),h.Dc(3,vo,1,0,"ng-template",3,4,h.Ec),h.Dc(5,Co,2,1,"ng-template",5,6,h.Ec),h.Dc(7,So,1,1,"ng-template",null,7,h.Ec),h.Dc(9,Oo,3,4,"ng-template",8,9,h.Ec),h.Dc(11,Do,9,2,"ng-template",null,10,h.Ec),h.Nb(),h.Nb(),h.Lb(13,"dexih-help",11),h.Nb()),2&e&&(h.yb(1),h.hc("showCloseButton",!0),h.yb(1),h.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[u.P,d.a,G.a,u.j,u.u,p.t,u.g,u.o,p.w,u.t,u.b,a.I,a.t,a.l,u.D,a.s,a.j,a.c,p.s,u.H],encapsulation:2,data:{animation:[Object(go.j)("slideDown",[Object(go.g)("hide",Object(go.h)({height:0,overflow:"hidden"})),Object(go.g)("show",Object(go.h)({height:"*",overflow:"unset"})),Object(go.i)("hide <=> show",Object(go.e)("200ms ease-in"))])]}}),e})()},{path:"search",data:{pageTitle:"Search"},children:[{path:"",pathMatch:"full",redirectTo:"0/"},{path:":searchObject/:search",pathMatch:"full",component:Ks},{path:":searchObject/:search",loadChildren:()=>Promise.resolve().then(i.bind(null,"e1St")).then(e=>e.HubBaseModule)}]},{path:"",children:Eo},{path:"",children:Io},{path:"",children:Fo},{path:"",children:qo},{path:"",children:Lo},{path:"",children:Po},{path:"",children:jo},{path:"",children:Ao},{path:"",children:Mo},{path:"",children:Ro},{path:"",children:Zo},{path:"",children:_o},{path:"",children:Ho},{path:"",children:Uo},{path:"",children:Vo},{path:"",children:Bo}]);var Wo=i("mCXf");let Go=(()=>{class e{static forRoot(){return{ngModule:e,providers:[o.a,on.a]}}}return e.\u0275mod=h.Ib({type:e}),e.\u0275inj=h.Hb({factory:function(t){return new(t||e)},providers:[on.a],imports:[[n.a,zo,a.C,Es.a,Wo.a,Vs]]}),e})()},mCXf:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i("PCNd"),n=i("RRRx"),s=i("fXoL");let o=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[a.a,n.a]]}),e})()},wTS4:function(e,t,i){"use strict";i.d(t,"a",(function(){return O})),i.d(t,"b",(function(){return pe}));var a=i("4Y1E"),n=i("2Vo4"),s=i("itXk"),o=i("3WyZ"),c=i("soiQ"),r=i("fXoL"),l=i("tyNb"),b=i("Wumg"),h=i("H3K+"),u=i("3Pt+"),d=i("ofXK"),m=i("Npcx");function f(e,t){if(1&e){const e=r.Pb();r.Ob(0,"div",9),r.Ob(1,"div",10),r.Ob(2,"dexih-button-refresh",11),r.Vb("click",(function(){return r.vc(e),r.Zb().refresh()})),r.Nb(),r.Ob(3,"input",12),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb().rows=t})),r.Nb(),r.Nb(),r.Ob(4,"div",13),r.Ob(5,"form-select",14),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb().auditType=t})),r.Nb(),r.Nb(),r.Nb()}if(2&e){const e=r.Zb();r.yb(3),r.hc("ngModel",e.rows),r.yb(2),r.hc("ngModel",e.auditType)("border",!1)("items",e.auditTypes)("enableTextEntry",!1)("allowNullSelect",!0)}}function p(e,t){if(1&e){const e=r.Pb();r.Ob(0,"div",16),r.Ob(1,"form-tags-dropdown",17),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb(2).datalinks=t})),r.Nb(),r.Nb()}if(2&e){const e=r.Zb(2);r.yb(1),r.hc("ngModel",e.datalinks)("items",e.hubCache.hub.dexihDatalinks)("enableAddAll",!0)}}function g(e,t){if(1&e){const e=r.Pb();r.Ob(0,"div",16),r.Ob(1,"form-tags-dropdown",18),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb(2).datajobs=t})),r.Nb(),r.Nb()}if(2&e){const e=r.Zb(2);r.yb(1),r.hc("ngModel",e.datajobs)("items",e.hubCache.hub.dexihDatajobs)("enableAddAll",!0)}}function v(e,t){if(1&e){const e=r.Pb();r.Ob(0,"div",16),r.Ob(1,"form-tags-dropdown",19),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb(2).datalinkTests=t})),r.Nb(),r.Nb()}if(2&e){const e=r.Zb(2);r.yb(1),r.hc("ngModel",e.datalinkTests)("items",e.hubCache.hub.dexihDatalinkTests)("enableAddAll",!0)}}function y(e,t){if(1&e&&(r.Dc(0,p,2,3,"div",15),r.Dc(1,g,2,3,"div",15),r.Dc(2,v,2,3,"div",15)),2&e){const e=r.Zb();r.hc("ngIf","Datalink"===e.auditType),r.yb(1),r.hc("ngIf","Datajob"===e.auditType),r.yb(1),r.hc("ngIf","DatalinkTest"===e.auditType)}}const C=function(e,t){return[e,"datalink-edit","edit",t]},w=function(e,t){return["result-view",e,t]};function S(e,t){if(1&e&&(r.Lb(0,"dexih-button-edit",20),r.Lb(1,"dexih-button-view",21)),2&e){const e=t.item,i=r.Zb();r.hc("routerLink",r.nc(2,C,i.hubPath,e.referenceKey)),r.yb(1),r.hc("routerLink",r.nc(5,w,e.auditConnectionKey,e.auditKey))}}function k(e,t){1&e&&r.Lb(0,"datalink-status",22),2&e&&r.hc("writerResult",t.item)}let O=(()=>{class e{constructor(e,t,i){this.hubService=e,this.router=t,this.route=i,this.rows=20,this.cancelToken=new o.a,this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"auditKey",title:"#",format:""},{name:"auditType",title:"Type",format:""},{name:"referenceName",title:"Name",format:""},{name:"rowsTotal",title:"Rows Total",format:""},{name:"startTime",title:"Start Date",format:"Calendar"},{name:"startTime",title:"Time",format:"Time"},{name:"endTime",title:"Finished At",format:"Time"},{name:"message",title:"Message",format:""}],this.auditTypes=["Datalink","Datajob","DatalinkTest"],this._tableData=new n.a(null),this.tableData=this._tableData.asObservable(),this.datalinks=[],this.datajobs=[],this.datalinkTests=[],this.auditType=null}ngOnInit(){try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe(e=>{let t=e[2];this.hubCache=e[3];let i=e[4];if(this.showPage=!1,this.showPageMessage="Waiting for an active remote agent...",this.hubCache.isLoaded()&&i){this.hubPath=this.hubCache.getHubUrl();let e=t.datalinkKeys,i=t.datajobKeys,a=t.datalinkTestKeys;e&&(this.datalinks=(e+"").split(",").map(e=>+e),this.auditType="Datalink"),i&&(this.datajobs=(i+"").split(",").map(e=>+e),this.auditType="Datajob"),a&&(this.datalinkTests=(a+"").split(",").map(e=>+e),this.auditType="DatalinkTest"),this.refresh(),this.showPage=!0,this.showPageMessage=""}})}catch(e){this.hubService.addHubClientErrorMessage(e,"Results Index")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}showResult(e){this.router.navigate(["result-view",e.auditConnectionKey,e.auditKey],{relativeTo:this.route})}refresh(){let e,t=[];switch(this.auditType){case"Datalink":e=this.datalinks,t=this.datalinks.map(e=>this.hubCache.hub.dexihDatalinks.find(t=>t.key===e).auditConnectionKey);break;case"Datajob":e=this.datajobs,t=this.datajobs.map(e=>this.hubCache.hub.dexihDatajobs.find(t=>t.key===e).auditConnectionKey);break;case"DatalinkTest":e=this.datalinkTests,t=this.datalinkTests.map(e=>this.hubCache.hub.dexihDatalinkTests.find(t=>t.key===e).auditConnectionKey);break;default:e=null}let i=t.filter((function(e,t,i){return i.indexOf(e)===t}));0===i.length&&(i=this.hubCache.hub.dexihConnections.filter(e=>e.purpose===c.jb.Managed).map(e=>e.key)),this.hubService.getAuditResults(this.auditType,i,e,!0,this.rows,this.cancelToken).then(e=>{this._tableData.next(e),this.watchChanges()})}watchChanges(){this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe(e=>{let t=this._tableData.value;if(this.datalinks&&this.datalinks.findIndex(t=>t===e.referenceKey)>=0){let i=t.find(t=>t.auditKey===e.auditKey);i?(Object.assign(i,e),this._tableData.next(t)):this._tableData.next([e].concat(t))}if(this.datajobs&&this.datajobs.findIndex(t=>t===e.referenceKey)>=0){let i=t.find(t=>t.auditKey===e.auditKey);i?(Object.assign(i,e),this._tableData.next(t)):this._tableData.next([e].concat(t))}if(this.datalinkTests&&this.datalinkTests.findIndex(t=>t===e.referenceKey)>=0){let i=t.find(t=>t.auditKey===e.auditKey);i?(Object.assign(i,e),this._tableData.next(t)):this._tableData.next([e].concat(t))}})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(l.e),r.Kb(l.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["results-index"]],decls:11,vars:6,consts:[[1,"container-fluid"],["title","Execution Results","iconClass","fa fa-lg fa-fw fa-exchange"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","enableSaveCsv","rowClick"],["actions",""],["tableHeader",""],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],[1,"d-flex","flex-wrap"],[1,"input-group"],["text","Reload",1,"input-group-prepend",3,"click"],["type","number","placeholder","Maximum rows...","title","Specify the maximum rows to return",1,"form-control",2,"width","100%","max-width","100px",3,"ngModel","ngModelChange"],[1,"flex-fill","ml-1"],["labelLeft","Type","selectNullMessage","All types",1,"form-control","p-0",3,"ngModel","border","items","enableTextEntry","allowNullSelect","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[1,"d-flex","flex-wrap","pt-1"],["labelLeft","Datalinks","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","Datajobs","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","DatalinkTests","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["text","Edit Datalink",1,"mr-1",3,"routerLink"],["queryParamsHandling","merge",3,"routerLink"],[3,"writerResult"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Ob(1,"dexih-widget",1),r.Ob(2,"dexih-table",2),r.Vb("rowClick",(function(e){return t.showResult(e)})),r.Dc(3,f,6,6,"ng-template",null,3,r.Ec),r.Dc(5,y,3,3,"ng-template",null,4,r.Ec),r.Dc(7,S,2,8,"ng-template",5,6,r.Ec),r.Dc(9,k,1,1,"ng-template",7,8,r.Ec),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.yb(2),r.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("enableSaveCsv",!0))},directives:[b.P,h.a,b.s,u.y,u.c,u.s,u.v,b.E,d.t,b.G,b.j,l.f,b.y,m.a],encapsulation:2}),e})();var N=i("ElCs"),T=i("zQsl");const D=function(e){return["progress-bar",e]},x=function(e){return{width:e}};let F=(()=>{class e{constructor(){this.percent="0%"}ngOnInit(){if(0===this.value)this.percent="0%";else if(0===this.total)this.percent="100%";else{let e=100*this.value/this.total;e<0&&(e=0),e>100&&(e=100),this.percent=e.toString()+"%"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Eb({type:e,selectors:[["result-progress"]],inputs:{value:"value",total:"total",caption:"caption",color:"color"},decls:8,vars:9,consts:[[1,""],[1,"text"],[1,"float-right"],[1,"progress",2,"width","100%"],[3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Ob(1,"span",1),r.Fc(2),r.Ob(3,"span",2),r.Fc(4),r.Nb(),r.Nb(),r.Ob(5,"div",3),r.Ob(6,"div",4),r.Fc(7,"\xa0"),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.yb(2),r.Hc(" ",t.caption," "),r.yb(2),r.Ic("",t.value,"/",t.total,""),r.yb(2),r.hc("ngClass",r.mc(5,D,t.color))("ngStyle",r.mc(7,x,t.percent)))},directives:[d.q,d.w],encapsulation:2}),e})();var I=i("WrAK");function K(e,t){1&e&&(r.Ob(0,"li",27),r.Ob(1,"h5"),r.Fc(2,"Error encountered!"),r.Nb(),r.Nb())}function E(e,t){1&e&&(r.Ob(0,"li",28),r.Ob(1,"h5"),r.Fc(2,"Finished Successfully"),r.Nb(),r.Nb())}function V(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button",33),r.Vb("click",(function(){r.vc(e);const t=r.Zb(2);return t.exceptionHidden=!t.exceptionHidden})),r.Fc(1,"Details"),r.Nb()}}function L(e,t){if(1&e&&(r.Ob(0,"pre"),r.Fc(1),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.Gc(e.auditResult.exceptionDetails)}}function P(e,t){if(1&e&&(r.Ob(0,"li",5),r.Ob(1,"div",29),r.Fc(2),r.Ob(3,"div",30),r.Dc(4,V,2,0,"dexih-button",31),r.Nb(),r.Nb(),r.Ob(5,"div"),r.Dc(6,L,2,1,"pre",32),r.Nb(),r.Nb()),2&e){const e=r.Zb();r.yb(2),r.Hc(" ",e.auditResult.message," "),r.yb(2),r.hc("ngIf",e.auditResult.exceptionDetails),r.yb(2),r.hc("ngIf",!e.exceptionHidden&&e.auditResult.exceptionDetails)}}function j(e,t){if(1&e&&(r.Ob(0,"div",9),r.Fc(1,"Target Table"),r.Nb(),r.Ob(2,"div",9),r.Fc(3),r.Nb(),r.Lb(4,"div",10)),2&e){const e=r.Zb();r.yb(3),r.Gc(e.auditResult.targetTableName)}}function A(e,t){if(1&e&&(r.Ob(0,"div",9),r.Fc(1,"Scheduled Time"),r.Nb(),r.Ob(2,"div",9),r.Fc(3),r.ac(4,"calendar"),r.Nb(),r.Lb(5,"div",10)),2&e){const e=r.Zb();r.yb(3),r.Gc(r.bc(4,1,e.auditResult.scheduledTime))}}function M(e,t){1&e&&(r.Ob(0,"li",13),r.Ob(1,"h5"),r.Fc(2,"Child Results"),r.Nb(),r.Nb())}function R(e,t){if(1&e&&(r.Ob(0,"div"),r.Ob(1,"div",35),r.Ob(2,"span",36),r.Fc(3),r.Nb(),r.Lb(4,"datalink-status",37),r.Nb(),r.Nb()),2&e){const e=t.$implicit;r.yb(3),r.Hc(" ","Table"===e.auditType?e.targetTableName:e.referenceName," "),r.yb(1),r.hc("writerResult",e)}}function Z(e,t){if(1&e&&(r.Ob(0,"li",5),r.Dc(1,R,5,2,"div",34),r.Nb()),2&e){const e=r.Zb();r.yb(1),r.hc("ngForOf",e.auditResult.childResults)}}function _(e,t){if(1&e&&r.Lb(0,"result-progress",38),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsReadPrimary)("total",e.auditResult.rowsReadPrimary+e.auditResult.rowsReadReference)}}function H(e,t){if(1&e&&r.Lb(0,"result-progress",39),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsReadReference)("total",e.auditResult.rowsReadPrimary+e.auditResult.rowsReadReference)}}function B(e,t){if(1&e&&r.Lb(0,"result-progress",40),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsCreated)("total",e.auditResult.rowsTotal)}}function U(e,t){if(1&e&&r.Lb(0,"result-progress",41),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsUpdated)("total",e.auditResult.rowsTotal)}}function q(e,t){if(1&e&&r.Lb(0,"result-progress",42),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsDeleted)("total",e.auditResult.rowsTotal)}}function z(e,t){if(1&e&&r.Lb(0,"result-progress",43),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsRejected)("total",e.auditResult.rowsTotal)}}function W(e,t){if(1&e&&r.Lb(0,"result-progress",44),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsPreserved)("total",e.auditResult.rowsTotal)}}function G(e,t){if(1&e&&r.Lb(0,"result-progress",45),2&e){const e=r.Zb();r.hc("value",e.auditResult.rowsIgnored)("total",e.auditResult.rowsTotal)}}function Q(e,t){if(1&e&&r.Lb(0,"result-progress",46),2&e){const e=r.Zb();r.hc("value",e.auditResult.passed)("total",e.auditResult.rowsTotal)}}function $(e,t){if(1&e&&r.Lb(0,"result-progress",47),2&e){const e=r.Zb();r.hc("value",e.auditResult.failed)("total",e.auditResult.rowsTotal)}}function X(e,t){if(1&e&&(r.Ob(0,"div",9),r.Fc(1),r.Nb(),r.Ob(2,"div",9),r.Fc(3),r.ac(4,"number"),r.Nb(),r.Lb(5,"div",10)),2&e){const e=t.$implicit;r.yb(1),r.Gc(e.transformName),r.yb(2),r.Hc("",0==e.seconds?"N/A":r.cc(4,2,e.rows/e.seconds,"1.2-2")," rows/second")}}let Y=(()=>{class e{constructor(e,t){this.route=e,this.router=t,this.exceptionHidden=!0,this.fail=!1,this.success=!1,this.eRunStatus=c.Yb,this.eTriggerMethod=c.oc}ngOnInit(){switch(this.runTime=this.auditResult.endTime?(new Date(this.auditResult.endTime).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:this.auditResult.runStatus===c.Yb.Running||this.auditResult.runStatus===c.Yb.RunningErrors||this.auditResult.runStatus===c.Yb.Started?((new Date).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:null,this.auditResult.runStatus){case c.Yb.Abended:case c.Yb.Cancelled:case c.Yb.Failed:case c.Yb.FinishedErrors:this.fail=!0;break;case c.Yb.Finished:case c.Yb.Passed:this.success=!0}this.barChartData=[{name:"Reading",value:this.rowsPerSecond(this.auditResult.rowsReadPrimary+this.auditResult.rowsReadReference,this.auditResult.readTicks)},{name:"Processing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.processingTicks)},{name:"Writing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.writeTicks)}]}numberWithCommas(e){const t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}rowsPerSecond(e,t){return 0===t?0:e/(t/1e7)}openResult(e){this.router.navigate(["..",e],{relativeTo:this.route})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(l.a),r.Kb(l.e))},e.\u0275cmp=r.Eb({type:e,selectors:[["stats"]],inputs:{auditResult:"auditResult"},decls:75,vars:44,consts:[[1,"list-group"],["class","list-group-item list-group-item-danger",4,"ngIf"],["class","list-group-item list-group-item-success",4,"ngIf"],["class","list-group-item",4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],[1,"container"],[1,"row","rounded","text-white","bg-secondary"],[3,"ngIf"],[1,"col","border","border-white"],[1,"w-100"],["class","list-group-item list-group-item-info",4,"ngIf"],["class","list-group-item ",4,"ngIf"],[1,"list-group-item","list-group-item-info"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total",4,"ngIf"],["caption","Created","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Updated","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Deleted","color","bg-color-magenta",3,"value","total",4,"ngIf"],["caption","Rejected","color","bg-color-red",3,"value","total",4,"ngIf"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total",4,"ngIf"],["caption","Ignored","color","bg-color-grayDark",3,"value","total",4,"ngIf"],["caption","Passed","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Failed","color","bg-color-magenta",3,"value","total",4,"ngIf"],["ngFor","",3,"ngForOf"],[2,"display","grid"],["scheme","natural","yAxisLabel","rows/second","xAxisLabel","operation",3,"results","gradient","xAxis","yAxis","legend","showGridLines","showXAxisLabel","showYAxisLabel"],[1,"list-group-item","list-group-item-danger"],[1,"list-group-item","list-group-item-success"],[1,"d-flex","mb-2"],[1,"ml-auto"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],[4,"ngFor","ngForOf"],[1,""],[1,"text"],[3,"writerResult"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total"],["caption","Created","color","bg-color-greenDark",3,"value","total"],["caption","Updated","color","bg-color-blueDark",3,"value","total"],["caption","Deleted","color","bg-color-magenta",3,"value","total"],["caption","Rejected","color","bg-color-red",3,"value","total"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total"],["caption","Ignored","color","bg-color-grayDark",3,"value","total"],["caption","Passed","color","bg-color-greenDark",3,"value","total"],["caption","Failed","color","bg-color-magenta",3,"value","total"]],template:function(e,t){1&e&&(r.Ob(0,"ul",0),r.Dc(1,K,3,0,"li",1),r.Dc(2,E,3,0,"li",2),r.Dc(3,P,7,3,"li",3),r.Ob(4,"li",4),r.Ob(5,"h5"),r.Fc(6,"Running Time"),r.Nb(),r.Nb(),r.Ob(7,"li",5),r.Ob(8,"div",6),r.Ob(9,"div",7),r.Dc(10,j,5,1,"ng-template",8),r.Ob(11,"div",9),r.Fc(12,"Run Status"),r.Nb(),r.Ob(13,"div",9),r.Fc(14),r.Nb(),r.Lb(15,"div",10),r.Ob(16,"div",9),r.Fc(17,"Start Date"),r.Nb(),r.Ob(18,"div",9),r.Fc(19),r.ac(20,"calendar"),r.Nb(),r.Lb(21,"div",10),r.Dc(22,A,6,3,"ng-template",8),r.Ob(23,"div",9),r.Fc(24,"Initialized"),r.Nb(),r.Ob(25,"div",9),r.Fc(26),r.ac(27,"calendar"),r.Nb(),r.Lb(28,"div",10),r.Ob(29,"div",9),r.Fc(30,"Started"),r.Nb(),r.Ob(31,"div",9),r.Fc(32),r.ac(33,"calendar"),r.Nb(),r.Lb(34,"div",10),r.Ob(35,"div",9),r.Fc(36,"Finished"),r.Nb(),r.Ob(37,"div",9),r.Fc(38),r.ac(39,"calendar"),r.Nb(),r.Lb(40,"div",10),r.Ob(41,"div",9),r.Fc(42,"Run Time"),r.Nb(),r.Ob(43,"div",9),r.Fc(44),r.ac(45,"number"),r.Nb(),r.Lb(46,"div",10),r.Ob(47,"div",9),r.Fc(48,"Triggered By"),r.Nb(),r.Ob(49,"div",9),r.Fc(50),r.Nb(),r.Nb(),r.Nb(),r.Nb(),r.Dc(51,M,3,0,"li",11),r.Dc(52,Z,2,1,"li",12),r.Ob(53,"li",13),r.Ob(54,"h5"),r.Fc(55,"Row Distribution"),r.Nb(),r.Nb(),r.Ob(56,"li",5),r.Dc(57,_,1,2,"result-progress",14),r.Dc(58,H,1,2,"result-progress",15),r.Dc(59,B,1,2,"result-progress",16),r.Dc(60,U,1,2,"result-progress",17),r.Dc(61,q,1,2,"result-progress",18),r.Dc(62,z,1,2,"result-progress",19),r.Dc(63,W,1,2,"result-progress",20),r.Dc(64,G,1,2,"result-progress",21),r.Dc(65,Q,1,2,"result-progress",22),r.Dc(66,$,1,2,"result-progress",23),r.Nb(),r.Ob(67,"li",13),r.Ob(68,"h5"),r.Fc(69,"Performance Estimates (rows/second)"),r.Nb(),r.Nb(),r.Ob(70,"li",5),r.Ob(71,"div",7),r.Dc(72,X,6,5,"ng-template",24),r.Nb(),r.Ob(73,"div",25),r.Lb(74,"ngx-charts-bar-vertical",26),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.yb(1),r.hc("ngIf",t.fail),r.yb(1),r.hc("ngIf",t.success),r.yb(1),r.hc("ngIf",null==t.auditResult?null:t.auditResult.message),r.yb(7),r.hc("ngIf",t.auditResult.targetTableName),r.yb(4),r.Gc(t.eRunStatus[t.auditResult.runStatus]),r.yb(5),r.Gc(r.bc(20,33,t.auditResult.initializeTime)),r.yb(3),r.hc("ngIf",t.auditResult.scheduledTime),r.yb(4),r.Gc(r.bc(27,35,t.auditResult.initializeTime)),r.yb(6),r.Gc(r.bc(33,37,t.auditResult.startTime)),r.yb(6),r.Gc(r.bc(39,39,t.auditResult.endTime)),r.yb(6),r.Hc("",r.cc(45,41,t.runTime,"1.2-2")," seconds"),r.yb(6),r.Gc(t.eTriggerMethod[t.auditResult.triggerMethod]),r.yb(1),r.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),r.yb(1),r.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),r.yb(5),r.hc("ngIf",t.auditResult.rowsReadPrimary>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsReadReference>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsCreated>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsUpdated>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsDeleted>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsRejected>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsPreserved>0),r.yb(1),r.hc("ngIf",t.auditResult.rowsIgnored>0),r.yb(1),r.hc("ngIf",t.auditResult.passed>0),r.yb(1),r.hc("ngIf",t.auditResult.failed>0),r.yb(6),r.hc("ngForOf",t.auditResult.performanceSummary),r.yb(2),r.hc("results",t.barChartData)("gradient",!0)("xAxis",!0)("yAxis",!0)("legend",!1)("showGridLines",!0)("showXAxisLabel",!0)("showYAxisLabel",!0))},directives:[d.t,d.s,T.p,b.f,m.a,F],pipes:[I.a,d.g],encapsulation:2}),e})();function J(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button-refresh",2),r.Vb("click",(function(){return r.vc(e),r.Zb().refresh()})),r.Nb(),r.Ob(1,"dexih-button-download",3),r.Vb("click",(function(){return r.vc(e),r.Zb().download()})),r.Nb(),r.Ob(2,"div",4),r.Ob(3,"div",5),r.Ob(4,"form-checkbox",6),r.Vb("ngModelChange",(function(t){return r.vc(e),r.Zb().showDetailed=t}))("change",(function(){return r.vc(e),r.Zb().refresh()})),r.Nb(),r.Nb(),r.Nb()}if(2&e){const e=r.Zb();r.yb(4),r.hc("ngModel",e.showDetailed)("border",!0)}}let ee=(()=>{class e{constructor(e,t){this.authService=e,this.hubService=t,this.showDetailed=!1,this.cancelToken=new o.a}ngOnInit(){this.refresh()}ngOnDestroy(){this.cancelToken.cancel()}refresh(){this.hubService.previewProfileData(this.auditResult,!this.showDetailed,this.cancelToken).then(e=>{this.columns=e.columns,this.data=e.data}).catch(e=>{})}download(){this.hubService.downloadProfileData(this.auditResult,this.cancelToken)}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(N.a),r.Kb(a.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["profile-results"]],inputs:{auditResult:"auditResult"},decls:3,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[1,"d-flex","flex-wrap"],[1,"flex-fill","pl-1"],["label","Show Detailed Results",3,"ngModel","border","ngModelChange","change"]],template:function(e,t){1&e&&(r.Ob(0,"dexih-table",0),r.Dc(1,J,5,2,"ng-template",null,1,r.Ec),r.Nb()),2&e&&r.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[h.a,b.s,b.h,b.A,u.s,u.v],encapsulation:2}),e})();var te=i("XNiG"),ie=i("RXlv");function ae(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-button-refresh",3),r.Vb("click",(function(){return r.vc(e),r.Zb().refresh()})),r.Nb(),r.Ob(1,"dexih-button-download",4),r.Vb("click",(function(){return r.vc(e),r.Zb().download()})),r.Nb()}}function ne(e,t){if(1&e){const e=r.Pb();r.Ob(0,"query-builder",5),r.Vb("onRefreshData",(function(){return r.vc(e),r.Zb().refresh()})),r.Nb()}if(2&e){const e=r.Zb();r.hc("selectQuery",e.selectQuery)("columns",e.targetTable.dexihTableColumns)("inputColumns",e.inputColumns)("refreshEvent",e.refreshDataSubject.asObservable())}}let se=(()=>{class e{constructor(e){this.hubService=e,this.selectQuery=new c.V,this.refreshDataSubject=new te.a,this.cancelToken=new o.a}ngOnInit(){this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe(e=>{switch(this.cache=e,this.auditResult.auditType){case"Table":this.targetTable=this.cache.getTable(this.auditResult.referenceKey),this.refresh();break;case"Datalink":case"DatalinkStep":let e=this.cache.hub.dexihDatalinks.find(e=>e.key===this.auditResult.referenceKey);if(!e)return void this.hubService.addHubErrorMessage(`The datalink with the key ${this.auditResult.referenceKey} cannot be found.`);if(!(e.dexihDatalinkTargets.length>=1))return void this.hubService.addHubErrorMessage("There is no target table for this datalink.");this.targetTable=this.cache.getTable(e.dexihDatalinkTargets[0].tableKey),this.refresh();break;case"DatalinkTestStep":let t=this.cache.getDatalinkTestStep(this.auditResult.referenceKey);if(!t)return void this.hubService.addHubErrorMessage(`The test step with the key ${this.auditResult.referenceKey} cannot be found.`);let i=this.cache.hub.dexihDatalinks.find(e=>e.key===t.datalinkKey);if(!(i.dexihDatalinkTargets.length>=1))return void this.hubService.addHubErrorMessage("There is no target table for this datalink.");{let e=this.cache.getTable(i.dexihDatalinkTargets[0].tableKey),a=JSON.parse(JSON.stringify(e));a.name=t.errorTableName,a.schema=t.errorSchema,a.connectionKey=t.errorConnectionKey;for(let t of a.dexihTableColumns)t.deltaType=c.qb.NonTrackingField;let n=new c.I;n.name="error_audit_key",n.dataType=c.pc.Int64,n.deltaType=c.qb.CreateAuditKey;let s=new c.I;s.name="error_operation",s.dataType=c.pc.CharArray,s.maxLength=1,s.deltaType=c.qb.DatabaseOperation;let o=new c.I;o.name="mismatch_reason",o.dataType=c.pc.String,o.deltaType=c.qb.UpdateReason,a.dexihTableColumns.push(n),a.dexihTableColumns.push(s),a.dexihTableColumns.push(o),this.targetTable=a}this.refresh()}})}ngOnDestroy(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this.runningQuery&&this.runningQuery.cancel(),this.cancelToken.cancel()}createSelectQuery(){const e=this.targetTable.dexihTableColumns.find(e=>e.deltaType===c.qb.CreateAuditKey),t=this.targetTable.dexihTableColumns.find(e=>e.deltaType===c.qb.UpdateAuditKey);if(!e&&!t)return void this.hubService.addHubErrorMessage(`The table ${this.targetTable.name} does not contain a create or update audit column which is required to connect to an audit.`);let i=JSON.parse(JSON.stringify(this.selectQuery));if(e){let t=new c.N;t.column1=new c.X,Object.assign(t.column1,e),t.operator=c.hb.IsEqual,t.value2=this.auditResult.auditKey,t.andOr=c.cb.Or,t.compareDataType=c.pc.Int64,i.filters.push(t)}if(t){let e=new c.N;e.column1=new c.X,Object.assign(e.column1,t),e.operator=c.hb.IsEqual,e.value2=this.auditResult.auditKey,e.andOr=c.cb.Or,e.compareDataType=c.pc.Int64,i.filters.push(e)}return i.rows=100,i}refresh(){let e=this.createSelectQuery(),t=this.hubService.previewTableDataQuery(this.targetTable,!1,e,null,null,this.cancelToken);t.then(e=>{this.refreshDataSubject.next(),this.columns=e.columns,this.data=e.data}).catch(()=>{}),this.runningQuery=t}download(){let e=this.createSelectQuery(),t=new c.M;t.objectKey=this.targetTable.key,t.objectType=c.lb.Table,t.query=e,this.hubService.downloadData([t],!1,c.rb.Csv,this.cancelToken)}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["preview-results"]],inputs:{auditResult:"auditResult"},decls:5,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["tableHeader",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[3,"selectQuery","columns","inputColumns","refreshEvent","onRefreshData"]],template:function(e,t){1&e&&(r.Ob(0,"dexih-table",0),r.Dc(1,ae,2,0,"ng-template",null,1,r.Ec),r.Dc(3,ne,1,4,"ng-template",null,2,r.Ec),r.Nb()),2&e&&r.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[h.a,b.s,b.h,ie.a],encapsulation:2}),e})();const oe=function(){return{view:"Profile"}};function ce(e,t){if(1&e&&(r.Ob(0,"li",7),r.Ob(1,"a",8),r.Lb(2,"i",12),r.Ob(3,"span",10),r.Fc(4,"Profile Data"),r.Nb(),r.Nb(),r.Nb()),2&e){const e=r.Zb(3);r.yb(1),r.Cb("active","Profile"==e.view),r.hc("queryParams",r.lc(3,oe))}}const re=function(){return{view:"Preview"}};function le(e,t){if(1&e&&(r.Ob(0,"li",7),r.Ob(1,"a",8),r.Lb(2,"i",13),r.Ob(3,"span",10),r.Fc(4,"Preview"),r.Nb(),r.Nb(),r.Nb()),2&e){const e=r.Zb(3);r.yb(1),r.Cb("active","Preview"==e.view),r.hc("queryParams",r.lc(3,re))}}const be=function(){return{view:"Stats"}};function he(e,t){if(1&e&&(r.Ob(0,"ul",6),r.Ob(1,"li",7),r.Ob(2,"a",8),r.Lb(3,"i",9),r.Ob(4,"span",10),r.Fc(5,"Execution Stats"),r.Nb(),r.Nb(),r.Nb(),r.Dc(6,ce,5,4,"li",11),r.Dc(7,le,5,4,"li",11),r.Nb()),2&e){const e=r.Zb(2);r.yb(2),r.Cb("active","Stats"==e.view),r.hc("queryParams",r.lc(5,be)),r.yb(4),r.hc("ngIf",e.auditResult.profileTableName&&("DatalinkStep"==(null==e.auditResult?null:e.auditResult.auditType)||"Datalink"==(null==e.auditResult?null:e.auditResult.auditType))),r.yb(1),r.hc("ngIf","DatalinkStep"==(null==e.auditResult?null:e.auditResult.auditType)||"Datalink"==(null==e.auditResult?null:e.auditResult.auditType)||"Table"==(null==e.auditResult?null:e.auditResult.auditType)||"DatalinkTestStep"==(null==e.auditResult?null:e.auditResult.auditType))}}function ue(e,t){if(1&e&&(r.Ob(0,"div"),r.Lb(1,"stats",14),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.hc("auditResult",e.auditResult)}}function de(e,t){if(1&e&&(r.Ob(0,"div"),r.Lb(1,"profile-results",14),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.hc("auditResult",e.auditResult)}}function me(e,t){if(1&e&&(r.Ob(0,"div"),r.Lb(1,"preview-results",14),r.Nb()),2&e){const e=r.Zb(2);r.yb(1),r.hc("auditResult",e.auditResult)}}function fe(e,t){if(1&e){const e=r.Pb();r.Ob(0,"dexih-widget",2),r.Vb("close",(function(){return r.vc(e),r.Zb().close()})),r.Dc(1,he,8,6,"ng-template",null,3,r.Ec),r.Ob(3,"div",4),r.Dc(4,ue,2,1,"div",5),r.Dc(5,de,2,1,"div",5),r.Dc(6,me,2,1,"div",5),r.Nb(),r.Nb()}if(2&e){const e=r.Zb();r.hc("title",null==e.auditResult?null:e.auditResult.referenceName)("showCloseButton",!0),r.yb(3),r.hc("ngSwitch",e.view),r.yb(1),r.hc("ngSwitchCase","Stats"),r.yb(1),r.hc("ngSwitchCase","Profile"),r.yb(1),r.hc("ngSwitchCase","Preview")}}let pe=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new o.a}ngOnInit(){this.watchChanges();try{this._subscription=Object(s.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteAgentObservable(!0)).subscribe(e=>{let t=e[1],i=e[2];this.hubCache=e[3];let a=e[4],n=+t.auditConnectionKey,s=+t.auditKey;this.showPage=!1,this.showPageMessage="Waiting for an active remote agent...",this.view=i.view,this.view||(this.view="Stats"),a&&(this.showPage=!0,this.showPageMessage="",this.hubService.getResultDetail(n,s,this.cancelToken).then(e=>{this.auditResult=e[0]}))})}catch(e){this.hubService.addHubClientErrorMessage(e,"Results View")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}watchChanges(){this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe(e=>{this.auditResult&&e.auditConnectionKey===this.auditResult.auditConnectionKey&&e.auditKey===this.auditResult.auditKey&&(this.auditResult=e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(N.a),r.Kb(l.e),r.Kb(l.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["results-view"]],decls:2,vars:1,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close"],["header",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"nav","nav-tabs","card-header-tabs"],[1,"nav-item"],["routerLink",".",1,"nav-link",3,"queryParams"],[1,"fa","fa-clock-o"],[1,"ml-1","d-none","d-md-inline"],["class","nav-item",4,"ngIf"],[1,"fa","fa-tachometer"],[1,"fa","fa-table"],[3,"auditResult"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Dc(1,fe,7,6,"dexih-widget",1),r.Nb()),2&e&&(r.yb(1),r.hc("ngIf",t.auditResult))},directives:[d.t,b.P,d.x,d.y,l.h,Y,ee,se],encapsulation:2}),e})()},ynzd:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var a=i("4Y1E"),n=i("ElCs"),s=i("2Vo4"),o=i("itXk"),c=i("soiQ"),r=i("fXoL"),l=i("tyNb"),b=i("Wumg"),h=i("H3K+"),u=i("/pur"),d=i("mWX8"),m=i("VdXI"),f=i("axB7");function p(e,t){if(1&e&&r.Lb(0,"tags-update-button",9),2&e){const e=t.items,i=r.Zb();r.hc("objectType",i.eSharedObjectType.View)("objects",e)}}function g(e,t){if(1&e&&r.Lb(0,"dependent-items-button",10),2&e){const e=t.item,i=r.Zb();r.hc("key",e.key)("objectType",i.eSharedObjectType.View)}}function v(e,t){1&e&&r.Lb(0,"actions-view-button",11),2&e&&r.hc("views",t.items)}let y=(()=>{class e{constructor(e,t,i,a){this.hubService=e,this.authService=t,this.router=i,this.route=a,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"viewType",title:"Chart/Table"},{name:"sourceName",title:"Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.watchChanges();try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe(e=>{this.hubCache=e[2],this.updateViews()})}catch(e){this.hubService.addHubClientErrorMessage(e,"View Index")}}ngOnDestroy(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}deleteViews(e){this.hubService.deleteViews(e)}updateViews(){if(this.hubCache&&this.hubCache.isLoaded()){let e;e=this.hubCache.hub.dexihViews.filter(e=>e.isValid);let t=e.map(e=>{let t="";switch(e.sourceType){case c.lb.Table:let i=this.hubCache.getTable(e.sourceTableKey);t=i?i.logicalName:"Error, not found";break;case c.lb.Datalink:let a=this.hubCache.hub.dexihDatalinks.find(t=>t.key===e.sourceDatalinkKey);t=a?"Datalink: "+a.name:"Error, not found"}return{key:e.key,name:e.name,tags:this.hubCache.getObjectTags(c.dc.View,e.key),viewType:c.rc[e.viewType],sourceName:t,updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"}});this._tableData.next(t)}else this._tableData.next(null)}editView(e){this.router.navigate(["view-edit",e.key],{relativeTo:this.route})}export(e){const t=this.hubCache,i=this.hubService.createHub(t.hub.hubKey,"");e.forEach(e=>{t.cacheAddView(e.key,i)}),this.hubService.exportHub(i,1===e.length?"View - "+e[0].name+".json":"views.json")}watchChanges(){this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe(e=>{e.changeClass!==c.dc.View&&e.changeClass!==c.dc.TagObjects||this.updateViews()})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(a.a),r.Kb(n.a),r.Kb(l.e),r.Kb(l.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["views"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Views","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"views"]],template:function(e,t){1&e&&(r.Ob(0,"div",0),r.Ob(1,"dexih-widget",1),r.Vb("close",(function(){return t.close()})),r.Ob(2,"dexih-table",2),r.Vb("rowClick",(function(e){return t.editView(e)})),r.Dc(3,p,1,2,"ng-template",3,4,r.Ec),r.Dc(5,g,1,2,"ng-template",5,6,r.Ec),r.Dc(7,v,1,1,"ng-template",null,7,r.Ec),r.Nb(),r.Nb(),r.Lb(9,"dexih-help",8),r.Nb()),2&e&&(r.yb(1),r.hc("showCloseButton",!0),r.yb(1),r.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[b.P,h.a,u.a,d.a,m.a,f.a],encapsulation:2}),e})()}}]);