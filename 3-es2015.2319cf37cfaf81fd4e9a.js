(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{DN8j:function(e,t,o){"use strict";o.r(t),o.d(t,"DashboardEditModule",(function(){return F}));var i=o("cvPx"),s=o("bK5D"),n=o("M0ag"),r=o("ofXK"),a=o("3Pt+"),c=o("LyCD"),l=(o("ynzd"),o("MbvK")),m=o("tyNb"),h=o("XNiG"),u=o("Ljk9"),b=o("soiQ"),d=o("3WyZ"),p=o("fXoL"),f=o("ElCs"),g=o("Xjf6"),w=o("Wumg"),v=o("YcGA"),x=o("NbKI");const C=["gridster"];function y(e,t){if(1&e){const e=p.Pb();p.Ob(0,"form",11),p.Ob(1,"fieldset"),p.Ob(2,"section"),p.Lb(3,"form-input",12),p.Nb(),p.Ob(4,"section"),p.Lb(5,"form-textarea",13),p.Nb(),p.Ob(6,"section"),p.Ob(7,"div",14),p.Ob(8,"section",15),p.Lb(9,"form-input",16),p.Nb(),p.Ob(10,"section",15),p.Lb(11,"form-input",17),p.Nb(),p.Ob(12,"section",15),p.Lb(13,"form-input",18),p.Nb(),p.Ob(14,"section",15),p.Lb(15,"form-input",19),p.Nb(),p.Ob(16,"dexih-button-refresh",20),p.Vb("click",(function(){return p.vc(e),p.Zb(2).updateGrid()})),p.Nb(),p.Nb(),p.Nb(),p.Ob(17,"section"),p.Lb(18,"form-checkbox",21),p.Lb(19,"form-checkbox",22),p.Nb(),p.Nb(),p.Nb()}if(2&e){const e=p.Zb(2);p.hc("formGroup",e.formsService.currentForm),p.yb(3),p.hc("autocapitalize",e.on)("errors",e.formsService.formErrors.name),p.yb(2),p.hc("showMarkdown",!0)}}function I(e,t){if(1&e&&(p.Ob(0,"dexih-widget-section",9),p.Dc(1,y,20,4,"form",10),p.Nb()),2&e){const e=p.Zb();p.hc("showExpandButton",!0),p.yb(1),p.hc("ngIf",e.formsService.currentForm)}}function N(e,t){if(1&e){const e=p.Pb();p.Ob(0,"dexih-widget-section",23),p.Vb("onChange",(function(){return p.vc(e),p.Zb().parameterChange()})),p.Ob(1,"input-parameters",24),p.Vb("onChange",(function(){return p.vc(e),p.Zb().parameterChange()}))("onRefreshData",(function(){return p.vc(e),p.Zb().refresh()})),p.Nb(),p.Nb()}if(2&e){const e=p.Zb();p.hc("showExpandButton",!0),p.yb(1),p.hc("showEdit",e.showEdit)("parameters",e.parameters)("formsService",e.formsService)("refreshEvent",e.refreshDataSubject.asObservable())}}function E(e,t){if(1&e){const e=p.Pb();p.Ob(0,"span",27),p.Ob(1,"div",28),p.Ob(2,"div",29),p.Fc(3),p.Nb(),p.Nb(),p.Ob(4,"form-input",30),p.Vb("ngModelChange",(function(o){return p.vc(e),t.$implicit.value=o})),p.Nb(),p.Nb()}if(2&e){const e=t.$implicit,o=t.index;p.yb(3),p.Hc(" ",e.logicalName," "),p.yb(1),p.jc("name","column",o,""),p.hc("placeholder","Enter "+e.logicalName)("ngModel",e.value)}}function S(e,t){if(1&e&&(p.Ob(0,"dexih-widget-section",25),p.Dc(1,E,5,4,"span",26),p.Nb()),2&e){const e=p.Zb();p.hc("showExpandButton",!0),p.yb(1),p.hc("ngForOf",e.inputColumns)}}const R=function(e,t,o,i,s){return{x:e,y:t,cols:o,rows:i,control:s}};function O(e,t){if(1&e){const e=p.Pb();p.Ob(0,"gridster-item",32),p.Ob(1,"dashboard-item",33),p.Vb("onRemove",(function(){p.vc(e);const o=t.index;return p.Zb(2).removeItem(o)}))("onMaximize",(function(t){return p.vc(e),p.Zb(2).maximize(t)})),p.Nb(),p.Nb()}if(2&e){const e=t.$implicit,o=p.Zb(2);p.hc("item",p.qc(4,R,e.controls.x.value,e.controls.y.value,e.controls.cols.value,e.controls.rows.value,e)),p.yb(1),p.hc("item",e)("showEdit",o.showEdit)("refreshData",e.controls.runTime.value.refreshData)}}function D(e,t){if(1&e&&p.Dc(0,O,2,10,"gridster-item",31),2&e){const e=p.Zb();p.hc("ngForOf",e.dashboardItemControls.controls)}}function M(e,t){if(1&e){const e=p.Pb();p.Ob(0,"div",34),p.Ob(1,"dashboard-item",35),p.Vb("onRemove",(function(){p.vc(e);const t=p.Zb();return t.removeItem(t.i)}))("onMaximize",(function(t){return p.vc(e),p.Zb().maximize(t)})),p.Nb(),p.Nb()}if(2&e){const e=p.Zb();p.yb(1),p.hc("item",e.maximizedItem)("showEdit",e.showEdit)("refreshData",e.maximizedItem.controls.runTime.value.refreshData)("isMaximized",!0)}}const z=function(e){return{"d-none":e}},k=m.i.forChild([{path:"",component:c.a,canDeactivate:[s.a],children:[{path:"",redirectTo:"properties"},{path:"properties",component:(()=>{class e{constructor(e,t,o){this.authService=e,this.hubService=t,this.formsService=o,this.showEdit=!1,this.lock=!0,this.refreshDataSubject=new h.a,this.eViewType=b.rc,this.eSourceType=b.gc,this.cancelToken=new d.a}ngOnInit(){this.options={gridType:u.c.ScrollVertical,compactType:u.a.None,margin:5,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,mobileBreakpoint:640,minCols:12,maxCols:100,minRows:6,maxRows:100,maxItemCols:100,minItemCols:1,maxItemRows:100,minItemRows:1,maxItemArea:2500,minItemArea:1,defaultItemCols:2,defaultItemRows:2,fixedColWidth:105,fixedRowHeight:105,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{enabled:!1},resizable:{enabled:!1},swap:!1,pushItems:!0,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:u.b.None,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,itemChangeCallback:(e,t)=>{this.itemResize(e,t)},itemResizeCallback:(e,t)=>{this.itemResize(e,t)},itemInitCallback:(e,t)=>{this.itemResize(e,t)}},this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe(e=>{e.isLoaded()&&(this.hubCache=e)}),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe(e=>{this.currentForm=e,e&&(this.dashboardItemControls=e.controls.dexihDashboardItems,this.parameters=e.controls.parameters,this.options.minCols=e.controls.minCols.value,this.options.maxCols=e.controls.maxCols.value,this.options.minRows=e.controls.minRows.value,this.options.maxRows=e.controls.maxRows.value,this.showEdit=e.controls.runTime.value.showEdit,this._runTimeSubscription&&this._runTimeSubscription.unsubscribe(),this._runTimeSubscription=e.controls.runTime.valueChanges.subscribe(e=>{this.showEdit=e.showEdit,this.lock=e.lock,this.updateShowEdit()}),this.updateShowEdit())})}ngOnDestroy(){this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._runTimeSubscription&&this._runTimeSubscription.unsubscribe(),this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this.cancelToken.cancel()}getNextPossiblePosition(){return this.gridster.getFirstPossiblePosition({x:0,y:0,cols:1,rows:1,control:null})}updateShowEdit(){this.showEdit||!this.lock?(this.options.displayGrid=u.b.Always,this.options.draggable.enabled=!0,this.options.resizable.enabled=!0):(this.options.displayGrid=u.b.None,this.options.draggable.enabled=!1,this.options.resizable.enabled=!1),this.options=Object.assign({},this.options)}itemResize(e,t){function o(e,t){e.value!==t&&e.setValue(t)}let i=e.control;o(i.controls.x,e.x),o(i.controls.y,e.y),o(i.controls.cols,e.cols),o(i.controls.rows,e.rows),t.width&&e.control.controls.runTime.value.resizeEvent.emit([t.width,t.height])}removeItem(e){this.formsService.currentForm.controls.dexihDashboardItems.removeAt(e)}updateGrid(){let e=this.formsService.currentForm;this.options.minCols=e.controls.minCols.value,this.options.maxCols=e.controls.maxCols.value,this.options.minRows=e.controls.minRows.value,this.options.maxRows=e.controls.maxRows.value,this.options=Object.assign({},this.options)}maximize(e){this.maximizedItem=this.maximizedItem?null:e}parameterChange(){this.formsService.currentForm.controls.autoRefresh.value&&this.refresh()}refresh(){this.hubService.previewDashboard(this.formsService.currentForm.value,this.formsService.currentForm.value.parameters,this.cancelToken).then(e=>{this.refreshDataSubject.next();let t=this.formsService.currentForm.controls.dexihDashboardItems;e.forEach(e=>{let o=t.controls.find(t=>t.controls.key.value===e.dashboardItemKey);if(o){let t=o.controls.runTime.value.data;this.hubService.getRemoteResponse(e.dataKey,this.cancelToken).then(e=>{e.columns=this.authService.constructDataTableColumns(e.columns),e.status&&this.hubService.addHubMessage(e.status,!1,e.name),t.data.next(e)}).catch()}})})}}return e.\u0275fac=function(t){return new(t||e)(p.Kb(f.a),p.Kb(g.a),p.Kb(i.a))},e.\u0275cmp=p.Eb({type:e,selectors:[["dashboard-properties"]],viewQuery:function(e,t){var o;1&e&&p.Bc(C,!0),2&e&&p.rc(o=p.Wb())&&(t.gridster=o.first)},inputs:{showEdit:"showEdit",lock:"lock"},decls:9,vars:9,consts:[[3,"ngClass"],["title","Properties",3,"showExpandButton",4,"ngIf"],["title","Parameters",3,"showExpandButton","onChange",4,"ngIf"],["title","InputColumns",3,"showExpandButton",4,"ngIf"],[2,"height","800px"],[3,"options"],["gridster",""],[3,"ngIf"],["class","position-relative","style","height:800px; overflow: hidden;",4,"ngIf"],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["label","Dashboard Name","formControlName","name","placeholder","Enter the dashboard name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-3"],["type","number","label","Minimum Columns","formControlName","minCols"],["type","number","label","Maximum Columns","formControlName","maxCols"],["type","number","label","Minimum Rows","formControlName","minRows"],["type","number","label","Maximum Rows","formControlName","maxRows"],["text","Update Grid",3,"click"],["formControlName","autoRefresh","label","Automatically refresh data when view is opened"],["label","Table is shared in the catalog to users with read access.","formControlName","isShared"],["title","Parameters",3,"showExpandButton","onChange"],[3,"showEdit","parameters","formsService","refreshEvent","onChange","onRefreshData"],["title","InputColumns",3,"showExpandButton"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"item",4,"ngFor","ngForOf"],[3,"item"],[3,"item","showEdit","refreshData","onRemove","onMaximize"],[1,"position-relative",2,"height","800px","overflow","hidden"],[3,"item","showEdit","refreshData","isMaximized","onRemove","onMaximize"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Dc(1,I,2,2,"dexih-widget-section",1),p.Dc(2,N,2,5,"dexih-widget-section",2),p.Dc(3,S,2,2,"dexih-widget-section",3),p.Ob(4,"div",4),p.Ob(5,"gridster",5,6),p.Dc(7,D,1,1,"ng-template",7),p.Nb(),p.Nb(),p.Nb(),p.Dc(8,M,2,4,"div",8)),2&e&&(p.hc("ngClass",p.mc(7,z,t.maximizedItem)),p.yb(1),p.hc("ngIf",t.showEdit),p.yb(1),p.hc("ngIf",t.showEdit||(null==t.parameters?null:t.parameters.length)>0),p.yb(1),p.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),p.yb(2),p.hc("options",t.options),p.yb(2),p.hc("ngIf",t.dashboardItemControls),p.yb(1),p.hc("ngIf",t.maximizedItem))},directives:[r.q,r.t,u.d,w.T,a.I,a.t,a.l,w.D,a.s,a.j,w.H,w.s,w.A,v.a,r.s,a.v,u.e,x.a],encapsulation:2}),e})(),data:{navigateSkip:!0}},{path:"view-edit/:viewKey",component:l.a,data:{action:"edit",pageTitle:"Edit View"}},{path:"view-new",component:l.a,data:{action:"new",pageTitle:"New View"}}]}]);var T=o("RRRx");let F=(()=>{class e{static forRoot(){return{ngModule:e,providers:[i.a]}}}return e.\u0275mod=p.Ib({type:e}),e.\u0275inj=p.Hb({factory:function(t){return new(t||e)},providers:[i.a,s.a],imports:[[n.a,r.c,a.n,a.C,k,T.a]]}),e})()}}]);
//# sourceMappingURL=3-es2015.2319cf37cfaf81fd4e9a.js.map