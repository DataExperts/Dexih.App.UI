(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"3TNP":function(e,t,s){"use strict";s.r(t),s.d(t,"HubsModule",(function(){return Lt}));var i=s("tyNb"),n=s("fXoL"),a=s("ElCs"),o=s("mgEF"),r=s("ofXK"),c=s("24Dg");const l=["DexihMessage"];function b(e,t){if(1&e&&(n.Ob(0,"section"),n.Ob(1,"div",4),n.Fc(2),n.Nb(),n.Nb()),2&e){const e=n.Zb();n.yb(2),n.Hc(" ",e.webSocketStatus," ")}}let u=(()=>{class e{constructor(e,t){this.authService=e,this.hubsService=t,this.openDelay=!1,e.initialize()}ngOnInit(){this._hubsMessageSubscription=this.hubsService.getHubMessagesObservable().subscribe(e=>{e&&0!==e.length?this.dexihMessage.addMessage(e[e.length-1]):this.dexihMessage.reset()}),this._webSocketStatusSubscription=this.authService.getWebSocketStatusObservable().subscribe(e=>{this.webSocketStatus=e}),setTimeout(()=>{this.openDelay=!0},5e3)}ngOnDestroy(){this._hubsMessageSubscription&&this._hubsMessageSubscription.unsubscribe(),this._webSocketStatusSubscription&&this._webSocketStatusSubscription.unsubscribe()}onFocus(){this.openDelay=!1,setTimeout(()=>{this.openDelay=!0},5e3)}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(o.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["dexih-hubs"]],viewQuery:function(e,t){var s;1&e&&n.Bc(l,!0),2&e&&n.rc(s=n.Wb())&&(t.dexihMessage=s.first)},hostBindings:function(e,t){1&e&&n.Vb("focus",(function(e){return t.onFocus(e)}),!1,n.uc)},decls:6,vars:1,consts:[["id","content"],[4,"ngIf"],[1,"m-3"],["DexihMessage",""],[1,"alert","alert-danger","m-3"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Dc(1,b,3,1,"section",1),n.Ob(2,"div",2),n.Lb(3,"dexih-message",null,3),n.Nb(),n.Lb(5,"router-outlet"),n.Nb()),2&e&&(n.yb(1),n.hc("ngIf",t.openDelay&&"Connected"!=t.webSocketStatus))},directives:[r.t,c.a,i.j],encapsulation:2}),e})();var h=s("2Vo4"),d=s("Wumg"),m=s("H3K+");const f=function(e){return["hub-edit",e]},g=function(e){return["/hub",e]},p=function(e){return["/hub",e,"manage","manage-users"]};function v(e,t){if(1&e&&(n.Lb(0,"dexih-button-edit",8),n.Lb(1,"dexih-button-open",8),n.Lb(2,"dexih-button",9)),2&e){const e=t.item;n.hc("routerLink",n.mc(3,f,e.hubKey)),n.yb(1),n.hc("routerLink",n.mc(5,g,e.hubKey)),n.yb(1),n.hc("routerLink",n.mc(7,p,e.hubKey))}}function y(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-delete",10),n.Vb("click",(function(){n.vc(e);const s=t.items;return n.Zb().deleteHubs(s)})),n.Nb()}}const w=function(){return["hub-new"]};function N(e,t){1&e&&n.Lb(0,"dexih-button-new",11),2&e&&n.hc("routerLink",n.lc(1,w))}let O=(()=>{class e{constructor(e,t,s,i){this.authService=e,this.hubService=t,this.router=s,this.route=i,this.isLoaded=!1,this.columns=[{name:"name",title:"Name",format:""},{name:"description",title:"Description",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new h.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.hubsObserve=this.authService.getHubsObservable().subscribe(e=>{e&&(this.isLoaded=!0),this._tableData.next(e)})}ngOnDestroy(){this.hubsObserve&&this.hubsObserve.unsubscribe()}deleteHubs(e){this.authService.deleteHubs(e).catch(e=>{this.hubService.addHubMessage(e)})}edit(e){this.router.navigate(["hub-edit",e.hubKey],{relativeTo:this.route})}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(o.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["hubs"]],decls:9,vars:6,consts:[[1,"container-fluid"],["title","Available Hubs","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],["iconClass","fa fa-lock","queryParamsHandling","","preserveFragment","","text","Permissions",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"click"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.close()})),n.Ob(2,"dexih-table",2),n.Vb("rowClick",(function(e){return t.edit(e)})),n.Dc(3,v,3,9,"ng-template",3,4,n.Ec),n.Dc(5,y,1,0,"ng-template",5,6,n.Ec),n.Dc(7,N,1,2,"ng-template",null,7,n.Ec),n.Nb(),n.Nb(),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0),n.yb(1),n.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[d.P,m.a,d.j,i.f,d.p,d.f,d.g,d.o],encapsulation:2}),e})();var k=s("itXk"),S=s("3Pt+"),C=s("3WyZ"),x=s("soiQ");const L=["DexihMessage"];function I(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-save",11),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2);return!t.savingHub&&!t.mainForm.pristine&&t.saveHub()})),n.Nb(),n.Ob(1,"dexih-button-cancel",12),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2);return!t.savingHub&&t.cancel()})),n.Nb()}if(2&e){const e=n.Zb(2);n.hc("disabled",e.savingHub||e.mainForm.pristine)("busy",e.savingHub),n.yb(1),n.hc("disabled",e.savingHub)}}function A(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-widget",3),n.Vb("close",(function(){return n.vc(e),n.Zb().cancel()})),n.Dc(1,I,2,3,"ng-template",null,4,n.Ec),n.Ob(3,"form",5),n.Ob(4,"fieldset"),n.Ob(5,"section"),n.Lb(6,"form-input",6),n.Nb(),n.Ob(7,"section"),n.Lb(8,"form-textarea",7),n.Nb(),n.Ob(9,"section"),n.Ob(10,"form-input",8),n.Fc(11," ("),n.Ob(12,"dexih-button",9),n.Vb("click",(function(){return n.vc(e),n.Zb().generateKey()})),n.Fc(13,"Generate a new key"),n.Nb(),n.Fc(14,") "),n.Nb(),n.Nb(),n.Ob(15,"section"),n.Lb(16,"form-select",10),n.Nb(),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.hc("showCloseButton",!0)("padding",!0),n.yb(3),n.hc("formGroup",e.mainForm),n.yb(3),n.hc("autocapitalize",e.on)("errors",e.formErrors.name),n.yb(4),n.hc("errors",e.formErrors.encryptionKey),n.yb(2),n.hc("busy",e.generatingKey),n.yb(4),n.hc("items",e.SharedAccessItems)("errors",e.formErrors.sharedAccess)("enableFilter",!1)}}let D=(()=>{class e{constructor(e,t,s,i,n){this.authService=e,this.router=t,this.route=s,this.location=i,this.fb=n,this.SharedAccessItems=x.cc.filter(e=>e.key>0),this.generatingKey=!1,this.savingHub=!1,this.hasChanged=!1,this.showAllErrors=!1,this.formErrors={name:"",encryptionKey:"",sharedAccess:"",expiryDate:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long.",duplicateHubName:"Name cannot be the same as an existing hub name."},encryptionKey:{required:"Encryption Key is required.",minlength:"Encryption Key must be at least 10 characters long.",maxlength:"Encryption Key cannot be more than 250 characters long."},sharedAccess:{required:"Specify the type of required access."},expiryDate:{validateDate:"The expiry date is invalid."}}}ngOnInit(){try{this._subscription=Object(k.a)(this.route.data,this.route.params,this.authService.getHubsObservable(),this.authService.getRemoteAgentsObservable()).subscribe(e=>{let t=e[0],s=e[1],i=e[2];if(this.action=t.action,this.pageTitle=t.pageTitle,"New"===this.action)this.hub=new C.b,this.buildForm();else if(i){let e=+s.hubKey;this.hub=i.find(t=>t.hubKey===e),this.buildForm()}})}catch(e){this.dexihMessage.addErrorMessage(e.message)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe()}generateKey(){this.generatingKey=!0,this.authService.getRandomEncryptionKey().then(e=>{this.mainForm.controls.encryptionKey.setValue(e),this.mainForm.markAsDirty(),this.generatingKey=!1}).catch(e=>{this.dexihMessage.addMessage(e),this.generatingKey=!1})}saveHub(){this.mainForm.valid&&this.hasChanged?this.hub.hubKey>0&&this.hub.encryptionKey!==this.mainForm.value.encryptionKey?this.authService.confirmDialog("Warning: Encryption Key Changed","The encryption key has changed.  This will require all connection password & connection strings in the hub to be updated.  Would you like to continue?").then(e=>{e&&this.doSaveHub()}):this.doSaveHub():(this.showAllErrors=!0,this.onValueChanged())}doSaveHub(){this.dexihMessage.reset(),this.savingHub=!0,Object.assign(this.hub,this.mainForm.value),this.authService.saveHub(this.hub).then(e=>{this.savingHub=!1,this.cancel(),this.router.navigate(["/hub",e.hubKey,"summary","agents"])}).catch(e=>{this.dexihMessage.addMessage(e),this.savingHub=!1})}cancel(){this.authService.navigateUp()}buildForm(){this.mainForm=this.fb.group({name:[this.hub.name,[S.G.required,S.G.minLength(4),S.G.maxLength(50),this.duplicateHubNameValidator()]],description:[this.hub.description,[]],encryptionKey:[this.hub.encryptionKey,[]],sharedAccess:[this.hub.sharedAccess,[S.G.required]],expiryDate:[this.hub.expiryDate,[]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe(e=>this.onValueChanged(e)),this.onValueChanged(),this.hasChanged=!1}duplicateHubNameValidator(){return e=>{const t=e.value;return this.authService.hubNameExists(this.hub.hubKey,t)?{duplicateHubName:{name:t}}:null}}onValueChanged(e){if(!this.mainForm)return;const t=this.mainForm;this.hasChanged=!0;for(const s of Object.keys(this.formErrors)){this.formErrors[s]="";const e=t.get(s);if(e&&(e.dirty||this.showAllErrors)&&!e.valid){const t=this.validationMessages[s];for(const i of Object.keys(e.errors))this.formErrors[s]+=t[i]+" "}}}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a),n.Kb(r.n),n.Kb(S.g))},e.\u0275cmp=n.Eb({type:e,selectors:[["dexih-hub-edit-form"]],viewQuery:function(e,t){var s;1&e&&n.Bc(L,!0),2&e&&n.rc(s=n.Wb())&&(t.dexihMessage=s.first)},decls:4,vars:1,consts:[[1,"container"],["DexihMessage",""],["title","Edit Hub","subTitle","Complete the details to create/edit a new hub","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","padding","close",4,"ngIf"],["title","Edit Hub","subTitle","Complete the details to create/edit a new hub","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","padding","close"],["header",""],["id","hub-edit-form",3,"formGroup"],["label","Hub Name","formControlName","name","placeholder","Enter a name for the hub","iconClass","fa fa-life-ring",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter a description for the hub"],["label","Encryption Key","formControlName","encryptionKey","placeholder","Enter an encryption key","iconClass","fa fa-key","note","The encryption key will be used to encrypt table columns flagged as secure.  Ensure this key is kept securely as without it encrypted data will be lost.",2,"z-index","10000",3,"errors"],["buttonClass","btn btn-link mb-1 p-0","iconClass","fa fa-refresh",3,"busy","click"],["label","Shared Data Access","formControlName","sharedAccess","itemKey","key","itemName","description","iconClass","fa fa-lock","note","The level of access required for users to access shared data in this hub.",3,"items","errors","enableFilter"],[1,"mr-1",3,"disabled","busy","click"],[3,"disabled","click"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Lb(1,"dexih-message",null,1),n.Dc(3,A,17,10,"dexih-widget",2),n.Nb()),2&e&&(n.yb(3),n.hc("ngIf",t.mainForm))},directives:[c.a,r.t,d.P,S.I,S.t,S.l,d.D,S.s,S.j,d.H,d.f,d.E,d.t,d.b],encapsulation:2}),e})();function T(e,t){1&e&&(n.Ob(0,"div",29),n.Ob(1,"div",30),n.Lb(2,"dexih-button-new",31),n.Nb(),n.Ob(3,"h3"),n.Fc(4,"Let's get started."),n.Nb(),n.Ob(5,"h5"),n.Fc(6,"You do not have any hubs currently available to you."),n.Nb(),n.Ob(7,"h5"),n.Fc(8,"To get started, either create a new hub, or request another user provide access."),n.Nb(),n.Nb())}const M=function(e){return{active:e}};function F(e,t){if(1&e){const e=n.Pb();n.Ob(0,"div",32),n.Ob(1,"label",33),n.Ob(2,"input",34),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().view=t})),n.Nb(),n.Lb(3,"i",35),n.Nb(),n.Ob(4,"label",36),n.Ob(5,"input",34),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().view=t})),n.Nb(),n.Lb(6,"i",37),n.Nb(),n.Ob(7,"label",38),n.Ob(8,"input",34),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().view=t})),n.Nb(),n.Lb(9,"i",39),n.Nb(),n.Ob(10,"label",40),n.Ob(11,"input",34),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().view=t})),n.Nb(),n.Lb(12,"i",41),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.yb(1),n.hc("ngClass",n.mc(12,M,e.view===e.eHubAccess.All)),n.yb(1),n.hc("value",e.eHubAccess.All)("ngModel",e.view),n.yb(2),n.hc("ngClass",n.mc(14,M,e.view===e.eHubAccess.User)),n.yb(1),n.hc("value",e.eHubAccess.User)("ngModel",e.view),n.yb(2),n.hc("ngClass",n.mc(16,M,e.view===e.eHubAccess.ReadOnly)),n.yb(1),n.hc("value",e.eHubAccess.ReadOnly)("ngModel",e.view),n.yb(2),n.hc("ngClass",n.mc(18,M,e.view===e.eHubAccess.Public)),n.yb(1),n.hc("value",e.eHubAccess.Public)("ngModel",e.view)}}function K(e,t){if(1&e&&(n.Ob(0,"div",10),n.Ob(1,"p",11),n.Fc(2),n.Nb(),n.Nb()),2&e){const e=n.Zb(2).$implicit;n.yb(2),n.Gc(e.description)}}function E(e,t){if(1&e&&(n.Ob(0,"div",43),n.Ob(1,"div"),n.Ob(2,"div",44),n.Ob(3,"div",45),n.Ob(4,"div"),n.Fc(5),n.Ob(6,"div",46),n.Fc(7),n.Nb(),n.Nb(),n.Ob(8,"div",47),n.Lb(9,"dexih-button-open",48),n.Lb(10,"dexih-button-edit",49),n.Nb(),n.Nb(),n.Nb(),n.Dc(11,K,3,1,"div",50),n.Nb(),n.Nb()),2&e){const e=n.Zb().$implicit,t=n.Zb();n.yb(5),n.Hc(" ",e.name," "),n.yb(2),n.Hc("(",t.eHubAccess[e.hubAccess],")"),n.yb(2),n.jc("routerLink","/hub/",e.hubKey,"/summary"),n.yb(1),n.jc("routerLink","hub-edit/",e.hubKey,""),n.yb(1),n.hc("ngIf",e.description)}}function P(e,t){if(1&e&&n.Dc(0,E,12,5,"div",42),2&e){const e=t.$implicit,s=n.Zb();n.hc("ngIf",(s.view===s.eHubAccess.All||e.hubAccess===s.view)&&(!s.filterString||e.name.toUpperCase().includes(s.filterString.toUpperCase())))}}let H=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.logoSmallUrl=C.j,this.eSharedAccess=x.bc,this.ePermission=x.Wb,this.eHubAccess=C.i,this.view=C.i.User,this.hubAccess={}}ngOnInit(){this.hubs=this.authService.getHubsObservable()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e))},e.\u0275cmp=n.Eb({type:e,selectors:[["hubs-summary"]],decls:57,vars:10,consts:[[1,"container-fluid"],[1,"d-flex","align-items-center","p-3","my-3","text-white-50","bg-info","rounded"],["alt","","width","48","height","48",1,"mr-3",3,"src"],[1,"lh-100"],[1,"mb-0","text-white","lh-100"],["class","alert alert-warning",4,"ngIf"],[1,"card-deck"],[1,"card","mb-3",2,"min-width","18rem"],[1,"card-header","text-white","bg-success"],[1,"fa","fa-lg","fa-fw","fa-life-saver"],[1,"card-body"],[1,"card-text"],[1,"card-footer"],["iconClass","fa fa-life-saver","routerLink","hubs-view",1,"ml-1"],["routerLink","hub-new","title","Create a new hub",1,"ml-1"],[1,"card-header","text-white","bg-primary"],[1,"fa","fa-lg","fa-fw","fa-user"],["iconClass","fa fa-user","routerLink","manage",1,"ml-1"],[1,"card-header","text-white","bg-warning"],[1,"fa","fa-lg","fa-fw","fa-wifi"],["iconClass","fa fa-wifi","routerLink","agents",1,"mr-1"],["iconClass","fa fa-tasks","routerLink","tasks"],[1,"card-header","text-white","bg-danger"],[1,"fa","fa-lg","fa-fw","fa-newspaper-o"],["routerLink","sharedData"],["title","Hubs","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","padding","showFilter","filterString"],["header",""],[1,"card-columns"],["ngFor","",3,"ngForOf"],[1,"alert","alert-warning"],[1,"float-right"],["routerLink","hub-new","title","Create a new Hub","text","New Hub"],["data-toggle","buttons",1,"btn-group","btn-group-toggle","ml-1"],["title","All Hubs.",1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","autocomplete","off",3,"value","ngModel","ngModelChange"],[1,"fa","fa-globe"],["title","User owned hubs",1,"btn","btn-primary",3,"ngClass"],[1,"fa","fa-user-secret"],["title","Readonly hubs",1,"btn","btn-primary",3,"ngClass"],[1,"fa","fa-book"],["title","Public Hubs",1,"btn","btn-primary",3,"ngClass"],[1,"fa","fa-users"],["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"d-flex","flex-row","p-0"],[1,"small"],[1,"d-flex","ml-auto"],[3,"routerLink"],[1,"ml-1",3,"routerLink"],["class","card-body",4,"ngIf"]],template:function(e,t){if(1&e&&(n.Ob(0,"div",0),n.Ob(1,"div",1),n.Lb(2,"img",2),n.Ob(3,"div",3),n.Ob(4,"h3",4),n.Fc(5,"Data Experts Integration Hub"),n.Nb(),n.Nb(),n.Nb(),n.Dc(6,T,9,0,"div",5),n.ac(7,"async"),n.Ob(8,"div",6),n.Ob(9,"div",7),n.Ob(10,"div",8),n.Lb(11,"i",9),n.Fc(12,"Hub Management"),n.Nb(),n.Ob(13,"div",10),n.Ob(14,"p",11),n.Fc(15,"Hub's are used to store definitions for tables and data processing rules, and are used to run, schedule and publish data."),n.Nb(),n.Nb(),n.Ob(16,"div",12),n.Ob(17,"dexih-button",13),n.Fc(18,"Manage"),n.Nb(),n.Lb(19,"dexih-button-new",14),n.Nb(),n.Nb(),n.Ob(20,"div",7),n.Ob(21,"div",15),n.Lb(22,"i",16),n.Fc(23,"Account Management"),n.Nb(),n.Ob(24,"div",10),n.Ob(25,"p",11),n.Fc(26,"Edit your account details, password, and login providers."),n.Nb(),n.Nb(),n.Ob(27,"div",12),n.Ob(28,"dexih-button",17),n.Fc(29,"Account"),n.Nb(),n.Nb(),n.Nb(),n.Ob(30,"div",7),n.Ob(31,"div",18),n.Lb(32,"i",19),n.Fc(33,"Remote Agents"),n.Nb(),n.Ob(34,"div",10),n.Ob(35,"p",11),n.Fc(36,"Remote agents provide connectivity to data sources and are used run and publish data."),n.Nb(),n.Nb(),n.Ob(37,"div",12),n.Ob(38,"dexih-button",20),n.Fc(39,"Agents"),n.Nb(),n.Ob(40,"dexih-button",21),n.Fc(41,"Tasks"),n.Nb(),n.Nb(),n.Nb(),n.Ob(42,"div",7),n.Ob(43,"div",22),n.Lb(44,"i",23),n.Fc(45,"Shared Data"),n.Nb(),n.Ob(46,"div",10),n.Ob(47,"p",11),n.Fc(48,"View all datasets which have been shared."),n.Nb(),n.Nb(),n.Ob(49,"div",12),n.Lb(50,"dexih-button-view",24),n.Nb(),n.Nb(),n.Nb(),n.Ob(51,"dexih-widget",25),n.Vb("filterString",(function(e){return t.filterString=e})),n.Dc(52,F,13,20,"ng-template",null,26,n.Ec),n.Ob(54,"div",27),n.Dc(55,P,1,1,"ng-template",28),n.ac(56,"async"),n.Nb(),n.Nb(),n.Nb()),2&e){var s;const e=0==(null==(s=n.bc(7,6,t.hubs))?null:s.length);n.yb(2),n.hc("src",t.logoSmallUrl,n.xc),n.yb(4),n.hc("ngIf",e),n.yb(45),n.hc("showCloseButton",!1)("padding",!0)("showFilter",!0),n.yb(4),n.hc("ngForOf",n.bc(56,8,t.hubs))}},directives:[r.t,d.f,i.f,d.o,d.y,d.P,r.s,r.q,S.A,S.c,S.s,S.v,d.p,d.j],pipes:[r.b],encapsulation:2}),e})();var Z=s("d2yJ");const V=["DexihMessage"];function U(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-save",11),n.Vb("click",(function(){return n.vc(e),n.Zb().save()})),n.Nb(),n.Ob(1,"dexih-button-cancel",12),n.Vb("click",(function(){return n.vc(e),n.Zb().cancel()})),n.Nb()}if(2&e){const e=n.Zb();n.hc("busy",e.formsService.formSaving)("disabled",e.formsService.formSaving||!e.formsService.hasChanged)}}function _(e,t){if(1&e&&(n.Ob(0,"form",13),n.Ob(1,"fieldset"),n.Ob(2,"div",14),n.Ob(3,"section",15),n.Lb(4,"form-input",16),n.Nb(),n.Ob(5,"section",15),n.Lb(6,"form-input",17),n.Nb(),n.Nb(),n.Ob(7,"div",14),n.Ob(8,"section",18),n.Lb(9,"form-input",19),n.Nb(),n.Ob(10,"section",18),n.Lb(11,"form-input",20),n.Nb(),n.Nb(),n.Ob(12,"section"),n.Lb(13,"form-checkbox",21),n.Nb(),n.Ob(14,"section"),n.Lb(15,"form-checkbox",22),n.Nb(),n.Ob(16,"section"),n.Lb(17,"form-checkbox",23),n.Nb(),n.Nb(),n.Nb()),2&e){const e=n.Zb();n.hc("formGroup",e.formsService.currentForm)}}function R(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button",24),n.Fc(1,"Forgot Password"),n.Nb(),n.Ob(2,"dexih-button-save",25),n.Vb("click",(function(){return n.vc(e),n.Zb().updatePassword()})),n.Fc(3,"Update Password"),n.Nb()}if(2&e){const e=n.Zb();n.yb(2),n.hc("disabled",!e.passwordForm.valid)("busy",e.updatingPassword)}}function G(e,t){if(1&e&&(n.Ob(0,"form",13),n.Ob(1,"fieldset"),n.Ob(2,"section"),n.Lb(3,"form-input",26),n.Nb(),n.Ob(4,"section"),n.Lb(5,"form-input",27),n.Nb(),n.Ob(6,"section"),n.Lb(7,"form-input",28),n.Nb(),n.Nb(),n.Nb()),2&e){const e=n.Zb();n.hc("formGroup",e.passwordForm),n.yb(7),n.hc("errors",e.passwordMatchError)}}function B(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button",29),n.Vb("click",(function(){return n.vc(e),n.Zb().microsoftLogin(!0)})),n.Fc(1,"Add Microsoft"),n.Nb(),n.Ob(2,"dexih-button",30),n.Vb("click",(function(){return n.vc(e),n.Zb().googleLogin(!0)})),n.Fc(3,"Add Google"),n.Nb()}}function j(e,t){if(1&e){const e=n.Pb();n.Ob(0,"li",31),n.Ob(1,"div",32),n.Ob(2,"dexih-button-delete",33),n.Vb("click",(function(){n.vc(e);const s=t.$implicit;return n.Zb().deleteLogin(s)})),n.Nb(),n.Nb(),n.Ob(3,"h3"),n.Fc(4),n.Nb(),n.Nb()}if(2&e){const e=t.$implicit;n.yb(4),n.Gc(e.providerDisplayName)}}function q(e,t){if(1&e){const e=n.Pb();n.Ob(0,"section"),n.Ob(1,"div",34),n.Fc(2),n.Ob(3,"dexih-button",35),n.Vb("click",(function(){return n.vc(e),n.Zb().googleLogin(!0)})),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.yb(2),n.Hc(' Google could not automatically sign-in due to "',e.googleMessage,'". Click login button to open new window to login to your google account. ')}}function $(e,t){if(1&e){const e=n.Pb();n.Ob(0,"section"),n.Ob(1,"div",34),n.Fc(2),n.Ob(3,"dexih-button",36),n.Vb("click",(function(){return n.vc(e),n.Zb().microsoftLogin(!0)})),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.yb(2),n.Hc(' Microsoft could not automatically sign-in due to "',e.microsoftMessage,'". Click login button to open new window to login to your microsoft account. ')}}let W=(()=>{class e{constructor(e,t,s,i,n,a){this.authService=e,this.formsService=t,this.fb=s,this.route=i,this.router=n,this.location=a,this.updatingPassword=!1,this.passwordMatchError="",this.passwordStrengthError="",this.googleMessage=!1,this.microsoftMessage=!1}ngOnInit(){this._userSubscription=this.authService.getUserObservable().subscribe(e=>{this.formsService.createDefault(e,new C.g),this.updateLogins(),this.formsService.currentForm.controls.email.disable(),this.passwordForm=this.fb.group({password:["",[]],newPassword:["",[S.G.required,S.G.minLength(8),S.G.maxLength(20),S.G.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*d)(?=.*[#$^+=!*()@%&]).{8,}$")]],confirmPassword:["",[this.duplicatePasswordValidator()]]})})}ngOnDestroy(){this._userSubscription&&this._userSubscription.unsubscribe()}updateLogins(){this.authService.getLoginProviders().then(e=>{this.logins=e})}duplicatePasswordValidator(){return e=>{if(this.passwordForm){let e=this.passwordForm;return e.controls.confirmPassword.dirty&&e.controls.newPassword.value!==e.controls.confirmPassword.value?(this.passwordMatchError="The passwords do not match",{passwordMatch:{}}):(this.passwordMatchError="",null)}}}updatePassword(){this.updatingPassword=!0,this.authService.changePassword(this.passwordForm.controls.password.value,this.passwordForm.controls.newPassword.value).then(e=>{this.updatingPassword=!1,this.dexihMessage.addSuccessMessage("The password change was successful.")}).catch(e=>{this.dexihMessage.addMessage(e),this.updatingPassword=!1})}save(){this.authService.updateUserDetails(this.formsService.currentForm.value).then(e=>{e&&this.dexihMessage.addSuccessMessage("Details updated successfully")}).catch(e=>{this.dexihMessage.addMessage(e)})}cancel(){this.authService.navigateUp()}googleLogin(e){this.dexihMessage.reset(),this.authService.googleSignIn(e).then(e=>{this.authService.addExternalLogin(x.Sb.Google,e.providerKey,e.authenticationToken).then(e=>{this.updateLogins()}).catch(e=>{this.dexihMessage.addMessage(e)})}).catch(e=>{this.googleMessage=e,this.dexihMessage.addErrorMessage(e)})}microsoftLogin(e){this.dexihMessage.reset(),this.authService.microsoftSignIn(e).then(e=>{this.authService.addExternalLogin(x.Sb.Microsoft,e.providerKey,e.authenticationToken).then(e=>{this.updateLogins()}).catch(e=>{this.dexihMessage.addMessage(e)})}).catch(e=>{this.microsoftMessage=e,this.dexihMessage.addErrorMessage(e)})}deleteLogin(e){this.authService.removeExternalLogin(e.loginProvider,e.providerKey)}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(Z.a),n.Kb(S.g),n.Kb(i.a),n.Kb(i.e),n.Kb(r.n))},e.\u0275cmp=n.Eb({type:e,selectors:[["manage-form"]],viewQuery:function(e,t){var s;1&e&&n.Bc(V,!0),2&e&&n.rc(s=n.Wb())&&(t.dexihMessage=s.first)},features:[n.xb([Z.a])],decls:19,vars:8,consts:[[1,"container"],["DexihMessage",""],["title","User Details","iconClass","fa fa-lg fa-fw fa-user",3,"padding"],["header",""],[3,"formGroup",4,"ngIf"],["title","Reset Password","iconClass","fa fa-lg fa-fw fa-lock",3,"padding"],["title","Logins","subTitle","The following login providers are available","iconClass","fa fa-lg fa-fw fa-life-saver",3,"padding"],["subHeader",""],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mr-1",3,"busy","disabled","click"],[3,"click"],[3,"formGroup"],[1,"form-row"],[1,"col-md-6"],["label","User Name","formControlName","userName","placeholder","Enter the user name.","iconClass","fa fa-list"],["label","Email Address","formControlName","email","placeholder","Enter the email.","iconClass","fa fa-list"],[1,"form-group","col-md-6"],["label","First Name","formControlName","firstName","placeholder","First Name"],["label","Last Name","formControlName","lastName","placeholder","Last Name"],["label","I want to receive news and special offers","formControlName","subscription"],["label","I want to receive private notifications from other users.","formControlName","notifyPrivateMessage"],["label","I want to receive critical support and issue updates.","formControlName","notifySupportMessage"],["iconClass","fa fa-key","btnClass","btn btn-danger","routerLink","/auth/forgot-password",1,"mr-1"],[3,"disabled","busy","click"],["label","Current Password","formControlName","password","type","password"],["label","New Password","formControlName","newPassword","type","password"],["label","Confirm New Password","formControlName","confirmPassword","type","password",3,"errors"],["buttonClass","btn btn-primary","iconClass","fa fa-windows",1,"mr-1",3,"click"],["buttonClass","btn btn-danger","iconClass","fa fa-google",3,"click"],[1,"list-group-item"],[1,"float-right"],["title","Remove the following login",3,"click"],[1,"alert","alert-danger"],["buttonClass","btn btn-danger","iconClass","fa fa-google","text","Google Login",3,"click"],["buttonClass","btn btn-primary","iconClass","fa fa-microsoft","text","Microsoft Login",3,"click"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Lb(1,"dexih-message",null,1),n.Ob(3,"dexih-widget-vertical"),n.Ob(4,"dexih-widget",2),n.Dc(5,U,2,2,"ng-template",null,3,n.Ec),n.Dc(7,_,18,1,"form",4),n.Nb(),n.Ob(8,"dexih-widget",5),n.Dc(9,R,4,2,"ng-template",null,3,n.Ec),n.Dc(11,G,8,2,"form",4),n.Nb(),n.Ob(12,"dexih-widget",6),n.Dc(13,B,4,0,"ng-template",null,7,n.Ec),n.Ob(15,"ul",8),n.Dc(16,j,5,1,"li",9),n.Nb(),n.Dc(17,q,4,1,"section",10),n.Dc(18,$,4,1,"section",10),n.Nb(),n.Nb(),n.Nb()),2&e&&(n.yb(4),n.hc("padding",!0),n.yb(3),n.hc("ngIf",t.formsService.currentForm),n.yb(1),n.hc("padding",!0),n.yb(3),n.hc("ngIf",t.passwordForm),n.yb(1),n.hc("padding",!0),n.yb(4),n.hc("ngForOf",t.logins),n.yb(1),n.hc("ngIf",t.googleMessage),n.yb(1),n.hc("ngIf",t.microsoftMessage))},directives:[c.a,d.S,d.P,r.t,r.s,d.t,d.b,S.I,S.t,S.l,d.D,S.s,S.j,d.A,d.f,i.f,d.g],encapsulation:2}),e})();function Q(e,t){if(1&e){const e=n.Pb();n.Ob(0,"div",1),n.Ob(1,"dexih-progressbar",2),n.Vb("cancelled",(function(){return n.vc(e),n.Zb().cancelled()}))("click",(function(){return n.vc(e),n.Zb().clicked()})),n.Fc(2),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.yb(1),n.hc("animate",!0)("showCancel",e.currentStatus.canCancel)("value",e.currentStatus.percentage)("type",e.currentStatus.statusType),n.yb(1),n.Hc(" ",e.currentStatus.message," ")}}let z=(()=>{class e{constructor(e){this.hubsService=e}ngOnInit(){this.currentStatus=this.getStatus(this.task)}ngOnDestroy(){}getStatus(e){const t=new J;if(e){switch(t.percentage=e.percentage,e.status){case x.Tb.Error:case x.Tb.Cancelled:t.statusType="danger",t.canCancel=!1;break;case x.Tb.Created:case x.Tb.Running:case x.Tb.Scheduled:case x.Tb.Queued:t.statusType="primary",t.canCancel=!0;break;case x.Tb.Completed:t.statusType="success",t.canCancel=!1}switch(e.status){case x.Tb.Error:t.iconClass="fa fa-ban text-danger";break;case x.Tb.Cancelled:t.iconClass="fa fa-ban text-warning";break;case x.Tb.Created:t.iconClass="fa fa-circle text-success";break;case x.Tb.Queued:t.iconClass="fa fa-square";break;case x.Tb.Running:t.iconClass="fa fa-cogs text-success";break;case x.Tb.Scheduled:t.iconClass="fa fa-calendar text-success";break;case x.Tb.Created:t.iconClass="fa fa-cog text-success";break;case x.Tb.Completed:t.iconClass="fa fa-square text-success"}t.message=e.message,t.error=e.message}else t.message="not running",t.percentage=0,t.statusType="info",t.error="";return t}cancelled(){this.task&&this.hubsService.cancelTasks([this.task])}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(o.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["task-status"]],inputs:{task:"task"},decls:1,vars:1,consts:[["style","width:100%",4,"ngIf"],[2,"width","100%"],[3,"animate","showCancel","value","type","cancelled","click"]],template:function(e,t){1&e&&n.Dc(0,Q,3,5,"div",0),2&e&&n.hc("ngIf",t.currentStatus)},directives:[r.t,d.K],encapsulation:2}),e})();class J{}const X=function(e,t,s){return["/hub",e,"summary","datalinks","result-view",t,s]};function Y(e,t){if(1&e&&n.Lb(0,"dexih-button-view",10),2&e){const e=n.Zb().item;n.hc("routerLink",n.oc(1,X,e.task.referenceKey,e.task.data.auditConnectionKey,e.task.data.auditKey))}}function ee(e,t){if(1&e&&n.Lb(0,"dexih-button-view",11),2&e){const e=n.Zb().item;n.hc("routerLink",n.oc(1,X,e.task.referenceKey,e.task.data.auditConnectionKey,e.task.data.auditKey))}}function te(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-view",7),n.Vb("click",(function(){n.vc(e);const s=t.item;return n.Zb().showTask(s.task)})),n.Nb(),n.Dc(1,Y,1,5,"dexih-button-view",8),n.Dc(2,ee,1,5,"dexih-button-view",9)}if(2&e){const e=t.item;n.yb(1),n.hc("ngIf","Datalink"==e.task.category),n.yb(1),n.hc("ngIf","Datajob"==e.task.category)}}function se(e,t){1&e&&n.Lb(0,"task-status",12),2&e&&n.hc("task",t.item.task)}let ie=(()=>{class e{constructor(e,t,s){this.authService=e,this.router=t,this.route=s,this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"hub",title:"Hub",format:""},{name:"task.category",title:"Category",format:""},{name:"task.status",title:"Status",format:"Enum",enum:x.Tb},{name:"task.stepName",title:"Current Step",format:""},{name:"task.name",title:"Name",format:""},{name:"task.lastUpdate",title:"Last Modified",format:"Calendar"}],this._tableData=new h.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this._subscription=Object(k.a)(this.route.data,this.route.params,this.authService.getHubsObservable(),this.authService.getTasksObservable()).subscribe(e=>{let t=e[2],s=[];e[3].forEach(e=>{let i=t.find(t=>t.hubKey===e.referenceKey);s.push({hub:i?i.name:"Unknown hub",task:e})}),this._tableData.next(s)})}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}showTask(e){this.router.navigate(["view",e.taskId],{relativeTo:this.route})}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["tasks-index"]],decls:7,vars:4,consts:[[1,"container-fluid"],["title","Tasks","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],[3,"enableMultiSelect","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["text","View Task",3,"click"],["class","ml-1","text","Datalink Result",3,"routerLink",4,"ngIf"],["class","ml-1","text","Datajob Result",3,"routerLink",4,"ngIf"],["text","Datalink Result",1,"ml-1",3,"routerLink"],["text","Datajob Result",1,"ml-1",3,"routerLink"],[3,"task"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.close()})),n.Ob(2,"dexih-table",2),n.Vb("rowClick",(function(e){return t.showTask(e.task)})),n.Dc(3,te,3,2,"ng-template",3,4,n.Ec),n.Dc(5,se,1,1,"ng-template",5,6,n.Ec),n.Nb(),n.Nb(),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0),n.yb(1),n.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[d.P,m.a,d.y,r.t,i.f,z],encapsulation:2}),e})();var ne=s("WrAK");function ae(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button",16),n.Vb("click",(function(){n.vc(e);const t=n.Zb(3);return t.exceptionHidden=!t.exceptionHidden})),n.Fc(1,"Toggle Details"),n.Nb()}}function oe(e,t){if(1&e&&(n.Ob(0,"pre"),n.Fc(1),n.Nb()),2&e){const e=n.Zb(3);n.yb(1),n.Gc(e.task.exceptionDetails)}}function re(e,t){if(1&e&&(n.Ob(0,"li",13),n.Ob(1,"h5"),n.Fc(2,"Error encountered!"),n.Nb(),n.Ob(3,"h6"),n.Fc(4),n.Ob(5,"div",14),n.Dc(6,ae,2,0,"dexih-button",15),n.Nb(),n.Nb(),n.Ob(7,"div"),n.Dc(8,oe,2,1,"pre",12),n.Nb(),n.Nb()),2&e){const e=n.Zb(2);n.yb(4),n.Hc("",e.task.message," "),n.yb(2),n.hc("ngIf",e.task.exceptionDetails),n.yb(2),n.hc("ngIf",!e.exceptionHidden&&e.task.exceptionDetails)}}const ce=function(e,t,s){return["/hub",e,"summary","datalinks","result-view",t,s]};function le(e,t){if(1&e&&(n.Ob(0,"h6"),n.Lb(1,"dexih-button-view",17),n.Nb()),2&e){const e=n.Zb(2);n.yb(1),n.hc("routerLink",n.oc(1,ce,e.task.referenceKey,e.task.data.auditConnectionKey,e.task.data.auditKey))}}function be(e,t){if(1&e&&(n.Ob(0,"h6"),n.Lb(1,"dexih-button-view",18),n.Nb()),2&e){const e=n.Zb(2);n.yb(1),n.hc("routerLink",n.oc(1,ce,e.task.referenceKey,e.task.data.auditConnectionKey,e.task.data.auditKey))}}function ue(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-widget",2),n.Vb("close",(function(){return n.vc(e),n.Zb().close()})),n.Ob(1,"div",3),n.Ob(2,"ul",4),n.Dc(3,re,9,3,"li",5),n.Ob(4,"li",6),n.Ob(5,"h5"),n.Fc(6,"Details"),n.Nb(),n.Nb(),n.Ob(7,"li",7),n.Ob(8,"div",8),n.Ob(9,"div",9),n.Ob(10,"div",10),n.Fc(11,"Status"),n.Nb(),n.Ob(12,"div",10),n.Fc(13),n.Nb(),n.Lb(14,"div",11),n.Ob(15,"div",10),n.Fc(16,"Last Updated"),n.Nb(),n.Ob(17,"div",10),n.Fc(18),n.ac(19,"calendar"),n.Nb(),n.Lb(20,"div",11),n.Ob(21,"div",10),n.Fc(22,"Name"),n.Nb(),n.Ob(23,"div",10),n.Fc(24),n.Nb(),n.Lb(25,"div",11),n.Ob(26,"div",10),n.Fc(27,"Category"),n.Nb(),n.Ob(28,"div",10),n.Fc(29),n.Nb(),n.Lb(30,"div",11),n.Ob(31,"div",10),n.Fc(32,"Description"),n.Nb(),n.Ob(33,"div",10),n.Fc(34),n.Nb(),n.Lb(35,"div",11),n.Nb(),n.Dc(36,le,2,5,"h6",12),n.Dc(37,be,2,5,"h6",12),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.hc("title","Task - "+(null==e.task?null:e.task.name))("showCloseButton",!0),n.yb(1),n.hc("ngSwitch",e.view),n.yb(2),n.hc("ngIf",(null==e.task?null:e.task.status)==e.eManagedTaskStatus.Error),n.yb(10),n.Gc(e.eManagedTaskStatus[e.task.status]),n.yb(5),n.Gc(n.bc(19,11,e.task.lastUpdate)),n.yb(6),n.Gc(e.task.name),n.yb(5),n.Gc(e.task.category),n.yb(5),n.Gc(e.task.description),n.yb(2),n.hc("ngIf","Datalink"===e.task.category),n.yb(1),n.hc("ngIf","Datajob"===e.task.category)}}let he=(()=>{class e{constructor(e,t,s){this.authService=e,this.router=t,this.route=s,this.showPage=!1,this.showPageMessage="Loading...",this.eManagedTaskStatus=x.Tb,this.exceptionHidden=!0}ngOnInit(){this.watchChanges();try{this._subscription=Object(k.a)(this.route.data,this.route.params,this.authService.getTasksObservable()).subscribe(e=>{let t=e[2],s=e[1].reference;this.showPage=!1,this.showPageMessage="Loading...",this.task=t.find(e=>e.taskId===s),this.task||this.authService.navigateUp()})}catch(e){}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}watchChanges(){}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["task-view"]],decls:2,vars:1,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close"],[1,"content",3,"ngSwitch"],[1,"list-group"],["class","list-group-item list-group-item-danger",4,"ngIf"],[1,"list-group-item","list-group-item-info"],[1,"list-group-item"],[1,"container"],[1,"row","rounded","text-white","bg-secondary"],[1,"col","border","border-white"],[1,"w-100"],[4,"ngIf"],[1,"list-group-item","list-group-item-danger"],[1,"float-right"],[3,"click",4,"ngIf"],[3,"click"],["text","Datalink Result",3,"routerLink"],["text","Datajob Result",3,"routerLink"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Dc(1,ue,38,13,"dexih-widget",1),n.Nb()),2&e&&(n.yb(1),n.hc("ngIf",t.task))},directives:[r.t,d.P,r.x,d.f,d.y,i.f],pipes:[ne.a],encapsulation:2}),e})();function de(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-view",5),n.Vb("click",(function(){n.vc(e);const s=t.item;return n.Zb().showMessage(s)})),n.Nb()}}let me=(()=>{class e{constructor(e,t,s){this.authService=e,this.router=t,this.route=s,this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"success",title:"Success",format:""},{name:"message",title:"Message",format:""},{name:"value",title:"Value",format:""}],this._tableData=new h.a(null),this.tableData=this._tableData.asObservable()}ngOnInit(){this.notifications=this.authService.getNotifications()}ngOnDestroy(){}showMessage(e){this.router.navigate(["view",e.reference],{relativeTo:this.route})}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["notification-index"]],decls:5,vars:6,consts:[[1,"container-fluid"],["title","Notifications","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","data","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],[3,"click"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.close()})),n.Ob(2,"dexih-table",2),n.Vb("rowClick",(function(e){return t.showMessage(e)})),n.Dc(3,de,1,0,"ng-template",3,4,n.Ec),n.Nb(),n.Nb(),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0),n.yb(1),n.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("data",t.notifications))},directives:[d.P,m.a,d.y],encapsulation:2}),e})();function fe(e,t){if(1&e&&(n.Ob(0,"div"),n.Lb(1,"hr"),n.Ob(2,"pre"),n.Fc(3),n.Nb(),n.Nb()),2&e){const e=n.Zb(3);n.yb(3),n.Gc(e.message.exceptionDetails)}}function ge(e,t){if(1&e&&(n.Ob(0,"section"),n.Ob(1,"div",4),n.Fc(2),n.Dc(3,fe,4,1,"div",3),n.Nb(),n.Nb()),2&e){const e=n.Zb(2);n.yb(1),n.Cb("alert-danger",0==e.message.success)("alert-success",1==e.message.success),n.yb(1),n.Hc(" ",e.message.message," "),n.yb(1),n.hc("ngIf",e.message.exceptionDetails&&e.message.message!=e.message.exceptionDetails)}}function pe(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-widget",2),n.Vb("close",(function(){return n.vc(e),n.Zb().close()})),n.Dc(1,ge,4,6,"section",3),n.Nb()}if(2&e){const e=n.Zb();n.hc("showCloseButton",!0)("padding",!0),n.yb(1),n.hc("ngIf",e.message)}}let ve=(()=>{class e{constructor(e,t,s){this.authService=e,this.router=t,this.route=s,this.showPage=!1,this.showPageMessage="Loading...",this.exceptionHidden=!0}ngOnInit(){this.watchChanges();try{this._subscription=Object(k.a)(this.route.params).subscribe(e=>{let t=e[0].reference;this.showPage=!1,this.showPageMessage="Loading...",this.message=this.authService.getNotification(t),this.message||this.authService.navigateUp()})}catch(e){}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}watchChanges(){}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["notification-view"]],decls:2,vars:1,consts:[[1,"container-fluid"],["title","Notification","iconClass","fa fa-lg fa-fw fa-bell",3,"showCloseButton","padding","close",4,"ngIf"],["title","Notification","iconClass","fa fa-lg fa-fw fa-bell",3,"showCloseButton","padding","close"],[4,"ngIf"],[1,"alert","clearfix"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Dc(1,pe,2,3,"dexih-widget",1),n.Nb()),2&e&&(n.yb(1),n.hc("ngIf",t.message))},directives:[r.t,d.P],encapsulation:2}),e})();var ye=s("1wre"),we=s("/pur");function Ne(e,t){}function Oe(e,t){}const ke=function(e){return["edit",e]},Se=function(e){return["token-renew",e]};function Ce(e,t){if(1&e&&(n.Ob(0,"li"),n.Ob(1,"a",19),n.Lb(2,"i",20),n.Fc(3," Edit"),n.Nb(),n.Nb(),n.Ob(4,"li"),n.Ob(5,"a",19),n.Lb(6,"i",21),n.Fc(7," Refresh Token"),n.Nb(),n.Nb()),2&e){const e=n.Zb(2).items;n.yb(1),n.hc("routerLink",n.mc(2,ke,e[0].remoteAgentKey)),n.yb(4),n.hc("routerLink",n.mc(4,Se,e[0].remoteAgentKey))}}function xe(e,t){if(1&e){const e=n.Pb();n.Ob(0,"li"),n.Ob(1,"a",22),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2).items;return n.Zb().test(t)})),n.Lb(2,"i",23),n.Fc(3," Test"),n.Nb(),n.Nb(),n.Ob(4,"li"),n.Ob(5,"a",24),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2).items;return n.Zb().restartAgents(t)})),n.Lb(6,"i",21),n.Fc(7," Restart"),n.Nb(),n.Nb(),n.Ob(8,"li"),n.Ob(9,"a",25),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2).items;return n.Zb().removeUserTokens(t)})),n.Ob(10,"span",26),n.Lb(11,"i",27),n.Fc(12," Revoke Tokens"),n.Nb(),n.Nb(),n.Nb()}}const Le=function(){return["token-new"]},Ie=function(){return["download"]};function Ae(e,t){if(1&e&&(n.Ob(0,"dexih-button-dropdown",13),n.Ob(1,"li"),n.Ob(2,"a",14),n.Lb(3,"i",15),n.Fc(4," New Token"),n.Nb(),n.Nb(),n.Ob(5,"li"),n.Ob(6,"a",16),n.Lb(7,"i",17),n.Fc(8," New Agent"),n.Nb(),n.Nb(),n.Dc(9,Ce,8,6,"ng-template",18),n.Dc(10,xe,13,0,"ng-template",18),n.Nb()),2&e){const e=n.Zb().items,t=n.Zb();n.hc("text",e.length>1?"Agents":"Agent")("pullRight",t.pullRight),n.yb(2),n.hc("routerLink",n.lc(6,Le)),n.yb(4),n.hc("routerLink",n.lc(7,Ie)),n.yb(3),n.hc("ngIf",1==e.length),n.yb(1),n.hc("ngIf",e.length>0)}}function De(e,t){if(1&e){const e=n.Pb();n.Dc(0,Ae,11,8,"dexih-button-dropdown",11),n.Ob(1,"dexih-button-refresh",12),n.Vb("click",(function(){return n.vc(e),n.Zb().refresh()})),n.Nb()}if(2&e){const e=t.items;n.hc("ngIf",e&&e.length>=0)}}function Te(e,t){if(1&e){const e=n.Pb();n.Ob(0,"button",31),n.Vb("click",(function(){n.vc(e);const t=n.Zb().item;return n.Zb().test([t])})),n.Fc(1,"test"),n.Nb()}}function Me(e,t){if(1&e&&(n.Ob(0,"button",36),n.Fc(1,"Failed"),n.Nb()),2&e){const e=n.Zb().$implicit;n.hc("title",e.testMessage)}}function Fe(e,t){if(1&e&&(n.Ob(0,"button",37),n.Fc(1,"Success"),n.Nb()),2&e){const e=n.Zb().$implicit;n.hc("title",e.testMessage)}}function Ke(e,t){if(1&e&&(n.Ob(0,"div",32),n.Fc(1),n.Ob(2,"a",33),n.Fc(3,"Open"),n.Nb(),n.Dc(4,Me,2,1,"button",34),n.Dc(5,Fe,2,1,"button",35),n.Nb()),2&e){const e=t.$implicit,s=n.Zb(2);n.yb(1),n.Hc(" ",s.eDownloadUrlType[e.downloadUrlType],": "),n.yb(1),n.hc("href",e.url+"/ping",n.xc),n.yb(2),n.hc("ngIf","error"==e.testStatus),n.yb(1),n.hc("ngIf","success"==e.testStatus)}}function Ee(e,t){if(1&e&&(n.Dc(0,Te,2,0,"button",28),n.Ob(1,"div",29),n.Dc(2,Ke,6,4,"div",30),n.Nb()),2&e){const e=t.item;n.hc("ngIf",(null==e.downloadUrls?null:e.downloadUrls.length)>0),n.yb(2),n.hc("ngForOf",e.downloadUrls)}}let Pe=(()=>{class e{constructor(e,t,s,i,n){this.hubsService=e,this.authService=t,this.hubService=s,this.router=i,this.route=n,this.columns=[{name:"name",title:"Name",format:""},{name:"connected",title:"Status",format:"Text",footer:"ipAddress"},{name:"user",title:"Owner",format:""},{name:"version",footer:"latestVersion",title:"Version",format:"Md",class:"versionClass",tooltip:"versionTooltip"},{name:"lastLoginDateTime",title:"Last Login",format:"Calendar"}],this._tableData=new h.a(null),this.tableData=this._tableData.asObservable(),this.eDownloadUrlType=x.sb,this.cancelToken=new C.a}ngOnInit(){this._subscription=this.authService.getRemoteAgentsObservable().subscribe(e=>{e&&(this.remoteAgents=e,this.refreshData())})}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}close(){this.authService.navigateUp()}refreshData(){let e=[];this.remoteAgents.forEach(t=>{let s=t.activeAgents&&t.activeAgents.length>0?t.activeAgents[0]:null;e.push(s?{remoteAgentKey:t.remoteAgentKey,connected:"active",name:s?s.name:t?t.name:"Unknown",user:s.user,dataPrivacyStatus:s.dataPrivacyStatus,isEncrypted:s.dataPrivacyStatus,ipAddress:s.ipAddress,restrictIp:t.restrictIp,ipAddresses:t.ipAddresses,lastLoginIpAddress:t.lastLoginIpAddress,lastLoginDateTime:t.lastLoginDateTime,remoteAgentId:t.remoteAgentId,downloadUrls:s.downloadUrls,instanceId:s.instanceId,version:s.version,latestVersion:"Latest("+s.latestVersion+")",versionTooltip:s.upgradeAvailable?"Upgrade is available.":"Agent is up to date.",versionClass:s.upgradeAvailable?"dexih-error-text":"",activeAgent:s}:{remoteAgentKey:t.remoteAgentKey,connected:"not connected",name:t.name,user:"",dataPrivacyStatus:"",isEncrypted:"",ipAddress:"",restrictIp:t.restrictIp,ipAddresses:t.ipAddresses,lastLoginIpAddress:t.lastLoginIpAddress,lastLoginDateTime:t.lastLoginDateTime,remoteAgentId:t.remoteAgentId,downloadUrls:[],instanceId:null,version:"",latestVersion:"",versionTooltip:"",versionClass:"",activeAgent:null})}),this._tableData.next(e)}test(e,t){e.forEach(e=>{e.downloadUrls.forEach((e,s)=>{this.authService.getFromExternal(e.url+"/ping","Testing remote agent connectivity...",t).then(t=>{t&&"alive"===t.status?e.testStatus="success":(e.testStatus="error",e.testMessage="Server returned invalid message.")}).catch(t=>{e.testStatus="error",e.testMessage=t.message})})})}removeUserTokens(e){this.authService.removeUserTokens(e.map(e=>e.remoteAgentKey)).then(e=>this.refreshData()).catch(e=>this.hubsService.addHubClientErrorMessage(e,"Remove tokens"))}refreshUserToken(e){this.router.navigate(["token-renew",e.remoteAgentKey],{relativeTo:this.route})}edit(e){this.router.navigate(["edit",e.remoteAgentKey],{relativeTo:this.route})}restartAgents(e){let t=e.filter(e=>e.activeAgent).map(e=>e.activeAgent);0!==t.length?t.forEach(e=>{this.hubsService.restartAgent(e,!1,this.cancelToken)}):this.hubService.addHubErrorMessage("No active agents were selected.")}refresh(){this.authService.pingRemoteAgents()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(o.a),n.Kb(a.a),n.Kb(o.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["remoteAgents"]],decls:12,vars:6,consts:[[1,"container-fluid"],["title","Connected Agents","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","close"],["rowStatusHeading","Direct Data Connections",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Remote Agent Installation","path","/assets/help/intro/remote_agent.md",1,"m-3"],["buttonClass","btn-primary","iconClass","fa fa-table",3,"text","pullRight",4,"ngIf"],["text","Refresh Agents","title","Refresh the active agents",1,"ml-1",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-table",3,"text","pullRight"],["title","Create a new remote agent token.",1,"dropdown-item",3,"routerLink"],[1,"fa","fa-file-o"],["title","Configure and download a new remote agent",1,"dropdown-item",3,"routerLink"],[1,"fa","fa-download"],[3,"ngIf"],[1,"dropdown-item",3,"routerLink"],[1,"fa","fa-edit"],[1,"fa","fa-refresh"],["title","Test the connectivity of the remote agents.",1,"dropdown-item",3,"click"],[1,"fa","fa-thumbs-o-up"],["title","Restart the selected agents",1,"dropdown-item",3,"click"],["title","Revoke the selected tokens",1,"dropdown-item",3,"click"],[1,"text-danger"],[1,"fa","fa-ban"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"list-group","mt-1"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"list-group-item"],["target","_blank",3,"href"],["class","btn btn-danger btn-sm float-right",3,"title",4,"ngIf"],["class","btn btn-success btn-sm float-right",3,"title",4,"ngIf"],[1,"btn","btn-danger","btn-sm","float-right",3,"title"],[1,"btn","btn-success","btn-sm","float-right",3,"title"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.close()})),n.Ob(2,"dexih-table",2),n.Vb("rowClick",(function(e){return t.edit(e)})),n.Dc(3,Ne,0,0,"ng-template",3,4,n.Ec),n.Dc(5,Oe,0,0,"ng-template",5,6,n.Ec),n.Dc(7,De,2,1,"ng-template",null,7,n.Ec),n.Dc(9,Ee,3,2,"ng-template",8,9,n.Ec),n.Nb(),n.Nb(),n.Lb(11,"dexih-help",10),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0),n.yb(1),n.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[d.P,m.a,we.a,r.t,d.s,d.i,i.h,r.s],encapsulation:2}),e})();var He=s("Xjf6");let Ze=(()=>{class e{constructor(e,t,s,i){this.authService=e,this.hubService=t,this.router=s,this.route=i}ngOnInit(){this._subscription=this.route.queryParams.subscribe(e=>{let t=e.path;this.path=t?"/assets/help/"+t:"/assets/help/intro/getting_started.md"}),this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe(e=>{this.hubKey=e&&e.hub?e.hub.hubKey:null})}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe()}close(){this.authService.navigateUp()}linkClick(e){this.router.navigate([],{relativeTo:this.route,queryParams:{path:e}})}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(He.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["help"]],decls:2,vars:3,consts:[[1,"container-fluid"],["title","Help",3,"path","display","hubKey","linkClick"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-help",1),n.Vb("linkClick",(function(e){return t.linkClick(e)})),n.Nb(),n.Nb()),2&e&&(n.yb(1),n.hc("path",t.path)("display",!0)("hubKey",t.hubKey))},directives:[we.a],encapsulation:2}),e})();function Ve(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-download",5),n.Vb("click",(function(){n.vc(e);const t=n.Zb();return!t.downloading&&t.download()})),n.Nb(),n.Ob(1,"dexih-button",6),n.Vb("click",(function(){n.vc(e);const t=n.Zb();return!t.downloading&&t.downloadRemoteSettings()})),n.Nb(),n.Ob(2,"dexih-button-cancel",7),n.Vb("click",(function(){n.vc(e);const t=n.Zb();return!t.downloading&&t.cancel()})),n.Nb()}if(2&e){const e=n.Zb();n.hc("busy",e.downloading),n.yb(1),n.hc("busy",e.downloading)}}function Ue(e,t){if(1&e){const e=n.Pb();n.Ob(0,"a",46),n.Vb("click",(function(){return n.vc(e),n.Zb(2).generateEncryptionKey()})),n.Lb(1,"i",47),n.Fc(2," Generate Random Key "),n.Nb()}}function _e(e,t){1&e&&(n.Ob(0,"span"),n.Lb(1,"i",48),n.Fc(2," Refreshing... please wait "),n.Nb())}function Re(e,t){1&e&&n.Lb(0,"form-checkbox",49)}function Ge(e,t){if(1&e&&(n.Ob(0,"section"),n.Lb(1,"form-tags",50),n.Nb()),2&e){const e=n.Zb(2);n.yb(1),n.hc("errors",e.formsService.formErrors.allowedPaths)}}function Be(e,t){if(1&e&&(n.Ob(0,"section"),n.Lb(1,"form-tags-dropdown",51),n.Nb()),2&e){const e=n.Zb(2);n.yb(1),n.hc("items",e.hubs)("errors",e.formsService.formErrors.allowedHubs)("returnKeys",!0)}}const je=function(){return{standalone:!0}};function qe(e,t){if(1&e){const e=n.Pb();n.Ob(0,"form",8),n.Ob(1,"fieldset"),n.Ob(2,"section"),n.Lb(3,"form-input",9),n.Nb(),n.Ob(4,"section"),n.Ob(5,"form-select",10),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().environment=t})),n.Nb(),n.Nb(),n.Ob(6,"section"),n.Ob(7,"form-input",11),n.Fc(8," ( "),n.Dc(9,Ue,3,0,"a",12),n.Dc(10,_e,3,0,"span",13),n.Fc(11," ) "),n.Nb(),n.Nb(),n.Ob(12,"div",14),n.Ob(13,"section",15),n.Ob(14,"form-checkbox",16),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().embedUserName=t})),n.Nb(),n.Nb(),n.Nb(),n.Ob(15,"div",14),n.Ob(16,"section",15),n.Lb(17,"form-checkbox",17),n.Nb(),n.Ob(18,"section",15),n.Lb(19,"form-checkbox",18),n.Nb(),n.Nb(),n.Ob(20,"div",14),n.Ob(21,"section",15),n.Lb(22,"form-checkbox",19),n.Nb(),n.Ob(23,"section",15),n.Lb(24,"form-checkbox",20),n.Nb(),n.Nb(),n.Ob(25,"section"),n.Ob(26,"form-select",21),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().logLevel=t})),n.Nb(),n.Nb(),n.Ob(27,"div",14),n.Ob(28,"section",15),n.Lb(29,"form-input",22),n.Nb(),n.Ob(30,"section",15),n.Lb(31,"form-input",23),n.Nb(),n.Nb(),n.Ob(32,"div",14),n.Ob(33,"section",15),n.Lb(34,"form-checkbox",24),n.Nb(),n.Ob(35,"section",15),n.Lb(36,"form-checkbox",25),n.Nb(),n.Nb(),n.Ob(37,"div",14),n.Ob(38,"section",15),n.Lb(39,"form-checkbox",26),n.Nb(),n.Ob(40,"section",15),n.Lb(41,"form-checkbox",27),n.Nb(),n.Nb(),n.Ob(42,"div",14),n.Ob(43,"section",15),n.Lb(44,"form-checkbox",28),n.Nb(),n.Lb(45,"section",15),n.Nb(),n.Ob(46,"div",14),n.Ob(47,"section",15),n.Lb(48,"form-checkbox",29),n.Nb(),n.Ob(49,"section",15),n.Lb(50,"form-checkbox",30),n.Nb(),n.Nb(),n.Ob(51,"div",14),n.Ob(52,"section",15),n.Lb(53,"form-checkbox",31),n.Nb(),n.Nb(),n.Ob(54,"div",14),n.Ob(55,"section",15),n.Lb(56,"form-checkbox",32),n.Nb(),n.Ob(57,"section",15),n.Lb(58,"form-checkbox",33),n.Nb(),n.Nb(),n.Ob(59,"div",14),n.Ob(60,"section",15),n.Lb(61,"form-checkbox",34),n.Nb(),n.Ob(62,"section",15),n.Dc(63,Re,1,0,"form-checkbox",35),n.Nb(),n.Nb(),n.Dc(64,Ge,2,1,"section",13),n.Ob(65,"section"),n.Lb(66,"form-checkbox",36),n.Nb(),n.Dc(67,Be,2,3,"section",13),n.Ob(68,"div",14),n.Ob(69,"section",15),n.Lb(70,"form-input",37),n.Nb(),n.Ob(71,"section",15),n.Lb(72,"form-input",38),n.Nb(),n.Nb(),n.Ob(73,"div",14),n.Ob(74,"section",15),n.Lb(75,"form-input",39),n.Nb(),n.Ob(76,"section",15),n.Lb(77,"form-input",40),n.Nb(),n.Nb(),n.Ob(78,"div",14),n.Ob(79,"section",15),n.Lb(80,"form-input",41),n.Nb(),n.Ob(81,"section",15),n.Lb(82,"form-checkbox",42),n.Nb(),n.Nb(),n.Ob(83,"div",14),n.Ob(84,"section",15),n.Lb(85,"form-checkbox",43),n.Nb(),n.Ob(86,"section",15),n.Lb(87,"form-checkbox",44),n.Nb(),n.Nb(),n.Ob(88,"section"),n.Lb(89,"form-tags",45),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.hc("formGroup",e.formsService.currentForm),n.yb(3),n.hc("errors",e.formsService.formErrors.name),n.yb(2),n.hc("ngModel",e.environment)("ngModelOptions",n.lc(19,je))("items",e.eEnvironmentItems)("enableFilter",!1),n.yb(2),n.hc("autocapitalize",e.on)("errors",e.formsService.formErrors.encryptionKey),n.yb(2),n.hc("ngIf",0==e.refreshingEncryptionKey),n.yb(1),n.hc("ngIf",1==e.refreshingEncryptionKey),n.yb(4),n.hc("ngModel",e.embedUserName)("ngModelOptions",n.lc(20,je)),n.yb(12),n.hc("ngModel",e.logLevel)("ngModelOptions",n.lc(21,je))("items",e.logLevelItems)("enableFilter",!1),n.yb(37),n.hc("ngIf",e.formsService.currentForm.controls.allowLocalFiles.value),n.yb(1),n.hc("ngIf",e.formsService.currentForm.controls.allowLocalFiles.value&&!e.formsService.currentForm.controls.allowAllPaths.value),n.yb(3),n.hc("ngIf",!e.formsService.currentForm.controls.allowAllHubs.value)}}let $e=(()=>{class e{constructor(e,t,s,i){this.hubsService=e,this.authService=t,this.formsService=s,this.fb=i,this.downloading=!1,this.refreshingEncryptionKey=!1,this.refreshingUserToken=!1,this.logLevelItems=x.tc,this.eEnvironmentItems=x.wb.filter(e=>e.key>0),this.embedUserName=!0,this.logLevel=x.sc.Information,this.environment=x.vb.Windows}ngOnInit(){this.hubs=this.authService.getHubs();let e=new x.T;this.remoteAgentSettings(e),this.logLevel=x.sc.Information}ngOnDestroy(){}cancel(){this.authService.navigateUp()}download(){this.formsService.currentForm.valid?(this.downloading=!0,this.hubsService.downloadRemoteAgent(this.embedUserName,this.environment,this.logLevel,this.formsService.currentForm.value).then(e=>{this.downloading=!1,this.hubsService.addHubSuccessMessage("Download successful.")}).catch(e=>{this.downloading=!1,this.hubsService.addHubMessage(e)})):this.formsService.showErrors()}downloadRemoteSettings(){this.formsService.currentForm.valid?(this.downloading=!0,this.hubsService.downloadRemoteSettings(this.embedUserName,this.environment,this.logLevel,this.formsService.currentForm.value).then(e=>{this.downloading=!1,this.hubsService.addHubSuccessMessage("Download successful.")}).catch(e=>{this.downloading=!1})):this.formsService.showErrors()}generateEncryptionKey(){this.refreshingEncryptionKey=!0,this.authService.getRandomEncryptionKey().then(e=>{this.formsService.currentForm.controls.encryptionKey.setValue(e),this.refreshingEncryptionKey=!1}).catch(e=>{this.hubsService.addHubErrorMessage(e),this.refreshingEncryptionKey=!1})}generateUserToken(){this.refreshingUserToken=!0,this.authService.getUserToken().then(e=>{this.formsService.currentForm.controls.userToken.setValue(e.userToken),this.formsService.currentForm.controls.remoteAgentId.setValue(e.remoteAgentId),this.refreshingUserToken=!1}).catch(e=>{this.hubsService.addHubErrorMessage(e),this.refreshingUserToken=!1})}remoteAgentSettings(e){const t=this.fb.group({name:[e.name,[S.G.required,S.G.minLength(3),S.G.maxLength(50)]],encryptionKey:[e.encryptionKey,[S.G.required]]});this.formsService.addMissing(e,t,new x.T),this.formsService.clearFormSubscriptions(),this.formsService.startForm(t)}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(o.a),n.Kb(a.a),n.Kb(Z.a),n.Kb(S.g))},e.\u0275cmp=n.Eb({type:e,selectors:[["dexih-remoteAgent-download-form"]],features:[n.xb([Z.a])],decls:6,vars:3,consts:[[1,"container"],["title","Download Agent","iconClass","fa fa-lg fa-fw fa-download",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Remote Agent Installation","path","/assets/help/intro/remote_agent.md",1,"m-3"],["text","Download",1,"mr-1",3,"busy","click"],["iconClass","fa fa-wrench","text","Settings File",1,"mr-1",3,"busy","click"],[3,"click"],[3,"formGroup"],["label","Remote Agent Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"errors"],["label","Operating System","itemKey","key","itemName","name","note","The operating system that remote agent will be executed on.",3,"ngModel","ngModelOptions","items","enableFilter","ngModelChange"],["label","Encryption Key","formControlName","encryptionKey","placeholder","Encryption key (blank will auto-generate)","iconClass","fa fa-key","note","Encryption key is used to encrypt secure fields and connection passwords.  Note: this key is not retained by the integration hub, and if lost encrypted data can not be restored.",3,"autocapitalize","errors"],["href","javascript:void(0)",3,"click",4,"ngIf"],[4,"ngIf"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Auto-login using current user.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Auto-upgrade when new versions of the remote agent become available.","formControlName","autoUpgrade"],["label","Allow beta and pre-releases.","formControlName","preRelease"],["label","Allow data and files to be uploaded to the remote agent.","formControlName","allowUpload"],["label","Allow data and files to be downloaded (including data previews) from the remote agent.","formControlName","allowDownload"],["label","Logging Level","itemKey","key","itemName","name","note","The level of detail to be included in the diagnostic logs.",3,"ngModel","ngModelOptions","items","enableFilter","ngModelChange"],["label","Local Upload/Download Port","formControlName","downloadPort","placeholder","Enter the upload/download port","note","The local port for the remote agent to use for upload/download operations."],["label","External Upload/Download Url","formControlName","externalDownloadUrl","note","The url which can be used to access the upload/download operations on the remote agent.  e.g. https://10.10.10.10:33944."],["label","Include plugin for Oracle databases (~4MB download)","formControlName","oracle"],["label","Include plugin for DB2 databases (~30MB download)","formControlName","dB2"],["label","Include plugin for Mongo databases  (~4MB download)","formControlName","mongo"],["label","Include plugin for Excel files (~3MB download)","formControlName","excel"],["label","Include plugin for Machine Learning Functions (~32-40MB download)","formControlName","mLNet"],["label","Allow data access through the Local Area Network (LAN).","formControlName","allowLanAccess"],["label","Allow data access through the Internet.","formControlName","allowExternalAccess"],["label","Allow data access through an internet based Proxy Server.","formControlName","allowProxy"],["label","Enforce Https (SSL encrypted connections).","formControlName","enforceHttps"],["label","Automatically attempt to create an SSL certificate (used for encryption).","formControlName","autoGenerateCertificate"],["label","Allow files to be managed on local file system.","formControlName","allowLocalFiles"],["label","Allow all remote agent paths to be available.","formControlName","allowAllPaths",4,"ngIf"],["label","Allow all hubs to be available.","formControlName","allowAllHubs"],["label","Alerts Smtp Server","formControlName","smtpServer","placeholder","Alerts Smtp Server","note","Enter the Smtp Server name to use to send alert emails."],["type","number","label","Smtp Port Number","formControlName","smtpPort","note","The port number to for tme Smtp Server"],["label","Alerts Smtp UserName","formControlName","smtpUserName","placeholder","Alerts Smtp Server","note","Enter the Smtp user name to use to send alert emails."],["label","Smtp Password","formControlName","smtpPassword","note","The Smtp password"],["label","Alerts From Email","formControlName","fromEmail","note",'Email address listed "From" when sending alerts.'],["label","Smpt Server Requires SSL encryption.","formControlName","enableSsl"],["label","Send alert on startup and shutdown.","formControlName","alertOnShutdown"],["label","Send alert on critical remote agent errors.","formControlName","alertOnCritical"],["label","Email addresses to send the bcc alerts to.","formControlName","adminEmails","iconClass","fa fa-email","note","A set of emails that any alerts will be bcc'd to."],["href","javascript:void(0)",3,"click"],[1,"fa","fa-refresh"],[1,"fa","fa-spin","fa-refresh"],["label","Allow all remote agent paths to be available.","formControlName","allowAllPaths"],["label","Allowed root paths for local file management.","formControlName","allowedPaths","iconClass","fa fa-list","note","The root directories which can be accessed when managing flat files.   All directories below the specified root directories will be available.",3,"errors"],["label","Hubs allowed by the remote agent.","formControlName","allowedHubs","itemKey","hubKey","itemName","name","iconClass","fa fa-list",3,"items","errors","returnKeys"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.cancel()})),n.Dc(2,Ve,3,2,"ng-template",null,2,n.Ec),n.Dc(4,qe,90,22,"form",3),n.Nb(),n.Lb(5,"dexih-help",4),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0)("padding",!0),n.yb(3),n.hc("ngIf",t.formsService.currentForm))},directives:[d.P,r.t,we.a,d.h,d.f,d.b,S.I,S.t,S.l,d.D,S.s,S.j,d.E,S.v,d.A,d.F,d.G],encapsulation:2}),e})();function We(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-save",5),n.Vb("click",(function(){return n.vc(e),n.Zb().save()})),n.Nb(),n.Ob(1,"dexih-button-cancel",6),n.Vb("click",(function(){return n.vc(e),n.Zb().close()})),n.Nb()}}function Qe(e,t){if(1&e){const e=n.Pb();n.Ob(0,"span"),n.Fc(1," ( "),n.Ob(2,"a",14),n.Vb("click",(function(){return n.vc(e),n.Zb(3).addCurrentIp()})),n.Lb(3,"i",15),n.Fc(4),n.Nb(),n.Fc(5,") "),n.Nb()}if(2&e){const e=n.Zb(3);n.yb(4),n.Hc(" Add Current (",e.ipAddress,") ")}}function ze(e,t){if(1&e&&(n.Ob(0,"section"),n.Ob(1,"form-tags",13),n.Dc(2,Qe,6,1,"span",12),n.Nb(),n.Nb()),2&e){const e=n.Zb(2);n.yb(2),n.hc("ngIf",e.ipAddress)}}function Je(e,t){if(1&e&&(n.Ob(0,"form",7),n.Ob(1,"fieldset"),n.Ob(2,"section"),n.Lb(3,"form-input",8),n.Nb(),n.Ob(4,"section"),n.Lb(5,"form-input",9),n.Nb(),n.Ob(6,"section"),n.Lb(7,"form-checkbox",10),n.Nb(),n.Ob(8,"section"),n.Lb(9,"form-checkbox",11),n.Nb(),n.Dc(10,ze,3,1,"section",12),n.Nb(),n.Nb()),2&e){const e=n.Zb();n.hc("formGroup",e.formsService.currentForm),n.yb(10),n.hc("ngIf",e.formsService.currentForm.controls.restrictIp.value)}}let Xe=(()=>{class e{constructor(e,t,s,i,n,a){this.authService=e,this.hubsService=t,this.formsService=s,this.fb=i,this.router=n,this.route=a}ngOnInit(){try{this._subscription=Object(k.a)(this.route.data,this.route.params,this.authService.getRemoteAgentsObservable()).subscribe(e=>{let t=e[1];this.remoteAgents=e[2],this.remoteAgents&&(this.remoteAgentKey=+t.remoteAgentKey,this.hubsService.remoteAgents().then(e=>{let t=this.remoteAgents.find(e=>e.remoteAgentKey===this.remoteAgentKey);const s=this.fb.group({});this.formsService.addMissing(t,s,new x.F),s.controls.name.disable(),s.controls.remoteAgentId.disable(),this.formsService.clearFormSubscriptions(),this.formsService.startForm(s)}))})}catch(e){this.hubsService.addHubClientErrorMessage(e,"Remote Agent Edit")}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}save(){let e=this.formsService.currentForm,t=e.value;t.name=e.controls.name.value,t.remoteAgentId=e.controls.remoteAgentId.value,this.authService.saveRemoteAgent(this.formsService.currentForm.value).then(e=>{this.hubsService.addHubSuccessMessage("The remote agent was updated successfully."),this.authService.pingRemoteAgents()})}addCurrentIp(){if(this.ipAddress){let e=this.formsService.currentForm.controls.ipAddresses,t=e.value;t.findIndex(e=>e===this.ipAddress)<0&&(t.push(this.ipAddress),e.setValue(t))}}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(o.a),n.Kb(Z.a),n.Kb(S.g),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["remote-agents"]],inputs:{hubKey:"hubKey"},features:[n.xb([Z.a])],decls:7,vars:3,consts:[["DexihMessage",""],[1,"container"],["title","Edit Agent","iconClass","fa fa-lg fa-fw fa-database",3,"padding","showCloseButton","close"],["header",""],[3,"formGroup",4,"ngIf"],[1,"mr-1",3,"click"],[3,"click"],[3,"formGroup"],["label","Agent name","note","This can only be changed on the remote agent settings file.","formControlName","name","iconClass","fa fa-comment"],["label","Remote Agent Id","note","This can only be changed on the remote agent settings file.","formControlName","remoteAgentId","iconClass","fa fa-comment"],["label","Allow data sharing through the agent via other hubs or through the API.","formControlName","allowExternalConnect"],["label","Restrict remote agent ip addresses.","formControlName","restrictIp"],[4,"ngIf"],["label","Restricted IP Addresses","formControlName","ipAddresses","placeholder","Enter the IP Address.","note","List of Ip Addresses.  The remote agent only be authorized for this hub if originating from one of the listed ip addresses."],["href","javascript:void(0)",3,"click"],[1,"fa","fa-refresh"]],template:function(e,t){1&e&&(n.Lb(0,"dexih-message",null,0),n.Ob(2,"div",1),n.Ob(3,"dexih-widget",2),n.Vb("close",(function(){return t.close()})),n.Dc(4,We,2,0,"ng-template",null,3,n.Ec),n.Dc(6,Je,11,2,"form",4),n.Nb(),n.Nb()),2&e&&(n.yb(3),n.hc("padding",!0)("showCloseButton",!0),n.yb(3),n.hc("ngIf",t.formsService.currentForm))},directives:[c.a,d.P,r.t,d.t,d.b,S.I,S.t,S.l,d.D,S.s,S.j,d.A,d.F],encapsulation:2}),e})();function Ye(e,t){1&e&&(n.Ob(0,"label",11),n.Fc(1,"A new remote agent token has been generated. "),n.Nb())}function et(e,t){1&e&&(n.Ob(0,"label",11),n.Fc(1,"The token for this user/remote id has been renewed. "),n.Nb())}function tt(e,t){if(1&e&&(n.Dc(0,Ye,2,0,"label",9),n.Dc(1,et,2,0,"label",9),n.Ob(2,"div",10),n.Fc(3," Ensure this token is kept safe and secure. It cannot be viewed again. If it is lost or compromised, a new token should be created. "),n.Nb()),2&e){const e=n.Zb(2);n.hc("ngIf","New"==e.action),n.yb(1),n.hc("ngIf","ReNew"==e.action)}}function st(e,t){if(1&e){const e=n.Pb();n.Ob(0,"div",2),n.Ob(1,"dexih-widget",3),n.Vb("close",(function(){return n.vc(e),n.Zb().close()})),n.Dc(2,tt,4,2,"ng-template",null,4,n.Ec),n.Ob(4,"section"),n.Ob(5,"form-textarea",5),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().remoteToken.user=t})),n.Nb(),n.Nb(),n.Ob(6,"section"),n.Ob(7,"form-textarea",6),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().remoteToken.remoteAgentId=t})),n.Nb(),n.Nb(),n.Ob(8,"section"),n.Ob(9,"form-textarea",7),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().remoteToken.userToken=t})),n.Nb(),n.Nb(),n.Ob(10,"section"),n.Ob(11,"form-textarea",8),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb().appSettings=t})),n.Nb(),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb();n.yb(1),n.hc("padding",!0)("showCloseButton",!0),n.yb(4),n.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.remoteToken.user),n.yb(2),n.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.remoteToken.remoteAgentId),n.yb(2),n.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.remoteToken.userToken),n.yb(2),n.hc("showCopy",!0)("showPreview",!1)("hideToggle",!0)("disabled",!0)("ngModel",e.appSettings)}}let it=(()=>{class e{constructor(e,t,s){this.route=e,this.hubsService=t,this.authService=s}ngOnInit(){this._subscription=Object(k.a)(this.route.data,this.route.params).subscribe(e=>{return t=this,void 0,i=function*(){let t,s=e[0],i=e[1];this.action=s.action,t="New"===s.action?this.authService.createRemoteAgent():this.authService.refreshRemoteAgentToken(+i.remoteAgentKey),t.then(e=>{this.remoteToken=e,this.updateAppSettings()}).catch(e=>{this.hubsService.addHubMessage(e),this.authService.navigateUp()})},new((s=void 0)||(s=Promise))((function(e,n){function a(e){try{r(i.next(e))}catch(t){n(t)}}function o(e){try{r(i.throw(e))}catch(t){n(t)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(a,o)}r((i=i.apply(t,[])).next())}));var t,s,i})}updateAppSettings(){this.appSettings=`"RemoteAgentId": "${this.remoteToken.remoteAgentId}",\n"User": "${this.remoteToken.user}",\n"UserToken": "${this.remoteToken.userToken}",\n`}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe()}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(i.a),n.Kb(o.a),n.Kb(a.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["remote-agent-token"]],features:[n.xb([Z.a])],decls:3,vars:1,consts:[["DexihMessage",""],["class","container",4,"ngIf"],[1,"container"],["title","New Agent Token","iconClass","fa fa-lg fa-fw fa-wifi",3,"padding","showCloseButton","close"],["subHeader",""],["rows","1","label","User",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["rows","1","label","RemoteAgentId",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["rows","4","label","UserToken",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["rows","4","label","AppSettings Content","note","Copy this section over the existing items in the AppSettings section of the appsettings.json configuration file for your remote agent.",3,"showCopy","showPreview","hideToggle","disabled","ngModel","ngModelChange"],["class","label",4,"ngIf"],[1,"alert","alert-info"],[1,"label"]],template:function(e,t){1&e&&(n.Lb(0,"dexih-message",null,0),n.Dc(2,st,12,22,"div",1)),2&e&&(n.yb(2),n.hc("ngIf",t.remoteToken))},directives:[c.a,r.t,d.P,d.H,S.s,S.v],encapsulation:2}),e})();var nt=s("wd/R"),at=s("IGpA");const ot=["DexihMessage"];function rt(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-save",19),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2);return!t.saving&&!t.mainForm.pristine&&t.save()})),n.Nb(),n.Ob(1,"dexih-button-cancel",20),n.Vb("click",(function(){n.vc(e);const t=n.Zb(2);return!t.saving&&t.cancel()})),n.Nb()}if(2&e){const e=n.Zb(2);n.hc("disabled",e.saving||e.mainForm.pristine)("busy",e.saving),n.yb(1),n.hc("disabled",e.saving)}}function ct(e,t){if(1&e&&(n.Ob(0,"form",23),n.Ob(1,"fieldset"),n.Ob(2,"section"),n.Lb(3,"form-textarea",24),n.ac(4,"calendar"),n.Nb(),n.Nb(),n.Nb()),2&e){const e=t.$implicit;n.hc("formGroup",e),n.yb(3),n.kc("label","",e.controls.userName.value," - ",n.bc(4,4,e.controls.updateDate.value),""),n.hc("disabled",!0)}}function lt(e,t){if(1&e&&(n.Ob(0,"dexih-widget-section",21),n.Dc(1,ct,5,6,"form",22),n.Nb()),2&e){const e=n.Zb(2);n.hc("showExpandButton",!0)("padding",!0),n.yb(1),n.hc("ngForOf",e.mainForm.controls.dexihIssueComments.controls)}}function bt(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-save",19),n.Vb("click",(function(){n.vc(e);const t=n.Zb(3);return!t.saving&&t.newComment&&t.saveComment()})),n.Nb(),n.Ob(1,"dexih-button-cancel",20),n.Vb("click",(function(){n.vc(e);const t=n.Zb(3);return!t.saving&&t.cancel()})),n.Nb()}if(2&e){const e=n.Zb(3);n.hc("disabled",e.saving||!e.newComment)("busy",e.saving),n.yb(1),n.hc("disabled",e.saving)}}const ut=function(){return{standalone:!0}};function ht(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-widget-section",25),n.Dc(1,bt,2,3,"ng-template",null,6,n.Ec),n.Ob(3,"form"),n.Ob(4,"fieldset"),n.Ob(5,"section"),n.Ob(6,"form-textarea",26),n.Vb("ngModelChange",(function(t){return n.vc(e),n.Zb(2).newComment=t})),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Nb()}if(2&e){const e=n.Zb(2);n.hc("showExpandButton",!0)("padding",!0),n.yb(6),n.hc("ngModel",e.newComment)("ngModelOptions",n.lc(5,ut))("hideToggle",!0)}}function dt(e,t){if(1&e&&(n.Ob(0,"dexih-widget-section",25),n.Ob(1,"p"),n.Fc(2,"This is a public issue and is managed through the GitHub issue below."),n.Nb(),n.Ob(3,"a",27),n.Lb(4,"i",28),n.Fc(5,"GitHub Issue"),n.Nb(),n.Nb()),2&e){const e=n.Zb(2);n.hc("showExpandButton",!0)("padding",!0),n.yb(3),n.hc("href",null==e.mainForm.controls.gitHubLink?null:e.mainForm.controls.gitHubLink.value,n.xc)}}function mt(e,t){if(1&e&&(n.Ob(0,"dexih-widget",3),n.Lb(1,"support-options",4),n.Ob(2,"dexih-widget-section",5),n.Dc(3,rt,2,3,"ng-template",null,6,n.Ec),n.Ob(5,"form",7),n.Ob(6,"fieldset"),n.Ob(7,"section"),n.Lb(8,"form-input",8),n.Nb(),n.Ob(9,"div",9),n.Ob(10,"section",10),n.Lb(11,"form-select",11),n.Nb(),n.Ob(12,"section",10),n.Lb(13,"form-select",12),n.Nb(),n.Nb(),n.Ob(14,"div",9),n.Ob(15,"section",10),n.Lb(16,"form-select",13),n.Nb(),n.Ob(17,"section",10),n.Lb(18,"form-select",14),n.Nb(),n.Nb(),n.Ob(19,"section"),n.Lb(20,"form-checkbox",15),n.Nb(),n.Ob(21,"section"),n.Lb(22,"form-textarea",16),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Dc(23,lt,2,3,"dexih-widget-section",17),n.Dc(24,ht,7,6,"dexih-widget-section",18),n.Dc(25,dt,6,3,"dexih-widget-section",18),n.Nb()),2&e){const e=n.Zb();n.yb(1),n.hc("isExpanded",!1),n.yb(1),n.hc("subTitle",e.subTitle)("showExpandButton",!0)("padding",!0),n.yb(3),n.hc("formGroup",e.mainForm),n.yb(3),n.hc("errors",e.formErrors.name),n.yb(3),n.hc("items",e.eIssueTypeItems),n.yb(2),n.hc("items",e.eIssueSeverityItems),n.yb(3),n.hc("items",e.eIssueCategoryItems),n.yb(2),n.hc("items",e.eIssueStatusItems),n.yb(4),n.hc("hideToggle",e.isNew),n.yb(1),n.hc("ngIf",e.mainForm.controls.dexihIssueComments.controls.length>0),n.yb(1),n.hc("ngIf",e.mainForm.controls.key.value>0&&e.mainForm.controls.isPrivate.value),n.yb(1),n.hc("ngIf",e.mainForm.controls.key.value>0&&!e.mainForm.controls.isPrivate.value)}}const ft=nt;let gt=(()=>{class e{constructor(e,t,s){this.authService=e,this.route=t,this.fb=s,this.eIssueTypeItems=x.Ob,this.eIssueSeverityItems=x.Kb,this.eIssueStatusItems=x.Mb,this.eIssueCategoryItems=x.Ib,this.SharedAccessItems=x.cc.filter(e=>e.key>0),this.generatingKey=!1,this.saving=!1,this.hasChanged=!1,this.showAllErrors=!1,this.disable=!1,this.isNew=!0,this.formErrors={name:"",description:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long.",duplicateHubName:"Name cannot be the same as an existing hub name."},description:{required:"Description is required."}},this.supportOptions=[{name:"Forums",icon:"fa fa-smile-o",link:"https://dexih.mn.co/feed",description:"Use the community forums for questions and other integration hub discussion."},{name:"Twitter",icon:"fa fa-twitter",link:"https://twitter.com/dataexperts",description:"Send messages to our twitter for quick short queries and comments."},{name:"YouTube",icon:"fa fa-youtube",link:"https://www.youtube.com/channel/UCUQQ_sVuFti-xYvKtfLJNkg",description:"Refer to our youtube channel for video tutorials."},{name:"Features / Issues",icon:"fa fa-github",link:"https://github.com/DataExperts/Dexih.App.UI",description:"We are an open source platform.  Raise feature requests and bugs on our github pages."}],this.cancelToken=new C.a}ngOnInit(){try{this._subscription=Object(k.a)(this.route.data,this.route.params).subscribe(e=>{let t=e[0],s=e[1];if(this.action=t.action,this.pageTitle=t.pageTitle,"new"===this.action)this.issue=new x.D,this.buildForm(),this.isNew=!0,this.disable=!1;else if("edit"===this.action){let e=+s.issueKey;this.isNew=!1,this.authService.getIssue(e,this.cancelToken).then(e=>{this.issue=e,this.subTitle="Updated by "+e.userName+" - "+ft(e.updateDate).calendar(),this.buildForm(),this.disable=!this.authService.getUser().isAdmin})}})}catch(e){this.dexihMessage.addErrorMessage(e.message)}}ngOnDestroy(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this.cancelToken.cancel()}save(){this.dexihMessage.reset(),this.saving=!0,Object.assign(this.issue,this.mainForm.value),this.authService.saveIssue(this.issue).then(()=>{this.saving=!1,this.dexihMessage.addSuccessMessage("Issue created successfully."),this.cancel()}).catch(e=>{this.dexihMessage.addMessage(e),this.saving=!1})}saveComment(){this.dexihMessage.reset(),this.saving=!0,this.authService.addIssueComment(this.issue.key,this.newComment).then(()=>{this.saving=!1,this.dexihMessage.addSuccessMessage("Issue comment added successfully."),this.cancel()}).catch(e=>{this.dexihMessage.addMessage(e),this.saving=!1})}cancel(){this.authService.navigateUp()}buildForm(){this.mainForm=this.fb.group({key:[{value:this.issue.key,disabled:this.disable},[]],name:[{value:this.issue.name,disabled:this.disable},[S.G.required,S.G.minLength(4),S.G.maxLength(50)]],description:[{value:this.issue.description,disabled:this.disable},[S.G.required]],type:[{value:this.issue.type,disabled:this.disable},[]],category:[{value:this.issue.category,disabled:this.disable},[]],severity:[{value:this.issue.severity,disabled:this.disable},[]],isPrivate:[{value:this.issue.isPrivate,disabled:this.disable},[]],updateDate:[{value:this.issue.updateDate,disabled:!0},[]],userName:[{value:this.issue.userName,disabled:!0},[]],issueStatus:[{value:this.issue.issueStatus,disabled:!1},[]],gitHubLink:[{value:this.issue.gitHubLink,disabled:!1},[]],dexihIssueComments:this.fb.array(this.issue.dexihIssueComments.map(e=>this.fb.group({comment:{value:e.comment,disabled:this.disable},userName:[{value:e.userName,disabled:!0},[]],updateDate:{value:e.updateDate,disabled:!0}})))}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe(()=>this.onValueChanged()),this.onValueChanged(),this.hasChanged=!1}onValueChanged(){if(!this.mainForm)return;const e=this.mainForm;this.hasChanged=!0;for(const t of Object.keys(this.formErrors)){this.formErrors[t]="";const s=e.get(t);if(s&&(s.dirty||this.showAllErrors)&&!s.valid){const e=this.validationMessages[t];for(const i of Object.keys(s.errors))this.formErrors[t]+=e[i]+" "}}}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.a),n.Kb(S.g))},e.\u0275cmp=n.Eb({type:e,selectors:[["issue-edit-form"]],viewQuery:function(e,t){var s;1&e&&n.Bc(ot,!0),2&e&&n.rc(s=n.Wb())&&(t.dexihMessage=s.first)},decls:4,vars:1,consts:[[1,"container"],["DexihMessage",""],["iconClass","fa fa-ticket","title","Support",4,"ngIf"],["iconClass","fa fa-ticket","title","Support"],[3,"isExpanded"],["title","Raise Issue","iconClass","fa fa-lg fa-fw fa-comments",3,"subTitle","showExpandButton","padding"],["header",""],["id","edit-form",3,"formGroup"],["label","Title","formControlName","name","placeholder","Title","iconClass","fa fa-life-ring",3,"errors"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Type","formControlName","type","iconClass","fa fa-life-ring","itemKey","key","itemName","description",3,"items"],["label","Severity","formControlName","severity","iconClass","fa fa-life-ring","itemKey","key","itemName","description",3,"items"],["label","Category","formControlName","category","iconClass","fa fa-life-ring","itemKey","key","itemName","description",3,"items"],["label","Status","formControlName","issueStatus","iconClass","fa fa-circle-notch","itemKey","key","itemName","description",3,"items"],["c","","label","Is Private (will not be published to public github issue)","formControlName","isPrivate"],["label","Description","formControlName","description","placeholder","Details of the issue of feature request","rows","20",3,"hideToggle"],["title","Commentary","iconClass","fa fa-lg fa-fw fa-comments",3,"showExpandButton","padding",4,"ngIf"],["title","Add new comment","iconClass","fa fa-lg fa-fw fa-comments",3,"showExpandButton","padding",4,"ngIf"],[1,"mr-1",3,"disabled","busy","click"],[3,"disabled","click"],["title","Commentary","iconClass","fa fa-lg fa-fw fa-comments",3,"showExpandButton","padding"],["id","comment-form",3,"formGroup",4,"ngFor","ngForOf"],["id","comment-form",3,"formGroup"],["formControlName","comment","placeholder","Comment","iconClass","fa fa-comment",3,"label","disabled"],["title","Add new comment","iconClass","fa fa-lg fa-fw fa-comments",3,"showExpandButton","padding"],["placeholder","Enter a new comment","iconClass","fa fa-comment","rows","20",3,"ngModel","ngModelOptions","hideToggle","ngModelChange"],["target","_blank",1,"btn","btn-primary",3,"href"],[1,"fa","fa-github"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Lb(1,"dexih-message",null,1),n.Dc(3,mt,26,14,"dexih-widget",2),n.Nb()),2&e&&(n.yb(3),n.hc("ngIf",t.mainForm))},directives:[c.a,r.t,d.P,at.a,d.T,S.I,S.t,S.l,d.D,S.s,S.j,d.E,d.A,d.H,d.t,d.b,r.s,S.u,S.v],pipes:[ne.a],encapsulation:2}),e})();const pt=function(e){return["edit",e]};function vt(e,t){1&e&&n.Lb(0,"dexih-button-edit",10),2&e&&n.hc("routerLink",n.mc(1,pt,t.item.key))}function yt(e,t){if(1&e){const e=n.Pb();n.Ob(0,"dexih-button-delete",11),n.Vb("click",(function(){n.vc(e);const s=t.items;return n.Zb().delete(s)})),n.Nb()}}const wt=function(){return["new"]};function Nt(e,t){1&e&&n.Lb(0,"dexih-button-new",12),2&e&&n.hc("routerLink",n.lc(1,wt))}const Ot=[{path:"",component:O,data:{pageTitle:"Hubs View"}},{path:"hub-edit/:hubKey",component:D,data:{action:"Edit",pageTitle:"Edit Hub"}},{path:"hub-new",component:D,data:{action:"New",pageTitle:"New Hub"}}],kt=[{path:"manage",component:W,data:{pageTitle:"Manage"}},{path:"sharedData",data:{pageTitle:"Shared Data"},children:[{path:"",component:ye.c,data:{pageTitle:"Shared Data"}},{path:"preview/:hubKey/:objectType/:objectKey",component:ye.a,data:{pageTitle:"Preview"}},{path:"previewDashboard/:hubKey/:dashboardKey",component:ye.b,data:{pageTitle:"Preview Dashboard"}}]},{path:"tasks",data:{pageTitle:"Tasks"},children:[{path:"",component:ie,data:{pageTitle:"Tasks"}},{path:"view/:reference",component:he,data:{pageTitle:"Task"}}]},{path:"notifications",data:{pageTitle:"Notifications"},children:[{path:"",component:me,data:{pageTitle:"Notifications"}},{path:"view/:reference",component:ve,data:{pageTitle:"Notification"}}]},{path:"support",data:{pageTitle:"Issues"},children:[{path:"",component:(()=>{class e{constructor(e,t,s){this.authService=e,this.router=t,this.route=s,this.columns=[{name:"name",title:"Name",format:""},{name:"description",title:"Description",format:"Md"},{name:"type",title:"Type",format:"Enum",enum:x.Nb},{name:"category",title:"Category",format:"Enum",enum:x.Hb},{name:"severity",title:"Severity",format:"Enum",enum:x.Jb},{name:"issueStatus",title:"Status",format:"Enum",enum:x.Lb},{name:"gitHubLink",title:"Github Issue",format:"Md"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new h.a(null),this.tableData=this._tableData.asObservable(),this.cancelToken=new C.a}ngOnInit(){this.authService.getIssues(this.cancelToken).then(e=>{const t=e.map(e=>({key:e.key,name:e.name,description:e.description,type:e.type,category:e.category,severity:e.severity,issueStatus:e.issueStatus,gitHubLink:e.gitHubLink?`[github](${e.gitHubLink})`:null,updateDate:e.updateDate}));this._tableData.next(t)})}ngOnDestroy(){this.cancelToken.cancel()}edit(e){this.router.navigate(["edit",e.key],{relativeTo:this.route})}close(){this.authService.navigateUp()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(a.a),n.Kb(i.e),n.Kb(i.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["issue"]],decls:11,vars:8,consts:[[1,"container-fluid"],["title","Raised Issues","iconClass","fa fa-lg fa-fw fa-life-saver",3,"showCloseButton","close"],[3,"isExpanded"],["title","Current Support Issues",3,"padding"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[3,"click"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"dexih-widget",1),n.Vb("close",(function(){return t.close()})),n.Lb(2,"support-options",2),n.Ob(3,"dexih-widget-section",3),n.Ob(4,"dexih-table",4),n.Vb("rowClick",(function(e){return t.edit(e)})),n.Dc(5,vt,1,3,"ng-template",5,6,n.Ec),n.Dc(7,yt,1,0,"ng-template",7,8,n.Ec),n.Dc(9,Nt,1,2,"ng-template",null,9,n.Ec),n.Nb(),n.Nb(),n.Nb(),n.Nb()),2&e&&(n.yb(1),n.hc("showCloseButton",!0),n.yb(1),n.hc("isExpanded",!0),n.yb(1),n.hc("padding",!1),n.yb(1),n.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[d.P,at.a,d.T,m.a,d.j,i.f,d.g,d.o],encapsulation:2}),e})(),data:{pageTitle:"Issues"}},{path:"new",component:gt,data:{action:"new",pageTitle:"Create"}},{path:"edit/:issueKey",component:gt,data:{action:"edit",pageTitle:"Edit"}}]},{path:"agents",data:{pageTitle:"Remote Agents"},children:[{path:"",component:Pe,data:{pageTitle:"Remote Agents"}},{path:"edit/:remoteAgentKey",component:Xe,data:{pageTitle:"Remote Edit"}},{path:"download",component:$e,data:{pageTitle:"Download Agent"}},{path:"token-new",component:it,data:{action:"New",pageTitle:"New Token"}},{path:"token-renew/:remoteAgentKey",component:it,data:{action:"Renew",pageTitle:"Renew Token"}}]},{path:"help",component:Ze,data:{pageTitle:"Help"}},{path:"",children:Ot}],St=i.i.forChild([{path:"",component:u,children:[{path:"",redirectTo:"index"},{path:"index",data:{pageTitle:"Hubs"},children:[{path:"",component:H,data:{pageTitle:"Hubs Summary"}},{path:"hubs-view",data:{pageTitle:"Hubs View"},children:Ot},{path:"",children:kt}]},{path:"",children:kt}]}]);var Ct=s("PCNd"),xt=s("4Y1E");let Lt=(()=>{class e{static forRoot(){return{ngModule:e,providers:[o.a,xt.a]}}}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},providers:[o.a,xt.a],imports:[[Ct.a,St,S.C]]}),e})()}}]);
//# sourceMappingURL=15-es2015.bda55d3c361f14cceaba.js.map