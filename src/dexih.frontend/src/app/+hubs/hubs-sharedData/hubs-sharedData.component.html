<div class="m-3">
    <dexih-message #DexihMessage></dexih-message>
</div>

<div class="container-fluid">
    <dexih-widget title="Shared Data Index" iconClass="fa fa-lg fa-fw fa-life-saver">


        <dexih-table [enableMultiSelect]="true" [enableFilter]="false" [columns]="columns" [data]="dataIndex" (rowClick)="previewData($event)">
            <ng-template #selectedItemAction select="selectedItemAction" let-item="item">
                <dexih-button-preview [routerLink]="['preview', item.hubKey, item.objectType, item.objectKey]">
                </dexih-button-preview>
            </ng-template>

            <ng-template #actions  let-items="items">
                    <form [formGroup]="searchForm">
                            <fieldset>
                                <div class="form-row">
                                    <section class="col">
                                        <form-input formControlName="searchString" placeholder="Search..." iconClass="fa fa-search">
                                        </form-input>
                                    </section>
                                    <section *ngIf="hubs" class="col">
                                        <form-tags-dropdown labelLeft="Hubs" formControlName="hubKeys" [items]="hubs"                                            itemKey="hubKey" itemName="name" [enableAddAll]="true">
                                        </form-tags-dropdown>
                                    </section>
                                </div>
                            </fieldset>
                        </form>                
                    </ng-template>
    
            <ng-template #selectedItemsAction select="selectedItemsAction" let-items="items">
                <download-button class="ml-1" (download)="downloadData(items, true, $event)"></download-button>
            </ng-template>

            <ng-template #rowAction let-item="item">
                <div *ngFor="let column of item.inputColumns; let i = index" class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            {{column.logicalName}}
                        </div>
                    </div>
                    <form-input name="column{{i}}" class="form-control p-0" [placeholder]="column.logicalName"
                        [(ngModel)]="column.defaultValue" [border]="false"></form-input>
                </div>
                <div class="input-group mt-1 pull-right">
                    <download-button class="ml-1" [autoCompact]="false" (download)="downloadData([item], true, $event)"></download-button>
                    <dexih-button-edit *ngIf="hubKeys?.indexOf(item.hubKey)>=0" class="ml-1" [autoCompact]="false" (click)="edit(item)"></dexih-button-edit>
                </div>
            </ng-template>

        </dexih-table>
    </dexih-widget>
</div>