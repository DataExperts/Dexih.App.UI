function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"/fhR":function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a("3WyZ"),i=a("itXk"),r=a("2v7R"),o=a("ElCs"),c=a("Xjf6"),s=a("cvPx"),l=a("soiQ"),u=a("fXoL"),b=a("tyNb"),h=a("3Pt+"),d=a("ofXK"),f=a("Wumg"),m=a("obiC"),v=a("H3K+"),p=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{s(n.next(e))}catch(t){r(t)}}function c(e){try{s(n.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,c)}s((n=n.apply(e,t||[])).next())}))};function g(e,t){if(1&e&&(u.Ob(0,"section"),u.Ob(1,"div",2),u.Fc(2," There are no files configured. Create a file based connection, and add at least one file definition. "),u.Lb(3,"hr"),u.Ob(4,"div"),u.Ob(5,"a",3),u.Fc(6,"New Connection"),u.Nb(),u.Nb(),u.Nb(),u.Nb()),2&e){var a=u.Zb();u.yb(5),u.jc("routerLink","/hub/",a.hubCache.hub.hubKey,"/connections/connection-new/Source")}}function y(e,t){if(1&e&&(u.Ob(0,"section",16),u.Ob(1,"form-select",22),u.Ob(2,"a",13),u.Fc(3,"("),u.Lb(4,"i",14),u.Fc(5," New )"),u.Nb(),u.Nb(),u.Nb()),2&e){var a=u.Zb(4);u.yb(1),u.hc("items",a.hubCache.hub.dexihFileFormats)("enableFilter",!1)("allowNullSelect",!0),u.yb(1),u.jc("routerLink","/hub/",a.hubCache.hub.hubKey,"/fileFormats/fileFormat-new")}}function C(e,t){if(1&e&&(u.Ob(0,"form",10),u.Ob(1,"div",11),u.Ob(2,"section"),u.Ob(3,"form-select",12),u.Ob(4,"a",13),u.Fc(5,"("),u.Lb(6,"i",14),u.Fc(7," New )"),u.Nb(),u.Nb(),u.Nb(),u.Ob(8,"div",15),u.Ob(9,"section",16),u.Lb(10,"form-select",17),u.Nb(),u.Dc(11,y,6,4,"section",18),u.Nb(),u.Ob(12,"section"),u.Lb(13,"form-checkbox",19),u.Lb(14,"form-checkbox",20),u.Lb(15,"form-checkbox",21),u.Nb(),u.Nb(),u.Nb()),2&e){var a=u.Zb(3);u.hc("formGroup",a.bulkLoadForm),u.yb(3),u.hc("items",a.fileConnections),u.yb(1),u.jc("routerLink","//hub/",a.hubCache.hub.hubKey,"/connections/connection-new/Source"),u.yb(6),u.hc("items",a.formatTypes),u.yb(1),u.hc("ngIf",a.bulkLoadForm.controls.formatType.value==a.eTypeCode.Text)}}function k(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-button",38),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).uploadSelected(e)})),u.Fc(1,"Upload"),u.Nb(),u.Ob(2,"dexih-button-cancel",39),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).cancelSelected(e)})),u.Nb(),u.Ob(3,"dexih-button-delete",40),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).removeSelected(e)})),u.Nb()}}function w(e,t){if(1&e){var a=u.Pb();u.Ob(0,"div",41),u.Ob(1,"form-checkbox",42),u.Vb("ngModelChange",(function(e){return u.vc(a),u.Zb(4).automaticUpload=e})),u.Nb(),u.Nb()}if(2&e){var n=u.Zb(4);u.yb(1),u.hc("ngModel",n.automaticUpload)}}var S=function(e){return{width:e}};function O(e,t){if(1&e&&(u.Ob(0,"div",45),u.Lb(1,"div",46),u.Nb()),2&e){var a=u.Zb().item;u.yb(1),u.hc("ngStyle",u.mc(1,S,a.progress+"%"))}}var N=function(e,t,a){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":a}};function T(e,t){if(1&e&&(u.Dc(0,O,2,3,"div",43),u.Ob(1,"span"),u.Lb(2,"i",44),u.Fc(3),u.Nb()),2&e){var a=t.item,n=u.Zb(4);u.hc("ngIf",a.isRunning()),u.yb(2),u.hc("ngClass",u.oc(3,N,a.status===n.eFileStatus.Complete,a.status===n.eFileStatus.Error,a.status===n.eFileStatus.Cancelled)),u.yb(1),u.Gc(a.status)}}function D(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-button",47),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).saveTables(e)})),u.Fc(1,"Create Tables"),u.Nb(),u.Ob(2,"dexih-button",48),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).createDatalinks(e)})),u.Fc(3,"Create Datalinks"),u.Nb(),u.Ob(4,"dexih-button-delete",49),u.Vb("click",(function(){u.vc(a);var e=t.items;return u.Zb(4).discardTables(e)})),u.Nb()}}function x(e,t){if(1&e){var a=u.Pb();u.Ob(0,"ul",23),u.Ob(1,"dexih-widget-section",24),u.Ob(2,"div",25),u.Vb("dropFiles",(function(e){return u.vc(a),u.Zb(3).filesDrop(e)})),u.Fc(3," Drop Files to Load Here "),u.Ob(4,"div",26),u.Ob(5,"input",27),u.Vb("change",(function(e){return u.vc(a),u.Zb(3).uploadFile(e)})),u.Nb(),u.Ob(6,"label",28),u.Fc(7,"Choose files"),u.Nb(),u.Nb(),u.Nb(),u.Nb(),u.Ob(8,"dexih-widget-section",29),u.Ob(9,"dexih-table",30),u.Dc(10,k,4,0,"ng-template",31,32,u.Ec),u.Dc(12,w,2,1,"ng-template",null,33,u.Ec),u.Dc(14,T,4,7,"ng-template",34,35,u.Ec),u.Nb(),u.Nb(),u.Ob(16,"dexih-widget-section",36),u.Ob(17,"dexih-table",37),u.Vb("rowClick",(function(e){return u.vc(a),u.Zb(3).editTable(e)})),u.Dc(18,D,5,0,"ng-template",31,32,u.Ec),u.Nb(),u.Nb(),u.Nb()}if(2&e){var n=u.Zb(3);u.yb(1),u.hc("showExpandButton",!0),u.yb(1),u.hc("requireFiles",!0),u.yb(6),u.hc("showExpandButton",!0)("padding",!1),u.yb(1),u.hc("enableMultiSelect",!0)("columns",n.uploadColumns)("data",n.uploadedFiles),u.yb(7),u.hc("showExpandButton",!0)("padding",!1),u.yb(1),u.hc("enableMultiSelect",!0)("columns",n.tableColumns)("data",n.tables)}}function F(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-widget",7),u.Vb("close",(function(){return u.vc(a),u.Zb(2).close()})),u.Dc(1,C,16,5,"form",8),u.Dc(2,x,20,12,"ul",9),u.Nb()}if(2&e){var n=u.Zb(2);u.hc("title","Bulk Load: "+(null==n.connection?null:n.connection.name))("showCloseButton",!0),u.yb(1),u.hc("ngIf",n.bulkLoadForm),u.yb(1),u.hc("ngIf",n.connection)}}function I(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-button-apply",52),u.Vb("click",(function(){return u.vc(a),u.Zb(3).applyChanges()})),u.Nb(),u.Ob(1,"dexih-button-cancel",53),u.Vb("click",(function(){return u.vc(a),u.Zb(3).cancel()})),u.Nb()}}function K(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-widget",50),u.Vb("close",(function(){return u.vc(a),u.Zb(2).closeTable()})),u.Dc(1,I,2,0,"ng-template",null,51,u.Ec),u.Lb(3,"router-outlet"),u.Nb()}if(2&e){var n=u.Zb(2);u.hc("title","Edit table: "+n.formsService.currentForm.controls.name.value)("showCloseButton",!0)}}function E(e,t){if(1&e&&(u.Ob(0,"div",4),u.Dc(1,F,3,4,"dexih-widget",5),u.Dc(2,K,4,2,"dexih-widget",6),u.Nb()),2&e){var a=u.Zb();u.yb(1),u.hc("ngIf",!a.currentTable),u.yb(1),u.hc("ngIf",a.currentTable)}}var V=function(){var e=function(){function e(t,a,i,o,c,s){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.route=i,this.router=o,this.formsService=c,this.fb=s,this.entityType="Table",this.canEdit=!1,this.formatTypes=r.m,this.eTypeCode=l.pc,this.eFileStatus=n.h,this.automaticUpload=!0,this.uploadedFiles=[],this.reference=null,this.tables=[],this.currentTable=null,this.cancelToken=new n.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.tableColumns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description"},{name:"name",title:"Table Name"}],this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){var a=t[0];e.hubCache=t[1];var n=t[2];e.fileConnections=e.hubCache.hub.dexihConnections.filter((function(e){var t=n.connections.find((function(t){return e.connectionAssemblyName===t.connectionAssemblyName&&e.connectionClassName===t.connectionClassName}));return!!t&&(t.connectionCategory===l.ib.File||e.purpose!==l.jb.Source)}));var i=+a.connectionKey;i||e.fileConnections.length>0&&(i=e.fileConnections[0].key),e.bulkLoadForm=e.fb.group({connectionKey:[i],formatType:[l.pc.Text],fileFormatKey:[],includeFileName:[!1],includeFileDate:[!1],includeFileRowNumber:[!1]}),e.updateConnection(i),e._connectionKeySubscription&&e._connectionKeySubscription.unsubscribe(),e._connectionKeySubscription=e.bulkLoadForm.controls.connectionKey.valueChanges.subscribe((function(t){e.updateConnection(t)}))})),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._flatFilesSubscription=this.hubService.getFlatFilesObservable().subscribe((function(t){t.reference===e.reference&&(e.tables=t.tables)}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Files Manage")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._flatFilesSubscription&&this._flatFilesSubscription.unsubscribe(),this._connectionKeySubscription&&this._connectionKeySubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateConnection",value:function(e){this.connection=this.hubCache.getConnection(e),!this.connection&&e?this.hubService.addHubErrorMessage("The connection with the key ".concat(e," could not be found.")):this.connection&&(this.pageTitle="Load files for "+this.connection.name,this.showPage=!0)}},{key:"uploadFile",value:function(e){return this.doUpload(e.srcElement.files),!1}},{key:"filesDrop",value:function(e){this.doUpload(e)}},{key:"doUpload",value:function(e){var t=this;Array.prototype.forEach.call(e,(function(e){var a=t.bulkLoadForm.value;t.hubService.bulkUploadFiles(a.connectionKey,a.fileFormatKey,a.formatType,a.includeFileName,a.includeFileDate,a.includeFileRowNumber,e.name,t.cancelToken).then((function(a){var i=a.url;t.reference=a.reference;var r=new n.d(e,i);t.uploadedFiles=t.uploadedFiles.concat(r),t.automaticUpload&&t.authService.upload(r).then((function(a){a.success?t.hubService.addHubSuccessMessage(e.name+" uploaded."):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)}))})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"editTable",value:function(e){this.currentTable=e,this.formsService.table(e),this.router.navigate(["table-edit"],{relativeTo:this.route})}},{key:"applyChanges",value:function(){this.formsService.hasChanged&&Object.assign(this.currentTable,this.formsService.currentForm.value),this.currentTable=null,this.authService.navigateUp()}},{key:"cancel",value:function(){this.currentTable=null,this.authService.navigateUp()}},{key:"saveTables",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n,i,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object.assign([],this.tables),n=[],i=regeneratorRuntime.mark((function t(i){var r,c,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e[i],t.next=3,o.hubService.saveTables([r]);case 3:c=t.sent,n.push(c[0].key),s=o.tables.findIndex((function(e){return r.key===e.key})),a.splice(s,1);case 7:case"end":return t.stop()}}),t)})),r=0;case 3:if(!(r<e.length)){t.next=8;break}return t.delegateYield(i(r),"t0",5);case 5:r++,t.next=3;break;case 8:return t.abrupt("return",(this.tables=a,n));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"createDatalinks",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveTables(e);case 2:a=t.sent.join("|"),this.router.navigate(["/hub",this.hubCache.hub.hubKey,"tables","datalink-new",a,0],{relativeTo:this.route.root});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"discardTables",value:function(e){for(var t=this,a=Object.assign([],this.tables),n=function(n){var i=e[n],r=t.tables.findIndex((function(e){return i.key===e.key}));a.splice(r,1)},i=0;i<e.length;i++)n(i);this.tables=a}},{key:"uploadSelected",value:function(e){var t=this;e.forEach((function(e){t.authService.upload(e).then((function(e){t.hubService.addHubMessage(e)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"removeSelected",value:function(e){var t=this;e.forEach((function(e){var a=t.uploadedFiles.findIndex((function(t){return t.id===e.id}));a>=0&&t.uploadedFiles.splice(a,1)}))}},{key:"cancelSelected",value:function(e){e.forEach((function(e){return e.cancel()}))}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.tables.length>0?e.authService.confirmDialog("Unsaved tables!","Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.tables.length>0&&(e.returnValue="Table(s) have not been saved, this action will discard unsaved tables.  Do you want to discard the changes and exit?")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Kb(o.a),u.Kb(c.a),u.Kb(b.a),u.Kb(b.e),u.Kb(s.a),u.Kb(h.g))},e.\u0275cmp=u.Eb({type:e,selectors:[["files-bulk-load"]],hostBindings:function(e,t){1&e&&u.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,u.uc)},decls:2,vars:2,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],[1,"btn","btn-sm","btn-primary","text-white",3,"routerLink","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close",4,"ngIf"],[3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-files-o",3,"title","showCloseButton","close"],[3,"formGroup",4,"ngIf"],["class","list-group",4,"ngIf"],[3,"formGroup"],[1,"m-3"],["label","Connection","formControlName","connectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","The connection where the files will be uploaded to.",3,"items"],[3,"routerLink"],[1,"fa","fa-sticky-note-o"],[1,"form-row"],[1,"col-md-6"],["label","Format Type","formControlName","formatType","itemKey","key","itemName","name","iconClass","fa fa-text","note","The format of data.",3,"items"],["class","col-md-6",4,"ngIf"],["label","Include file name field","formControlName","includeFileName"],["label","Include file date field","formControlName","includeFileDate"],["label","Include file row field","formControlName","includeFileRowNumber"],["label","File Format","formControlName","fileFormatKey","placeholder","File Format","itemKey","key","itemName","name","note","Specify the file format to use, if not specified, a csv (command separated) format will be used.","selectNullMessage","Use default (csv) format",3,"items","enableFilter","allowNullSelect"],[1,"list-group"],["title","Drop Files to Load",3,"showExpandButton"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],["title","Upload Queues",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Tables Created",3,"showExpandButton","padding"],[3,"enableMultiSelect","columns","data","rowClick"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],[1,"d-flex","align-items-center","h-100"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],["iconClass","fa fa-table","title","Save the selected tables.",1,"ml-1",3,"click"],["iconClass","fa fa-exchange","title","Save the selected tables, and create datalinks to load them into a staging area.",1,"ml-1",3,"click"],["title","Discard the selected tables.","text","Discard",1,"ml-1",3,"click"],[3,"title","showCloseButton","close"],["header",""],[3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){1&e&&(u.Dc(0,g,7,1,"section",0),u.Dc(1,E,3,2,"div",1)),2&e&&(u.hc("ngIf",(null==t.hubCache?null:t.hubCache.hub)&&(!t.fileConnections||0===t.fileConnections.length)),u.yb(1),u.hc("ngIf",t.fileConnections&&t.fileConnections.length>0))},directives:[d.t,b.h,f.P,h.I,h.t,h.l,f.E,h.s,h.j,f.A,f.T,m.a,v.a,f.f,f.b,f.g,h.v,d.q,d.w,b.j,f.a],encapsulation:2}),e}()},LyCD:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a("4Y1E"),i=a("itXk"),r=a("cvPx"),o=a("ElCs"),c=a("3WyZ"),s=a("2v7R"),l=a("soiQ"),u=a("fXoL"),b=a("tyNb"),h=a("Wumg"),d=a("iFLP"),f=a("ofXK"),m=a("79jk"),v=a("64E1"),p=a("oLr2"),g=["dashboardItem"];function y(e,t){if(1&e){var a=u.Pb();u.Ob(0,"li"),u.Ob(1,"a",8),u.Vb("click",(function(){u.vc(a);var e=t.$implicit;return u.Zb(2).add(e.key)})),u.Fc(2),u.Nb(),u.Nb()}if(2&e){var n=t.$implicit;u.yb(2),u.Gc(n.name)}}function C(e,t){if(1&e&&u.Lb(0,"save-button",13),2&e){var a=u.Zb(2);u.hc("formsService",a.formsService)}}function k(e,t){if(1&e){var a=u.Pb();u.Ob(0,"dexih-invalid-form-details",3),u.Vb("click",(function(){return u.vc(a),u.Zb().formsService.showErrors()})),u.Nb(),u.Ob(1,"dexih-button-edit",4),u.Vb("click",(function(){return u.vc(a),u.Zb().toggleEdit()})),u.Nb(),u.Ob(2,"dexih-button",5),u.Vb("click",(function(){return u.vc(a),u.Zb().toggleLock()})),u.Nb(),u.Ob(3,"dexih-button-refresh",6),u.Vb("click",(function(){return u.vc(a),u.Zb().refresh()})),u.Nb(),u.Ob(4,"dexih-button-dropdown",7),u.Ob(5,"a",8),u.Vb("click",(function(){return u.vc(a),u.Zb().newView()})),u.Fc(6,"(New View)"),u.Nb(),u.Dc(7,y,3,1,"li",9),u.Nb(),u.Ob(8,"download-button",10),u.Vb("download",(function(e){return u.vc(a),u.Zb().download(e)})),u.Nb(),u.Dc(9,C,1,1,"save-button",11),u.Lb(10,"cancel-button",12)}if(2&e){var n=u.Zb();u.hc("control",n.formsService.currentForm),u.yb(1),u.hc("text",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.showEdit?"Hide Edit":"Edit"),u.yb(1),u.hc("iconClass",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.lock?"fa fa-lock":"fa fa-unlock")("text",null!=n.formsService.currentForm&&n.formsService.currentForm.controls.runTime.value.lock?"Unlock":"Lock"),u.yb(5),u.hc("ngForOf",n.views),u.yb(2),u.hc("ngIf",n.hubCache.canWrite),u.yb(1),u.hc("formsService",n.formsService)}}var w=function(){var e=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1,this.isRefreshing=!1,this.refreshComplete=!1,this.cancelToken=new c.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(i.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.remoteAgent=t[3],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===s.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.views=e.hubCache.hub.dexihViews,e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Dashboard Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.dashboardKey=+this.params.dashboardKey,this.dashboardKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihDashboards.find((function(t){return t.key===e.dashboardKey}));t=JSON.parse(JSON.stringify(t)),this.formsService.dashboard(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no dashboard specified to edit.");if("new"===this.action){this.refreshComplete=!0;var a=new l.i;a.minCols=4,a.maxCols=100,a.minRows=4,a.maxRows=100,a.autoRefresh=!0,this.formsService.dashboard(a),this.formsService.currentForm.controls.runTime.value.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/dashboard-new","/dashboard-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.formsService.currentForm.controls.autoRefresh.value&&this.remoteAgent&&!this.refreshComplete&&(this.refreshComplete=!0,this.refresh())}},{key:"refresh",value:function(){var e=this;this.hubService.previewDashboard(this.formsService.currentForm.value,this.formsService.currentForm.value.parameters,this.cancelToken).then((function(t){var a=e.formsService.currentForm.controls.dexihDashboardItems;t.forEach((function(t){var n=a.controls.find((function(e){return e.controls.key.value===t.dashboardItemKey}));if(n){var i=n.controls.runTime.value.data;i.isRefreshing=!0,e.hubService.getRemoteResponse(t.dataKey,e.cancelToken).then((function(t){t.columns=e.authService.constructDataTableColumns(t.columns),i.data.next(t),i.isRefreshing=!1})).catch()}}))}))}},{key:"toggleEdit",value:function(){var e=this.formsService.currentForm.controls.runTime.value;e.showEdit=!e.showEdit,this.formsService.currentForm.controls.runTime.setValue(e)}},{key:"toggleLock",value:function(){var e=this.formsService.currentForm.controls.runTime.value;e.lock=!e.lock,this.formsService.currentForm.controls.runTime.setValue(e)}},{key:"add",value:function(e){var t=this.hubCache.hub.dexihViews.find((function(t){return t.key===e}));if(t){var a=this.formsService.currentForm,n=a.controls.dexihDashboardItems,i=new l.j;i.key=this.hubCache.getNextSequence(),i.cols=1,i.rows=1,i.x=-1,i.y=-1;e:for(var r=0;r<a.controls.maxRows.value;r++)for(var o=0;o<a.controls.maxCols.value;o++){for(var c=!1,s=0;s<n.controls.length;s++){var u=n.controls[s].value;if(u.x<=o&&u.x+u.cols>o&&u.y<=r&&u.y+u.rows>r){c=!0;break}}if(!c){i.x=o,i.y=r;break e}}i.viewKey=e,i.name=t.name;var b=this.formsService.dashboardItem(i);this.formsService.updateDashboardItemView(b),n.push(b)}}},{key:"newView",value:function(){this.router.navigate(["view-new"],{relativeTo:this.route})}},{key:"download",value:function(e){var t=this,a=this.formsService.currentForm.controls.dexihDashboardItems.value.filter((function(e){return e.viewKey})).map((function(e){var a=t.hubCache.hub.dexihViews.find((function(t){return t.key===e.viewKey})),n=new l.M;return a.sourceType===l.lb.Datalink&&(n.objectKey=a.sourceDatalinkKey,n.objectType=l.lb.Datalink),a.sourceType===l.lb.Table&&(n.objectKey=a.sourceTableKey,n.objectType=l.lb.Table),n.query=a.selectQuery,n}));this.hubService.downloadData(a,!1,e,this.cancelToken)}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The dashboard has not been saved","The dashboard changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The dashboard changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Kb(n.a),u.Kb(o.a),u.Kb(r.a),u.Kb(b.a),u.Kb(b.e))},e.\u0275cmp=u.Eb({type:e,selectors:[["dexih-dashboard-edit-form"]],viewQuery:function(e,t){var a;1&e&&u.Kc(g,!0),2&e&&u.rc(a=u.Wb())&&(t.dashboardItems=a)},hostBindings:function(e,t){1&e&&u.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,u.uc)},features:[u.xb([r.a])],decls:5,vars:3,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-pie-chart",3,"title","showCloseButton","padding","close"],["header",""],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"text","click"],[1,"mr-1",3,"iconClass","text","click"],[1,"mr-1",3,"click"],["iconClass","fa fa-plus","text","Add",1,"mr-1"],[1,"dropdown-item",3,"click"],[4,"ngFor","ngForOf"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"]],template:function(e,t){1&e&&(u.Ob(0,"div",0),u.Ob(1,"dexih-widget",1),u.Vb("close",(function(){return t.close()})),u.Dc(2,k,11,7,"ng-template",null,2,u.Ec),u.Lb(4,"router-outlet"),u.Nb(),u.Nb()),2&e&&(u.yb(1),u.jc("title","Dashboard - ",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.name.value,""),u.hc("showCloseButton",!0)("padding",!1))},directives:[h.P,b.j,d.a,h.j,h.f,h.s,h.i,f.s,m.a,f.t,v.a,p.a],encapsulation:2}),e}()},MbvK:function(e,t,a){"use strict";a.d(t,"a",(function(){return z}));var n=a("4Y1E"),i=a("XNiG"),r=a("itXk"),o=a("VRyK"),c=a("cvPx"),s=a("ElCs"),l=a("Z+eP"),u=a("3WyZ"),b=a("2v7R"),h=a("soiQ"),d=a("fXoL"),f=a("tyNb"),m=a("ofXK"),v=a("Wumg"),p=a("PMKX"),g=a("/pur"),y=a("iFLP"),C=a("79jk"),k=a("64E1"),w=a("oLr2"),S=a("YcGA"),O=a("3Pt+"),N=a("+F4M"),T=a("hJJo"),D=a("RXlv"),x=a("H3K+"),F=a("kzgk");function I(e,t){if(1&e&&d.Lb(0,"save-button",23),2&e){var a=d.Zb(3);d.hc("formsService",a.formsService)}}var K=function(e){return{active:e}};function E(e,t){if(1&e){var a=d.Pb();d.Ob(0,"dexih-invalid-form-details",10),d.Vb("click",(function(){return d.vc(a),d.Zb(2).formsService.showErrors()})),d.Nb(),d.Ob(1,"dexih-button-refresh",11),d.Vb("click",(function(){return d.vc(a),d.Zb(2).refresh()})),d.Nb(),d.Ob(2,"download-button",12),d.Vb("download",(function(e){return d.vc(a),d.Zb(2).download(e)})),d.Nb(),d.Ob(3,"div",13),d.Ob(4,"label",14),d.Ob(5,"input",15),d.Vb("click",(function(){return d.vc(a),d.Zb(2).toggleChart()})),d.Nb(),d.Lb(6,"i",16),d.Nb(),d.Ob(7,"label",17),d.Ob(8,"input",18),d.Vb("click",(function(){return d.vc(a),d.Zb(2).toggleChart()})),d.Nb(),d.Lb(9,"i",19),d.Nb(),d.Nb(),d.Dc(10,I,1,1,"save-button",20),d.Ob(11,"dexih-button-edit",21),d.Vb("click",(function(){return d.vc(a),d.Zb(2).toggleEdit()})),d.Nb(),d.Lb(12,"cancel-button",22)}if(2&e){var n=d.Zb(2);d.hc("control",n.formsService.currentForm),d.yb(4),d.hc("ngClass",d.mc(6,K,!1===n.showChart)),d.yb(3),d.hc("ngClass",d.mc(8,K,!0===n.showChart)),d.yb(3),d.hc("ngIf",n.hubCache.canWrite),d.yb(1),d.hc("text",n.showEdit?"Hide Edit":"Edit"),d.yb(1),d.hc("formsService",n.formsService)}}function V(e,t){if(1&e&&(d.Ob(0,"section",32),d.Ob(1,"form-select",37),d.Lb(2,"table-edit-button",38),d.Nb(),d.Nb()),2&e){var a=d.Zb(4);d.yb(1),d.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),d.yb(1),d.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function L(e,t){if(1&e){var a=d.Pb();d.Ob(0,"section",32),d.Ob(1,"form-select",39),d.Lb(2,"datalink-edit-button",38),d.Nb(),d.Ob(3,"dexih-button-refresh",40),d.Vb("click",(function(){return d.vc(a),d.Zb(4).refreshDatalink()})),d.Nb(),d.Nb()}if(2&e){var n=d.Zb(4);d.yb(1),d.hc("errors",null==n.errors?null:n.errors.sourceDatalinkKey)("items",n.datalinks),d.yb(1),d.hc("key",n.formsService.currentForm.controls.sourceDatalinkKey.value)}}function P(e,t){if(1&e&&(d.Ob(0,"form",28),d.Ob(1,"fieldset"),d.Ob(2,"section"),d.Lb(3,"form-input",29),d.Nb(),d.Ob(4,"section"),d.Lb(5,"form-textarea",30),d.Nb(),d.Ob(6,"section"),d.Ob(7,"div",31),d.Ob(8,"section",32),d.Lb(9,"form-select",33),d.Nb(),d.Dc(10,V,3,3,"section",34),d.Dc(11,L,4,3,"section",34),d.Nb(),d.Lb(12,"form-checkbox",35),d.Lb(13,"form-checkbox",36),d.Nb(),d.Nb(),d.Nb()),2&e){var a=d.Zb(3);d.hc("formGroup",a.formsService.currentForm),d.yb(3),d.hc("autocapitalize",a.on)("errors",a.formsService.formErrors.name),d.yb(2),d.hc("showMarkdown",!0),d.yb(4),d.hc("items",a.sourceTypes)("enableFilter",!1),d.yb(1),d.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eDataObjectType.Table),d.yb(1),d.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eDataObjectType.Datalink)}}function A(e,t){if(1&e){var a=d.Pb();d.Ob(0,"div",41),d.Ob(1,"dexih-button-refresh",42),d.Vb("click",(function(){return d.vc(a),d.Zb(3).refresh()})),d.Nb(),d.Nb()}2&e&&(d.yb(1),d.hc("autoCompact",!1))}function R(e,t){if(1&e){var a=d.Pb();d.Ob(0,"dexih-widget-section",24),d.Dc(1,P,14,8,"form",25),d.Ob(2,"input-parameters",26),d.Vb("onRefreshData",(function(){return d.vc(a),d.Zb(2).refresh()}))("onChange",(function(){return d.vc(a),d.Zb(2).parameterChange()})),d.Nb(),d.Dc(3,A,2,1,"div",27),d.Nb()}if(2&e){var n=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("ngIf",n.showEdit),d.yb(1),d.hc("showEdit",n.showEdit)("parameters",null==n.formsService.currentForm?null:n.formsService.currentForm.controls.parameters)("formsService",n.formsService)("refreshEvent",n.refreshDataSubject.asObservable()),d.yb(1),d.hc("ngIf",!n.data||0===n.data.length)}}function j(e,t){if(1&e){var a=d.Pb();d.Ob(0,"span",45),d.Ob(1,"div",46),d.Ob(2,"div",47),d.Fc(3),d.Nb(),d.Nb(),d.Ob(4,"form-input",48),d.Vb("ngModelChange",(function(e){return d.vc(a),t.$implicit.value=e})),d.Nb(),d.Nb()}if(2&e){var n=t.$implicit,i=t.index;d.yb(3),d.Hc(" ",n.logicalName," "),d.yb(1),d.jc("name","column",i,""),d.hc("placeholder","Enter "+n.logicalName)("ngModel",n.value)}}function _(e,t){if(1&e&&(d.Ob(0,"dexih-widget-section",43),d.Dc(1,j,5,4,"span",44),d.Nb()),2&e){var a=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("ngForOf",a.inputColumns)}}function M(e,t){if(1&e){var a=d.Pb();d.Ob(0,"dexih-widget-section",49),d.Ob(1,"query-builder",50),d.Vb("hasChanged",(function(){return d.vc(a),d.Zb(2).hasChanged()}))("onRefreshData",(function(){return d.vc(a),d.Zb(2).refresh()})),d.Nb(),d.Nb()}if(2&e){var n=d.Zb(2);d.hc("showExpandButton",!0),d.yb(1),d.hc("selectQuery",n.formsService.currentForm.controls.selectQuery.value)("columns",n.tableColumns)("inputColumns",n.inputColumns)("parameters",n.formsService.currentForm.controls.parameters.value)("refreshEvent",n.refreshDataSubject.asObservable())}}function Z(e,t){if(1&e){var a=d.Pb();d.Ob(0,"dexih-button-refresh",11),d.Vb("click",(function(){return d.vc(a),d.Zb(4).refresh()})),d.Nb()}}function H(e,t){if(1&e&&(d.Ob(0,"dexih-table",53),d.Dc(1,Z,1,0,"ng-template",null,54,d.Ec),d.Nb()),2&e){var a=d.Zb(3);d.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",a.columns)("data",a.data)("hideTable",a.showChart)}}function B(e,t){if(1&e){var a=d.Pb();d.Ob(0,"div"),d.Ob(1,"chart-builder",55),d.Vb("hasChanged",(function(){return d.vc(a),d.Zb(3).hasChanged()})),d.Nb(),d.Nb()}if(2&e){var n=d.Zb(3);d.yb(1),d.hc("title",n.formsService.currentForm.controls.name.value)("columns",n.columns)("data",n.data)("config",n.formsService.currentForm.controls.chartConfig.value)("showEdit",n.showEdit)}}function U(e,t){if(1&e&&(d.Dc(0,H,3,5,"dexih-table",51),d.Dc(1,B,2,5,"div",52)),2&e){var a=d.Zb(2);d.hc("ngIf",!a.showChart),d.yb(1),d.hc("ngIf",a.showChart)}}function q(e,t){if(1&e){var a=d.Pb();d.Ob(0,"div",1),d.Ob(1,"dexih-widget",2),d.Vb("close",(function(){return d.vc(a),d.Zb().close()})),d.Dc(2,E,13,10,"ng-template",null,3,d.Ec),d.Dc(4,R,4,7,"dexih-widget-section",4),d.Dc(5,_,2,2,"dexih-widget-section",5),d.Ob(6,"series-animate",6),d.Vb("hasChanged",(function(){return d.vc(a),d.Zb().hasChanged()}))("dataChange",(function(e){return d.vc(a),d.Zb().data=e})),d.Nb(),d.Dc(7,M,2,6,"dexih-widget-section",7),d.Dc(8,U,2,2,"ng-template",8),d.Nb(),d.Lb(9,"dexih-help",9),d.Nb()}if(2&e){var n=d.Zb();d.yb(1),d.hc("showCloseButton",!0)("padding",!1),d.yb(3),d.hc("ngIf",n.formsService.currentForm&&(n.showEdit||(null==n.formsService.currentForm?null:n.formsService.currentForm.controls.parameters.length)>0||(null==n.datalinkParameters?null:n.datalinkParameters.length)>0)),d.yb(1),d.hc("ngIf",n.inputColumns&&n.inputColumns.length>0),d.yb(1),d.hc("showEdit",n.showEdit)("animateConfig",n.animateConfig)("columns",n.columns)("baseData",n.baseData)("data",n.data),d.yb(1),d.hc("ngIf",n.showEdit),d.yb(1),d.hc("ngIf",(null==n.columns?null:n.columns.length)>0&&(null==n.data?null:n.data.length)>0)}}var z=function(){var e=function(){function e(t,a,n,r,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=r,this.router=o,this.showEdit=!1,this.hasEdited=!1,this.refreshDataSubject=new i.a,this.sourceTypes=[{key:h.lb.Datalink,name:"Datalink"},{key:h.lb.Table,name:"Table"}],this.eViewType=h.rc,this.eDataObjectType=h.lb,this.connectionTables=[],this.datalinks=[],this.showChart=!1,this.isLoaded=!1,this.firstLoad=!0,this.dialogOpen=!1,this.animationValues=[],this.animationPaused=!1,this.cancelToken=new u.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(r.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.remoteAgent=t[3],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===b.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Edit")}}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,this.hubCache&&this.hubCache.isLoaded()&&(this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks),"edit"===this.action)if(this.viewKey=+this.params.viewKey,this.viewKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihViews.find((function(t){return t.key===e.viewKey}));null==(t=JSON.parse(JSON.stringify(t))).selectQuery&&(t.selectQuery=new h.V),null==t.animateConfig&&(t.animateConfig=new h.a),this.inputColumns=t.inputValues,this.showChart=t.viewType===h.rc.Chart,this.formsService.view(t),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no view specified to edit.");if("new"===this.action){var a=new h.L;a.selectQuery=new h.V,a.animateConfig=new h.a,this.formsService.view(a),this.watchChanges(),this.showEdit=!0,this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/view-new","/view-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.remoteAgent&&(this.firstLoad?this.formsService.currentForm.controls.autoRefresh.value&&this.refresh():this.dialogOpen||(this.dialogOpen=!0,this.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then((function(t){t&&e.refresh(),e.dialogOpen=!1}))))}},{key:"watchChanges",value:function(){var e=this;this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(o.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe((function(){e.reset(),e.selectQuery=new h.V,e.animateConfig=new h.a,e.getColumns(),e.refreshDatalink(),e.refresh()}))}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"toggleChart",value:function(){this.showChart?(this.showChart=!1,this.formsService.currentForm.controls.viewType.setValue(h.rc.Table)):(this.showChart=!0,null==this.formsService.currentForm.controls.chartConfig.value&&this.formsService.currentForm.controls.chartConfig.setValue(new h.b),this.formsService.currentForm.controls.viewType.setValue(h.rc.Chart))}},{key:"getColumns",value:function(){var e=this.formsService.currentForm,t=e.controls.inputValues.value;if(e.controls.sourceType.value===h.lb.Table&&e.controls.sourceTableKey.value>0){var a=this.hubCache.getTable(e.controls.sourceTableKey.value);if(a)return this.inputColumns=a.dexihTableColumns.filter((function(e){return e.isInput})).map((function(e){return t.find((function(t){return t.name===e.name})),{datalinkKey:0,datalinkName:"",name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue,defaultValue:e.defaultValue}})),void(this.tableColumns=a.dexihTableColumns);this.reset()}else this.reset();if(e.controls.sourceType.value===h.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){var n=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(n){var i=new l.b;i.buildInputOutput(this.hubCache,n),this.tableColumns=i.getDatalinkOutputColumns(n),this.inputColumns=n.sourceDatalinkTable.dexihDatalinkColumns.filter((function(e){return e.isInput})).map((function(e){var a,i=t.find((function(t){return t.name===e.name}));return a=i?i.value:e.defaultValue,{datalinkKey:n.key,datalinkName:n.name,name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:a,defaultValue:e.defaultValue}}))}else this.reset()}else this.reset()}},{key:"reset",value:function(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null,this.baseData=null}},{key:"refreshDatalink",value:function(){for(var e=this.formsService.currentForm,t=this.formsService.currentForm.controls.parameters,a=t.controls.length-1;a>=0;a--)t.controls[a].value.datalinkParameterKey&&t.removeAt(a);if(e.controls.sourceType.value===h.lb.Datalink&&e.controls.sourceDatalinkKey.value>0){var n=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(n){var i,r=_createForOfIteratorHelper(n.parameters);try{for(r.s();!(i=r.n()).done;){var o=i.value,c=Object.assign({},o);c.datalinkParameterKey=o.key,c.key=this.hubCache.getNextSequence();var s=this.formsService.parameter(c);t.push(s)}}catch(l){r.e(l)}finally{r.f()}}}}},{key:"refresh",value:function(){var e=this,t=this.formsService.currentForm,a=[],n=this.formsService.currentForm.controls.parameters.getRawValue();n&&(a=a.concat(n));var i=t.value;i.selectQuery=t.controls.selectQuery.value,i.animateConfig=t.controls.animateConfig.value,(i.sourceType===h.lb.Table&&i.sourceTableKey>0||i.sourceType===h.lb.Datalink&&i.sourceDatalinkKey>0)&&this.hubService.previewView(i,this.inputColumns,a,this.cancelToken).then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.baseData=t.data,e.animateConfig.seriesColumn||(e.data=e.baseData)})).catch((function(){}))}},{key:"download",value:function(e){var t=this.formsService.currentForm.value,a=new h.M;t.sourceType===h.lb.Datalink&&(a.objectKey=t.sourceDatalinkKey,a.objectType=h.lb.Datalink),t.sourceType===h.lb.Table&&(a.objectKey=t.sourceTableKey,a.objectType=h.lb.Table),a.query=this.selectQuery,this.hubService.downloadData([a],!1,e,this.cancelToken)}},{key:"hasChanged",value:function(){this.formsService.markAsChanged()}},{key:"parameterChange",value:function(){this.formsService.currentForm.controls.autoRefresh.value&&this.refresh()}},{key:"toggleEdit",value:function(){this.showEdit=!this.showEdit,this.hasEdited=!0}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.hasEdited&&e.formsService.hasChanged?e.authService.confirmDialog("The view has not been saved","The view changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.hasEdited&&this.formsService.hasChanged&&(e.returnValue="The view changes have not been saved.  Do you want to discard the changes and exit?")}},{key:"animateConfig",get:function(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.animateConfig.value},set:function(e){var t,a;null===(a=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===a||a.controls.animateConfig.setValue(e)}},{key:"selectQuery",get:function(){var e,t;return null===(t=null===(e=this.formsService)||void 0===e?void 0:e.currentForm)||void 0===t?void 0:t.controls.selectQuery.value},set:function(e){var t,a;null===(a=null===(t=this.formsService)||void 0===t?void 0:t.currentForm)||void 0===a||a.controls.selectQuery.setValue(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Kb(n.a),d.Kb(s.a),d.Kb(c.a),d.Kb(f.a),d.Kb(f.e))},e.\u0275cmp=d.Eb({type:e,selectors:[["dexih-view-edit-form"]],hostBindings:function(e,t){1&e&&d.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,d.uc)},features:[d.xb([c.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit View","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton",4,"ngIf"],["title","InputColumns",3,"showExpandButton",4,"ngIf"],[3,"showEdit","animateConfig","columns","baseData","data","hasChanged","dataChange"],["title","Query Configuration",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"mr-1",3,"control","click"],["text","Reload",1,"mr-1",3,"click"],[1,"mr-1",3,"download"],["data-toggle","buttons","title","Table",1,"btn-group","btn-group-toggle","mr-1"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","table","autocomplete","off",3,"click"],[1,"fa","fa-table"],["title","Chart",1,"btn","btn-primary",3,"ngClass"],["type","radio","name","options","value","chart","autocomplete","off",3,"click"],[1,"fa","fa-bar-chart"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"mr-1",3,"text","click"],[3,"formsService"],[1,"mr-1",3,"formsService"],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],[3,"showEdit","parameters","formsService","refreshEvent","onRefreshData","onChange"],["class","mt-3",4,"ngIf"],[3,"formGroup"],["label","View Name","formControlName","name","placeholder","Enter the view name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["formControlName","autoRefresh","label","Automatically refresh data when view is opened"],["label","View is shared in the catalog to users with read access.","formControlName","isShared"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["text","Refresh Parameters",3,"click"],[1,"mt-3"],["text","Reload",1,"mr-1",3,"autoCompact","click"],["title","InputColumns",3,"showExpandButton"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable",4,"ngIf"],[4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data","hideTable"],["actions",""],[3,"title","columns","data","config","showEdit","hasChanged"]],template:function(e,t){1&e&&d.Dc(0,q,10,11,"div",0),2&e&&d.hc("ngIf",t.formsService)},directives:[m.t,v.P,p.a,g.a,y.a,v.s,C.a,m.q,v.j,k.a,w.a,v.T,S.a,O.I,O.t,O.l,v.D,O.s,O.j,v.H,v.E,v.A,N.a,T.a,m.s,O.v,D.a,x.a,F.a],encapsulation:2}),e}()},NUI7:function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return A}));var n=a("4Y1E"),i=a("ElCs"),r=a("2Vo4"),o=a("itXk"),c=a("soiQ"),s=a("fXoL"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("/pur"),d=a("ofXK"),f=a("EjXd"),m=a("mWX8"),v=function(){return["fileFormat-new"]};function p(e,t){1&e&&s.Lb(0,"dexih-button-new",10),2&e&&s.hc("routerLink",s.lc(1,v))}function g(e,t){if(1&e&&s.Dc(0,p,1,2,"dexih-button-new",9),2&e){var a=s.Zb();s.hc("ngIf",a.hubCache.canWrite)}}function y(e,t){1&e&&s.Lb(0,"actions-fileFormat-button",11),2&e&&s.hc("fileFormat",t.item)}function C(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-delete",15),s.Vb("click",(function(){s.vc(a);var e=s.Zb().items;return s.Zb().deleteFileFormats(e)})),s.Nb()}}function k(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-save-local",12),s.Vb("click",(function(){s.vc(a);var e=t.items;return s.Zb().export(e)})),s.Nb(),s.Dc(1,C,1,0,"dexih-button-delete",13),s.Lb(2,"tags-update-button",14)}if(2&e){var n=t.items,i=s.Zb();s.yb(1),s.hc("ngIf",i.hubCache.canWrite),s.yb(1),s.hc("objectType",i.eSharedObjectType.FileFormat)("objects",n)}}var w,S=((w=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateFileFormats()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"File Format Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteFileFormats",value:function(e){this.hubService.deleteFileFormats(e)}},{key:"updateFileFormats",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihFileFormats.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(c.dc.FileFormat,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editFileFormat",value:function(e){this.router.navigate(["fileFormat-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddFileFormat(e.key,a)})),this.hubService.exportHub(a,1===e.length?"FileFormat - "+e[0].name+".json":"fileFormats.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.FileFormat&&t.changeClass!==c.dc.TagObjects||e.updateFileFormats()}))}}]),e}()).\u0275fac=function(e){return new(e||w)(s.Kb(n.a),s.Kb(i.a),s.Kb(l.e),s.Kb(l.a))},w.\u0275cmp=s.Eb({type:w,selectors:[["fileFormats"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","File Formats","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],["class","mr-1","title","Create a new file format",3,"routerLink",4,"ngIf"],["title","Create a new file format",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"fileFormat"],[1,"mr-1",3,"click"],["title","Delete selected file formats",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["title","Delete selected file formats",3,"click"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"dexih-widget",1),s.Vb("close",(function(){return t.close()})),s.Ob(2,"dexih-table",2),s.Vb("rowClick",(function(e){return t.editFileFormat(e)})),s.Dc(3,g,1,1,"ng-template",null,3,s.Ec),s.Dc(5,y,1,1,"ng-template",4,5,s.Ec),s.Dc(7,k,3,3,"ng-template",6,7,s.Ec),s.Nb(),s.Nb(),s.Lb(9,"dexih-help",8),s.Nb()),2&e&&(s.yb(1),s.hc("showCloseButton",!0),s.yb(1),s.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,b.a,h.a,d.t,u.o,l.f,f.a,u.u,m.a,u.g],encapsulation:2}),w),O=a("cvPx"),N=a("2v7R"),T=a("iFLP"),D=a("64E1"),x=a("oLr2"),F=a("3Pt+");function I(e,t){if(1&e&&s.Lb(0,"save-button",8),2&e){var a=s.Zb(2);s.hc("formsService",a.formsService)}}function K(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-invalid-form-details",5),s.Vb("click",(function(){return s.vc(a),s.Zb().formsService.showErrors()})),s.Nb(),s.Dc(1,I,1,1,"save-button",6),s.Lb(2,"cancel-button",7)}if(2&e){var n=s.Zb();s.hc("control",n.formsService.currentForm),s.yb(1),s.hc("ngIf",n.hubCache.canWrite),s.yb(1),s.hc("formsService",n.formsService)}}function E(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"form-input",32),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("errors",a.formsService.formErrors.comment)}}function V(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"form-input",33),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("maxlength",1)("errors",a.formsService.formErrors.quote)}}function L(e,t){if(1&e&&(s.Ob(0,"form",9),s.Ob(1,"fieldset"),s.Ob(2,"section"),s.Lb(3,"form-input",10),s.Nb(),s.Ob(4,"section"),s.Lb(5,"form-textarea",11),s.Nb(),s.Ob(6,"div",12),s.Ob(7,"section",13),s.Lb(8,"form-input",14),s.Nb(),s.Lb(9,"section",13),s.Nb(),s.Ob(10,"div",12),s.Ob(11,"section",13),s.Lb(12,"form-input",15),s.Nb(),s.Ob(13,"section",13),s.Lb(14,"form-input",16),s.Nb(),s.Nb(),s.Ob(15,"div",12),s.Ob(16,"section",13),s.Lb(17,"form-checkbox",17),s.Nb(),s.Ob(18,"section",13),s.Lb(19,"form-checkbox",18),s.Nb(),s.Nb(),s.Ob(20,"div",12),s.Ob(21,"section",13),s.Lb(22,"form-checkbox",19),s.Nb(),s.Ob(23,"section",13),s.Lb(24,"form-checkbox",20),s.Nb(),s.Nb(),s.Ob(25,"div",12),s.Ob(26,"section",13),s.Lb(27,"form-checkbox",21),s.Dc(28,E,2,1,"div",22),s.Nb(),s.Ob(29,"section",13),s.Lb(30,"form-checkbox",23),s.Dc(31,V,2,2,"div",22),s.Nb(),s.Nb(),s.Ob(32,"div",12),s.Ob(33,"section",13),s.Lb(34,"form-checkbox",24),s.Nb(),s.Ob(35,"section",13),s.Lb(36,"form-checkbox",25),s.Nb(),s.Nb(),s.Ob(37,"div",12),s.Ob(38,"section",13),s.Lb(39,"form-checkbox",26),s.Nb(),s.Ob(40,"section",13),s.Lb(41,"form-checkbox",27),s.Nb(),s.Nb(),s.Ob(42,"div",12),s.Ob(43,"section",13),s.Lb(44,"form-checkbox",28),s.Nb(),s.Ob(45,"section",13),s.Lb(46,"form-checkbox",29),s.Nb(),s.Nb(),s.Ob(47,"div",12),s.Ob(48,"section",13),s.Lb(49,"form-checkbox",30),s.Nb(),s.Ob(50,"section",13),s.Lb(51,"form-checkbox",31),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb();s.hc("formGroup",a.formsService.currentForm),s.yb(3),s.hc("errors",a.formsService.formErrors.name)("autocapitalize",!0),s.yb(2),s.hc("showMarkdown",!0),s.yb(3),s.hc("errors",a.formsService.formErrors.delimiter),s.yb(4),s.hc("errors",a.formsService.formErrors.bufferSize),s.yb(2),s.hc("errors",a.formsService.formErrors.skipHeaderRows),s.yb(14),s.hc("ngIf",a.formsService.currentForm.controls.allowComments.value),s.yb(3),s.hc("ngIf",!a.formsService.currentForm.controls.ignoreQuotes.value)}}var P,A=((P=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===N.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"File Format Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe()}},{key:"load",value:function(){var e=this;if(this.hubCache.isLoaded()){if(!this.hubCache||this.hubCache.status!==N.j.Loaded||this.isLoaded)return;if(this.isLoaded=!0,"edit"===this.action)if(this.fileFormatKey=+this.params.fileFormatKey,this.fileFormatKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihFileFormats.find((function(t){return t.key===e.fileFormatKey}));this.formsService.fileFormat(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no file format specified to edit.");if("new"===this.action){var a=new c.y;this.formsService.fileFormat(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/fileFormat-new","/fileFormat-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}}}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||P)(s.Kb(n.a),s.Kb(i.a),s.Kb(O.a),s.Kb(l.a),s.Kb(l.e))},P.\u0275cmp=s.Eb({type:P,selectors:[["dexih-fileFormat-edit-form"]],features:[s.xb([O.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Format","iconClass","fa fa-lg fa-fw fa-file-text-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","File Formats","path","/assets/help/reference/fileFormat.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","File Format Name","formControlName","name","placeholder","Enter the file format name.","iconClass","fa fa-list",3,"errors","autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Delimiter","formControlName","delimiter","placeholder","Enter the delimiter","iconClass","fa fa-list","note","The field delimiter (use \\t=tab, \\n=new line, \\r=carriage return).",3,"errors"],["type","number","label","Buffer Size","formControlName","bufferSize","placeholder","Enter buffer size","iconClass","fa fa-list","note","The size of the internal buffer that is used when reader or writing data.",3,"errors"],["type","number","label","Skip Header Rows Count","formControlName","skipHeaderRows","placeholder","Enter row count","iconClass","fa fa-list","note","The number of rows at the start of the file that will be ignored.",3,"errors"],["label","Has Header Record","formControlName","hasHeaderRecord","note","Tells the reader/writer if there is a header row in the CSV file."],["label","Ignore Header White Space","formControlName","ignoreHeaderWhiteSpace","note","Tells the reader to ignore white space in the headers when matching the columns to the properties by name."],["label","Match to Column to Header","formControlName","matchHeaderRecord","note","Tells the reader to use the column heading name to load the data.  If unchecked, columns will be read into fields in the order specified in the table columns."],["label","Set White Space Cells to Null ","formControlName","setWhiteSpaceCellsToNull","note","Set empty cells or cells containing only white spaces to null."],["label","Allow Comments","formControlName","allowComments"],[4,"ngIf"],["label","Ignore Quotes","formControlName","ignoreQuotes"],["label","Quote All Fields","formControlName","quoteAllFields","note","Tells the writer whether all fields written should have quotes around them; regardless if the field contains anything that should be escaped."],["label","Quote No Fields","formControlName","quoteNoFields","note","Tells the writer whether all fields written should not have quotes around them; regardless if the field contains anything that should be escaped."],["label","Trim Fields","formControlName","trimFields","note","Tells the reader to trim whitespace from the beginning and ending of the field value when reading."],["label","Trim Headers","formControlName","trimHeaders","note","Tells the reader to ignore white space from the beginning and ending of the headers when matching the columns to the properties by name."],["label","Detect Column Count Changes","formControlName","detectColumnCountChanges","note","Check for changes in the number of column from row to row.  If true, the job will abend."],["label","Ignore Reading Exceptions","formControlName","ignoreReadingExceptions","note","Tells the reader to ignore any issues when parsing the file.  Issues mean the file is bad in some way, and the parser isn't able to recover."],["label","Will Abend On Missing Field","formControlName","willThrowOnMissingField","note","Indicates if the job should be abended if reading and an expected field is missing."],["label","Skip Empty Records","formControlName","skipEmptyRecords","note","Tells the reader a record should be skipped when reading if it's empty. A record is considered empty if all fields are empty."],["label","Comment","formControlName","comment","placeholder","Enter comment character","iconClass","fa fa-list","note","The value used to denote a line that is commented out.",3,"errors"],["label","Quote","formControlName","quote","placeholder","Enter the quote","iconClass","fa fa-list","note","The value used to escape fields that contain a delimiter, quote, or line ending.",3,"maxlength","errors"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"dexih-widget",1),s.Vb("close",(function(){return t.close()})),s.Dc(2,K,3,3,"ng-template",null,2,s.Ec),s.Dc(4,L,52,9,"form",3),s.Nb(),s.Lb(5,"dexih-help",4),s.Nb()),2&e&&(s.yb(1),s.hc("showCloseButton",!0)("padding",!0),s.yb(3),s.hc("ngIf",t.formsService.currentForm))},directives:[u.P,d.t,h.a,T.a,D.a,x.a,F.I,F.t,F.l,u.D,F.s,F.j,u.H,u.A,F.o],encapsulation:2}),P)},NbKI:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a("fXoL"),i=a("Xjf6"),r=a("XNiG"),o=a("itXk"),c=a("cvPx"),s=a("3WyZ"),l=a("soiQ"),u=a("ElCs"),b=a("Wumg"),h=a("ofXK"),d=a("3Pt+"),f=a("YcGA"),m=a("PMKX"),v=a("HjvC"),p=a("l2bN"),g=a("H3K+"),y=a("g8Ys"),C=["widget"];function k(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button-edit",10),n.Vb("click",(function(){return n.vc(a),n.Zb().toggleEdit()})),n.Nb()}2&e&&n.hc("compact",!0)}function w(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button-preview",10),n.Vb("click",(function(){return n.vc(a),n.Zb().toggleEdit()})),n.Nb()}2&e&&n.hc("compact",!0)}function S(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button",14),n.Vb("click",(function(){return n.vc(a),n.Zb().maximise()})),n.Nb()}}function O(e,t){if(1&e){var a=n.Pb();n.Ob(0,"dexih-button",15),n.Vb("click",(function(){return n.vc(a),n.Zb().maximise()})),n.Nb()}}function N(e,t){if(1&e){var a=n.Pb();n.Ob(0,"span",20),n.Ob(1,"div",21),n.Ob(2,"div",22),n.Fc(3),n.Nb(),n.Nb(),n.Ob(4,"form-input",23),n.Vb("ngModelChange",(function(e){return n.vc(a),t.$implicit.value=e})),n.Nb(),n.Nb()}if(2&e){var i=t.$implicit,r=t.index;n.yb(3),n.Hc(" ",i.logicalName," "),n.yb(1),n.jc("name","column",r,""),n.hc("placeholder","Enter "+i.logicalName)("ngModel",i.value)}}function T(e,t){if(1&e&&(n.Ob(0,"div",18),n.Dc(1,N,5,4,"span",19),n.Nb()),2&e){var a=n.Zb(2);n.yb(1),n.hc("ngForOf",a.inputColumns)}}function D(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",18),n.Ob(1,"input-parameters",24),n.Vb("onRefreshData",(function(){return n.vc(a),n.Zb(2).refresh()})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb(2);n.yb(1),n.hc("showEdit",!1)("parameters",i.item.controls.parameters)("formsService",i.formsService)("parentParameters",i.parentParameters)("refreshEvent",i.refreshDataSubject.asObservable())}}function x(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",25),n.Ob(1,"series-animate",26),n.Vb("hasChanged",(function(){return n.vc(a),n.Zb(2).hasChanged()}))("dataChange",(function(e){return n.vc(a),n.Zb(2).dataRows=e})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb(2);n.yb(1),n.hc("showEdit",!1)("showFrame",!1)("animateConfig",null==i.dataResult?null:i.dataResult.viewConfig.animateConfig)("columns",null==i.dataResult?null:i.dataResult.columns)("baseData",null==i.dataResult?null:i.dataResult.data)("data",i.dataRows)}}function F(e,t){if(1&e&&(n.Ob(0,"div"),n.Dc(1,T,2,1,"div",16),n.Dc(2,D,2,5,"div",16),n.Dc(3,x,2,6,"div",17),n.Nb()),2&e){var a=n.Zb();n.yb(1),n.hc("ngIf",a.inputColumns&&a.inputColumns.length>0),n.yb(1),n.hc("ngIf",a.item.controls.parameters.length>0),n.yb(1),n.hc("ngIf",!(null!=a.data&&a.data.isRefreshing)&&(null==a.dataResult||null==a.dataResult.columns?null:a.dataResult.columns.length)>0&&(null==a.dataResult?null:a.dataResult.viewConfig)&&(null==a.dataResult?null:a.dataResult.data))}}function I(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",27),n.Ob(1,"form",28),n.Ob(2,"section"),n.Lb(3,"form-input",29),n.Nb(),n.Ob(4,"section"),n.Lb(5,"form-textarea",30),n.Nb(),n.Ob(6,"section"),n.Ob(7,"form-select",31),n.Lb(8,"view-edit-button",32),n.Nb(),n.Nb(),n.Ob(9,"section"),n.Lb(10,"form-checkbox",33),n.Lb(11,"form-checkbox",34),n.Nb(),n.Nb(),n.Ob(12,"input-parameters",35),n.Vb("onRefreshData",(function(){return n.vc(a),n.Zb().refresh()})),n.Nb(),n.Nb()}if(2&e){var i=n.Zb();n.yb(1),n.hc("formGroup",i.item),n.yb(2),n.hc("autocapitalize",i.on),n.yb(2),n.hc("showMarkdown",!0),n.yb(2),n.hc("items",i.views),n.yb(1),n.hc("key",i.item.controls.viewKey.value),n.yb(4),n.hc("showEdit",i.showEdit)("allowAddRemove",!1)("parameters",i.item.controls.parameters)("formsService",i.formsService)("parentParameters",i.parentParameters)("refreshEvent",i.refreshDataSubject.asObservable())}}function K(e,t){1&e&&(n.Ob(0,"div",40),n.Lb(1,"div",41),n.Fc(2," Refreshing, please wait... "),n.Nb())}function E(e,t){if(1&e&&(n.Ob(0,"div",46),n.Ob(1,"div",47),n.Ob(2,"b"),n.Fc(3),n.Nb(),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(3),n.Gc(a.item.controls.name.value)}}function V(e,t){if(1&e&&(n.Ob(0,"div",48),n.Ob(1,"div",18),n.Lb(2,"ngx-md",49),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(2),n.hc("data",a.item.controls.description.value)}}function L(e,t){if(1&e&&n.Lb(0,"dexih-table",54),2&e){var a=n.Zb(5);n.hc("enableMultiSelect",!1)("enableResponsive",!1)("enableSaveCsv",!1)("enableFilter",!1)("columns",a.dataResult.columns)("data",a.dataRows)}}function P(e,t){if(1&e&&n.Lb(0,"chart-view",55),2&e){var a=n.Zb(5);n.hc("responsive",!0)("columns",a.dataResult.columns)("data",a.dataRows)("config",a.view.chartConfig)}}function A(e,t){if(1&e&&(n.Ob(0,"div",50),n.Dc(1,L,1,6,"dexih-table",51),n.Ob(2,"div",52),n.Dc(3,P,1,4,"chart-view",53),n.Nb(),n.Nb()),2&e){var a=n.Zb(4);n.yb(1),n.hc("ngIf",a.view.viewType==a.eViewType.Table),n.yb(2),n.hc("ngIf",a.view.viewType==a.eViewType.Chart)}}function R(e,t){if(1&e){var a=n.Pb();n.Ob(0,"div",56),n.Vb("click",(function(){return n.vc(a),n.Zb(4).refresh()})),n.Lb(1,"i",57),n.Fc(2," Select to refresh the view. "),n.Nb()}}function j(e,t){if(1&e&&(n.Dc(0,E,4,1,"div",42),n.Dc(1,V,3,1,"div",43),n.Dc(2,A,4,2,"div",44),n.Dc(3,R,3,0,"ng-template",null,45,n.Ec)),2&e){var a=n.sc(4),i=n.Zb(3);n.hc("ngIf",i.item.controls.header.value),n.yb(1),n.hc("ngIf",i.item.controls.description.value),n.yb(1),n.hc("ngIf",!(null!=i.data&&i.data.isRefreshing)&&(null==i.dataResult||null==i.dataResult.columns?null:i.dataResult.columns.length)>0&&(null==i.dataResult||null==i.dataResult.data?null:i.dataResult.data.length)>0)("ngIfElse",a)}}var _=function(e){return{overflow:e}};function M(e,t){if(1&e&&(n.Ob(0,"div",37),n.Dc(1,K,3,0,"div",38),n.Dc(2,j,5,4,"ng-template",null,39,n.Ec),n.Nb()),2&e){var a=n.sc(3),i=n.Zb(2);n.hc("ngStyle",n.mc(3,_,i.item.controls.scrollable.value?"scroll":"hidden")),n.yb(1),n.hc("ngIf",null==i.data?null:i.data.isRefreshing)("ngIfElse",a)}}function Z(e,t){if(1&e&&n.Dc(0,M,4,5,"div",36),2&e){var a=n.Zb();n.hc("ngIf",!a.showPreview&&a.view)}}var H=function(){var e=function(){function e(t,a,i){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.formsService=i,this.showEdit=!0,this.showPreview=!1,this.isMaximized=!1,this.onRemove=new n.n,this.onMaximize=new n.n,this.eViewType=l.rc,this.firstLoad=!0,this.dialogOpen=!1,this.dataRows=[],this.refreshDataSubject=new r.a,this.cancelToken=new s.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(o.a)(this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a;e.hubCache=t[0],e.remoteAgent=t[1],e.hubService.isHubCacheLoaded&&(e.views=e.hubCache.hub.dexihViews,(null===(a=e.item)||void 0===a?void 0:a.controls.viewKey)&&(e.view=e.hubCache.hub.dexihViews.find((function(t){return t.key===e.item.controls.viewKey.value})),e.data=e.item.controls.runTime.value.data,e.data?e._refreshDataSubscription=e.data.data.subscribe((function(t){t&&(e.dataResult=t,t.viewConfig.animateConfig||(e.dataRows=e.dataResult.data),t.status&&e.hubService.addHubMessage(t.status,!1,e.view.name))})):e.remoteAgent&&(e.firstLoad?e.refresh():e.dialogOpen||(e.dialogOpen=!0,e.authService.confirmDialog("Remote Agent Available","A remote agent is available, would you like to refresh the data?").then((function(t){t&&e.refresh(),e.dialogOpen=!1}))),e.firstLoad=!1)),e.parentParameters=e.formsService.currentForm.controls.parameters.value,e._parametersSubscription&&e._parametersSubscription.unsubscribe(),e._parametersSubscription=e.formsService.currentForm.controls.parameters.valueChanges.subscribe((function(t){e.parentParameters=t})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._refreshDataSubscription&&this._refreshDataSubscription.unsubscribe(),this._parametersSubscription&&this._parametersSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"ngOnChanges",value:function(e){var t=this,a=e.item;if(a){var n=a.currentValue;this.views&&n.value&&(this.view=this.hubCache.hub.dexihViews.find((function(e){return e.key===n.value}))),this._viewKeySubscription&&this._viewKeySubscription.unsubscribe(),this._viewKeySubscription=n.controls.viewKey.valueChanges.subscribe((function(e){t.formsService.updateDashboardItemView(n)}))}}},{key:"refresh",value:function(){var e=this,t=this.hubService.previewViewKey(this.item.controls.viewKey.value,null,this.formsService.currentForm.controls.parameters.value,this.item.controls.parameters.value,this.cancelToken);this.data=this.item.controls.runTime.value.data,this.data.refresh(t),t.then((function(t){e.refreshDataSubject.next(),e.dataResult=t,e.dataResult.viewConfig.animateConfig||(e.dataRows=e.dataResult.data)})).catch((function(t){e.hubService.addHubMessage(t)}))}},{key:"parameterChange",value:function(){this.refresh()}},{key:"toggleEdit",value:function(){this.showEdit=!this.showEdit}},{key:"removeItem",value:function(e){e.preventDefault(),e.stopPropagation(),this.onRemove.emit()}},{key:"maximise",value:function(){this.onMaximize.emit(this.item)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(n.Kb(u.a),n.Kb(i.a),n.Kb(c.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["dashboard-item"]],viewQuery:function(e,t){var a;1&e&&n.Bc(C,!0),2&e&&n.rc(a=n.Wb())&&(t.widget=a.first)},inputs:{item:"item",showEdit:"showEdit",showPreview:"showPreview",refreshData:"refreshData",isMaximized:"isMaximized"},outputs:{onRemove:"onRemove",onMaximize:"onMaximize"},features:[n.wb],decls:16,vars:9,consts:[[1,"side-menu"],[1,"side-menu-content"],[1,"spin-icon"],[1,"fa","fa-cog","fa-spin"],[1,"side-menu-box"],[1,"bg-light","rounded","p-1"],[3,"compact","click"],["class","ml-1",3,"compact","click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",3,"click",4,"ngIf"],["class","ml-1","buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",3,"click",4,"ngIf"],[1,"ml-1",3,"compact","click"],[4,"ngIf"],["class","p-3 gridster-item-content",4,"ngIf"],[3,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-window-maximize text-white","tooltip","Maximize window",1,"ml-1",3,"click"],["buttonClass","btn btn-primary","iconClass","fa fa-window-minimize text-white","tooltip","Minimize window",1,"ml-1",3,"click"],["class","m-1",4,"ngIf"],["class","m-1","style","z-index: 99999;",4,"ngIf"],[1,"m-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"showEdit","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],[1,"m-1",2,"z-index","99999"],[3,"showEdit","showFrame","animateConfig","columns","baseData","data","hasChanged","dataChange"],[1,"p-3","gridster-item-content"],[3,"formGroup"],["label","Item Name","formControlName","name","placeholder","Enter the dashboard item name.","iconClass","fa fa-list",3,"autocapitalize"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Select View","formControlName","viewKey","itemKey","key","itemName","name",3,"items"],[3,"key"],["label","Show Header","formControlName","header"],["label","Allow Scrolling","formControlName","scrollable"],[3,"showEdit","allowAddRemove","parameters","formsService","parentParameters","refreshEvent","onRefreshData"],["class","box",3,"ngStyle",4,"ngIf"],[1,"box",3,"ngStyle"],["class","p-3",4,"ngIf","ngIfElse"],["notRefreshing",""],[1,"p-3"],[1,"dexih-loader"],["class","box-header bg-secondary text-white",4,"ngIf"],["class","box-header",4,"ngIf"],["class","box-content",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"box-header","bg-secondary","text-white"],[1,"m-3"],[1,"box-header"],[3,"data"],[1,"box-content"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data",4,"ngIf"],[1,"h-100"],[3,"responsive","columns","data","config",4,"ngIf"],[3,"enableMultiSelect","enableResponsive","enableSaveCsv","enableFilter","columns","data"],[3,"responsive","columns","data","config"],[1,"alert","alert-info",3,"click"],[1,"fa","fa-warning"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Ob(1,"div",1),n.Ob(2,"div",2),n.Lb(3,"i",3),n.Nb(),n.Ob(4,"div",4),n.Ob(5,"div",5),n.Ob(6,"div"),n.Ob(7,"dexih-button-refresh",6),n.Vb("click",(function(){return t.refresh()})),n.Nb(),n.Dc(8,k,1,1,"dexih-button-edit",7),n.Dc(9,w,1,1,"dexih-button-preview",7),n.Dc(10,S,1,0,"dexih-button",8),n.Dc(11,O,1,0,"dexih-button",9),n.Ob(12,"dexih-button-delete",10),n.Vb("click",(function(e){return t.removeItem(e)})),n.Nb(),n.Nb(),n.Dc(13,F,4,3,"div",11),n.Nb(),n.Nb(),n.Nb(),n.Nb(),n.Dc(14,I,13,11,"div",12),n.Dc(15,Z,1,1,"ng-template",13)),2&e&&(n.yb(7),n.hc("compact",!0),n.yb(1),n.hc("ngIf",!t.showEdit),n.yb(1),n.hc("ngIf",t.showEdit),n.yb(1),n.hc("ngIf",!t.isMaximized),n.yb(1),n.hc("ngIf",t.isMaximized),n.yb(1),n.hc("compact",!0),n.yb(1),n.hc("ngIf",!t.showEdit&&!t.showPreview&&t.view),n.yb(1),n.hc("ngIf",t.showEdit),n.yb(1),n.hc("ngIf",!t.showEdit))},directives:[b.s,h.t,b.g,b.j,b.q,b.f,h.s,b.D,d.s,d.v,f.a,m.a,d.I,d.t,d.l,d.j,b.H,b.E,v.a,b.A,h.w,p.a,g.a,y.a],styles:[".dashboard-item[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;overflow:auto}"]}),e}()},e1St:function(e,t,a){"use strict";a.r(t),a.d(t,"HubBaseModule",(function(){return Kc}));var n=a("3Pt+"),i=a("PCNd"),r=a("tyNb"),o=a("4Y1E"),c=a("ElCs"),s=a("2Vo4"),l=a("itXk"),u=a("soiQ"),b=a("fXoL"),h=a("Wumg"),d=a("H3K+"),f=a("MI/1"),m=a("VdXI"),v=a("ofXK"),p=a("mWX8");function g(e,t){if(1&e&&(b.Lb(0,"actions-columnValidation-button",8),b.Lb(1,"dependent-items-button",9)),2&e){var a=t.item,n=b.Zb();b.hc("columnValidation",a),b.yb(1),b.hc("key",a.key)("objectType",n.eSharedObjectType.ColumnValidation)}}function y(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",10),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().deleteValidations(e)})),b.Nb()}}function C(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",10),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb(),b.Dc(1,y,1,0,"dexih-button-delete",11),b.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=b.Zb();b.yb(1),b.hc("ngIf",i.hubCache.canWrite),b.yb(1),b.hc("objectType",i.eSharedObjectType.ColumnValidation)("objects",n)}}var k=function(){return["columnValidation-new"]};function w(e,t){1&e&&b.Lb(0,"dexih-button-new",14),2&e&&b.hc("routerLink",b.lc(1,k))}function S(e,t){if(1&e&&b.Dc(0,w,1,2,"dexih-button-new",13),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite)}}var O,N=((O=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateValidations()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteValidations",value:function(e){this.hubService.deleteColumnValidations(e)}},{key:"updateValidations",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihColumnValidations.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(u.dc.ColumnValidation,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["columnValidation-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddColumnValidation(e.key,a)})),this.hubService.exportHub(a,1===e.length?"ColumnValidation - "+e[0].name+".json":"columnValidations.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.ColumnValidation&&t.changeClass!==u.dc.TagObjects||e.updateValidations()}))}}]),e}()).\u0275fac=function(e){return new(e||O)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},O.\u0275cmp=b.Eb({type:O,selectors:[["columnValidations"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Validation Rules","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"mr-1",3,"columnValidation"],[1,"mr-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,g,2,3,"ng-template",3,4,b.Ec),b.Dc(5,C,3,3,"ng-template",5,6,b.Ec),b.Dc(7,S,1,1,"ng-template",null,7,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,f.a,m.a,h.u,v.t,p.a,h.g,h.o,r.f],encapsulation:2}),O),T=a("2v7R"),D=a("cvPx"),x=a("1qMd"),F=a("3WyZ"),I=a("64E1"),K=a("iFLP"),E=a("oLr2");function V(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div"),b.Ob(1,"div",10),b.Ob(2,"div",11),b.Ob(3,"button",12),b.Vb("click",(function(){return b.vc(a),b.Zb(3).test()})),b.Lb(4,"i",13),b.Nb(),b.Nb(),b.Ob(5,"input",14),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb(3).testValue=e})),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(3);b.yb(5),b.hc("ngModel",n.testValue)}}function L(e,t){if(1&e&&b.Lb(0,"save-button",6),2&e){var a=b.Zb(3);b.hc("formsService",a.formsService)}}function P(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",7),b.Vb("click",(function(){return b.vc(a),b.Zb(2).formsService.showErrors()})),b.Nb(),b.Dc(1,V,6,1,"div",8),b.Dc(2,L,1,1,"save-button",9)}if(2&e){var n=b.Zb(2);b.hc("control",n.formsService.currentForm),b.yb(1),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("ngIf",n.hubCache.canWrite)}}function A(e,t){if(1&e&&(b.Ob(0,"div",4),b.Dc(1,P,3,3,"ng-template",5),b.Lb(2,"cancel-button",6),b.Nb()),2&e){var a=b.Zb();b.yb(1),b.hc("ngIf",a.hubCache&&a.hubCache.status===a.eCacheStatus.Loaded),b.yb(1),b.hc("formsService",a.formsService)}}function R(e,t){if(1&e&&(b.Ob(0,"div"),b.Fc(1),b.Nb()),2&e){var a=b.Zb(3);b.yb(1),b.Hc("Cleaned Value = ",a.testResult.cleanedValue," ")}}function j(e,t){if(1&e&&(b.Ob(0,"div"),b.Fc(1),b.Nb()),2&e){var a=b.Zb(3);b.yb(1),b.Hc("Reject Reason = ",a.testResult.rejectReason," ")}}function _(e,t){if(1&e&&(b.Ob(0,"section"),b.Ob(1,"div",30),b.Fc(2),b.Dc(3,R,2,1,"div",8),b.Dc(4,j,2,1,"div",8),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.Cb("alert-danger",0==a.testResult.success)("alert-success",1==a.testResult.success),b.yb(1),b.Hc(" Test Result = ",a.testResult.success," "),b.yb(1),b.hc("ngIf",a.testResult.cleanedValue),b.yb(1),b.hc("ngIf",a.testResult.rejectReason)}}function M(e,t){if(1&e&&(b.Ob(0,"section",17),b.Lb(1,"form-select",31),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("items",a.cleanActions)}}function Z(e,t){1&e&&(b.Ob(0,"section"),b.Lb(1,"form-input",32),b.Nb())}function H(e,t){1&e&&(b.Ob(0,"div",16),b.Ob(1,"section",17),b.Lb(2,"form-input",33),b.Nb(),b.Ob(3,"section",17),b.Lb(4,"form-input",34),b.Nb(),b.Nb())}function B(e,t){1&e&&(b.Ob(0,"section"),b.Lb(1,"form-input",35),b.Nb())}function U(e,t){1&e&&(b.Ob(0,"section"),b.Lb(1,"form-input",36),b.Nb())}function q(e,t){1&e&&(b.Ob(0,"div",16),b.Ob(1,"section",17),b.Lb(2,"form-input",37),b.Nb(),b.Ob(3,"section",17),b.Lb(4,"form-input",38),b.Nb(),b.Nb())}function z(e,t){if(1&e&&(b.Ob(0,"form",15),b.Ob(1,"fieldset"),b.Dc(2,_,5,7,"section",8),b.Ob(3,"div",16),b.Ob(4,"section",17),b.Lb(5,"form-input",18),b.Nb(),b.Ob(6,"section",17),b.Lb(7,"form-select",19),b.Nb(),b.Nb(),b.Ob(8,"section"),b.Lb(9,"form-textarea",20),b.Nb(),b.Ob(10,"div",16),b.Ob(11,"section",17),b.Lb(12,"form-select",21),b.Nb(),b.Dc(13,M,2,1,"section",22),b.Nb(),b.Dc(14,Z,2,0,"section",8),b.Ob(15,"section"),b.Lb(16,"form-checkbox",23),b.Nb(),b.Dc(17,H,5,0,"div",24),b.Dc(18,B,2,0,"section",8),b.Dc(19,U,2,0,"section",8),b.Dc(20,q,5,0,"div",24),b.Ob(21,"section"),b.Lb(22,"form-tags",25),b.Nb(),b.Ob(23,"section"),b.Lb(24,"form-tags",26),b.Nb(),b.Ob(25,"section"),b.Lb(26,"form-select",27),b.Nb(),b.Ob(27,"section"),b.Lb(28,"form-checkbox",28),b.Nb(),b.Ob(29,"section"),b.Lb(30,"form-checkbox",29),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.formsService.currentForm),b.yb(2),b.hc("ngIf",a.testResult),b.yb(3),b.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),b.yb(2),b.hc("items",a.typeCodes),b.yb(2),b.hc("showMarkdown",!0),b.yb(3),b.hc("items",a.InvalidActions),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.invalidAction==a.eInvalidAction.Clean||a.formsService.currentForm.value.invalidAction==a.eInvalidAction.RejectClean),b.yb(1),b.hc("ngIf",(a.formsService.currentForm.value.invalidAction==a.eInvalidAction.RejectClean||a.formsService.currentForm.value.invalidAction==a.eInvalidAction.Clean)&&a.formsService.currentForm.value.cleanAction==a.eCleanAction.CleanValue),b.yb(3),b.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.dataType==a.eTypeCode.String||a.formsService.currentForm.value.dataType==a.eTypeCode.Char),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.dataType!=a.eTypeCode.String&&a.formsService.currentForm.value.dataType!=a.eTypeCode.Char),b.yb(6),b.hc("items",a.connections)("allowNullSelect",!0)}}var W,G=((W=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.eInvalidAction=u.Fb,this.eCleanAction=u.fb,this.eTypeCode=u.pc,this.InvalidActions=T.g,this.CleanActions=T.a,this.typeCodes=x.a,this.invalidActions=T.g,this.cleanActions=T.a,this.lookupColumnValue="",this.isLoaded=!1,this.eCacheStatus=T.j,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===T.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.connections=this.hubCache.getConnectionTables(),"edit"===this.action)if(this.columnValidationKey=+this.params.validationKey,this.columnValidationKey)if(this.hubCache.hub&&this.hubCache.hub.dexihColumnValidations){var t=this.hubCache.hub.dexihColumnValidations.find((function(t){return t.key===e.columnValidationKey}));this.formsService.validation(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no validation specified to edit.");if("new"===this.action){var a=new u.e;this.formsService.validation(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/columnValidation-new","/columnValidation-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.isLoaded=!0,this.getValidationLookupColumn(),this._lookupColumnSubscription&&this._lookupColumnSubscription.unsubscribe(),this._lookupColumnSubscription=this.formsService.currentForm.controls.lookupColumnKey.valueChanges.subscribe((function(){e.getValidationLookupColumn()}))}},{key:"getValidationLookupColumn",value:function(){var e=this.formsService.currentForm.controls.lookupColumnKey.value;if(e){var t=this.hubCache.getColumn(e);if(t){var a=this.hubCache.getTable(t.tableKey);this.lookupColumnValue="Exists in table:"+a.name+", column:"+t.name}else this.lookupColumnValue="Column not found.  Re-select a valid column."}else this.lookupColumnValue=""}},{key:"test",value:function(){var e=this;this.hubService.testColumnValidation(this.formsService.currentForm.value,this.testValue,this.cancelToken).then((function(t){e.testResult=t}))}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The view has not been saved","The column validation changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The column validation changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||W)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e))},W.\u0275cmp=b.Eb({type:W,selectors:[["dexih-columnValidation-edit-form"]],hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},features:[b.xb([D.a])],decls:5,vars:3,consts:[[1,"container"],["title","Edit Validation","iconClass","fa fa-lg fa-fw fa-check-square-o",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],[1,"d-inline-flex"],[3,"ngIf"],[1,"mr-1",3,"formsService"],[1,"mr-1",3,"control","click"],[4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[1,"input-group","mr-1"],[1,"input-group-prepend"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-check-circle-o"],["type","text","placeholder","Test value","aria-label","","aria-describedby","basic-addon1",1,"form-control",2,"max-width","100px",3,"ngModel","ngModelChange"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Column Validation Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Data Type","formControlName","dataType","itemKey","key","itemName","name",3,"items"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],["label","Validation Fail Action","formControlName","invalidAction","itemKey","key","itemName","name","note","Action to take when the validation fails.",3,"items"],["class","form-group col-md-6",4,"ngIf"],["label","Ignore null values.","formControlName","allowDbNull"],["class","form-row",4,"ngIf"],["label","Restrict to list of values","formControlName","listOfValues","placeholder","Provide a list of values which are valid."],["label","Excluded list of values","formControlName","listOfNotValues","placeholder","Provide a list of values which are valid."],["label","Restrict to values that exist in a lookup table column","formControlName","lookupColumnKey","grandParentName","name","parentName","name","itemKey","key","itemName","name","childItems","dexihTables","grandChildItems","dexihTableColumns","note","Checks the selected table column, and ensures the value contains at least one match.",3,"items","allowNullSelect"],["label","Only lookup values where the 'is current' column is true.","formControlName","lookupIsValid"],["label","Allow valid when lookup returns multiple rows.","formControlName","lookupMultipleRecords"],[1,"alert"],["label","Clean Action","formControlName","cleanAction","itemKey","key","itemName","name","note","Clean Action to apply",3,"items"],["label","Clean Value","formControlName","cleanValue","placeholder","Enter the clean value.","iconClass","fa fa-list"],["label","Minimum String Length","formControlName","minLength","placeholder","Enter the minimum string length","type","number","iconClass","fa fa-list"],["label","Maximum String Length","formControlName","maxLength","placeholder","Enter the maximum string length","type","number","iconClass","fa fa-list"],["label","Simple Pattern Match","formControlName","patternMatch","placeholder","Provide a match string","iconClass","fa fa-list","note","Simple pattern match, use the format - A=Upper, a=Lower, Z=Any Character, 9=numeric.  (For example: AA999 matches AS123)"],["label","Regular Expression Match","formControlName","regexMatch","placeholder","Provide a regular expression","iconClass","fa fa-list","note","Use a standard regular expression to validate.  For example [A-Za-z0-9] will ensure string only contains characters and numbers."],["label","Minimum Value","formControlName","minValue","placeholder","Enter the minimum value","type","number","iconClass","fa fa-list"],["label","Maximum Value","formControlName","maxValue","placeholder","Enter the maximum value","type","number","iconClass","fa fa-list"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,A,3,2,"ng-template",null,2,b.Ec),b.Dc(4,z,31,15,"form",3),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(3),b.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,I.a,K.a,n.c,n.s,n.v,E.a,n.I,n.t,n.l,h.D,n.j,h.E,h.H,h.A,h.F],encapsulation:2}),W),Q=a("rgmq"),$=a("/pur"),X=a("l2bN"),Y=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{s(n.next(e))}catch(t){r(t)}}function c(e){try{s(n.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,c)}s((n=n.apply(e,t||[])).next())}))};function J(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",10),b.Vb("click",(function(){b.vc(a);var e=b.Zb(2);return!e.refreshingConnection&&e.refreshConnection()})),b.Fc(1,"Test"),b.Nb()}if(2&e){var n=b.Zb(2);b.hc("busy",n.refreshingConnection)}}function ee(e,t){if(1&e&&b.Lb(0,"save-button",11),2&e){var a=b.Zb(2);b.hc("formsService",a.formsService)}}var te=function(e){return["../../connection-import",e]};function ae(e,t){if(1&e&&(b.Ob(0,"dexih-button",13),b.Fc(1,"Import Tables"),b.Nb()),2&e){var a=b.Zb(4);b.hc("routerLink",b.mc(1,te,a.formsService.currentForm.controls.key.value))}}function ne(e,t){if(1&e&&b.Dc(0,ae,2,3,"dexih-button",12),2&e){var a=b.Zb(3);b.hc("ngIf",a.formsService.currentForm.controls.key.value)}}var ie=function(e){return["../../../tables","table-new",e]};function re(e,t){if(1&e&&(b.Ob(0,"dexih-button",13),b.Fc(1,"New File"),b.Nb()),2&e){var a=b.Zb(4);b.hc("routerLink",b.mc(1,ie,a.formsService.currentForm.controls.key.value))}}function oe(e,t){if(1&e&&b.Dc(0,re,2,3,"dexih-button",12),2&e){var a=b.Zb(3);b.hc("ngIf",a.formsService.currentForm.controls.key.value)}}function ce(e,t){if(1&e&&(b.Ob(0,"dexih-button",13),b.Fc(1,"New WebService"),b.Nb()),2&e){var a=b.Zb(4);b.hc("routerLink",b.mc(1,ie,a.formsService.currentForm.controls.key.value))}}function se(e,t){if(1&e&&b.Dc(0,ce,2,3,"dexih-button",12),2&e){var a=b.Zb(3);b.hc("ngIf",a.formsService.currentForm.controls.key.value)}}function le(e,t){if(1&e&&(b.Dc(0,ne,1,1,"ng-template",8),b.Dc(1,oe,1,1,"ng-template",8),b.Dc(2,se,1,1,"ng-template",8)),2&e){var a=b.Zb(2);b.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.SqlDatabase||a.connectionReference.connectionCategory==a.eConnectionCategory.DatabaseFile||a.connectionReference.connectionCategory==a.eConnectionCategory.NoSqlDatabase||a.connectionReference.connectionCategory==a.eConnectionCategory.Hub),b.yb(1),b.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.File),b.yb(1),b.hc("ngIf",a.connectionReference.connectionCategory==a.eConnectionCategory.WebService)}}function ue(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",5),b.Vb("click",(function(){return b.vc(a),b.Zb().formsService.showErrors()})),b.Nb(),b.Dc(1,J,2,1,"dexih-button",6),b.Dc(2,ee,1,1,"save-button",7),b.Dc(3,le,3,3,"ng-template",8),b.Lb(4,"cancel-button",9)}if(2&e){var n=b.Zb();b.hc("control",n.formsService.currentForm),b.yb(1),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("ngIf",n.hubCache.canWrite&&n.connectionReference),b.yb(1),b.hc("formsService",n.formsService)}}function be(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",33),b.Vb("click",(function(){return b.vc(a),b.Zb(7).revealConnectionString()})),b.Lb(1,"i",34),b.Fc(2," Reveal "),b.Nb()}}function he(e,t){1&e&&(b.Ob(0,"span"),b.Lb(1,"i",35),b.Fc(2," Revealing... please wait "),b.Nb())}function de(e,t){if(1&e&&(b.Ob(0,"span"),b.Fc(1," ("),b.Dc(2,be,3,0,"a",32),b.Dc(3,he,3,0,"span",23),b.Fc(4,")"),b.Nb()),2&e){var a=b.Zb(6);b.yb(2),b.hc("ngIf",0==a.revealingConnectionString),b.yb(1),b.hc("ngIf",1==a.revealingConnectionString)}}function fe(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form-input",31),b.Vb("keydown",(function(){return b.vc(a),b.Zb(5).connectionStringChanged()})),b.Dc(1,de,5,2,"span",23),b.Nb()}if(2&e){var n=b.Zb(5);b.hc("errors",n.formsService.formErrors.connectionStringDisplay),b.yb(1),b.hc("ngIf",!n.formsService.formErrors.connectionStringRaw)}}function me(e,t){if(1&e&&b.Lb(0,"form-select",36),2&e){var a=b.Zb(5);b.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function ve(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section"),b.Dc(1,fe,2,2,"form-input",28),b.Dc(2,me,1,3,"form-select",29),b.Ob(3,"form-checkbox",30),b.Vb("click",(function(){return b.vc(a),b.Zb(4).clearConnectionString()})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(1),b.hc("ngIf",!n.formsService.currentForm.controls.useConnectionStringVariable.value),b.yb(1),b.hc("ngIf",n.formsService.currentForm.controls.useConnectionStringVariable.value)}}function pe(e,t){if(1&e&&(b.Ob(0,"span"),b.Ob(1,"section"),b.Lb(2,"form-checkbox",27),b.Nb(),b.Dc(3,ve,4,2,"section",23),b.Nb()),2&e){var a=b.Zb(3);b.yb(3),b.hc("ngIf",1==a.formsService.currentForm.controls.useConnectionString.value)}}function ge(e,t){1&e&&(b.Ob(0,"section"),b.Lb(1,"form-checkbox",40),b.Nb())}function ye(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form-input",45),b.Vb("keydown",(function(){return b.vc(a),b.Zb(5).passwordChanged()})),b.Nb()}if(2&e){var n=b.Zb(5);b.hc("errors",n.formsService.formErrors.password)}}function Ce(e,t){if(1&e&&b.Lb(0,"form-select",46),2&e){var a=b.Zb(5);b.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function ke(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",18),b.Ob(1,"section",19),b.Lb(2,"form-select",41),b.Nb(),b.Ob(3,"section",19),b.Dc(4,ye,1,1,"form-input",42),b.Dc(5,Ce,1,3,"form-select",43),b.Ob(6,"form-checkbox",44),b.Vb("click",(function(){return b.vc(a),b.Zb(4).clearPassword()})),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(2),b.hc("enableTextEntry",!0)("errors",n.formsService.formErrors.username)("items",n.variables)("enableFilter",!0),b.yb(2),b.hc("ngIf",0==n.formsService.currentForm.controls.usePasswordVariable.value),b.yb(1),b.hc("ngIf",n.formsService.currentForm.controls.usePasswordVariable.value)}}function we(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form-input",50),b.Vb("keydown",(function(){return b.vc(a),b.Zb(5).passwordChanged()})),b.Nb()}if(2&e){var n=b.Zb(5);b.hc("errors",n.formsService.formErrors.password)}}function Se(e,t){if(1&e&&b.Lb(0,"form-select",51),2&e){var a=b.Zb(5);b.hc("items",a.variables)("sortItems",!0)("enableTextEntry",!0)}}function Oe(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",18),b.Ob(1,"section",19),b.Dc(2,we,1,1,"form-input",47),b.Dc(3,Se,1,3,"form-select",48),b.Ob(4,"form-checkbox",49),b.Vb("click",(function(){return b.vc(a),b.Zb(4).clearPassword()})),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(2),b.hc("ngIf",0==n.formsService.currentForm.controls.usePasswordVariable.value),b.yb(1),b.hc("ngIf",n.formsService.currentForm.controls.usePasswordVariable.value)}}function Ne(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",33),b.Vb("click",(function(){return b.vc(a),b.Zb(5).refreshConnection()})),b.Lb(1,"i",34),b.Fc(2," Refresh "),b.Nb()}}function Te(e,t){1&e&&(b.Ob(0,"span"),b.Lb(1,"i",35),b.Fc(2," Refreshing... please wait "),b.Nb())}function De(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",33),b.Vb("click",(function(){return b.vc(a),b.Zb(5).createDatabase()})),b.Lb(1,"i",54),b.Fc(2," New Database "),b.Nb()}}function xe(e,t){1&e&&(b.Ob(0,"span"),b.Lb(1,"i",35),b.Fc(2," Creating database... please wait "),b.Nb())}function Fe(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section",52),b.Ob(1,"form-select",53),b.Vb("textValueChange",(function(e){return b.vc(a),b.Zb(4).newDatabaseName(e)})),b.Fc(2," ("),b.Dc(3,Ne,3,0,"a",32),b.Dc(4,Te,3,0,"span",23),b.Fc(5,") ( "),b.Dc(6,De,3,0,"a",32),b.Dc(7,xe,3,0,"span",23),b.Fc(8,") "),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(1),b.hc("label",n.connectionReference.databaseDescription)("items",n.databases)("defaultItem",n.formsService.currentForm.value.defaultDatabase)("sortItems",!0)("enableTextEntry",!0),b.yb(2),b.hc("ngIf",0==n.refreshingConnection),b.yb(1),b.hc("ngIf",1==n.refreshingConnection),b.yb(2),b.hc("ngIf",0==n.creatingDatabase),b.yb(1),b.hc("ngIf",1==n.creatingDatabase)}}function Ie(e,t){if(1&e&&(b.Ob(0,"span"),b.Ob(1,"section"),b.Lb(2,"form-select",37),b.Nb(),b.Dc(3,ge,2,0,"section",23),b.Dc(4,ke,7,6,"div",38),b.Dc(5,Oe,5,2,"div",38),b.Dc(6,Fe,9,9,"section",39),b.Nb()),2&e){var a=b.Zb(3);b.yb(2),b.hc("enableTextEntry",!0)("label",a.connectionReference.serverDescription)("errors",a.formsService.formErrors.server)("items",a.variables)("enableFilter",!0)("note",a.connectionReference.serverHelp),b.yb(1),b.hc("ngIf",1==a.connectionReference.allowsWindowsAuth),b.yb(1),b.hc("ngIf",a.connectionReference.allowsUserPassword&&(0==a.formsService.currentForm.controls.useWindowsAuth.value||0==a.connectionReference.allowsWindowsAuth)),b.yb(1),b.hc("ngIf",a.connectionReference.allowsToken&&(0==a.formsService.currentForm.controls.useWindowsAuth.value||0==a.connectionReference.allowsWindowsAuth)),b.yb(1),b.hc("ngIf",a.connectionReference.requiresDatabase)}}function Ke(e,t){if(1&e&&(b.Ob(0,"section"),b.Lb(1,"form-checkbox",55),b.Nb()),2&e){var a=b.Zb(3);b.yb(1),b.hc("errors",a.formsService.formErrors.embedTableKey)}}function Ee(e,t){if(1&e){var a=b.Pb();b.Ob(0,"span"),b.Ob(1,"section"),b.Ob(2,"markdown",24),b.Vb("click",(function(e){return b.vc(a),b.Zb(2).getRoute(e)})),b.Nb(),b.Nb(),b.Dc(3,pe,4,1,"span",23),b.Dc(4,Ie,7,10,"span",23),b.Ob(5,"div",18),b.Ob(6,"section",19),b.Lb(7,"form-input",25),b.Nb(),b.Ob(8,"section",19),b.Lb(9,"form-input",26),b.Nb(),b.Nb(),b.Dc(10,Ke,2,1,"section",23),b.Nb()}if(2&e){var n=b.Zb(2);b.yb(2),b.hc("data",n.connectionReference.description),b.yb(1),b.hc("ngIf",1==n.connectionReference.allowsConnectionString),b.yb(1),b.hc("ngIf",0==n.formsService.currentForm.controls.useConnectionString.value),b.yb(3),b.hc("errors",n.formsService.formErrors.connectionTimeout),b.yb(2),b.hc("errors",n.formsService.formErrors.commandTimeout),b.yb(1),b.hc("ngIf","Managed"==n.formsService.currentForm.controls.purpose.value)}}var Ve=function(){return{standalone:!0}};function Le(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form",14),b.Lb(1,"input",15),b.Lb(2,"input",16),b.Ob(3,"fieldset"),b.Ob(4,"section"),b.Lb(5,"form-select",17),b.Nb(),b.Ob(6,"div",18),b.Ob(7,"section",19),b.Lb(8,"form-input",20),b.Nb(),b.Ob(9,"section",19),b.Ob(10,"form-select",21),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb().connectionReference=e}))("ngModelChange",(function(e){return b.vc(a),b.Zb().selectDatabaseType(e)})),b.Nb(),b.Nb(),b.Nb(),b.Ob(11,"section"),b.Lb(12,"form-textarea",22),b.Nb(),b.Dc(13,Ee,11,6,"span",23),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("formGroup",n.formsService.currentForm),b.yb(5),b.hc("items",n.eConnectionPurposeItems)("enableFilter",!1)("errors",n.formsService.formErrors.purpose),b.yb(3),b.hc("autocapitalize",!0)("errors",n.formsService.formErrors.name),b.yb(2),b.hc("ngModel",n.connectionReference)("ngModelOptions",b.lc(14,Ve))("items",n.connectionTypes)("enableKeySelect",!1)("sortItems",!0),b.yb(2),b.hc("showMarkdown",!0)("errors",n.formsService.formErrors.description),b.yb(1),b.hc("ngIf",n.connectionReference)}}var Pe,Ae=((Pe=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.savingConnection=!1,this.refreshingConnection=!1,this.revealingConnectionString=!1,this.creatingDatabase=!1,this.databases=[],this.eConnectionPurposeItems=u.kb.filter((function(e){return e.key>0})),this.eConnectionPurpose=u.jb,this.eConnectionCategory=u.ib,this.cancelToken=new F.a,this.isLoaded=!1,this.variables=[],this.logger=new Q.a("connection-edit")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.logger.LogC((function(){return"OnInit"}),Q.b.Trace);try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){return Y(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[0],this.params=t[1],this.hubCache=t[2],this.remoteLibraries=t[3],this.action=a.action,this.pageTitle=a.pageTitle,this.variables=this.hubCache.hub.dexihHubVariables.map((function(e){return"{"+e.name+"}"})),e.t0=this.hubCache&&this.hubCache.status===T.j.Loaded,!e.t0){e.next=17;break}if(e.t1=this.isLoaded&&"new"===this.action,e.t1){e.next=17;break}if(!this.isLoaded||!this.formsService.hasChanged){e.next=15;break}this.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(e){return Y(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e,!t.t0){t.next=4;break}return t.next=4,this.load();case 4:case"end":return t.stop()}}),t,this)})))})).catch((function(e){})),e.next=17;break;case 15:return e.next=17,this.load();case 17:case"end":return e.stop()}}),e,this)})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,n,i,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded=!0,"edit"!==this.action){e.next=21;break}if(this.connectionKey=+this.params.connectionKey,this.logger.LogC((function(){return"edit connection key ".concat(o.connectionKey,".")}),Q.b.Trace),!this.connectionKey){e.next=20;break}if(!this.hubCache.hub||!this.hubCache.hub.dexihConnections){e.next=17;break}if(!(t=this.hubCache.hub.dexihConnections.find((function(e){return e.key===o.connectionKey})))){e.next=14;break}return this.updateDatabaseTypes(t.purpose),e.next=8,this.hubService.GetConnectionReference(t);case 8:this.connectionReference=e.sent,this.formsService.connection(t),t.defaultDatabase&&(this.databases=[t.defaultDatabase]),this.logger.LogC((function(){return"edit connection, form loaded."}),Q.b.Trace),e.next=15;break;case 14:this.hubService.addHubErrorMessage("The specified connection could not be found."),this.logger.LogC((function(){return"edit connection with key ".concat(o.connectionKey," not found.")}),Q.b.Warning);case 15:e.next=18;break;case 17:this.hubService.addHubErrorMessage("The hub cache is not loaded.");case 18:e.next=21;break;case 20:this.hubService.addHubErrorMessage("There was no connection specified to edit.");case 21:if("new"===this.action&&((a=new u.f).purpose=+this.params.purpose,this.logger.LogC((function(){return"new connection, purpose ".concat(a.purpose,".")}),Q.b.Trace),this.updateDatabaseTypes(a.purpose),this.formsService.connection(a),this.updateUrl(),this.logger.LogC((function(){return"new connection, form loaded."}),Q.b.Trace)),"copy"!==this.action){e.next=35;break}return n=new u.f,i=+this.params.connectionKey,r=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i})),Object.assign(n,r),n.name+=" (copy)",n.key=null,e.next=29,this.hubService.GetConnectionReference(n);case 29:this.connectionReference=e.sent,this.logger.LogC((function(){return"copy connection, connectionKey ".concat(i,".")}),Q.b.Trace),this.updateDatabaseTypes(n.purpose),this.formsService.connection(n),this.updateUrl(),this.logger.LogC((function(){return"new connection, form loaded."}),Q.b.Trace);case 35:this._purposeSubscription&&this._purposeSubscription.unsubscribe(),this._purposeSubscription=this.formsService.currentForm.controls.purpose.valueChanges.subscribe((function(e){o.updateDatabaseTypes(e)}));case 36:case"end":return e.stop()}}),e,this)})))}},{key:"updateUrl",value:function(){var e=this;this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname,i=n.indexOf("/connection-new");if(i>0){var r=n.substr(0,i)+"/connection-edit/"+a;e.router.navigateByUrl(r)}e._formChangeSubscription.unsubscribe()}}))}},{key:"updateDatabaseTypes",value:function(e){this.connectionTypes=this.remoteLibraries.connections.filter((function(t){return e===u.jb.Source&&t.allowsSourceConnection||e===u.jb.Managed&&t.allowsManagedConnection||e===u.jb.Target&&t.allowsTargetConnection}))}},{key:"selectDatabaseType",value:function(e){return Y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.formsService.currentForm.controls.connectionClassName.setValue(e.connectionClassName),this.formsService.currentForm.controls.connectionAssemblyName.setValue(e.connectionAssemblyName),this.connectionReference.connectionCategory===u.ib.Hub&&(this.formsService.currentForm.controls.server.value||(a=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),this.formsService.currentForm.controls.server.setValue(a)),this.formsService.currentForm.controls.username.value||(n=this.authService.getUser())&&this.formsService.currentForm.controls.username.setValue(n.email));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"connectionStringChanged",value:function(){this.logger.LogC((function(){return"connectionStringChanged."}),Q.b.Trace),this.formsService.currentForm.controls.connectionString.value&&(this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue(""))}},{key:"clearConnectionString",value:function(){this.formsService.currentForm.controls.connectionString.setValue(null),this.formsService.currentForm.controls.connectionStringDisplay.setValue("")}},{key:"revealConnectionString",value:function(){var e=this;this.logger.LogC((function(){return"revealConnectionString."}),Q.b.Trace),this.revealingConnectionString=!0,this.hubService.decrypt(this.formsService.currentForm.controls.connectionString.value,this.cancelToken).then((function(t){e.formsService.currentForm.controls.connectionStringDisplay.setValue(t),e.revealingConnectionString=!1})).catch((function(t){e.hubService.addHubMessage(t),e.revealingConnectionString=!1}))}},{key:"passwordChanged",value:function(){this.logger.LogC((function(){return"passwordChanged."}),Q.b.Trace),this.formsService.currentForm.controls.password.value&&(this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue(""))}},{key:"clearPassword",value:function(){this.formsService.currentForm.controls.password.setValue(null),this.formsService.currentForm.controls.passwordDisplay.setValue("")}},{key:"refreshConnection",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.LogC((function(){return"refreshConnection."}),Q.b.Trace),e.next=3,this.encryptConnection();case 3:this.refreshingConnection=!0,this.hubService.refreshConnection(this.formsService.currentForm.value,this.cancelToken).then((function(e){t.hubService.addHubSuccessMessage("The connection was successful."),t.databases=e,t.refreshingConnection=!1})).catch((function(e){t.hubService.addHubMessage(e),t.refreshingConnection=!1}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"newDatabaseName",value:function(e){this.formsService.currentForm.controls.defaultDatabase.setValue(e)}},{key:"createDatabase",value:function(){var e=this;this.creatingDatabase=!0,this.authService.promptDialog("Create Database","Enter the name for the new database?").then((function(t){return Y(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,this.encryptConnection();case 3:(a=Object.assign({},this.formsService.currentForm.value)).defaultDatabase=t,this.hubService.createDatabase(a,this.cancelToken).then((function(){n.hubService.addHubSuccessMessage("The database was created successfully."),n.databases=[t],n.formsService.currentForm.controls.defaultDatabase.setValue(t),n.creatingDatabase=!1})).catch((function(e){n.hubService.addHubMessage(e),n.creatingDatabase=!1})),e.next=8;break;case 7:this.creatingDatabase=!1;case 8:case"end":return e.stop()}}),e,this)})))})).catch((function(){e.creatingDatabase=!1}))}},{key:"encryptConnection",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.formsService.currentForm,!(a=t.controls.passwordRaw.value)){e.next=6;break}return e.next=4,this.hubService.encrypt(a,this.cancelToken);case 4:n=e.sent,t.controls.password.setValue(n),t.controls.passwordRaw.setValue(null);case 6:if(!(i=t.controls.connectionStringRaw.value)){e.next=12;break}return e.next=10,this.hubService.encrypt(i,this.cancelToken);case 10:r=e.sent,t.controls.connectionString.setValue(r),t.controls.connectionStringRaw.setValue(null);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"save",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.encryptConnection();case 2:return e.next=4,this.formsService.save();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The connection has not been saved","The connection changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"getRoute",value:function(e){this.authService.getRoute(e)}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The connection changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||Pe)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e))},Pe.\u0275cmp=b.Eb({type:Pe,selectors:[["dexih-connection-edit-form"]],hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},features:[b.xb([D.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Connection","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1","buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",3,"busy","click",4,"ngIf"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"ngIf"],[3,"formsService"],["buttonClass","btn btn-success","iconClass","fa fa-thumbs-o-up","title","Test the connection against the source.",1,"mr-1",3,"busy","click"],[1,"mr-1",3,"formsService"],["class","mr-1","iconClass","fa fa-plus",3,"routerLink",4,"ngIf"],["iconClass","fa fa-plus",1,"mr-1",3,"routerLink"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["label","Purpose","formControlName","purpose","placeholder","Connection purpose","iconClass","fa fa-database","itemName","name","itemKey","key",3,"items","enableFilter","errors"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Name","formControlName","name","placeholder","Enter a name for the connection","iconClass","fa fa-database",3,"autocapitalize","errors"],["label","Database Type","itemName","name","itemKey","name","iconClass","fa fa-database",3,"ngModel","ngModelOptions","items","enableKeySelect","sortItems","ngModelChange"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown","errors"],[4,"ngIf"],[3,"data","click"],["type","number","label","Connection Timeout","formControlName","connectionTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will wait to establish a connection.",3,"errors"],["type","number","label","Command Timeout","formControlName","commandTimeout","iconClass","fa fa-clock-o","note","The duration in seconds the remote agent will for a command to start returning a result.",3,"errors"],["label","Use a connection string","formControlName","useConnectionString"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown",4,"ngIf"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for connection string","formControlName","useConnectionStringVariable",3,"click"],["label","Connection String","formControlName","connectionStringDisplay","placeholder","Enter a the connection string","iconClass","fa fa-database",3,"errors","keydown"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],[1,"fa","fa-refresh"],[1,"fa","fa-spin","fa-refresh"],["label","Connection String","formControlName","connectionString","iconClass","fa fa-at","textEntryNote","Enter the variable name surrounded by {}",3,"items","sortItems","enableTextEntry"],["formControlName","server","placeholder","Enter the details.","iconClass","fa fa-server",3,"enableTextEntry","label","errors","items","enableFilter","note"],["class","form-row",4,"ngIf"],["ng-disabled","refreshingConnection || creatingDatabase",4,"ngIf"],["label","Use windows authentication","formControlName","useWindowsAuth"],["label","User Name","formControlName","username","placeholder","Enter user name","iconClass","fa fa-user",3,"enableTextEntry","errors","items","enableFilter"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for password","formControlName","usePasswordVariable",3,"click"],["label","Password","formControlName","passwordDisplay","type","password","placeholder","Enter a password","iconClass","fa fa-lock",3,"errors","keydown"],["label","Password","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown",4,"ngIf"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry",4,"ngIf"],["label","Use a variable for token","formControlName","usePasswordVariable",3,"click"],["label","Secure Token","formControlName","passwordDisplay","type","password","placeholder","Enter secure token","iconClass","fa fa-lock",3,"errors","keydown"],["label","Secure Token","formControlName","password","iconClass","fa fa-at",3,"items","sortItems","enableTextEntry"],["ng-disabled","refreshingConnection || creatingDatabase"],["formControlName","defaultDatabase","iconClass","fa fa-database","textEntryNote","Enter the database name",3,"label","items","defaultItem","sortItems","enableTextEntry","textValueChange"],[1,"fa","fa-edit"],["label","Multi-use Managed Database (table keys will be added to table names to allow multiple hubs to use same database)","formControlName","embedTableKey",3,"errors"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,ue,5,5,"ng-template",null,2,b.Ec),b.Dc(4,Le,14,15,"form",3),b.Nb(),b.Lb(5,"dexih-help",4),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(3),b.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,$.a,K.a,I.a,h.f,E.a,r.f,n.I,n.t,n.l,h.E,n.s,n.j,h.D,n.v,h.H,X.a,h.A],encapsulation:2}),Pe);function Re(e,t){}function je(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-splitdropdown",12),b.Vb("buttonClick",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().importSelected(e)})),b.Ob(1,"a",13),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().newDatalinks(e)})),b.Fc(2,"Import & Create Datalinks"),b.Nb(),b.Nb()}}function _e(e,t){if(1&e){var a=b.Pb();b.Dc(0,je,3,0,"dexih-button-splitdropdown",10),b.Ob(1,"dexih-button-delete",11),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().deleteSelected(e)})),b.Nb()}if(2&e){var n=b.Zb();b.hc("ngIf",n.hubCache.canWrite)}}var Me=function(e){return["table-edit",e]};function Ze(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-edit",15),b.Vb("click",(function(){b.vc(a);var e=b.Zb(2);return e.deleteSelected(e.items)})),b.Nb()}if(2&e){var n=b.Zb().item;b.hc("routerLink",b.mc(1,Me,n.key))}}function He(e,t){1&e&&b.Dc(0,Ze,1,3,"dexih-button-edit",14),2&e&&b.hc("ngIf",t.item.key)}function Be(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-dropdown",16),b.Ob(1,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setTableFilter("All")})),b.Fc(2,"All"),b.Nb(),b.Ob(3,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setTableFilter("Imported")})),b.Fc(4,"Imported"),b.Nb(),b.Ob(5,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setTableFilter("NonImported")})),b.Fc(6,"Non Imported"),b.Nb(),b.Nb(),b.Ob(7,"dexih-button-dropdown",18),b.Ob(8,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setViewFilter("All")})),b.Fc(9,"All"),b.Nb(),b.Ob(10,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setViewFilter("Tables")})),b.Fc(11,"Tables"),b.Nb(),b.Ob(12,"a",17),b.Vb("click",(function(){return b.vc(a),b.Zb().setViewFilter("Views")})),b.Fc(13,"Views"),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("text",n.tableFilter)("pullRight",!0),b.yb(1),b.Cb("active","All"==n.tableFilter),b.yb(2),b.Cb("active","Imported"==n.tableFilter),b.yb(2),b.Cb("active","NonImported"==n.tableFilter),b.yb(2),b.hc("text",n.viewFilter)("pullRight",!0),b.yb(1),b.Cb("active","All"==n.viewFilter),b.yb(2),b.Cb("active","Imported"==n.viewFilter),b.yb(2),b.Cb("active","NonImported"==n.viewFilter)}}var Ue,qe=((Ue=function(){function e(t,a,n,i){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.router=n,this.route=i,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new F.a,this.columns=[{name:"schema",title:"Schema",format:""},{name:"name",title:"Name",format:""},{name:"tableType",title:"Type",enum:u.ic,format:"Enum"},{name:"entityStatus.message",title:"Latest Status"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable(),this.tableFilter="All",this.viewFilter="Tables"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.showPageMessage="Querying source database tables.  Please wait...";try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){return a=e,i=regeneratorRuntime.mark((function e(){var a,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[1],this.hubCache=t[2],n=t[3],this.connectionKey=+a.connectionKey,!this.connectionKey){e.next=15;break}if(e.t0=this.hubCache.isLoaded(),!e.t0){e.next=13;break}return this.connection=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i.connectionKey})),e.next=10,this.hubService.GetConnectionReference(this.connection);case 10:this.connectionReference=e.sent,this.showPage=!1,n?this.connection?this.getTables(this.connection):(this.hubService.addHubErrorMessage("The connection could not be found."),this.close()):this.showPageMessage="Waiting for an active remote agent...";case 13:e.next=16;break;case 15:this.hubService.addHubErrorMessage("There was no connection specified to import tables."),this.close();case 16:case"end":return e.stop()}}),e,this)})),new((n=void 0)||(n=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(a){t(a)}}function o(e){try{c(i.throw(e))}catch(a){t(a)}}function c(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}c((i=i.apply(a,[])).next())}));var a,n,i}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Import")}this.watchChanges()}},{key:"setTableFilter",value:function(e){this.tableFilter=e,this.updateFilter()}},{key:"setViewFilter",value:function(e){this.viewFilter=e,this.updateFilter()}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"updateFilter",value:function(){var e;switch(this.tableFilter){case"Imported":e=this.tables.filter((function(e){return e.key>0}));break;case"NonImported":e=this.tables.filter((function(e){return 0===e.key||!e.key}));break;default:e=this.tables}switch(this.viewFilter){case"Views":e=e.filter((function(e){return e.tableType===u.ic.View}));break;case"Tables":e=e.filter((function(e){return e.tableType===u.ic.Table}))}this._tableData.next(e)}},{key:"getTables",value:function(e){var t=this;this.showPage=!1,this.showPageMessage="Importing tables from remote database...",this.hubService.getDatabaseTableNames(e,this.cancelToken).then((function(a){t.tables=a;for(var n=t.hubCache.hub.dexihTables.filter((function(t){return t.connectionKey===e.key})),i=function(i){var r=null,o=a[i];n&&!(r=n.find((function(e){return e.name===o.name&&e.schema===o.schema})))&&t.connectionReference&&t.connectionReference.defaultSchema===o.schema&&(r=n.find((function(e){return e.name===o.name&&!e.schema}))),r?t.tables[i]=r:(o.connectionKey=e.key,o.tableType=o.tableType,o.entityStatus=new T.c)},r=0;r<a.length;r++)i(r);t.showPage=!0,t.showPageMessage="",t.updateFilter()})).catch((function(e){t.hubService.addHubMessage(e)}))}},{key:"import",value:function(e){var t=this;this.hubService.importTables([e],!0,this.cancelToken).then((function(e){t.mergeTables(e)})).catch((function(t){e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=u.hc.Error,e.entityStatus.message=t.message}))}},{key:"deleteTable",value:function(e){this.hubService.deleteTables([e]).then((function(t){e.entityStatus.isBusy=!1})).catch((function(t){e.entityStatus.isBusy=!1,e.entityStatus.lastStatus=u.hc.Error,e.entityStatus.message=t.message}))}},{key:"importSelected",value:function(e){var t=this,a=e.filter((function(e){return!e.entityStatus.isBusy}));a.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.importTables(a,!0,this.cancelToken).then((function(e){t.mergeTables(e)})).catch((function(e){a.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"mergeTables",value:function(e){var t=this;e&&(e.forEach((function(e){var a=t.tables.findIndex((function(t){return t.name===e.name&&t.schema===e.schema}));a>=0&&(t.tables[a]=e)})),this.updateFilter())}},{key:"deleteSelected",value:function(e){var t=e.filter((function(e){return!e.entityStatus.isBusy&&e.key>0}));0===t.length&&this.authService.informationDialog("Can not delete","None of the selected tables can be deleted, as they are either busy, or have not been imported."),t.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.deleteTables(t).then((function(e){t.forEach((function(e){return e.entityStatus.isBusy=!1}))})).catch((function(e){t.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"editTable",value:function(e){e&&e.key&&this.router.navigate(["table-edit",e.key],{relativeTo:this.route.parent})}},{key:"newDatalinks",value:function(e){var t=this,a=e.filter((function(e){return!e.entityStatus.isBusy}));a.forEach((function(e){return e.entityStatus.isBusy=!0})),this.hubService.importTables(a,!0,this.cancelToken).then((function(e){t.mergeTables(e);var a=e.map((function(e){return e.key})).join("|");t.router.navigate(["datalink-new",a,0],{relativeTo:t.route.parent})})).catch((function(e){a.forEach((function(e){return e.entityStatus.isBusy=!1}))}))}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){if(t.changeClass===u.dc.Table){if(t.changeType===u.Eb.Replace||t.changeType===u.Eb.New){var a=t.data;if(a.connectionKey===e.connectionKey){var n=e.tables.findIndex((function(e){return e.name===a.name&&e.schema===a.schema}));n>=0&&(e.tables[n]=a,e.updateFilter())}}if(t.changeType===u.Eb.Delete){var i=t.data;if(i.connectionKey===e.connectionKey){var r=e.tables.find((function(e){return e.key===i.key}));r&&(r.key=null,r.entityStatus.isBusy=!1,r.updateDate=null,r.createDate=null,e.updateFilter())}}}}))}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Ue)(b.Kb(c.a),b.Kb(o.a),b.Kb(r.e),b.Kb(r.a))},Ue.\u0275cmp=b.Eb({type:Ue,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:11,vars:10,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-database",3,"title","showIf","loadingMessage","showCloseButton","padding","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["select","filter"],["filter",""],["class","mr-1","text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",3,"buttonClick",4,"ngIf"],["title","Delete selected tables",3,"click"],["text","Import","buttonClass","btn btn-success","iconClass","fa fa-cloud-download","title","Import selected tables",1,"mr-1",3,"buttonClick"],["title","Import tables and create default staging datalinks",1,"dropdown-item",3,"click"],["class","mr-1","queryParamsHandling","","preserveFragment","","title","Edit this table",3,"routerLink","click",4,"ngIf"],["queryParamsHandling","","preserveFragment","","title","Edit this table",1,"mr-1",3,"routerLink","click"],["buttonClass","btn-primary","iconClass","fa fa-download","title","Filter by import status",1,"mr-1",3,"text","pullRight"],[1,"dropdown-item",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-table","title","Filter by tables/views",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,Re,0,0,"ng-template",null,2,b.Ec),b.Ob(4,"dexih-table",3),b.Vb("rowClick",(function(e){return t.editTable(e)})),b.Dc(5,_e,2,1,"ng-template",4,5,b.Ec),b.Dc(7,He,1,1,"ng-template",6,7,b.Ec),b.Dc(9,Be,14,16,"ng-template",8,9,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("title","Import Tables for "+(null==t.connection?null:t.connection.name))("showIf",t.showPage)("loadingMessage",t.showPageMessage)("showCloseButton",!0)("padding",!1),b.yb(3),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,v.t,h.g,h.w,h.j,r.f,h.i],encapsulation:2}),Ue),ze=a("Ifnz"),We=a("965U");function Ge(e,t){1&e&&b.Lb(0,"actions-connection-button",9),2&e&&b.hc("connections",t.items)}function Qe(e,t){if(1&e&&b.Lb(0,"tags-update-button",10),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.Connection)("objects",a)}}var $e=function(e){return{purposeFilter:e}};function Xe(e,t){if(1&e&&(b.Ob(0,"a",14),b.Fc(1),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(2);b.Cb("active",n.purposeFilter==a.key),b.hc("queryParams",b.mc(5,$e,a.key))("title",a.name),b.yb(1),b.Gc(a.name)}}var Ye=function(){return{purposeFilter:"All"}};function Je(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",11),b.Ob(1,"a",12),b.Fc(2,"All"),b.Nb(),b.Dc(3,Xe,2,7,"a",13),b.ac(4,"gtFilter"),b.Nb()),2&e){var a=b.Zb();b.hc("autoCompact",!1)("text",a.eConnectionPurpose[a.purposeFilter])("pullRight",!0),b.yb(1),b.Cb("active","All"==a.purposeFilter),b.hc("queryParams",b.lc(11,Ye)),b.yb(2),b.hc("ngForOf",b.dc(4,7,a.eConnectionPurposeItems,"key",0))}}var et,tt=((et=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eConnectionPurpose=u.jb,this.eConnectionPurposeItems=u.kb,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{name:"purpose",title:"Purpose",format:""},{name:"type",title:"Type",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.purposeFilter=+a.purposeFilter,e.purposeFilter||(e.purposeFilter=0),e.pageTitle=u.jb[e.purposeFilter]+" Connections",e.updateConnections()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Connection Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteConnection",value:function(e){this.hubService.deleteConnections([e]).catch((function(e){}))}},{key:"deleteConnections",value:function(e){this.hubService.deleteConnections(e)}},{key:"editConnection",value:function(e){this.router.navigate(["connection-edit",e.key],{relativeTo:this.route})}},{key:"updateConnections",value:function(){var e,t,a,n,i;return a=this,i=regeneratorRuntime.mark((function a(){var n,i,r,o,c,s,l=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.hubCache||!this.hubCache.isLoaded()){a.next=34;break}n=0!==this.purposeFilter&&this.purposeFilter?this.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===l.purposeFilter})):this.hubCache.hub.dexihConnections,i=[],a.prev=3,o=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(n);case 5:return a.next=7,o.next();case 7:if((r=a.sent).done){a.next=15;break}return c=r.value,a.next=11,this.hubService.GetConnectionReference(c);case 11:s=a.sent,i.push({key:c.key,connectionAssemblyName:c.connectionAssemblyName,connectionClassName:c.connectionClassName,purpose:u.jb[c.purpose],type:s?s.name:"Unknown ("+c.connectionClassName+")",name:c.name,tags:this.hubCache.getObjectTags(u.dc.Connection,c.key),description:c.description,updateDate:c.updateDate});case 13:a.next=5;break;case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(3),e={error:a.t0};case 20:if(a.prev=20,a.prev=21,a.t1=r&&!r.done&&(t=o.return),!a.t1){a.next=26;break}return a.next=26,t.call(o);case 26:if(a.prev=26,!e){a.next=29;break}throw e.error;case 29:return a.finish(26);case 30:return a.finish(20);case 31:this._tableData.next(i),a.next=35;break;case 34:this._tableData.next(null);case 35:case"end":return a.stop()}}),a,this,[[3,17,20,31],[21,,26,30]])})),new((n=void 0)||(n=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(a){t(a)}}function o(e){try{c(i.throw(e))}catch(a){t(a)}}function c(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}c((i=i.apply(a,[])).next())}))}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddConnection(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Connection - "+e[0].name+".json":"connections.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Connection&&t.changeClass!==u.dc.TagObjects||e.updateConnections()}))}}]),e}()).\u0275fac=function(e){return new(e||et)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},et.\u0275cmp=b.Eb({type:et,selectors:[["connections"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Connections","iconClass","fa fa-lg fa-fw fa-database",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],["title","Connections","path","/assets/help/reference/connection.md",1,"m-3"],[3,"connections"],[1,"ml-1",3,"objectType","objects"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.editConnection(e)})),b.Dc(3,Ge,1,1,"ng-template",null,3,b.Ec),b.Dc(5,Qe,1,2,"ng-template",4,5,b.Ec),b.Dc(7,Je,5,12,"ng-template",6,7,b.Ec),b.Nb(),b.Nb(),b.Lb(9,"dexih-help",8),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,ze.a,p.a,h.i,r.h,v.s],pipes:[We.a],encapsulation:2}),et),at=a("obiC"),nt=["fileInput"];function it(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section",9),b.Ob(1,"form-select",16),b.Vb("ngModelChange",(function(e){return b.vc(a),t.$implicit.action=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit,i=b.Zb(2);b.yb(1),b.jc("label","",i.eSharedObjectType[n.objectType]," Action"),b.jc("note","Action when importing ",i.eSharedObjectType[n.objectType],""),b.hc("ngModel",n.action)("items",i.importActions)}}function rt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-widget",3),b.Vb("close",(function(){return b.vc(a),b.Zb().close()})),b.Ob(1,"ul",4),b.Ob(2,"li",5),b.Ob(3,"h5"),b.Fc(4,"Drop Export Files"),b.Nb(),b.Nb(),b.Ob(5,"li",6),b.Ob(6,"div",7),b.Vb("dropFiles",(function(e){return b.vc(a),b.Zb().filesDrop(e)})),b.Ob(7,"div",8),b.Ob(8,"section",9),b.Fc(9," Drop import files "),b.Nb(),b.Ob(10,"section",9),b.Ob(11,"div",10),b.Ob(12,"input",11,12),b.Vb("change",(function(e){return b.vc(a),b.Zb().uploadFile(e)})),b.Nb(),b.Ob(14,"label",13),b.Fc(15,"Choose file"),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(16,"li",14),b.Ob(17,"h5"),b.Fc(18,"Import Options"),b.Nb(),b.Nb(),b.Ob(19,"li",6),b.Ob(20,"fieldset"),b.Ob(21,"div",8),b.Dc(22,it,2,4,"section",15),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("showCloseButton",!0),b.yb(6),b.hc("requireFiles",!0),b.yb(16),b.hc("ngForOf",n.importOptions)}}function ot(e,t){if(1&e&&(b.Ob(0,"ul",25),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.yb(1),b.Hc(" Warning: ",a," ")}}function ct(e,t){if(1&e&&(b.Ob(0,"div",23),b.Dc(1,ot,2,1,"ul",24),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("ngForOf",a.import.warnings)}}function st(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",26),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(2).importSelected(e)})),b.Nb()}}function lt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",27),b.Vb("click",(function(){return b.vc(a),b.Zb(2).importAll()})),b.Nb(),b.Ob(1,"dexih-button-close",28),b.Vb("click",(function(){return b.vc(a),b.Zb(2).reset()})),b.Nb()}}function ut(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-widget",17),b.Vb("close",(function(){return b.vc(a),b.Zb().reset()})),b.Dc(1,ct,2,1,"div",18),b.Ob(2,"dexih-table",19),b.Dc(3,st,1,0,"ng-template",20,21,b.Ec),b.Dc(5,lt,2,0,"ng-template",null,22,b.Ec),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("showCloseButton",!0),b.yb(1),b.hc("ngIf",(null==n.import||null==n.import.warnings?null:n.import.warnings.length)>0),b.yb(1),b.hc("enableMultiSelect",!0)("columns",n.columns)("dataObservable",n.tableData)}}var bt,ht=((bt=function(){function e(t,a,n){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.hubFormsService=n,this.automaticUpload=!0,this.pageTitle="Import Objects",this.showPage=!1,this.showPageMessage="Loading...",this.importActions=T.o,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",format:"Md",description:"description"},{name:"objectType",title:"Type",format:""},{name:"importAction",title:"Action",format:"Enum",enum:u.Eb}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.importOptions=T.u.map((function(e){return{action:u.Eb.Replace,objectType:e.type}})),this._hubCacheChangeSubscription=this.hubService.getHubCacheObservable().subscribe((function(t){e.hubCache=t}))}},{key:"ngOnDestroy",value:function(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"doImport",value:function(e){var t=this,a=new FormData;a.append("file",e,e.name),a.append("hubKey",this.hubCache.hub.hubKey.toString());for(var n=0;n<this.importOptions.length;n++)a.append("ImportActions[".concat(n,"].Action"),this.importOptions[n].action.toString()),a.append("ImportActions[".concat(n,"].ObjectType"),this.importOptions[n].objectType.toString());this.authService.postForm("/api/Hub/ImportPlan",a).then((function(e){t.import=e,t.refreshImport()}))}},{key:"uploadFile",value:function(e){this.doImport(e.srcElement.files[0])}},{key:"filesDrop",value:function(e){this.doImport(e[0])}},{key:"refreshImport",value:function(){var e=this,t=[];T.u.forEach((function(a){e.import[a.property].forEach((function(e){t.push({objectType:a.property,name:e.item.name,importAction:e.importAction,item:e})}))})),this._tableData.next(t)}},{key:"reset",value:function(){this._tableData.next(null)}},{key:"importSelected",value:function(e){var t=this,a=new u.P;e.forEach((function(e){a[e.objectType]||(a[e.objectType]=[]),a[e.objectType].push(e.item)})),this.hubService.importPackage(a).then((function(){t.authService.navigateUp()}))}},{key:"importAll",value:function(){var e=this;this.hubService.importPackage(this.import).then((function(){e.authService.navigateUp()}))}}]),e}()).\u0275fac=function(e){return new(e||bt)(b.Kb(c.a),b.Kb(o.a),b.Kb(D.a))},bt.\u0275cmp=b.Eb({type:bt,selectors:[["import"]],viewQuery:function(e,t){var a;1&e&&b.Bc(nt,!0),2&e&&b.rc(a=b.Wb())&&(t.fileInput=a.first)},features:[b.xb([D.a])],decls:5,vars:6,consts:[[1,"container"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close",4,"ngIf"],["title","Import Objects","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],[1,"list-group"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"form-row"],[1,"form-group","col-md-6"],[1,"custom-file","w-auto","pull-right"],["type","file",1,"custom-file-input",3,"change"],["fileInput",""],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","list-group-item-info"],["class","form-group col-md-6",4,"ngFor","ngForOf"],["itemKey","key","itemName","name",3,"label","ngModel","items","note","ngModelChange"],["title","Import Package","iconClass","fa fa-lg fa-fw fa-level-down",3,"showCloseButton","close"],["class","alert alert-warning",4,"ngIf"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],[1,"alert","alert-warning"],["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],["iconClass","fa fa-upload","buttonClass","btn-primary","text","Import Selected",1,"ml-1",3,"click"],["iconClass","fa fa-cloud-upload","buttonClass","btn-primary","text","Import All",3,"click"],[1,"ml-1",3,"click"]],template:function(e,t){if(1&e&&(b.Ob(0,"div",0),b.Dc(1,rt,23,3,"dexih-widget",1),b.ac(2,"async"),b.Dc(3,ut,7,5,"dexih-widget",2),b.ac(4,"async"),b.Nb()),2&e){var a,n,i=!(null!=(a=b.bc(2,2,t.tableData))&&a.length),r=(null==(n=b.bc(4,4,t.tableData))?null:n.length)>0;b.yb(1),b.hc("ngIf",i),b.yb(2),b.hc("ngIf",r)}},directives:[v.t,h.P,at.a,v.s,h.E,n.s,n.v,d.a,h.f,h.d],pipes:[v.b],encapsulation:2}),bt);function dt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",8),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb()}}function ft(e,t){}function mt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",9),b.Vb("click",(function(){return b.vc(a),b.Zb().exportAll()})),b.Nb()}}var vt,pt=((vt=function(){function e(t,a){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"label",title:"Item Type"},{name:"updateDate",title:"Last Modified",format:"Calendar"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){if(e.hubCache=t[0],e.hubCache.isLoaded()){var a=e.hubCache.getSharedObjects();e.data=a}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"exportAll",value:function(){this.export(this.data)}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddObject(e.type,e.item,a)})),this.hubService.exportHub(a,1===e.length?"".concat(e[0].label,"-").concat(e[0].type,".json"):"hub-".concat(this.hubCache.hub.name,".json"))}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||vt)(b.Kb(o.a),b.Kb(c.a))},vt.\u0275cmp=b.Eb({type:vt,selectors:[["export"]],inputs:{hubKey:"hubKey"},decls:9,vars:7,consts:[[1,"container-fluid"],["title","Export","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","data","tags"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["text","Export Selected",1,"mr-1",3,"click"],["text","Export All",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Dc(3,dt,1,0,"ng-template",3,4,b.Ec),b.Dc(5,ft,0,0,"ng-template",5,6,b.Ec),b.Dc(7,mt,1,0,"ng-template",null,7,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("data",t.data)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.u],encapsulation:2}),vt),gt=a("Npcx"),yt=a("mL+N");function Ct(e,t){if(1&e&&b.Lb(0,"dependent-items-button",11),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.Datajob)}}function kt(e,t){if(1&e&&b.Lb(0,"datalink-status",12),2&e){var a=t.item;b.hc("datajobKey",null==a?null:a.key)}}function wt(e,t){if(1&e&&b.Lb(0,"tags-update-button",13),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.Datajob)("objects",a)}}function St(e,t){1&e&&b.Lb(0,"actions-datajob-button",14),2&e&&b.hc("datajobs",t.items)}var Ot,Nt=((Ot=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateDatajobs()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datajob Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateDatajobs",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDatajobs.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(u.dc.Datajob,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editDatajob",value:function(e){this.router.navigate(["datajob-edit",e.key],{relativeTo:this.route})}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Datajob&&t.changeClass!==u.dc.TagObjects||e.updateDatajobs()}))}}]),e}()).\u0275fac=function(e){return new(e||Ot)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Ot.\u0275cmp=b.Eb({type:Ot,selectors:[["datajobs"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Data Jobs","iconClass","fa fa-lg fa-fw fa-calendar",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Datalinks","path","/assets/help/reference/datajob.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[3,"datajobKey"],[1,"ml-1",3,"objectType","objects"],[3,"datajobs"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.editDatajob(e)})),b.Dc(3,Ct,1,2,"ng-template",3,4,b.Ec),b.Dc(5,kt,1,1,"ng-template",5,6,b.Ec),b.Dc(7,wt,1,2,"ng-template",7,8,b.Ec),b.Dc(9,St,1,1,"ng-template",null,9,b.Ec),b.Nb(),b.Nb(),b.Lb(11,"dexih-help",10),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,gt.a,p.a,yt.a],encapsulation:2}),Ot),Tt=a("A4o/");function Dt(e,t){1&e&&b.Lb(0,"actions-datalink-button",13),2&e&&b.hc("datalinks",t.items)}var xt=function(e){return{typeFilter:e}};function Ft(e,t){if(1&e&&(b.Ob(0,"a",17),b.Fc(1),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(2);b.Cb("active",n.typeFilter==a.key),b.hc("queryParams",b.mc(5,xt,a.key))("title",a.name),b.yb(1),b.Gc(a.name)}}var It=function(){return{typeFilter:"All"}};function Kt(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",14),b.Ob(1,"a",15),b.Fc(2,"All"),b.Nb(),b.Dc(3,Ft,2,7,"a",16),b.ac(4,"gtFilter"),b.Nb()),2&e){var a=b.Zb();b.hc("autoCompact",!1)("text",a.eDatalinkType[a.typeFilter])("pullRight",!0),b.yb(1),b.Cb("active","All"==a.typeFilter),b.hc("queryParams",b.lc(11,It)),b.yb(2),b.hc("ngForOf",b.dc(4,7,a.eDatalinkTypeItems,"key",0))}}function Et(e,t){if(1&e&&b.Lb(0,"tags-update-button",18),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.Datalink)("objects",a)}}function Vt(e,t){if(1&e&&b.Lb(0,"datalink-status",19),2&e){var a=t.item;b.hc("datalinkKey",null==a?null:a.key)}}function Lt(e,t){if(1&e&&b.Lb(0,"dependent-items-button",20),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.Datalink)}}var Pt,At=((Pt=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.eDatalinkType=u.nb,this.eDatalinkTypeItems=u.ob,this.columns=[{name:"name",title:"Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"datalinkType",title:"Datalink Type",format:""},{name:"sourceName",title:"Source",format:""},{name:"targetName",title:"Target",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.hubCache.isLoaded()&&(e.typeFilter=+a.typeFilter,e.typeFilter||(e.typeFilter=0),e.updateDatalinks())}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateDatalinks",value:function(){var e,t=this;if(this.hubCache.isLoaded())if(this.hubCache.hub.dexihDatalinks){e=0!==this.typeFilter&&this.typeFilter?this.hubCache.hub.dexihDatalinks.filter((function(e){return e.datalinkType===t.typeFilter})):this.hubCache.hub.dexihDatalinks;var a=new Array;e.forEach((function(e){var n,i="";switch(e.sourceDatalinkTable.sourceType){case u.gc.Table:var r=t.hubCache.getTable(e.sourceDatalinkTable.sourceTableKey);i=r?r.logicalName:"Error, not found";break;case u.gc.Datalink:var o=t.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e.sourceDatalinkTable.sourceDatalinkKey}));i=o?"Datalink: "+o.name:"Error, not found";break;case u.gc.Rows:i="Static Rows"}n=e.isQuery?"None specified.":e.dexihDatalinkTargets.filter((function(e){return e.isValid})).map((function(e){var a=t.hubCache.getTable(e.tableKey);return a&&a.logicalName||"Error, not found"})).join(", "),a.push({key:e.key,datalinkType:t.eDatalinkType[e.datalinkType],name:e.name,tags:t.hubCache.getObjectTags(u.dc.Datalink,e.key),description:e.description,sourceName:i,targetName:n,updateDate:e.updateDate,sharedIcon:e.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:e.isShared?"Table is shared":"Table is private"})})),this._tableData.next(a)}else this._tableData.next(new Array)}},{key:"editDatalink",value:function(e){this.router.navigate(["datalink-edit","edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Datalink&&t.changeClass!==u.dc.TagObjects||e.updateDatalinks()}))}}]),e}()).\u0275fac=function(e){return new(e||Pt)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Pt.\u0275cmp=b.Eb({type:Pt,selectors:[["datalink-index"]],decls:14,vars:7,consts:[[1,"container-fluid"],["title","Datalinks","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],["tableClass","table table-striped table-hover m-0",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["actions",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/datalink.md",1,"m-3"],[3,"datalinks"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Datalinks",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkKey"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.editDatalink(e)})),b.Dc(3,Dt,1,1,"ng-template",null,3,b.Ec),b.Dc(5,Kt,5,12,"ng-template",4,5,b.Ec),b.Dc(7,Et,1,2,"ng-template",6,7,b.Ec),b.Dc(9,Vt,1,1,"ng-template",8,9,b.Ec),b.Dc(11,Lt,1,2,"ng-template",10,11,b.Ec),b.Nb(),b.Nb(),b.Lb(13,"dexih-help",12),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,Tt.a,h.i,r.h,v.s,p.a,gt.a,m.a],pipes:[We.a],encapsulation:2}),Pt),Rt=a("1mVc");function jt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save",6),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return!e.savingDatalink&&e.saveDatalink()})),b.Nb(),b.Ob(1,"dexih-button-cancel",7),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return!e.savingDatalink&&e.cancel()})),b.Nb()}if(2&e){var n=b.Zb();b.hc("busy",n.savingDatalink),b.yb(1),b.hc("busy",n.savingDatalink)}}function _t(e,t){if(1&e&&(b.Ob(0,"span",11),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.yb(1),b.Hc(" ",a.name," ")}}function Mt(e,t){if(1&e&&(b.Ob(0,"label",8),b.Fc(1,"Create datalinks for the following source table(s):"),b.Nb(),b.Ob(2,"div"),b.Ob(3,"div",9),b.Dc(4,_t,2,1,"span",10),b.ac(5,"fieldSort"),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.yb(4),b.hc("ngForOf",b.cc(5,1,a.sourceTables,"name"))}}function Zt(e,t){if(1&e&&b.Lb(0,"form-input",20),2&e){var a=b.Zb(2);b.hc("autocapitalize",!0)("errors",a.formErrors.name)}}function Ht(e,t){1&e&&b.Lb(0,"form-input",21)}function Bt(e,t){if(1&e&&(b.Ob(0,"form",12),b.Ob(1,"fieldset"),b.Ob(2,"div",13),b.Ob(3,"section",14),b.Dc(4,Zt,1,2,"form-input",15),b.Dc(5,Ht,1,0,"form-input",16),b.Nb(),b.Ob(6,"section",14),b.Lb(7,"form-select",17),b.Nb(),b.Nb(),b.Ob(8,"div",13),b.Ob(9,"section",14),b.Lb(10,"form-select",18),b.Nb(),b.Ob(11,"section",14),b.Lb(12,"form-select",19),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.mainForm),b.yb(4),b.hc("ngIf",1==a.sourceTables.length),b.yb(1),b.hc("ngIf",a.sourceTables.length>1),b.yb(2),b.hc("items",a.eDatalinkTypeItems)("errors",a.formErrors.datalinkType),b.yb(3),b.hc("items",a.managedConnections)("errors",a.formErrors.targetConnectionKey)("allowNullSelect",!0),b.yb(2),b.hc("items",a.managedConnections)("errors",a.formErrors.auditConnectionKey)("allowNullSelect",!0)}}var Ut=function(){return{standalone:!0}};function qt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section",14),b.Ob(1,"form-checkbox",26),b.Vb("ngModelChange",(function(e){return b.vc(a),t.$implicit.value=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit;b.yb(1),b.hc("label",n.name)("ngModel",n.value)("ngModelOptions",b.lc(3,Ut))}}function zt(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form"),b.Ob(1,"fieldset"),b.Ob(2,"section"),b.Ob(3,"div",13),b.Ob(4,"section",22),b.Lb(5,"form-checkbox",23),b.Nb(),b.Nb(),b.Ob(6,"div",13),b.Ob(7,"section",22),b.Ob(8,"label",8),b.Fc(9," Specify the audit columns (in addition to source columns) to be included in the target table. "),b.Nb(),b.Ob(10,"form-checkbox",24),b.Vb("ngModelChange",(function(){return b.vc(a),b.Zb().selectAllAuditColumns()})),b.Nb(),b.Nb(),b.Nb(),b.Ob(11,"div",13),b.Dc(12,qt,2,4,"section",25),b.Nb(),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.yb(5),b.hc("ngModel",n.addSourceColumns),b.yb(5),b.hc("ngModel",n.allAuditColumns),b.yb(2),b.hc("ngForOf",n.auditColumnTypes)}}var Wt,Gt,Qt=((Wt=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.route=a,this.router=n,this.location=i,this.fb=r,this.hasChanged=!1,this.showAllErrors=!1,this.addSourceColumns=!0,this.eConnectionPurpose=u.jb,this.auditColumnTypes=[{key:u.qb.AutoIncrement,name:"Auto Incrementing Key",value:!1},{key:u.qb.IsCurrentField,name:"Is Current Flag",value:!1},{key:u.qb.Version,name:"Record Version",value:!1},{key:u.qb.ValidFromDate,name:"Valid From Date",value:!1},{key:u.qb.ValidToDate,name:"Valid To Date",value:!1},{key:u.qb.CreateDate,name:"Created Date",value:!1},{key:u.qb.UpdateDate,name:"Updated Date",value:!1},{key:u.qb.CreateAuditKey,name:"Created by AuditKey Reference",value:!1},{key:u.qb.UpdateAuditKey,name:"Updated by AuditKey Reference",value:!1}],this.allAuditColumns=!1,this.eDatalinkTypeItems=u.ob,this.savingDatalink=!1,this.formErrors={name:"",targetConnectionKey:"",auditConnectionKey:"",datalinkType:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},targetConnectionKey:{},auditConnectionKey:{},datalinkType:{required:"Datalink Type is required."}}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.managedTargetConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===u.jb.Managed||e.purpose===u.jb.Target})),e.managedConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===u.jb.Managed})),e.tableKeys=a.sourceTableKeys.split("|").map((function(e){return+e})),e.hubCache.status===T.j.Loaded){if(e.updateTables(),e.targetConnectionKey=+a.targetConnectionKey,!e.targetConnectionKey){var n=e.hubCache.hub.dexihConnections.find((function(e){return e.purpose===u.jb.Managed}));n&&(e.targetConnectionKey=n.key)}e.auditConnectionKey=e.targetConnectionKey,e.datalinkType=u.nb.General,e.buildForm(),e.watchChanges()}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink New")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"updateTables",value:function(){var e=this;this.sourceTableKeys=new Array,this.sourceTables=new Array,this.tableKeys&&this.hubCache.hub.dexihConnections&&this.hubCache.hub.dexihTables.forEach((function(t){e.tableKeys.findIndex((function(e){return e===t.key}))>=0&&(e.sourceTableKeys.push(t.key),e.sourceTables.push(t))}))}},{key:"buildForm",value:function(){var e=this;this.mainForm=this.fb.group({name:[this.name,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],datalinkType:[this.datalinkType,[n.G.required]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe((function(t){return e.onValueChanged()})),this.onValueChanged(),this.hasChanged=!1}},{key:"onValueChanged",value:function(){if(this.mainForm){var e=this.mainForm;this.hasChanged=!0;for(var t=0,a=Object.keys(this.formErrors);t<a.length;t++){var n=a[t];this.formErrors[n]="";var i=e.get(n);if(i&&(i.dirty||this.showAllErrors)&&!i.valid)for(var r=this.validationMessages[n],o=0,c=Object.keys(i.errors);o<c.length;o++){var s=c[o];this.formErrors[n]+=r[s]+" "}}}}},{key:"selectAllAuditColumns",value:function(){var e=this;this.allAuditColumns=!this.allAuditColumns,this.auditColumnTypes.forEach((function(t){return t.value=e.allAuditColumns}))}},{key:"saveDatalink",value:function(){var e=this;if(this.mainForm.valid){var t=this.mainForm.value;this.savingDatalink=!0;var a=this.auditColumnTypes.filter((function(e){return e.value})).map((function(e){return e.key}));this.hubService.createDatalinks(this.sourceTableKeys,t.name,t.datalinkType,t.targetConnectionKey,null,null,t.auditConnectionKey,this.addSourceColumns,a).then((function(t){e.savingDatalink=!1,1===t.length?e.openDatalink(t[0].key):e.router.navigate(["/hub",e.hubCache.hub.hubKey,"datalinks"],{relativeTo:e.route.root})})).catch((function(){e.savingDatalink=!1}))}else this.showAllErrors=!0,this.onValueChanged()}},{key:"cancel",value:function(){this.location.back()}},{key:"openDatalink",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a>=10&&this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinks"],{relativeTo:this.route.root}),setTimeout((function(){t.hubCache.hub.dexihDatalinks.findIndex((function(t){return t.key===e}))>=0?t.router.navigate(["/hub",t.hubCache.hub.hubKey,"datalinks","datalink-edit","edit",e],{relativeTo:t.route.root}):t.openDatalink(e,a++)}),500)}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===u.dc.Table&&e.updateTables()}))}}]),e}()).\u0275fac=function(e){return new(e||Wt)(b.Kb(o.a),b.Kb(r.a),b.Kb(r.e),b.Kb(v.n),b.Kb(n.g))},Wt.\u0275cmp=b.Eb({type:Wt,selectors:[["dexih-datalink-new-form"]],decls:8,vars:4,consts:[[1,"container"],["title","New Datalink(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors",4,"ngIf"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment",4,"ngIf"],["formControlName","datalinkType","label","Type","itemKey","key","itemName","description",3,"items","errors"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for the target table.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],["formControlName","auditConnectionKey","label","Audit Connection","itemKey","key","itemName","name","note","Specify the connection to store execution results.","selectNullMessage","No datalink auditing",3,"items","errors","allowNullSelect"],["label","Datalink Name","formControlName","name","placeholder","Datalink name (leave blank for auto naming)","iconClass","fa fa-comment",3,"autocapitalize","errors"],["disabled","","label","Datalink Name","placeholder","Datalink name can not be specified when creating multiple datalinks.","iconClass","fa fa-comment"],[1,"col","col-11"],["label","Include source columns in target table","name","addSourceColumns",3,"ngModel"],["label","Select All/None","name","selectAllAuditColumns",3,"ngModel","ngModelChange"],["class","form-group col-md-6",4,"ngFor","ngForOf"],[3,"label","ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return!t.savingDatalink&&t.cancel()})),b.Dc(2,jt,2,2,"ng-template",null,2,b.Ec),b.Dc(4,Mt,6,4,"ng-template",null,3,b.Ec),b.Dc(6,Bt,13,11,"form",4),b.Dc(7,zt,13,3,"form",5),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(5),b.hc("ngIf",t.sourceTableKeys),b.yb(1),b.hc("ngIf",t.sourceTableKeys))},directives:[h.P,v.t,h.t,h.b,v.s,n.I,n.t,n.l,h.E,n.s,n.j,h.D,n.u,h.A,n.v],pipes:[Rt.a],encapsulation:2}),Wt),$t=a("NHAS"),Xt=((Gt=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.eDataObjectType=u.lb}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params).subscribe((function(t){var a=t[0],n=t[1];e.action=a.action,e.pageTitle=a.pageTitle,e.key=+n.datalinkKey,e.previewUpdates="true"===n.previewUpdates}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Preview")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Gt)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.a))},Gt.\u0275cmp=b.Eb({type:Gt,selectors:[["datalink-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["title","Preview Datalink","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","close"],[3,"key","previewUpdates","viewSource"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Lb(2,"preview-data",2),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("key",t.key)("previewUpdates",t.previewUpdates)("viewSource",t.eDataObjectType.Datalink))},directives:[h.P,$t.a],encapsulation:2}),Gt),Yt=a("NUI7");function Jt(e,t){if(1&e&&(b.Ob(0,"dexih-button",5),b.Fc(1),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(2);b.kc("routerLink","/hub/",null==n.hubCache?null:n.hubCache.hub.hubKey,"/connections/tables/table-new/",a.key,""),b.hc("autoCompact",!1),b.yb(1),b.Hc("New Table (",a.name,")")}}function ea(e,t){if(1&e&&(b.Ob(0,"div",2),b.Fc(1," There are no files configured. Create a file based connection, and add at least one file definition. "),b.Lb(2,"hr"),b.Ob(3,"div"),b.Lb(4,"dexih-button-new",3),b.Dc(5,Jt,2,4,"dexih-button",4),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.yb(4),b.jc("routerLink","/hub/",null==a.hubCache?null:a.hubCache.hub.hubKey,"/connections/connection-new/Source"),b.hc("autoCompact",!1),b.yb(1),b.hc("ngForOf",a.fileConnections)}}function ta(e,t){if(1&e&&(b.Ob(0,"a",13),b.Fc(1),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(3);b.kc("routerLink","/hub/",null==n.hubCache?null:n.hubCache.hub.hubKey,"/connections/tables/table-new/",a.key,""),b.yb(1),b.Gc(a.name)}}var aa=function(e,t){return{tableKey:e,path:t}};function na(e,t){if(1&e&&(b.Ob(0,"a",16),b.Lb(1,"i",17),b.Fc(2),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(4);b.Cb("active","item.name"==n.path),b.hc("queryParams",b.nc(4,aa,n.tableKey,a.key)),b.yb(2),b.Gc(a.name)}}function ia(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",14),b.Dc(1,na,3,7,"a",15),b.Nb()),2&e){var a=b.Zb(3);b.hc("text",a.eFlatFilePath[a.path])("pullRight",!0),b.yb(1),b.hc("ngForOf",a.eFlatFilePathItems)}}function ra(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",10),b.Dc(1,ta,2,3,"a",11),b.Nb(),b.Dc(2,ia,2,3,"dexih-button-dropdown",12)),2&e){var a=b.Zb(2);b.yb(1),b.hc("ngForOf",a.fileConnections),b.yb(1),b.hc("ngIf",(null==a.connectionReference?null:a.connectionReference.allowFlatFiles)&&(null==a.table?null:a.table.autoManageFiles))}}var oa=function(){return{standalone:!0}};function ca(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section"),b.Ob(1,"form-select",35),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb(3).updateStrategy=e})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(3);b.yb(1),b.hc("ngModel",n.updateStrategy)("ngModelOptions",b.lc(3,oa))("items",n.updateStrategies)}}function sa(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",36),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(3).uploadSelected(e)})),b.Fc(1,"Upload"),b.Nb(),b.Ob(2,"dexih-button-cancel",37),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(3).cancelSelected(e)})),b.Nb(),b.Ob(3,"dexih-button-delete",38),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(3).removeSelected(e)})),b.Nb()}}function la(e,t){if(1&e){var a=b.Pb();b.Ob(0,"section"),b.Ob(1,"form-checkbox",39),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb(3).automaticUpload=e})),b.Nb(),b.Nb()}if(2&e){var n=b.Zb(3);b.yb(1),b.hc("ngModel",n.automaticUpload)}}var ua=function(e){return{width:e}};function ba(e,t){if(1&e&&(b.Ob(0,"div",42),b.Lb(1,"div",43),b.Nb()),2&e){var a=b.Zb().item;b.yb(1),b.hc("ngStyle",b.mc(1,ua,a.progress+"%"))}}var ha=function(e,t,a){return{"fa-check":e,"fa-exclamation-circle":t,"fa-ban":a}};function da(e,t){if(1&e&&(b.Dc(0,ba,2,3,"div",40),b.Ob(1,"span"),b.Lb(2,"i",41),b.Fc(3),b.Nb()),2&e){var a=t.item,n=b.Zb(3);b.hc("ngIf",a.isRunning()),b.yb(2),b.hc("ngClass",b.oc(3,ha,a.status===n.eFileStatus.Complete,a.status===n.eFileStatus.Error,a.status===n.eFileStatus.Cancelled)),b.yb(1),b.Gc(a.status)}}function fa(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",50),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items,t=b.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Incoming)})),b.Fc(1,"To Incoming"),b.Nb()}}function ma(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",50),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items,t=b.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Outgoing)})),b.Fc(1,"To Processed"),b.Nb()}}function va(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",50),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items,t=b.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Processed)})),b.Fc(1,"To Processed"),b.Nb()}}function pa(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",50),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items,t=b.Zb(4);return t.moveSelected(e,t.eFlatFilePath.Rejected)})),b.Fc(1,"To Rejected"),b.Nb()}}function ga(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",37),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(4).deleteSelected(e)})),b.Nb(),b.Ob(1,"dexih-button-download",37),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb(4).downloadSelected(e)})),b.Nb(),b.Ob(2,"dexih-button-dropdown",48),b.Dc(3,fa,2,0,"a",49),b.Dc(4,ma,2,0,"a",49),b.Dc(5,va,2,0,"a",49),b.Dc(6,pa,2,0,"a",49),b.Nb()}if(2&e){var n=b.Zb(4);b.yb(2),b.hc("pullRight",!0),b.yb(1),b.hc("ngIf",n.path!=n.eFlatFilePath.Incoming),b.yb(1),b.hc("ngIf",n.path!=n.eFlatFilePath.Outgoing),b.yb(1),b.hc("ngIf",n.path!=n.eFlatFilePath.Processed),b.yb(1),b.hc("ngIf",n.path!=n.eFlatFilePath.Rejected)}}var ya=function(e,t,a,n){return["/hub",e,"summary","files","manage",t,"file-preview",a,n]};function Ca(e,t){if(1&e&&b.Lb(0,"dexih-button-preview",51),2&e){var a=t.item,n=b.Zb(4);b.hc("routerLink",b.pc(1,ya,null==n.hubCache?null:n.hubCache.hub.hubKey,n.tableKey,n.path,a.fileName))}}function ka(e,t){if(1&e&&(b.Ob(0,"a",16),b.Lb(1,"i",17),b.Fc(2),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(6);b.Cb("active","item.name"==n.path),b.hc("queryParams",b.nc(4,aa,n.tableKey,a.key)),b.yb(2),b.Gc(a.name)}}function wa(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",54),b.Dc(1,ka,3,7,"a",15),b.Nb()),2&e){var a=b.Zb(5);b.hc("text",a.eFlatFilePath[a.path])("pullRight",!0),b.yb(1),b.hc("ngForOf",a.eFlatFilePathItems)}}function Sa(e,t){if(1&e){var a=b.Pb();b.Dc(0,wa,2,3,"dexih-button-dropdown",52),b.Ob(1,"dexih-button-refresh",53),b.Vb("click",(function(){return b.vc(a),b.Zb(4).refreshFiles()})),b.Nb()}if(2&e){var n=b.Zb(4);b.hc("ngIf",null==n.table?null:n.table.autoManageFiles)}}function Oa(e,t){if(1&e&&(b.Ob(0,"li",22),b.Ob(1,"h5"),b.Fc(2,"Files (Local directory: "),b.Ob(3,"a",44),b.Fc(4),b.Nb(),b.Fc(5,")"),b.Nb(),b.Nb(),b.Ob(6,"li",27),b.Ob(7,"dexih-table",45),b.Dc(8,ga,7,5,"ng-template",29,30,b.Ec),b.Dc(10,Ca,1,6,"ng-template",46,47,b.Ec),b.Dc(12,Sa,2,1,"ng-template",null,31,b.Ec),b.Nb(),b.Nb()),2&e){var a=b.Zb(3);b.yb(3),b.jc("href","file://///",a.localPath,"",b.xc),b.yb(1),b.Gc(a.localPath),b.yb(3),b.hc("enableMultiSelect",!0)("columns",a.columns)("dataObservable",a.tableData)}}function Na(e,t){if(1&e){var a=b.Pb();b.Ob(0,"ul",18),b.Ob(1,"li",19),b.Ob(2,"section"),b.Ob(3,"form-select",20),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb(2).tableKey=e}))("ngModelChange",(function(e){return b.vc(a),b.Zb(2).updateTable(e)})),b.Nb(),b.Nb(),b.Dc(4,ca,2,4,"section",21),b.Nb(),b.Ob(5,"li",22),b.Ob(6,"h5"),b.Fc(7,"Drop Files to Upload"),b.Nb(),b.Nb(),b.Ob(8,"li",19),b.Ob(9,"div",23),b.Vb("dropFiles",(function(e){return b.vc(a),b.Zb(2).filesDrop(e)})),b.Fc(10," Drop Files to Upload Here "),b.Ob(11,"div",24),b.Ob(12,"input",25),b.Vb("change",(function(e){return b.vc(a),b.Zb(2).uploadFile(e)})),b.Nb(),b.Ob(13,"label",26),b.Fc(14,"Choose files"),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(15,"li",22),b.Ob(16,"h5"),b.Fc(17,"Upload Queue"),b.Nb(),b.Nb(),b.Ob(18,"li",27),b.Ob(19,"dexih-table",28),b.Dc(20,sa,4,0,"ng-template",29,30,b.Ec),b.Dc(22,la,2,1,"ng-template",null,31,b.Ec),b.Dc(24,da,4,7,"ng-template",32,33,b.Ec),b.Nb(),b.Nb(),b.Dc(26,Oa,14,5,"ng-template",34),b.Nb()}if(2&e){var n=b.Zb(2);b.yb(3),b.hc("ngModel",n.tableKey)("ngModelOptions",b.lc(9,oa))("items",n.connectionTables),b.yb(1),b.hc("ngIf",!(null!=n.connectionReference&&n.connectionReference.allowFlatFiles)),b.yb(5),b.hc("requireFiles",!0),b.yb(10),b.hc("enableMultiSelect",!0)("columns",n.uploadColumns)("data",n.uploadedFiles),b.yb(7),b.hc("ngIf",null==n.connectionReference?null:n.connectionReference.allowFlatFiles)}}function Ta(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",6),b.Ob(1,"dexih-widget",7),b.Vb("close",(function(){return b.vc(a),b.Zb().close()})),b.Dc(2,ra,3,2,"ng-template",null,8,b.Ec),b.Dc(4,Na,27,10,"ul",9),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.yb(1),b.hc("title","Manage Files: "+(null==n.table?null:n.table.name))("showCloseButton",!0),b.yb(3),b.hc("ngIf",n.table)}}var Da,xa=((Da=function(){function e(t,a,n,i){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.route=n,this.router=i,this.entityType="Table",this.canEdit=!1,this.updateStrategy=u.qc.Reload,this.updateStrategies=T.y,this.path=u.zb.None,this.eFlatFilePath=u.zb,this.eFlatFilePathItems=u.Ab.filter((function(e){return e.key>0})),this.eFileStatus=F.h,this.automaticUpload=!0,this.uploadedFiles=[],this.cancelToken=new F.a,this.pageTitle="Manage Files",this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"fileName",title:"File Name",format:""},{name:"length",title:"Size",format:""},{name:"lastModified",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable(),this.uploadColumns=[{name:"file.name",title:"File Name",format:""},{name:"file.size",title:"Size",format:""}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteLibrariesObservable()).subscribe((function(t){var a=t[1];e.hubCache=t[2],e.remoteLibraries=t[3],e.fileConnections=e.hubCache.hub.dexihConnections.filter((function(t){var a=e.remoteLibraries.connections.find((function(e){return t.connectionAssemblyName===e.connectionAssemblyName&&t.connectionClassName===e.connectionClassName}));return!!a&&(a.connectionCategory===u.ib.File||t.purpose!==u.jb.Source)}));var n=e.hubCache.getConnectionTables();e.connectionTables=n.filter((function(t){if(t.dexihTables.length>0)return null!=e.fileConnections.find((function(e){return t.key===e.key}))}));var i=!1;if(e.tableKey=+a.tableKey,e.tableKey||e.connectionTables.length>0&&e.connectionTables[0].dexihTables.length>0&&(e.tableKey=e.connectionTables[0].dexihTables[0].key,i=!0),e.path=+a.path,e.path||(e.path=u.zb.Incoming,i=!0),i)e.router.navigate([],{relativeTo:e.route,queryParams:{tableKey:e.tableKey,path:e.path},queryParamsHandling:"merge"});else{e.table=e.hubCache.getTable(e.tableKey);var r=e.hubCache.getConnection(e.table.connectionKey);e.connectionReference=e.remoteLibraries.connections.find((function(e){return r.connectionAssemblyName===e.connectionAssemblyName&&r.connectionClassName===e.connectionClassName})),!e.table&&e.tableKey?e.hubService.addHubErrorMessage("The table with the key ".concat(e.tableKey," could not be found.")):e.table&&(e.pageTitle="Manage files for "+e.table.name,e.showPage=!0,e.refreshFiles())}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Files Manage")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"updateTable",value:function(e){this.router.navigate([],{relativeTo:this.route,queryParams:{tableKey:e,path:"incoming"},queryParamsHandling:"merge"})}},{key:"refreshFiles",value:function(){var e=this;this.connectionReference.allowsFlatFiles&&this.hubService.getFileList(this.table,this.path,this.cancelToken).then((function(t){e._tableData.next(t)})).catch((function(t){e._tableData.next([])}))}},{key:"uploadSelected",value:function(e){var t=this;e.forEach((function(e){t.authService.upload(e).then((function(a){a.success?(t.hubService.addHubSuccessMessage("File ".concat(e.file.name," uploaded successfully.")),t.refreshFiles()):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"removeSelected",value:function(e){var t=this;e.forEach((function(e){var a=t.uploadedFiles.findIndex((function(t){return t.id===e.id}));a>=0&&t.uploadedFiles.splice(a,1)}))}},{key:"cancelSelected",value:function(e){e.forEach((function(e){return e.cancel()}))}},{key:"deleteSelected",value:function(e){var t=this,a=e.map((function(e){return e.fileName}));this.hubService.deleteFiles(this.table,this.path,a,this.cancelToken).then((function(e){e&&t.refreshFiles()})).catch()}},{key:"moveSelected",value:function(e,t){var a=this,n=e.map((function(e){return e.fileName}));this.hubService.moveFiles(this.table,this.path,t,n,this.cancelToken).then((function(e){e&&a.refreshFiles()})).catch((function(e){a.hubService.addHubMessage(status)}))}},{key:"downloadSelected",value:function(e){var t=this,a=e.map((function(e){return e.fileName}));this.hubService.downloadFiles(this.table,this.path,a,this.cancelToken).then((function(e){e&&t.refreshFiles()})).catch()}},{key:"preview",value:function(e){this.router.navigate(["hub",this.hubCache.hub.hubKey,"summary","files","manage",this.tableKey,this.path,e.fileName])}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"uploadFile",value:function(e){return this.doUpload(e.srcElement.files),!1}},{key:"doUpload",value:function(e){var t=this;Array.prototype.forEach.call(e,(function(e){t.hubService.uploadFile(t.table,t.path,t.updateStrategy,e.name,t.cancelToken).then((function(a){var n=new F.d(e,a);t.automaticUpload&&t.authService.upload(n).then((function(a){a.success?(t.hubService.addHubSuccessMessage("File ".concat(e.name," uploaded successfully.")),t.refreshFiles()):t.hubService.addHubMessage(a)})).catch((function(e){t.hubService.addHubMessage(e)})),t.uploadedFiles.push(n),t.uploadedFiles=_toConsumableArray(t.uploadedFiles)})).catch((function(e){t.hubService.addHubMessage(e)}))}))}},{key:"filesDrop",value:function(e){this.doUpload(e)}}]),e}()).\u0275fac=function(e){return new(e||Da)(b.Kb(c.a),b.Kb(o.a),b.Kb(r.a),b.Kb(r.e))},Da.\u0275cmp=b.Eb({type:Da,selectors:[["files-manage"]],decls:2,vars:2,consts:[["class","alert alert-danger m-3",4,"ngIf"],["class","container",4,"ngIf"],[1,"alert","alert-danger","m-3"],["text","New Connection",3,"routerLink","autoCompact"],[3,"routerLink","autoCompact","title",4,"ngFor","ngForOf"],[3,"routerLink","autoCompact","title"],[1,"container"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","close"],["header",""],["class","list-group",4,"ngIf"],["iconClass","fa fa-file-o","text","New File",1,"mr-1"],["class","dropdown-item",3,"routerLink","title",4,"ngFor","ngForOf"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[1,"dropdown-item",3,"routerLink","title"],["iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight"],["class","dropdown-item","routerLinkActive","active","data-toggle","tab","routerLink",".",3,"active","queryParams",4,"ngFor","ngForOf"],["routerLinkActive","active","data-toggle","tab","routerLink",".",1,"dropdown-item",3,"queryParams"],[1,"fa","fa-elipsis-h"],[1,"list-group"],[1,"list-group-item"],["label","Flat File","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the flat file to manage",3,"ngModel","ngModelOptions","items","ngModelChange"],[4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],["dropZone","","dropAllowedClass","nv-file-over",1,"well","my-drop-zone",3,"requireFiles","dropFiles"],[1,"custom-file","w-25","float-right"],["type","file","onclick","this.value=null",1,"custom-file-input",3,"change"],["for","inputGroupFile01",1,"custom-file-label"],[1,"list-group-item","p-0"],[3,"enableMultiSelect","columns","data"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],[3,"ngIf"],["label","Update Strategy","itemKey","key","itemName","description","iconClass","fa fa-database","note","Specify how records should be inserted/updated in the target table.",3,"ngModel","ngModelOptions","items","ngModelChange"],["iconClass","fa fa-upload","buttonClass","btn-primary",1,"mr-1",3,"click"],[1,"mr-1",3,"click"],["text","Remove",3,"click"],["label","Automatically upload files when added to the queue.",3,"ngModel","ngModelChange"],["class","progress","style","margin-bottom: 0;",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"progress",2,"margin-bottom","0"],["role","progressbar",1,"progress-bar",3,"ngStyle"],[3,"href"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemAction"],["selectedItemAction",""],["iconClass","fa fa-mail-forward","text","Move",1,"mr-1",3,"pullRight"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[3,"routerLink"],["class","mr-1","buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",3,"text","pullRight",4,"ngIf"],[3,"click"],["buttonClass","btn-primary","iconClass","fa fa-filter","title","Select the file location",1,"mr-1",3,"text","pullRight"]],template:function(e,t){1&e&&(b.Dc(0,ea,6,3,"div",0),b.Dc(1,Ta,5,3,"div",1)),2&e&&(b.hc("ngIf",!t.connectionTables||0===t.connectionTables.length),b.yb(1),b.hc("ngIf",t.connectionTables&&t.connectionTables.length>0))},directives:[v.t,h.o,r.f,v.s,h.f,h.P,h.i,r.h,r.g,h.E,n.s,n.v,at.a,d.a,h.b,h.g,h.A,v.q,v.w,h.h,h.q,h.s],encapsulation:2}),Da);a("/fhR");var Fa=function(e){return["hubVariable-edit",e]};function Ia(e,t){1&e&&b.Lb(0,"dexih-button-edit",9),2&e&&b.hc("routerLink",b.mc(1,Fa,t.item.key))}function Ka(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",10),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().deleteHubVariables(e)})),b.Nb()}}function Ea(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",10),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb(),b.Dc(1,Ka,1,0,"dexih-button-delete",11),b.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=b.Zb();b.yb(1),b.hc("ngIf",i.hubCache.canWrite),b.yb(1),b.hc("objectType",i.eSharedObjectType.HubVariable)("objects",n)}}var Va=function(){return["hubVariable-new"]};function La(e,t){1&e&&b.Lb(0,"dexih-button-new",14),2&e&&b.hc("routerLink",b.lc(1,Va))}function Pa(e,t){if(1&e&&b.Dc(0,La,1,2,"dexih-button-new",13),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite)}}var Aa,Ra=((Aa=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"value",title:"Value",format:""},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateVariables()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Hub Variables Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteHubVariables",value:function(e){this.hubService.deleteHubVariables(e)}},{key:"updateVariables",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihHubVariables.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,value:t.isEncrypted?"(Encrypted)":t.value,isEncrypted:t.isEncrypted,tags:e.hubCache.getObjectTags(u.dc.HubVariable,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["hubVariable-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache.hub.dexihHubVariables.filter((function(t){return e.findIndex((function(e){return e.key===t.key}))>=0})),a=this.hubService.createHub(this.hubCache.hub.hubKey,"");a.dexihHubVariables=t,this.hubService.exportHub(a,"hub_variables.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.HubVariable&&t.changeClass!==u.dc.TagObjects||e.updateVariables()}))}}]),e}()).\u0275fac=function(e){return new(e||Aa)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Aa.\u0275cmp=b.Eb({type:Aa,selectors:[["hubVariable"]],decls:10,vars:7,consts:[[1,"container-fluid"],["title","Hub Variables","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,Ia,1,3,"ng-template",3,4,b.Ec),b.Dc(5,Ea,3,3,"ng-template",5,6,b.Ec),b.Dc(7,Pa,1,1,"ng-template",null,7,b.Ec),b.Nb(),b.Nb(),b.Lb(9,"dexih-help",8),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,h.j,r.f,h.u,v.t,p.a,h.g,h.o],encapsulation:2}),Aa);function ja(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save",7),b.Vb("click",(function(){return b.vc(a),b.Zb(2).save()})),b.Nb()}}function _a(e,t){if(1&e&&(b.Dc(0,ja,1,0,"dexih-button-save",5),b.Lb(1,"cancel-button",6)),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite),b.yb(1),b.hc("formsService",a.formsService)}}function Ma(e,t){if(1&e&&(b.Ob(0,"form",8),b.Lb(1,"input",9),b.Lb(2,"input",10),b.Ob(3,"fieldset"),b.Ob(4,"div",11),b.Ob(5,"section",12),b.Lb(6,"form-input",13),b.Nb(),b.Ob(7,"section",12),b.Lb(8,"form-input",14),b.Nb(),b.Nb(),b.Ob(9,"section"),b.Lb(10,"form-checkbox",15),b.Nb(),b.Ob(11,"section"),b.Lb(12,"form-checkbox",16),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.formsService.currentForm),b.yb(6),b.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),b.yb(2),b.hc("label",a.formsService.currentForm.controls.isEnvironmentVariable.value?"Environment Variable Name":"Hub Variable Value")("type",a.formsService.currentForm.controls.isEncrypted.value?"password":"text")("errors",a.formsService.formErrors.value)}}var Za,Ha=((Za=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.pageTitle=a.pageTitle,e.action=a.action,e.hubCache&&e.hubCache.status===T.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Edit Variables")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._isEncryptedSubscription&&this._isEncryptedSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.hubVariableKey=+this.params.hubVariableKey,this.hubVariableKey)if(this.hubCache.hub&&this.hubCache.hub.dexihHubVariables){var t=this.hubCache.hub.dexihHubVariables.find((function(t){return t.key===e.hubVariableKey}));this.formsService.hubVariable(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no variable specified to edit.");if("new"===this.action){var a=new u.C;a.value="",a.name="",this.formsService.hubVariable(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/hubVariable-new","/hubVariable-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this._isEncryptedSubscription=this.formsService.currentForm.controls.isEncrypted.valueChanges.subscribe((function(t){t||e.formsService.currentForm.controls.valueRaw.setValue("")}))}},{key:"save",value:function(){return e=this,a=regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.formsService.currentForm).controls.isEncrypted.value){e.next=10;break}if(!(a=t.controls.valueRaw.value)){e.next=8;break}return e.next=6,this.hubService.encrypt(a,this.cancelToken);case 6:n=e.sent,t.controls.value.setValue(n),t.controls.valueRaw.setValue(null);case 8:e.next=11;break;case 10:t.controls.value.setValue(t.controls.valueRaw.value);case 11:return e.next=13,this.formsService.save();case 13:case"end":return e.stop()}}),e,this)})),new((t=void 0)||(t=Promise))((function(n,i){function r(e){try{c(a.next(e))}catch(t){i(t)}}function o(e){try{c(a.throw(e))}catch(t){i(t)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,o)}c((a=a.apply(e,[])).next())}));var e,t,a}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Za)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e))},Za.\u0275cmp=b.Eb({type:Za,selectors:[["dexih-hubVariable-edit-form"]],features:[b.xb([D.a])],decls:6,vars:3,consts:[[1,"container"],["title","Edit Variable","iconClass","fa fa-lg fa-fw fa-at",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Hub Variables","path","/assets/help/reference/hubVariable.md",1,"m-3"],["class","mr-1",3,"click",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"click"],[3,"formGroup"],["id","fake_user_name","name","fake_user[name]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],["id","fake_password","type","password","name","fake_password[password]","type","text","value","Fake Auto-fill",2,"position","absolute","top","-5000px"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Hub Variable Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["formControlName","valueRaw","placeholder","Enter the value.","iconClass","fa fa-list","autocomplete","off",3,"label","type","errors"],["label","Encrypt value","formControlName","isEncrypted"],["label","Use an environment variable on the remote agent","formControlName","isEnvironmentVariable"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,_a,2,2,"ng-template",null,2,b.Ec),b.Dc(4,Ma,13,6,"form",3),b.Nb(),b.Lb(5,"dexih-help",4),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(3),b.hc("ngIf",t.formsService.currentForm))},directives:[h.P,v.t,$.a,I.a,h.t,n.I,n.t,n.l,h.D,n.s,n.j,h.A],encapsulation:2}),Za),Ba=a("24Dg"),Ua=["DexihMessage"];function qa(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save",12),b.Vb("click",(function(){return b.vc(a),b.Zb().addUsers()})),b.Nb()}if(2&e){var n=b.Zb();b.hc("disabled",0==n.emails.length)}}function za(e,t){if(1&e){var a=b.Pb();b.Ob(0,"a",17),b.Vb("click",(function(){b.vc(a);var e=t.$implicit,n=b.Zb().items;return b.Zb().setPermission(e.key,n)})),b.Fc(1),b.Nb()}if(2&e){var n=t.$implicit;b.yb(1),b.Gc(n.name)}}function Wa(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",13),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().deleteUsers(e)})),b.Nb(),b.Ob(1,"dexih-button-dropdown",14),b.Dc(2,za,2,1,"a",15),b.Nb(),b.Ob(3,"dexih-button-dropdown",16),b.Ob(4,"a",17),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().setUserAlert(!0,e)})),b.Fc(5,"Receive alert emails"),b.Nb(),b.Ob(6,"a",17),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().setUserAlert(!1,e)})),b.Fc(7,"Do not receive alert emails."),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.yb(2),b.hc("ngForOf",n.ePermissionItems)}}var Ga,Qa=((Ga=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.columns=[{name:"userName",title:"User Name",format:""},{name:"firstName",title:"First Name",format:""},{name:"lastName",title:"Last Name",format:""},{name:"permission",title:"Permission",enum:u.Wb,format:"Enum"},{name:"receiveAlerts",title:"Receives Alert Emails",format:"Boolean"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable(),this.ePermission=u.Wb,this.ePermissionItems=u.Xb,this.permission=u.Wb.PublishReader,this.emails=[],this.sendInvites=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.refreshUsers()}},{key:"ngOnDestroy",value:function(){}},{key:"refreshUsers",value:function(){var e=this;this.hubService.getHubUsers().then((function(t){e._tableData.next(t)}))}},{key:"setPermission",value:function(e,t){var a=this,n=t.map((function(e){return e.userName}));this.authService.confirmDialog("Confirm Permission Change","This action will change the selected user(s) hub permission to ".concat(u.Wb[this.permission],".  Proceed?")).then((function(t){t&&a.hubService.setUserPermissions(n,e,!1).then((function(e){a.dexihMessage.addSuccessMessage("The specified user(s) permission have been updated."),a.refreshUsers()}))}))}},{key:"setUserAlert",value:function(e,t){var a=this,n=t.map((function(e){return e.id}));this.hubService.setUserAlerts(n,e,!1).then((function(e){a.dexihMessage.addSuccessMessage("The specified user(s) alert email status have been updated."),a.refreshUsers()}))}},{key:"deleteUsers",value:function(e){var t=this,a=e.map((function(e){return e.userName}));this.authService.confirmDialog("Confirm Delete Users","This action will delete the selected user(s) from using this hub.  Proceed?").then((function(e){e&&t.hubService.removeUsers(a).then((function(e){t.dexihMessage.addSuccessMessage("The specified users have been removed from the hub."),t.refreshUsers()}))}))}},{key:"addUsers",value:function(){var e=this;this.emails.length>0&&this.permission&&this.authService.confirmDialog("Add Users","This action will added users with the specified emails to this hub with permission ".concat(u.Wb[this.permission],".  Proceed?")).then((function(t){t&&e.hubService.setUserPermissions(e.emails,e.permission,e.sendInvites).then((function(t){e.emails=[],e.dexihMessage.addSuccessMessage("The specified users have been added to the hub."),e.refreshUsers()}))}))}}]),e}()).\u0275fac=function(e){return new(e||Ga)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Ga.\u0275cmp=b.Eb({type:Ga,selectors:[["users"]],viewQuery:function(e,t){var a;1&e&&b.Bc(Ua,!0),2&e&&b.rc(a=b.Wb())&&(t.dexihMessage=a.first)},decls:19,vars:9,consts:[[1,"p-3"],["DexihMessage",""],[1,"container-fluid"],["title","Invite Users","iconClass","fa fa-lg fa-fw fa-birthday-cake",3,"padding"],["subHeader",""],["label","Permission","name","permission","itemKey","key","itemName","name","note","Permission level to grant to emails",3,"ngModel","items","enableFilter","ngModelChange"],["label","Email Addresses / User names","name","emails","note","Provide a list of user names or email addresses of users to join the hub.",3,"ngModel","ngModelChange"],["label","Send invites","name","sendInvites","note","Emails which are not registered to use the integration hub will be sent an invite to join.",3,"ngModel","ngModelChange"],["title","Current Users","iconClass","fa fa-lg fa-fw fa-group"],[3,"enableMultiSelect","columns","dataObservable"],["select","selectedItemsAction"],["selectedItemsAction",""],["text","Add User(s)",3,"disabled","click"],[1,"mr-1",3,"click"],["buttonClass","btn-primary","iconClass","fa fa-lock","text","Set Permission"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["buttonClass","btn-primary","iconClass","fa fa-bell","text","Set User Alert",1,"ml-1"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(b.Lb(0,"dexih-message",0,1),b.Ob(2,"div",2),b.Ob(3,"dexih-widget-vertical"),b.Ob(4,"dexih-widget",3),b.Dc(5,qa,1,1,"ng-template",null,4,b.Ec),b.Ob(7,"form"),b.Ob(8,"fieldset"),b.Ob(9,"section"),b.Ob(10,"form-select",5),b.Vb("ngModelChange",(function(e){return t.permission=e})),b.Nb(),b.Nb(),b.Ob(11,"section"),b.Ob(12,"form-tags",6),b.Vb("ngModelChange",(function(e){return t.emails=e})),b.Nb(),b.Nb(),b.Ob(13,"section"),b.Ob(14,"form-checkbox",7),b.Vb("ngModelChange",(function(e){return t.sendInvites=e})),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(15,"dexih-widget",8),b.Ob(16,"dexih-table",9),b.Dc(17,Wa,8,1,"ng-template",10,11,b.Ec),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(4),b.hc("padding",!0),b.yb(6),b.hc("ngModel",t.permission)("items",t.ePermissionItems)("enableFilter",!1),b.yb(2),b.hc("ngModel",t.emails),b.yb(2),b.hc("ngModel",t.sendInvites),b.yb(2),b.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData))},directives:[Ba.a,h.S,h.P,n.I,n.t,n.u,h.E,n.s,n.v,h.F,h.A,d.a,h.t,h.g,h.i,v.s],encapsulation:2}),Ga),$a=function(){return{statusFilter:"All"}},Xa=function(){return{statusFilter:"Ready"}},Ya=function(){return{statusFilter:"Offline"}},Ja=function(){return{statusFilter:"Unauthorized"}};function en(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",9),b.Ob(1,"a",10),b.Fc(2,"All"),b.Nb(),b.Ob(3,"a",11),b.Fc(4,"Ready"),b.Nb(),b.Ob(5,"a",12),b.Fc(6,"Offline"),b.Nb(),b.Ob(7,"a",13),b.Fc(8,"Unauthorized"),b.Nb(),b.Nb(),b.Fc(9,"\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")),2&e){var a=b.Zb();b.hc("text",a.statusFilter)("pullRight",!0),b.yb(1),b.Cb("active","All"==a.statusFilter),b.hc("queryParams",b.lc(14,$a)),b.yb(2),b.Cb("active","Ready"==a.statusFilter),b.hc("queryParams",b.lc(15,Xa)),b.yb(2),b.Cb("active","Offline"==a.statusFilter),b.hc("queryParams",b.lc(16,Ya)),b.yb(2),b.Cb("active","Unauthorized"==a.statusFilter),b.hc("queryParams",b.lc(17,Ja))}}function tn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",14),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().deleteSelected(e)})),b.Nb(),b.Ob(1,"dexih-button",15),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().authorize(e)})),b.Fc(2,"Authorize"),b.Nb(),b.Ob(3,"dexih-button",16),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().deAuthorize(e)})),b.Fc(4,"De-Authorize"),b.Nb()}}var an=function(e,t){return["agent-edit",e,t]};function nn(e,t){if(1&e&&b.Lb(0,"dexih-button-edit",17),2&e){var a=t.item;b.hc("routerLink",b.nc(1,an,a.remoteAgentKey,a.remoteAgentHubKey))}}var rn=function(){return["/hubs/index/agents/download"]};function on(e,t){1&e&&b.Lb(0,"dexih-button-download",18),2&e&&b.hc("routerLink",b.lc(1,rn))}var cn,sn=((cn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.columns=[{name:"name",title:"Name",format:""},{name:"connected",title:"Connected",format:"Boolean"},{name:"isAuthorized",title:"Authorized?",format:"Boolean"},{name:"user",title:"User",format:""},{name:"dataPrivacyStatus",title:"Data Privacy",format:"Enum",enum:u.mb},{name:"isEncrypted",title:"Encrypted?",format:"Boolean"},{name:"ipAddress",title:"Current IP Address",format:""},{name:"remoteAgentId",title:"Id",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"},{name:"lastLoginDateTime",title:"Last Login",format:"Calendar"},{name:"lastLoginIpAddress",title:"Last IP Address",format:""}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.queryParams,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0];e.hubCache=t[1],e.remoteAgents=t[2],e.hubCache.isLoaded()&&(e.statusFilter=a.statusFilter,e.statusFilter||(e.statusFilter="All"),e.updateRemoteAgents())}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Remote Agent index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateRemoteAgents",value:function(){var e=this;if(this.hubCache&&this.hubCache.hub){var t=this.hubCache.hub.dexihRemoteAgentHubs.map((function(t){var a=e.remoteAgents?e.remoteAgents.find((function(e){return e.remoteAgentKey===t.remoteAgentKey})):null,n=a&&a.activeAgents&&a.activeAgents.length>0?a.activeAgents[0]:null;return{remoteAgentHubKey:t.remoteAgentHubKey,connected:null!==n,isAuthorized:t.isAuthorized,name:n?n.name:a?a.name:"Unknown",user:n?n.user:"",dataPrivacyStatus:n?n.dataPrivacyStatus:"",isEncrypted:n?n.isEncrypted:"",ipAddress:n?n.ipAddress:"",remoteAgentKey:t.remoteAgentKey,updateDate:t.updateDate,lastLoginDateTime:a?a.lastLoginDateTime:"",lastLoginIpAddress:a?a.lastLoginIpAddress:"",remoteAgentId:a?a.remoteAgentId:""}}));this.remoteAgents&&this.remoteAgents.forEach((function(e){var a=e.activeAgents&&e.activeAgents.length>0?e.activeAgents[0]:null;a&&t.findIndex((function(t){return t.remoteAgentKey===e.remoteAgentKey}))<0&&t.push({remoteAgentHubKey:0,connected:!0,isAuthorized:!1,name:a.name,user:a.user,dataPrivacyStatus:a.dataPrivacyStatus,isEncrypted:a.isEncrypted,ipAddress:a.ipAddress,remoteAgentKey:e.remoteAgentKey,remoteAgentId:e.remoteAgentId,updateDate:""})})),this._tableData.next(t)}}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===u.dc.RemoteAgent&&e.updateRemoteAgents()}))}},{key:"authorize",value:function(e){var t,a,n,i,r,o,c;return r=this,c=regeneratorRuntime.mark((function r(){var o,c=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,o=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a.value).isAuthorized){e.next=5;break}return t.remoteAgentHubKey?(n=c.hubCache.hub.dexihRemoteAgentHubs.find((function(e){return e.remoteAgentHubKey===t.remoteAgentHubKey}))).isAuthorized=!0:((n={hubKey:c.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:t.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null}).allowExternalConnect=!0,n.isSelected=!1),e.next=5,c.hubService.saveRemoteAgent(n);case 5:case"end":return e.stop()}}),e)})),t=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(e);case 3:return r.next=5,t.next();case 5:if((a=r.sent).done){r.next=9;break}return r.delegateYield(o(),"t0",7);case 7:r.next=3;break;case 9:r.next=14;break;case 11:r.prev=11,r.t1=r.catch(0),n={error:r.t1};case 14:if(r.prev=14,r.prev=15,r.t2=a&&!a.done&&(i=t.return),!r.t2){r.next=20;break}return r.next=20,i.call(t);case 20:if(r.prev=20,!n){r.next=23;break}throw n.error;case 23:return r.finish(20);case 24:return r.finish(14);case 25:case"end":return r.stop()}}),r,null,[[0,11,14,25],[15,,20,24]])})),new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{i(c.next(e))}catch(a){t(a)}}function n(e){try{i(c.throw(e))}catch(a){t(a)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(a,n)}i((c=c.apply(r,[])).next())}))}},{key:"deAuthorize",value:function(e){var t=this;e.forEach((function(e){if(e.isAuthorized&&e.remoteAgentHubKey){var a=t.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey}));a&&(a.isAuthorized=!1,t.hubService.saveRemoteAgent(a))}}))}},{key:"deleteSelected",value:function(e){var t=this;e.forEach((function(e){if(e.remoteAgentHubKey){var a=t.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey}));a&&(a.isAuthorized=!1,t.hubService.deleteRemoteAgent(a))}}))}},{key:"edit",value:function(e){this.router.navigate(["agent-edit",e.remoteAgentKey,e.remoteAgentHubKey],{relativeTo:this.route})}}]),e}()).\u0275fac=function(e){return new(e||cn)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},cn.\u0275cmp=b.Eb({type:cn,selectors:[["remoteagents"]],inputs:{hubKey:"hubKey"},decls:11,vars:6,consts:[[1,"container-fluid"],["title","Hub Remote Agents","iconClass","fa fa-lg fa-fw fa-wifi",3,"showCloseButton","close"],["header",""],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["buttonClass","btn btn-sm btn-outline-secondary","iconClass","fa fa-filter","title","Filter by a status",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Ready",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Offline Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Unauthorized Items",1,"dropdown-item",3,"queryParams"],["title","Delete selected remote agents",1,"mr-1",3,"click"],["iconClass","fa fa-check","buttonClass","btn-primary","title","Authorize the selected agents for this hub",1,"mr-1",3,"click"],["iconClass","fa fa-times","buttonClass","btn-danger","title","De-Authorize the selected agents",1,"mr-1",3,"click"],[1,"mr-1",3,"routerLink"],["iconClass","fa fa-download","text","Download Agent",1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,en,10,18,"ng-template",null,2,b.Ec),b.Ob(4,"dexih-table",3),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(5,tn,5,0,"ng-template",4,5,b.Ec),b.Dc(7,nn,1,4,"ng-template",6,7,b.Ec),b.Dc(9,on,1,2,"ng-template",null,8,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(3),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,h.i,r.h,h.g,h.f,h.j,r.f,h.h],encapsulation:2}),cn),ln=function(e){return["/hubs","index","agents","edit",e]};function un(e,t){if(1&e){var a=b.Pb();b.Lb(0,"dexih-button-edit",6),b.Ob(1,"dexih-button-save",7),b.Vb("click",(function(){return b.vc(a),b.Zb().save()})),b.Nb(),b.Lb(2,"cancel-button",8)}if(2&e){var n=b.Zb();b.hc("routerLink",b.mc(3,ln,n.remoteAgentKey)),b.yb(1),b.hc("disabled",!n.formsService.hasChanged),b.yb(1),b.hc("formsService",n.formsService)}}function bn(e,t){1&e&&b.Fc(0," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0")}function hn(e,t){1&e&&(b.Ob(0,"div",9),b.Fc(1," Creating a new hub -> remote agent authorization "),b.Nb())}var dn=function(){return{standalone:!0}};function fn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form",10),b.Ob(1,"fieldset"),b.Ob(2,"section"),b.Ob(3,"form-input",11),b.Vb("ngModelChange",(function(e){return b.vc(a),b.Zb().name=e})),b.Nb(),b.Nb(),b.Ob(4,"section"),b.Lb(5,"form-checkbox",12),b.Nb(),b.Ob(6,"section"),b.Lb(7,"form-checkbox",13),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("formGroup",n.formsService.currentForm),b.yb(3),b.hc("disabled",!0)("ngModel",n.name)("ngModelOptions",b.lc(4,dn))}}var mn,vn=((mn=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.formsService=n,this.router=i,this.route=r,this.isNew=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.authService.getRemoteAgentsObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.remoteAgents=t[3],e.hubCache.isLoaded()&&e.remoteAgents)if(e.remoteAgentKey=+a.remoteAgentKey,e.remoteAgentHubKey=+a.remoteAgentHubKey,e.remoteAgentKey){var n=e.remoteAgents.find((function(t){return t.remoteAgentKey===e.remoteAgentKey})),i=n.activeAgents&&n.activeAgents.length>0?n.activeAgents[0]:null;e.name=i?i.name:"",e.ipAddress=i?i.ipAddress:null,e.remoteAgentHub=e.hubCache.hub.dexihRemoteAgentHubs.find((function(t){return t.remoteAgentHubKey===e.remoteAgentHubKey})),e.remoteAgentHub||(e.remoteAgentHub={hubKey:e.hubCache.hub.hubKey,remoteAgentHubKey:0,remoteAgentKey:n.remoteAgentKey,isAuthorized:!0,isValid:!0,createDate:null,isDefault:!1,updateDate:null},e.remoteAgentHub.allowExternalConnect=!0,e.remoteAgentHub.isSelected=!1,e.isNew=!0),e.formsService.remoteAgent(e.remoteAgentHub),0===e.remoteAgentHub.remoteAgentHubKey&&(e.formsService.hasChanged=!0)}else e.hubService.addHubErrorMessage("There was no remote agent specified to edit.")}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Remote Agent Edit")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"addCurrentIp",value:function(){var e=this;if(this.ipAddress){var t=this.formsService.currentForm.controls.ipAddresses,a=t.value;a.findIndex((function(t){return t===e.ipAddress}))<0&&(a.push(this.ipAddress),t.setValue(a))}}},{key:"save",value:function(){var e=this;this.hubService.saveRemoteAgent(this.formsService.currentForm.value).then((function(t){t&&(e.hubService.addHubSuccessMessage("The remote agent updated successfully."),e.authService.navigateUp())}))}}]),e}()).\u0275fac=function(e){return new(e||mn)(b.Kb(c.a),b.Kb(o.a),b.Kb(D.a),b.Kb(r.e),b.Kb(r.a))},mn.\u0275cmp=b.Eb({type:mn,selectors:[["remote-agents"]],inputs:{hubKey:"hubKey"},features:[b.xb([D.a])],decls:11,vars:4,consts:[["DexihMessage",""],[1,"container"],["title","Edit Hub Remote Agent","iconClass","fa fa-lg fa-fw fa-database",3,"padding","showCloseButton","close"],["header",""],["class","alert alert-primary",4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"routerLink"],[1,"pl-1",3,"disabled","click"],[1,"pl-1",3,"formsService"],[1,"alert","alert-primary"],[3,"formGroup"],["label","Agent name","note","This can be changed in the agents appsettings.json config file.","iconClass","fa fa-comment",3,"disabled","ngModel","ngModelOptions","ngModelChange"],["label","Is default agent for this Hub","formControlName","isDefault"],["label","Is Authorized for this Hub.","formControlName","isAuthorized"]],template:function(e,t){1&e&&(b.Lb(0,"dexih-message",null,0),b.Ob(2,"div",1),b.Ob(3,"dexih-widget",2),b.Vb("close",(function(){return t.close()})),b.Dc(4,un,3,5,"ng-template",null,3,b.Ec),b.Fc(6," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"),b.Dc(7,bn,1,0,"ng-template",null,3,b.Ec),b.Dc(9,hn,2,0,"div",4),b.Dc(10,fn,8,5,"form",5),b.Nb(),b.Nb()),2&e&&(b.yb(3),b.hc("padding",!0)("showCloseButton",!0),b.yb(6),b.hc("ngIf",t.isNew),b.yb(1),b.hc("ngIf",t.formsService.currentForm))},directives:[Ba.a,h.P,v.t,h.j,r.f,h.t,I.a,n.I,n.t,n.l,h.D,n.s,n.v,h.A,n.j],encapsulation:2}),mn),pn=a("wTS4");function gn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-preview",11),b.Vb("click",(function(){b.vc(a);var e=t.item;return b.Zb().preview(e)})),b.Nb()}}function yn(e,t){}function Cn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-private",11),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().unshareSelectedTables(e)})),b.Nb()}}function kn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-download",12),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().downloadData(e)})),b.Nb(),b.Dc(1,Cn,1,0,"dexih-button-private",13)}if(2&e){var n=b.Zb();b.yb(1),b.hc("ngIf",n.hubCache.canWrite)}}var wn=function(){return{typeFilter:"All"}},Sn=function(){return{typeFilter:"Datalink"}},On=function(){return{typeFilter:"Table"}},Nn=function(){return{typeFilter:"View"}},Tn=function(){return{typeFilter:"Dashboard"}},Dn=function(){return{typeFilter:"Api"}};function xn(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",14),b.Ob(1,"a",15),b.Fc(2,"All"),b.Nb(),b.Ob(3,"a",16),b.Fc(4,"Datalinks"),b.Nb(),b.Ob(5,"a",17),b.Fc(6,"Tables"),b.Nb(),b.Ob(7,"a",18),b.Fc(8,"Views"),b.Nb(),b.Ob(9,"a",19),b.Fc(10,"Dashboards"),b.Nb(),b.Ob(11,"a",20),b.Fc(12,"Apis"),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("text",a.typeFilter)("pullRight",!0),b.yb(1),b.Cb("active","All"==a.typeFilter),b.hc("queryParams",b.lc(20,wn)),b.yb(2),b.Cb("active","Datalink"==a.typeFilter),b.hc("queryParams",b.lc(21,Sn)),b.yb(2),b.Cb("active","Table"==a.typeFilter),b.hc("queryParams",b.lc(22,On)),b.yb(2),b.Cb("active","View"==a.typeFilter),b.hc("queryParams",b.lc(23,Nn)),b.yb(2),b.Cb("active","Dashboard"==a.typeFilter),b.hc("queryParams",b.lc(24,Tn)),b.yb(2),b.Cb("active","Api"==a.typeFilter),b.hc("queryParams",b.lc(25,Dn))}}var Fn,In=((Fn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.cancelToken=new F.a,this.eSharedObjectType=u.dc,this.columns=[{name:"objectTypeName",title:"Type",format:""},{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:"Md"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3],e.watchChanges(),e.typeFilter=a.typeFilter,e.typeFilter||(e.typeFilter="All"),e.route.snapshot.data.pageTitle=e.typeFilter,e.updateSharedData()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Shared Data Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateSharedData",value:function(){var e=this,t=new Array;this.hubCache&&this.hubCache.isLoaded()&&(this.hubCache.hub.dexihDatalinks||this.hubCache.hub.dexihConnections?("All"!==this.typeFilter&&"Datalink"!==this.typeFilter||this.hubCache.hub.dexihDatalinks.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:u.lb[u.lb.Datalink],objectType:u.lb.Datalink,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(u.dc.Datalink,a.key)})})),"All"!==this.typeFilter&&"Table"!==this.typeFilter||this.hubCache.hub.dexihTables.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:u.lb[u.lb.Table],objectType:u.lb.Table,name:a.logicalName+" ("+a.name+")",description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(u.dc.TagObjects,a.key)})})),"All"!==this.typeFilter&&"View"!==this.typeFilter||this.hubCache.hub.dexihViews.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:u.lb[u.lb.View],objectType:u.lb.View,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(u.dc.View,a.key)})})),"All"!==this.typeFilter&&"Dashboard"!==this.typeFilter||this.hubCache.hub.dexihDashboards.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:u.lb[u.lb.Dashboard],objectType:u.lb.Dashboard,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(u.dc.Dashboard,a.key)})})),"All"!==this.typeFilter&&"Api"!==this.typeFilter||this.hubCache.hub.dexihApis.filter((function(e){return e.isShared})).forEach((function(a){t.push({objectKey:a.key,objectTypeName:u.lb[u.lb.Api],objectType:u.lb.Api,name:a.name,description:a.description,updateDate:a.updateDate,tags:e.hubCache.getObjectTags(u.dc.Api,a.key)})})),this._tableData.next(t)):this._tableData.next(new Array))}},{key:"downloadData",value:function(e){var t=this;this.hubService.downloadData(e,!0,u.rb.Csv,this.cancelToken).then((function(){t.hubService.addHubSuccessMessage("The specified data is being downloaded.")})).catch((function(){}))}},{key:"preview",value:function(e){e.objectType===u.lb.Table&&this.router.navigate(["table-preview",e.objectKey],{relativeTo:this.route}),e.objectType===u.lb.Datalink&&this.router.navigate(["datalink-preview",e.objectKey],{relativeTo:this.route}),e.objectType===u.lb.View&&this.router.navigate(["view-preview",e.objectKey],{relativeTo:this.route}),e.objectType===u.lb.Dashboard&&this.router.navigate(["dashboard-preview",e.objectKey],{relativeTo:this.route}),e.objectType===u.lb.Api&&this.router.navigate(["api-preview",e.objectKey],{relativeTo:this.route})}},{key:"unshareSelectedTables",value:function(e){var t=e.filter((function(e){return e.objectType===u.lb.Datalink})).map((function(e){return e.objectKey}));t.length>0&&this.hubService.shareItems(t,u.lb.Datalink,!1);var a=e.filter((function(e){return e.objectType===u.lb.Table})).map((function(e){return e.objectKey}));a.length>0&&this.hubService.shareItems(a,u.lb.Table,!1)}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Datalink&&t.changeClass!==u.dc.Table||e.updateSharedData()}))}}]),e}()).\u0275fac=function(e){return new(e||Fn)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Fn.\u0275cmp=b.Eb({type:Fn,selectors:[["sharedData-index"]],decls:11,vars:8,consts:[[1,"container-fluid"],["title","Shared Data","iconClass","fa fa-lg fa-fw fa-newspaper-o",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","filter"],["filter",""],[3,"click"],[1,"mr-1",3,"click"],[3,"click",4,"ngIf"],["buttonClass","btn-primary mr-1","iconClass","fa fa-filter","title","Filter by a purpose",3,"text","pullRight"],["routerLink",".","title","All Items",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Datalinks",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Tables",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Views",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Dashboards",1,"dropdown-item",3,"queryParams"],["routerLink",".","title","Apis",1,"dropdown-item",3,"queryParams"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.preview(e)})),b.Dc(3,gn,1,0,"ng-template",3,4,b.Ec),b.Dc(5,yn,0,0,"ng-template",5,6,b.Ec),b.Dc(7,kn,2,1,"ng-template",7,8,b.Ec),b.Dc(9,xn,13,26,"ng-template",9,10,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!1),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.q,h.h,v.t,h.r,h.i,r.h],encapsulation:2}),Fn),Kn=a("Wz3H"),En=a("47Fv"),Vn=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{s(n.next(e))}catch(t){r(t)}}function c(e){try{s(n.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,c)}s((n=n.apply(e,t||[])).next())}))};function Ln(e,t){}function Pn(e,t){1&e&&b.Lb(0,"actions-table-button",14),2&e&&b.hc("tables",t.items)("refreshTables",!0)}function An(e,t){if(1&e&&b.Lb(0,"datalink-status",15),2&e){var a=t.item;b.hc("tableKey",null==a?null:a.key)}}var Rn=function(e){return{connectionKey:e}};function jn(e,t){if(1&e&&(b.Ob(0,"a",22),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.hc("queryParams",b.mc(2,Rn,a.key)),b.yb(1),b.Gc(a.name)}}function _n(e,t){if(1&e&&(b.Ob(0,"dexih-button-dropdown",20),b.Dc(1,jn,2,4,"a",21),b.ac(2,"equalFilter"),b.Nb()),2&e){var a=b.Zb(2);b.hc("autoCompact",!1)("text",a.connectionName)("pullRight",!0),b.yb(1),b.hc("ngForOf",b.dc(2,4,a.hubCache.hub.dexihConnections,"isValid",!0))}}var Mn=function(e){return{purposeFilter:e}};function Zn(e,t){if(1&e&&(b.Ob(0,"a",23),b.Fc(1),b.Nb()),2&e){var a=t.$implicit,n=b.Zb(2);b.Cb("active",n.purposeFilter==a.key),b.hc("queryParams",b.mc(5,Mn,a.key))("title",a.name),b.yb(1),b.Gc(a.name)}}var Hn=function(){return{purposeFilter:"All"}};function Bn(e,t){if(1&e&&(b.Dc(0,_n,3,8,"dexih-button-dropdown",16),b.Ob(1,"dexih-button-dropdown",17),b.Ob(2,"a",18),b.Fc(3,"All"),b.Nb(),b.Dc(4,Zn,2,7,"a",19),b.ac(5,"gtFilter"),b.Nb()),2&e){var a=b.Zb();b.hc("ngIf",null==a.hubCache?null:a.hubCache.hub),b.yb(1),b.hc("autoCompact",!1)("text",a.eConnectionPurpose[a.purposeFilter])("pullRight",!0),b.yb(1),b.Cb("active","0"==a.purposeFilter),b.hc("queryParams",b.lc(12,Hn)),b.yb(2),b.hc("ngForOf",b.dc(5,8,a.eConnectionPurposeItems,"key",0))}}function Un(e,t){if(1&e&&b.Lb(0,"tags-update-button",24),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.Table)("objects",a)}}function qn(e,t){if(1&e&&b.Lb(0,"dependent-items-button",25),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.Table)}}var zn,Wn,Gn=((Wn=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eConnectionPurposeItems=u.kb,this.eConnectionPurpose=u.jb,this.eSharedObjectType=u.dc,this.columns=[{name:"logicalName",title:"Logical Name",format:"Md",footer:"description",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"tableType",title:"Table Type",format:"Enum",enum:u.ic},{name:"connectionName",title:"Connection",footer:"connectionType",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){return Vn(e,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[2],this.hubCache=t[3],!this.hubCache.isLoaded()){e.next=5;break}return this.purposeFilter=a.purposeFilter,this.purposeFilter||(this.purposeFilter="All"),this.connectionKey=+a.connectionKey,this.connectionKey?(n=this.hubCache.hub.dexihConnections.find((function(e){return e.key===i.connectionKey})))&&(this.connectionName=n.name):this.connectionName="All",e.next=5,this.updateTableData();case 5:case"end":return e.stop()}}),e,this)})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Table Index")}this.watchChanges()}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateTableData",value:function(){var e,t;return Vn(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,r,o,c,s=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.title="Tables ",this.connectionName="All",this.purposeFilter&&"All"!==this.purposeFilter&&(this.title+=": "+u.jb[this.purposeFilter]),!this.hubCache||!this.hubCache.isLoaded()){a.next=31;break}n=[],a.prev=2,i=regeneratorRuntime.mark((function e(){var t,a,i,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.value,a=s.hubCache.hub.dexihConnections.find((function(e){return e.key===t.connectionKey})),e.next=4,s.hubService.GetConnectionReference(a);case 4:i=e.sent,"All"!==s.purposeFilter&&s.purposeFilter&&(!a||a.purpose.toString()!==s.purposeFilter)||s.connectionKey&&t.connectionKey!==s.connectionKey||(o=t.tableType===u.ic.Query?"(Sql Query)":t.schema?t.schema+"."+t.name:t.name,s.hubCache.defaultTableLogicalName(t.schema,t.name)===t.logicalName?t.logicalName:"".concat(t.logicalName," (").concat(t.name,")"),c="",t.logicalName!==t.name&&(c="Name: "+t.name),c&&(c+="<br>"),t.description&&(c+=t.description),n.push({key:t.key,connectionType:a?u.jb[a.purpose]:"undefined",connectionName:a?a.name:"undefined",description:c,tableType:t.tableType,name:o,logicalName:t.logicalName,tags:s.hubCache.getObjectTags(u.dc.Table,t.key),updateDate:t.updateDate,connectionKey:a?a.key:"",isFile:!!i&&i.connectionCategory===u.ib.File,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}));case 6:case"end":return e.stop()}}),e)})),o=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise((function(n,i){!function(e,t,a,n){Promise.resolve(n).then((function(t){e({value:t,done:a})}),t)}(n,i,(t=e[a](t)).done,t.value)}))}}}(this.hubCache.hub.dexihTables);case 5:return a.next=7,o.next();case 7:if((r=a.sent).done){a.next=11;break}return a.delegateYield(i(),"t0",9);case 9:a.next=5;break;case 11:a.next=16;break;case 13:a.prev=13,a.t1=a.catch(2),e={error:a.t1};case 16:if(a.prev=16,a.prev=17,a.t2=r&&!r.done&&(t=o.return),!a.t2){a.next=22;break}return a.next=22,t.call(o);case 22:if(a.prev=22,!e){a.next=25;break}throw e.error;case 25:return a.finish(22);case 26:return a.finish(16);case 27:this.connectionKey&&(c=this.hubCache.hub.dexihConnections.find((function(e){return e.key===s.connectionKey})))&&(this.connectionName=c.name,this.title+=" for connection - "+c.name),this._tableData.next(n),a.next=32;break;case 31:this._tableData.next(null);case 32:case"end":return a.stop()}}),a,this,[[2,13,16,27],[17,,22,26]])})))}},{key:"routeSibling",value:function(e){this.router.navigate(["..",e])}},{key:"editTable",value:function(e){this.router.navigate(["table-edit",e.key],{queryParamsHandling:"merge",relativeTo:this.route.parent})}},{key:"getConnection",value:function(e){return this.hubCache.hub.dexihConnections.find((function(t){return t.key===e}))}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Table&&t.changeClass!==u.dc.TagObjects||e.updateTableData()}))}}]),e}()).\u0275fac=function(e){return new(e||Wn)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Wn.\u0275cmp=b.Eb({type:Wn,selectors:[["table-index"]],decls:16,vars:9,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-table",3,"title","showCloseButton","showIf","close"],["header",""],[3,"enableMultiSelect","columns","dataObservable","tags","enableStickyToolbar","toolbarZIndex","rowClick"],["actions",""],["select","rowStatus"],["rowStatus",""],["select","filter"],["filter",""],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["title","Datalinks","path","/assets/help/reference/table.md",1,"m-3"],[3,"tables","refreshTables"],[3,"tableKey"],["class","mr-1","buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",3,"autoCompact","text","pullRight",4,"ngIf"],["buttonClass","btn btn-primary","iconClass","fa fa-filter","title","Filter by a purpose",1,"mr-1",3,"autoCompact","text","pullRight"],["routerLink",".","title","All Connections",1,"dropdown-item",3,"queryParams"],["class","dropdown-item","routerLink",".",3,"active","queryParams","title",4,"ngFor","ngForOf"],["buttonClass","btn btn-primary","iconClass","fa fa-database","title","Filter by a connection",1,"mr-1",3,"autoCompact","text","pullRight"],["class","dropdown-item","routerLink",".",3,"queryParams",4,"ngFor","ngForOf"],["routerLink",".",1,"dropdown-item",3,"queryParams"],["routerLink",".",1,"dropdown-item",3,"queryParams","title"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,Ln,0,0,"ng-template",null,2,b.Ec),b.Ob(4,"dexih-table",3),b.Vb("rowClick",(function(e){return t.editTable(e)})),b.Dc(5,Pn,1,2,"ng-template",null,4,b.Ec),b.Dc(7,An,1,1,"ng-template",5,6,b.Ec),b.Dc(9,Bn,6,13,"ng-template",7,8,b.Ec),b.Dc(11,Un,1,2,"ng-template",9,10,b.Ec),b.Dc(13,qn,1,2,"ng-template",11,12,b.Ec),b.Nb(),b.Nb(),b.Lb(15,"dexih-help",13),b.Nb()),2&e&&(b.yb(1),b.hc("title",t.title)("showCloseButton",!0)("showIf",null==t.hubCache?null:t.hubCache.hub),b.yb(3),b.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags)("enableStickyToolbar",!0)("toolbarZIndex",100))},directives:[h.P,d.a,$.a,Kn.a,gt.a,v.t,h.i,r.h,v.s,p.a,m.a],pipes:[We.a,En.a],encapsulation:2}),Wn),Qn=((zn=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.eDataObjectType=u.lb,this.title="Preview Table"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.params,this.hubService.getHubCacheObservable(!0)).subscribe((function(t){var a=t[1];e.key=+t[0].tableKey;var n=a.getTable(e.key);n&&(e.title="Preview Table - "+n.logicalName)}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Table Preview Data")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||zn)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.a))},zn.\u0275cmp=b.Eb({type:zn,selectors:[["table-preview-data"]],decls:3,vars:4,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-exchange",3,"title","showCloseButton","close"],[3,"key","viewSource"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Lb(2,"preview-data",2),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("title",t.title)("showCloseButton",!0),b.yb(1),b.hc("key",t.key)("viewSource",t.eDataObjectType.Table))},directives:[h.P,$t.a],encapsulation:2}),zn);function $n(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",7),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().deleteCustomFunctions(e)})),b.Nb()}}function Xn(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",7),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb(),b.Dc(1,$n,1,0,"dexih-button-delete",8),b.Lb(2,"tags-update-button",9)}if(2&e){var n=t.items,i=b.Zb();b.yb(1),b.hc("ngIf",i.hubCache.canWrite),b.yb(1),b.hc("objectType",i.eSharedObjectType.CustomFunction)("objects",n)}}var Yn=function(){return["customFunction-new"]};function Jn(e,t){1&e&&b.Lb(0,"dexih-button-new",11),2&e&&b.hc("routerLink",b.lc(1,Yn))}function ei(e,t){if(1&e&&b.Dc(0,Jn,1,2,"dexih-button-new",10),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite)}}var ti,ai,ni=((ai=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.updateCustomFunctions()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteCustomFunctions",value:function(e){this.hubService.deleteCustomFunctions(e)}},{key:"updateCustomFunctions",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihCustomFunctions.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(u.dc.CustomFunction,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["customFunction-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this,a=this.hubService.createHub(this.hubCache.hub.hubKey,"");e.forEach((function(e){t.hubCache.cacheAddCustomFunction(e.key,a)})),this.hubService.exportHub(a,1===e.length?"CustomFunction - "+e[0].name+".json":"customFunctions.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.CustomFunction&&t.changeClass!==u.dc.TagObjects||e.updateCustomFunctions()}))}}]),e}()).\u0275fac=function(e){return new(e||ai)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},ai.\u0275cmp=b.Eb({type:ai,selectors:[["customFunction"]],inputs:{hubKey:"hubKey"},decls:8,vars:8,consts:[[1,"container-fluid"],["title","Custom Functions","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"ml-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,Xn,3,3,"ng-template",3,4,b.Ec),b.Dc(5,ei,1,1,"ng-template",null,5,b.Ec),b.Nb(),b.Nb(),b.Lb(7,"dexih-help",6),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!1),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,h.u,v.t,p.a,h.g,h.o,r.f],encapsulation:2}),ai),ii=((ti=function(){function e(){_classCallCheck(this,e),this.customFunctionParameterForm=null,this.addParameter=new b.n,this.removeParameter=new b.n,this.eBasicType=x.c,this.typeCodes=x.a,this.ignoreChanges=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){}},{key:"add",value:function(){this.addParameter.emit(this.customFunctionParameterForm)}},{key:"remove",value:function(){this.removeParameter.emit(this.customFunctionParameterForm)}}]),e}()).\u0275fac=function(e){return new(e||ti)},ti.\u0275cmp=b.Eb({type:ti,selectors:[["customFunction-parameter"]],inputs:{customFunctionParameterForm:"customFunctionParameterForm"},outputs:{addParameter:"addParameter",removeParameter:"removeParameter"},decls:15,vars:3,consts:[[1,"mb-1",3,"formGroup"],[1,"input-group"],["type","text","formControlName","name","placeholder","Enter a name for the parameter",1,"form-control"],["formControlName","dataType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],[1,"input-group-append"],[1,"input-group-text","p-0"],[1,"p-1"],["type","number","formControlName","rank",1,"mx-1"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"]],template:function(e,t){1&e&&(b.Ob(0,"form",0),b.Ob(1,"div",1),b.Lb(2,"input",2),b.Lb(3,"form-select",3),b.Ob(4,"div",4),b.Ob(5,"div",5),b.Ob(6,"span",6),b.Fc(7,"Array Dimensions (0-non array)"),b.Nb(),b.Lb(8,"input",7),b.Nb(),b.Ob(9,"div",5),b.Ob(10,"button",8),b.Vb("click",(function(){return t.add()})),b.Lb(11,"i",9),b.Nb(),b.Nb(),b.Ob(12,"div",5),b.Ob(13,"button",10),b.Vb("click",(function(){return t.remove()})),b.Lb(14,"i",11),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.hc("formGroup",t.customFunctionParameterForm),b.yb(3),b.hc("border",!1)("items",t.typeCodes))},directives:[n.I,n.t,n.l,n.c,n.s,n.j,h.E,n.y],encapsulation:2}),ti);function ri(e,t){if(1&e&&b.Lb(0,"save-button",13),2&e){var a=b.Zb(2);b.hc("formsService",a.formsService)}}function oi(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",10),b.Vb("click",(function(){return b.vc(a),b.Zb().formsService.showErrors()})),b.Nb(),b.Dc(1,ri,1,1,"save-button",11),b.Lb(2,"cancel-button",12)}if(2&e){var n=b.Zb();b.hc("control",n.formsService.currentForm),b.yb(1),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("formsService",n.formsService)}}function ci(e,t){if(1&e&&(b.Ob(0,"div"),b.Fc(1),b.Nb()),2&e){var a=b.Zb(3);b.yb(1),b.Hc("Cleaned Value = ",a.testResult.cleanedValue," ")}}function si(e,t){if(1&e&&(b.Ob(0,"div"),b.Fc(1),b.Nb()),2&e){var a=b.Zb(3);b.yb(1),b.Hc("Reject Reason = ",a.testResult.rejectReason," ")}}function li(e,t){if(1&e&&(b.Ob(0,"section"),b.Ob(1,"div",20),b.Fc(2),b.Dc(3,ci,2,1,"div",15),b.Dc(4,si,2,1,"div",15),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.Cb("alert-danger",0==a.testResult.success)("alert-success",1==a.testResult.success),b.yb(1),b.Hc(" Test Result = ",a.testResult.success," "),b.yb(1),b.hc("ngIf",a.testResult.cleanedValue),b.yb(1),b.hc("ngIf",a.testResult.rejectReason)}}function ui(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",24),b.Ob(1,"dexih-button",25),b.Vb("click",(function(){b.vc(a);var e=b.Zb(3);return e.addParameter(null,e.eParameterDirection.Input)})),b.Fc(2,"Add Parameter "),b.Nb(),b.Nb()}}var bi=function(e){return{"z-index":e,position:"relative"}};function hi(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",26),b.Ob(1,"customFunction-parameter",27),b.Vb("addParameter",(function(e){b.vc(a);var t=b.Zb(3);return t.addParameter(e,t.eParameterDirection.Input)}))("removeParameter",(function(e){return b.vc(a),b.Zb(3).removeParameter(e)})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit;b.hc("ngStyle",b.mc(2,bi,200-t.index)),b.yb(1),b.hc("customFunctionParameterForm",n)}}function di(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div"),b.Ob(1,"dexih-button",25),b.Vb("click",(function(){b.vc(a);var e=b.Zb(4);return e.addParameter(null,e.eParameterDirection.Output)})),b.Fc(2,"Add Parameter"),b.Nb(),b.Nb()}}function fi(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",26),b.Ob(1,"customFunction-parameter",27),b.Vb("addParameter",(function(e){b.vc(a);var t=b.Zb(4);return t.addParameter(e,t.eParameterDirection.Output)}))("removeParameter",(function(e){return b.vc(a),b.Zb(4).removeParameter(e)})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit;b.hc("ngStyle",b.mc(2,bi,100-t.index)),b.yb(1),b.hc("customFunctionParameterForm",n)}}var mi=function(){return{"z-index":101,position:"relative"}};function vi(e,t){if(1&e&&(b.Ob(0,"div"),b.Ob(1,"div",21),b.Fc(2," Output Parameters "),b.Nb(),b.Ob(3,"div",26),b.Ob(4,"section"),b.Ob(5,"div",28),b.Lb(6,"input",29),b.Lb(7,"form-select",30),b.Nb(),b.Nb(),b.Dc(8,di,3,0,"div",15),b.Dc(9,fi,2,4,"div",7),b.Nb(),b.Lb(10,"br"),b.Nb()),2&e){var a=b.Zb(3);b.yb(3),b.hc("ngStyle",b.lc(5,mi)),b.yb(4),b.hc("border",!1)("items",a.typeCodes),b.yb(1),b.hc("ngIf",0===a.outputParameters.length),b.yb(1),b.hc("ngForOf",a.outputParameters)}}function pi(e,t){if(1&e&&(b.Ob(0,"div"),b.Ob(1,"div",21),b.Fc(2," Input Parameters "),b.Nb(),b.Dc(3,ui,3,0,"div",22),b.Dc(4,hi,2,4,"div",7),b.Nb(),b.Dc(5,vi,11,6,"div",15),b.Fc(6," Function Code "),b.Lb(7,"textarea",23)),2&e){var a=b.Zb(2);b.yb(3),b.hc("ngIf",0===a.inputParameters.length),b.yb(1),b.hc("ngForOf",a.inputParameters),b.yb(1),b.hc("ngIf",a.functionType!=a.eFunctionType.Condition)}}function gi(e,t){if(1&e&&(b.Ob(0,"form",14),b.Ob(1,"fieldset"),b.Dc(2,li,5,7,"section",15),b.Ob(3,"section"),b.Lb(4,"form-select",16),b.Nb(),b.Ob(5,"section"),b.Lb(6,"form-input",17),b.Nb(),b.Ob(7,"section"),b.Lb(8,"form-textarea",18),b.Nb(),b.Dc(9,pi,8,3,"ng-template",19),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.formsService.currentForm),b.yb(2),b.hc("ngIf",a.testResult),b.yb(2),b.hc("items",a.functionTypes),b.yb(2),b.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),b.yb(2),b.hc("showMarkdown",!0),b.yb(1),b.hc("ngIf",a.functionType)}}function yi(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",31),b.Vb("click",(function(){return b.vc(a),b.Zb().test()})),b.Fc(1,"Syntax Check"),b.Nb(),b.Ob(2,"dexih-button",31),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return e.test(e.inputParameterValues)})),b.Fc(3,"Run"),b.Nb(),b.Ob(4,"dexih-button-save-local",32),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return e.downloadCode(e.inputParameterValues)})),b.Nb()}}function Ci(e,t){1&e&&(b.Ob(0,"div",33),b.Fc(1," Input Parameters "),b.Nb())}function ki(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div"),b.Ob(1,"div",37),b.Ob(2,"div",38),b.Fc(3),b.Nb(),b.Ob(4,"form-input",39),b.Vb("ngModelChange",(function(e){b.vc(a);var n=t.index,i=b.Zb(2).index;return b.Zb().inputParameterValues[i][n]=e})),b.Nb(),b.Ob(5,"div",40),b.Ob(6,"button",41),b.Vb("click",(function(){b.vc(a);var e=t.index,n=b.Zb(2).index;return b.Zb().addParameterValue(n,e)})),b.Lb(7,"i",42),b.Nb(),b.Nb(),b.Ob(8,"div",40),b.Ob(9,"button",43),b.Vb("click",(function(){b.vc(a);var e=t.index,n=b.Zb(2).index;return b.Zb().removeParameterValue(n,e)})),b.Lb(10,"i",44),b.Nb(),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=t.index,i=b.Zb(2),r=i.$implicit,o=i.index,c=b.Zb();b.yb(3),b.Hc(" ",r.controls.name.value+"["+n+"]"," "),b.yb(1),b.hc("border",!1)("ngModel",c.inputParameterValues[o][n])("name","inputParameterValues-"+o+"-"+n)}}function wi(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div"),b.Ob(1,"div"),b.Ob(2,"dexih-button",25),b.Vb("click",(function(){b.vc(a);var e=b.Zb().index;return b.Zb().addParameterValue(e)})),b.Fc(3),b.Nb(),b.Nb(),b.Dc(4,ki,11,4,"div",36),b.Nb()}if(2&e){var n=b.Zb(),i=n.$implicit,r=n.index,o=b.Zb();b.yb(3),b.Hc(" Add ",i.controls.name.value," value "),b.yb(1),b.hc("ngForOf",o.inputParameterValues[r])}}function Si(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form-input",45),b.Vb("ngModelChange",(function(e){b.vc(a);var t=b.Zb().index;return b.Zb().inputParameterValues[t]=e})),b.Nb()}if(2&e){var n=b.Zb(),i=n.$implicit,r=n.index,o=b.Zb();b.hc("label",i.controls.name.value)("ngModel",o.inputParameterValues[r])("name","inputParameterValues"+r)}}function Oi(e,t){if(1&e&&(b.Ob(0,"div",26),b.Dc(1,wi,5,2,"div",34),b.Dc(2,Si,1,3,"ng-template",null,35,b.Ec),b.Nb()),2&e){var a=t.$implicit,n=t.index,i=b.sc(3);b.hc("ngStyle",b.mc(3,bi,200-n)),b.yb(1),b.hc("ngIf",a.controls.rank.value>0)("ngIfElse",i)}}function Ni(e,t){1&e&&(b.Ob(0,"div",33),b.Fc(1," Outputs Parameters "),b.Nb())}function Ti(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",26),b.Ob(1,"form-input",46),b.Vb("ngModelChange",(function(e){b.vc(a);var n=t.index;return b.Zb().outputParameterValues[n]=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit,i=t.index,r=b.Zb();b.hc("ngStyle",b.mc(5,bi,200-i)),b.yb(1),b.hc("disabled",!0)("label",n.controls.name.value)("ngModel",r.outputParameterValues[i])("name","outputParameterValues"+i)}}var Di,xi=((Di=function(){function e(t,a,n,i,r,o){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.location=o,this.typeCodes=x.a,this.eParameterDirection=u.Vb,this.outputParameters=[],this.inputParameters=[],this.outputParameterValues=[],this.inputParameterValues=[],this.functionTypes=x.d,this.eFunctionType=u.Cb,this.lookupColumnValue="",this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===T.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Column Validation")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._functionTypeSubscription&&this._functionTypeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,"edit"===this.action)if(this.customFunctionKey=+this.params.customFunctionKey,this.customFunctionKey)if(this.hubCache.hub&&this.hubCache.hub.dexihCustomFunctions){var t=this.hubCache.hub.dexihCustomFunctions.find((function(t){return t.key===e.customFunctionKey}));this.formsService.customFunction(t),this.functionType=this.formsService.currentForm.controls.functionType.value}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no custom function specified to edit.");if("new"===this.action){var a=new u.g;a.key=this.hubCache.getNextSequence(),this.formsService.customFunction(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a>=0&&history.pushState){var n=window.location.pathname.replace("/customFunction-new","/customFunction-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}})),this.functionType=this.formsService.currentForm.controls.functionType.value}this._functionTypeSubscription=this.formsService.currentForm.controls.functionType.valueChanges.subscribe((function(t){e.functionType=t,e.functionType!==u.Cb.Condition&&e.functionType!==u.Cb.JoinCondition&&e.functionType!==u.Cb.Validate||(e.formsService.currentForm.controls.returnType.setValue(u.pc.Boolean),e.updateParameters())})),this.updateParameters()}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.currentForm&&!e.formsService.currentForm.pristine?e.authService.confirmDialog("Function has changed","The function has changed.  Would you like to discard the changes and return to the previous screen?").then((function(e){t(e)})).catch((function(e){t(!1)})):t(!0)}))}},{key:"parametersArray",value:function(){return this.formsService.currentForm.controls.dexihCustomFunctionParameters}},{key:"updateParameters",value:function(){var e=this.parametersArray();this.inputParameters=e.controls.sort((function(e,t){return e.value.position-t.value.position})).filter((function(e){return e.value.direction===u.Vb.Input})),this.outputParameters=e.controls.sort((function(e,t){return e.value.position-t.value.position})).filter((function(e){return e.value.direction===u.Vb.Output})),this.inputParameterValues.length=this.inputParameters.length,this.outputParameterValues.length=this.outputParameters.length}},{key:"addParameter",value:function(e,t){try{var a=new u.h;if(e){var n=e.value;a.dataType=n.dataType,a.name=n.name,a.position=n.position+1}a.key=this.hubCache.getNextSequence(),a.name="",a.direction=t,a.rank=0,a.isValid=!0;var i=this.parametersArray(),r=this.formsService.customFunctionParametersFormGroup(a);i.push(r),i.controls.sort((function(e,t){return e.value.position-t.value.position})).forEach((function(e,t){e.controls.position.setValue(10*t)})),this.updateParameters()}catch(o){this.hubService.addHubClientErrorMessage(o,"Edit Custom Function, add parameter")}}},{key:"addParameterValue",value:function(e,t){Array.isArray(this.inputParameterValues[e])?this.inputParameterValues[e].splice(t+1,0,""):this.inputParameterValues[e]=new Array(1)}},{key:"removeParameterValue",value:function(e,t){this.inputParameterValues[e].splice(t,1)}},{key:"removeParameter",value:function(e){try{var t=this.parametersArray(),a=t.controls.indexOf(e);a>-1&&t.removeAt(a),this.updateParameters()}catch(n){this.hubService.addHubClientErrorMessage(n,"Edit Custom Function, remove parameter")}}},{key:"downloadCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.createDataTransformItem();this.hubService.downloadCustomFunction(t,e)}},{key:"test",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.createDataTransformItem();this.hubService.testCustomFunction(a,t,this.cancelToken).then((function(t){e.syntaxMessage=new F.e(!0,"The function has successfully compiled.",null,null),t&&t.length>0?t.forEach((function(t,a){0===a?e.returnParameterValue=t:e.outputParameterValues[a-1]=t})):(e.returnParameterValue=null,e.outputParameterValues.forEach((function(e){return null})))})).catch((function(t){var a=t;t.stack&&(a=new F.e(!1,"Client Error: "+t.message,t.stack,"")),e.syntaxMessage=a,e.returnParameterValue=null,e.outputParameterValues.forEach((function(e){return null}))}))}},{key:"createDataTransformItem",value:function(){var e=this.formsService.currentForm.value,t=new u.x;t.functionCode=e.methodCode,t.functionResultCode=e.resultCode,t.transformItemType=u.kc.CustomFunction;var a=[];e.dexihCustomFunctionParameters.sort((function(e,t){return e.position-t.position})).forEach((function(e,t){if(e){var n=new u.A;n.key=0,n.datalinkTransformItemKey=0,n.name=e.name,n.rank=e.rank,n.direction=e.direction,n.dataType=e.dataType,n.position=t,n.isValid=!0,a.push(n)}}));var n=new u.A;return n.key=0,n.datalinkTransformItemKey=0,n.name="Return",n.rank=0,n.direction=u.Vb.ReturnValue,n.dataType=e.returnType,n.position=0,n.isValid=!0,a.push(n),t.dexihFunctionParameters=a,t}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Di)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e),b.Kb(v.n))},Di.\u0275cmp=b.Eb({type:Di,selectors:[["dexih-customFunction-edit-form"]],features:[b.xb([D.a])],decls:19,vars:11,consts:[[1,"container"],["title","Edit Function","iconClass","fa fa-lg fa-fw fa-code",3,"showCloseButton","padding","close"],["header",""],[3,"formGroup",4,"ngIf"],["title","Test Function","iconClass","fa fa-lg fa-fw fa-code",3,"padding"],[3,"message"],["class","label",4,"ngIf"],[3,"ngStyle",4,"ngFor","ngForOf"],["label","Return Value","name","returnParameterValue","type","text",3,"disabled","ngModel","ngModelChange"],["title","Custom Functions","path","/assets/help/reference/function.md",1,"m-3"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],[4,"ngIf"],["label","Function Type","formControlName","functionType","itemKey","key","itemName","name","iconClass","fa fa-question",3,"items"],["label","Custom Function Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[3,"ngIf"],[1,"alert"],[1,"label","mb-1"],["class","mb-1",4,"ngIf"],["rows","20","width","100%","spellcheck","false","formControlName","methodCode",1,"form-control"],[1,"mb-1"],["iconClass","fa fa-plus-square-o","title","Click to add a parameter",3,"click"],[3,"ngStyle"],[3,"customFunctionParameterForm","addParameter","removeParameter"],[1,"input-group","mb-1"],["readonly","","value","Return Data Type",1,"form-control"],["formControlName","returnType","itemKey","key","itemName","name",1,"form-control","p-0",3,"border","items"],["buttonClass","btn btn-success",1,"mr-1",3,"click"],["text","Sample Code",3,"click"],[1,"label"],[4,"ngIf","ngIfElse"],["showValue",""],[4,"ngFor","ngForOf"],[1,"input-group"],[1,"form-control"],["type","text","placeholder","Enter a test value for the parameter",1,"form-control","p-0",3,"border","ngModel","name","ngModelChange"],[1,"input-group-text","p-0"],["type","button","value","Add",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-sm","border-0","bg-transparent",3,"click"],[1,"fa","fa-minus-square-o"],["type","text","placeholder","Enter a test value for the parameter",3,"label","ngModel","name","ngModelChange"],["type","text",3,"disabled","label","ngModel","name","ngModelChange"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget-vertical"),b.Ob(2,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(3,oi,3,3,"ng-template",null,2,b.Ec),b.Dc(5,gi,10,7,"form",3),b.Nb(),b.Ob(6,"dexih-widget",4),b.Dc(7,yi,5,0,"ng-template",null,2,b.Ec),b.Lb(9,"dexih-message",5),b.Ob(10,"form"),b.Ob(11,"fieldset"),b.Ob(12,"div"),b.Dc(13,Ci,2,0,"div",6),b.Dc(14,Oi,4,5,"div",7),b.Ob(15,"form-input",8),b.Vb("ngModelChange",(function(e){return t.returnParameterValue=e})),b.Nb(),b.Dc(16,Ni,2,0,"div",6),b.Dc(17,Ti,2,7,"div",7),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Lb(18,"dexih-help",9),b.Nb(),b.Nb()),2&e&&(b.yb(2),b.hc("showCloseButton",!0)("padding",!0),b.yb(3),b.hc("ngIf",t.formsService.currentForm),b.yb(1),b.hc("padding",!0),b.yb(3),b.hc("message",t.syntaxMessage),b.yb(4),b.hc("ngIf",t.inputParameters.length>0),b.yb(1),b.hc("ngForOf",t.inputParameters),b.yb(1),b.hc("disabled",!0)("ngModel",t.returnParameterValue),b.yb(1),b.hc("ngIf",t.outputParameters.length>0),b.yb(1),b.hc("ngForOf",t.outputParameters))},directives:[h.S,h.P,v.t,Ba.a,n.I,n.t,n.u,v.s,h.D,n.s,n.v,$.a,K.a,I.a,E.a,n.l,h.E,n.j,h.H,n.c,h.f,v.w,ii,h.u],encapsulation:2}),Di),Fi=a("bK5D"),Ii=a("crXl");function Ki(e,t){if(1&e&&b.Lb(0,"dependent-items-button",11),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.DatalinkTest)}}function Ei(e,t){if(1&e&&b.Lb(0,"tags-update-button",12),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.DatalinkTest)("objects",a)}}function Vi(e,t){1&e&&b.Lb(0,"actions-datalinkTest-button",13),2&e&&b.hc("datalinkTests",t.items)}function Li(e,t){if(1&e&&b.Lb(0,"datalink-status",14),2&e){var a=t.item;b.hc("datalinkTestKey",null==a?null:a.key)}}var Pi,Ai=((Pi=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.cancelToken=new F.a,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"description",title:"Description",format:""},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Tests Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteDatalinkTests(e)}},{key:"snapshot",value:function(e){this.hubService.runDatalinkTestSnapshot(e,this.cancelToken)}},{key:"run",value:function(e){var t=e.map((function(e){return e.key}));this.hubService.runDatalinkTests(t,this.cancelToken)}},{key:"update",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDatalinkTests.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(u.dc.DatalinkTest,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["datalinkTest-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubService.createHub(this.hubCache.hub.hubKey,"");t.dexihDatalinkTests=e,this.hubService.exportHub(t,"datalink_tests.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.DatalinkTest&&t.changeClass!==u.dc.TagObjects||e.update()}))}}]),e}()).\u0275fac=function(e){return new(e||Pi)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Pi.\u0275cmp=b.Eb({type:Pi,selectors:[["datalink-test"]],decls:12,vars:5,consts:[[1,"container-fluid"],["title","Datalink Tests","iconClass","fa fa-lg fa-fw fa-flag-checkered",3,"showCloseButton","close"],[3,"enableMultiSelect","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Datalink Test","path","/assets/help/reference/datalinkTest.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"datalinkTests"],[3,"datalinkTestKey"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,Ki,1,2,"ng-template",3,4,b.Ec),b.Dc(5,Ei,1,2,"ng-template",5,6,b.Ec),b.Dc(7,Vi,1,1,"ng-template",null,7,b.Ec),b.Dc(9,Li,1,1,"ng-template",8,9,b.Ec),b.Nb(),b.Nb(),b.Lb(11,"dexih-help",10),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,p.a,Ii.a,gt.a],encapsulation:2}),Pi);function Ri(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save",5),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return!e.saving&&e.save()})),b.Nb(),b.Ob(1,"dexih-button-cancel",6),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return!e.saving&&e.cancel()})),b.Nb()}if(2&e){var n=b.Zb();b.hc("busy",n.saving),b.yb(1),b.hc("busy",n.saving)}}function ji(e,t){if(1&e&&(b.Ob(0,"span",10),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.yb(1),b.Hc(" ",a.name," ")}}function _i(e,t){if(1&e&&(b.Ob(0,"label",7),b.Fc(1,"Create automatic tests for the following datalink(s):"),b.Nb(),b.Ob(2,"div"),b.Ob(3,"div",8),b.Dc(4,ji,2,1,"span",9),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.yb(4),b.hc("ngForOf",a.sourceDatalinks)}}function Mi(e,t){if(1&e&&b.Lb(0,"form-input",21),2&e){var a=b.Zb(2);b.hc("errors",a.formErrors.name)}}function Zi(e,t){1&e&&b.Lb(0,"form-input",22)}function Hi(e,t){if(1&e&&(b.Ob(0,"form",11),b.Ob(1,"fieldset"),b.Ob(2,"div",12),b.Ob(3,"section",13),b.Dc(4,Mi,1,1,"form-input",14),b.Dc(5,Zi,1,0,"form-input",15),b.Nb(),b.Ob(6,"section",13),b.Lb(7,"form-select",16),b.Nb(),b.Nb(),b.Ob(8,"div",12),b.Ob(9,"section",13),b.Lb(10,"form-select",17),b.Nb(),b.Ob(11,"section",13),b.Lb(12,"form-select",18),b.Nb(),b.Nb(),b.Nb(),b.Ob(13,"fieldset"),b.Ob(14,"section"),b.Ob(15,"div",12),b.Ob(16,"section",19),b.Lb(17,"form-checkbox",20),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.mainForm),b.yb(4),b.hc("ngIf",1==a.sourceDatalinks.length),b.yb(1),b.hc("ngIf",a.sourceDatalinks.length>1),b.yb(2),b.hc("items",a.hubCache.hub.dexihConnections)("errors",a.formErrors.auditConnectionKey),b.yb(3),b.hc("items",a.managedConnections)("errors",a.formErrors.sourceConnectionKey)("allowNullSelect",!0),b.yb(2),b.hc("items",a.managedConnections)("errors",a.formErrors.targetConnectionKey)("allowNullSelect",!0)}}var Bi,Ui=((Bi=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.route=a,this.router=n,this.location=i,this.fb=r,this.cancelToken=new F.a,this.hasChanged=!1,this.showAllErrors=!1,this.saving=!1,this.formErrors={name:"",auditConnectionKey:"",sourceConnectionKey:"",targetConnectionKey:"",snapshotData:""},this.validationMessages={name:{required:"Name is required.",minlength:"Name must be at least 4 characters long.",maxlength:"Name cannot be more than 50 characters long."},auditConnectionKey:{},targetConnectionKey:{},sourceConnectionKey:{},snapshotData:{}}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[1];if(e.hubCache=t[2],e.managedConnections=e.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===u.jb.Managed})),e.hubCache.status===T.j.Loaded){var n=a.datalinkKeys;if(e.sourceDatalinkKeys=new Array,e.sourceDatalinks=new Array,n&&e.hubCache.hub.dexihConnections){var i=n.split("|");e.hubCache.hub.dexihDatalinks.forEach((function(t){i.findIndex((function(e){return e===t.key.toString()}))>=0&&(e.sourceDatalinkKeys.push(t.key),e.sourceDatalinks.push(t))}))}var r=e.hubCache.hub.dexihConnections.find((function(e){return e.purpose===u.jb.Managed}));r&&(e.targetConnectionKey=r.key),e.sourceConnectionKey=e.targetConnectionKey,e.auditConnectionKey=e.targetConnectionKey,e.buildForm()}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink New")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"buildForm",value:function(){var e=this;this.mainForm=this.fb.group({name:[this.name,[]],auditConnectionKey:[this.auditConnectionKey>0?this.auditConnectionKey:null,[]],targetConnectionKey:[this.targetConnectionKey>0?this.targetConnectionKey:null,[]],sourceConnectionKey:[this.sourceConnectionKey>0?this.sourceConnectionKey:null,[]],snapshotData:[!0,[]]}),this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe(),this._valueChangesSubscription=this.mainForm.valueChanges.subscribe((function(t){return e.onValueChanged(t)})),this.onValueChanged(),this.hasChanged=!1}},{key:"onValueChanged",value:function(e){if(this.mainForm){var t=this.mainForm;this.hasChanged=!0;for(var a=0,n=Object.keys(this.formErrors);a<n.length;a++){var i=n[a];this.formErrors[i]="";var r=t.get(i);if(r&&(r.dirty||this.showAllErrors)&&!r.valid)for(var o=this.validationMessages[i],c=0,s=Object.keys(r.errors);c<s.length;c++){var l=s[c];this.formErrors[i]+=o[l]+" "}}}}},{key:"save",value:function(){var e=this;if(this.mainForm.valid){var t=this.mainForm.value;this.saving=!0,this.hubService.newDatalinkTest(this.name,this.sourceDatalinkKeys,t.auditConnectionKey,t.targetConnectionKey,t.sourceConnectionKey).then((function(a){return n=e,r=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.snapshotData,!e.t0){e.next=4;break}return e.next=4,this.hubService.runDatalinkTestSnapshot([a],this.cancelToken);case 4:this.router.navigate(["/hub",this.hubCache.hub.hubKey,"datalinkTests","datalinkTest-edit",a.key],{relativeTo:this.route.root});case 5:case"end":return e.stop()}}),e,this)})),new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{c(r.next(e))}catch(a){t(a)}}function o(e){try{c(r.throw(e))}catch(a){t(a)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,o)}c((r=r.apply(n,[])).next())}));var n,i,r})).catch((function(t){e.saving=!1}))}else this.showAllErrors=!0,this.onValueChanged()}},{key:"cancel",value:function(){this.location.back()}}]),e}()).\u0275fac=function(e){return new(e||Bi)(b.Kb(o.a),b.Kb(r.a),b.Kb(r.e),b.Kb(v.n),b.Kb(n.g))},Bi.\u0275cmp=b.Eb({type:Bi,selectors:[["dexih-datalinkTest-new-form"]],decls:7,vars:3,consts:[[1,"container"],["title","New Datalink Test(s)","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[3,"formGroup",4,"ngIf"],[1,"mr-1",3,"busy","click"],[3,"busy","click"],[1,"label"],[1,"list-group","d-inline-block"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors",4,"ngIf"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment",4,"ngIf"],["label","Audit Connection","formControlName","auditConnectionKey","itemKey","key","itemName","name","iconClass","fa fa-database","note","Connection where test results are stored.",3,"items","errors"],["formControlName","sourceConnectionKey","label","Input Connection","itemKey","key","itemName","name","note","Specify the connection to use for any datalink source data.","selectNullMessage","No source table",3,"items","errors","allowNullSelect"],["formControlName","targetConnectionKey","label","Target Connection","itemKey","key","itemName","name","note","Specify the connection for target data.","selectNullMessage","No target table",3,"items","errors","allowNullSelect"],[1,"col","col-11"],["label","Snapshot and copy current source/target data into the test connections.","formControlName","snapshotData","name","snapshotData"],["label","Test Name","formControlName","name","placeholder","Test name (leave blank for auto naming)","iconClass","fa fa-comment",3,"errors"],["disabled","","label","Test Name","placeholder","Test name can not be specified when creating multiple tests.","iconClass","fa fa-comment"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return!t.saving&&t.cancel()})),b.Dc(2,Ri,2,2,"ng-template",null,2,b.Ec),b.Dc(4,_i,5,1,"ng-template",null,3,b.Ec),b.Dc(6,Hi,18,11,"form",4),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(5),b.hc("ngIf",t.sourceDatalinkKeys))},directives:[h.P,v.t,h.t,h.b,v.s,n.I,n.t,n.l,h.E,n.s,n.j,h.A,h.D],encapsulation:2}),Bi),qi=a("MbvK"),zi=a("ynzd"),Wi=a("XNiG"),Gi=a("VRyK"),Qi=a("Z+eP"),$i=a("RXlv"),Xi=a("79jk"),Yi=a("+F4M"),Ji=a("hJJo"),er=a("YcGA");function tr(e,t){if(1&e&&b.Lb(0,"save-button",16),2&e){var a=b.Zb(2);b.hc("formsService",a.formsService)}}function ar(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",12),b.Vb("click",(function(){return b.vc(a),b.Zb().formsService.showErrors()})),b.Nb(),b.Ob(1,"download-button",13),b.Vb("download",(function(e){return b.vc(a),b.Zb().download(e)})),b.Nb(),b.Dc(2,tr,1,1,"save-button",14),b.Lb(3,"cancel-button",15)}if(2&e){var n=b.Zb();b.hc("control",n.formsService.currentForm),b.yb(2),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("formsService",n.formsService)}}function nr(e,t){if(1&e&&(b.Ob(0,"section",21),b.Ob(1,"form-select",28),b.Lb(2,"table-edit-button",29),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),b.yb(1),b.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function ir(e,t){if(1&e&&(b.Ob(0,"section",21),b.Ob(1,"form-select",30),b.Lb(2,"datalink-edit-button",29),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("errors",null==a.errors?null:a.errors.sourceDatalinkKey)("items",a.datalinks),b.yb(1),b.hc("key",a.formsService.currentForm.controls.sourceDatalinkKey.value)}}function rr(e,t){if(1&e&&(b.Ob(0,"form",17),b.Ob(1,"fieldset"),b.Ob(2,"section"),b.Lb(3,"form-input",18),b.Nb(),b.Ob(4,"section"),b.Lb(5,"form-textarea",19),b.Nb(),b.Ob(6,"section"),b.Ob(7,"div",20),b.Ob(8,"section",21),b.Lb(9,"form-checkbox",22),b.Nb(),b.Ob(10,"section",21),b.Lb(11,"form-input",23),b.Nb(),b.Nb(),b.Nb(),b.Ob(12,"section"),b.Ob(13,"div",20),b.Ob(14,"section",21),b.Lb(15,"form-checkbox",24),b.Nb(),b.Ob(16,"section",21),b.Lb(17,"form-time",25),b.Nb(),b.Nb(),b.Nb(),b.Ob(18,"section"),b.Ob(19,"div",20),b.Ob(20,"section",21),b.Lb(21,"form-select",26),b.Nb(),b.Dc(22,nr,3,3,"section",27),b.Dc(23,ir,3,3,"section",27),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.formsService.currentForm),b.yb(3),b.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),b.yb(2),b.hc("showMarkdown",!0),b.yb(6),b.hc("errors",a.formsService.formErrors.logDirectory),b.yb(6),b.hc("errors",a.formsService.formErrors.resetCacheInterval),b.yb(4),b.hc("items",a.sourceTypes)("enableFilter",!1),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eSourceType.Table),b.yb(1),b.hc("ngIf",a.formsService.currentForm.value.sourceType==a.eSourceType.Datalink)}}function or(e,t){if(1&e&&(b.Ob(0,"dexih-widget-section",31),b.Lb(1,"input-parameters",32),b.Nb()),2&e){var a=b.Zb();b.hc("showExpandButton",!0)("padding",!0),b.yb(1),b.hc("showEdit",!0)("parameters",a.formsService.currentForm.controls.parameters)("formsService",a.formsService)}}function cr(e,t){if(1&e){var a=b.Pb();b.Ob(0,"span",35),b.Ob(1,"div",36),b.Ob(2,"div",37),b.Fc(3),b.Nb(),b.Nb(),b.Ob(4,"form-input",38),b.Vb("ngModelChange",(function(e){return b.vc(a),t.$implicit.value=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit,i=t.index;b.yb(3),b.Hc(" ",n.logicalName," "),b.yb(1),b.jc("name","column",i,""),b.hc("placeholder","Enter "+n.logicalName)("ngModel",n.value)}}function sr(e,t){if(1&e&&(b.Ob(0,"div",33),b.Dc(1,cr,5,4,"span",34),b.Nb()),2&e){var a=b.Zb();b.yb(1),b.hc("ngForOf",a.inputColumns)}}function lr(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-refresh",39),b.Vb("click",(function(){return b.vc(a),b.Zb().refresh()})),b.Nb()}}var ur,br=((ur=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.refreshDataSubject=new Wi.a,this.sourceTypes=[{key:u.gc.Datalink,name:"Datalink"},{key:u.gc.Table,name:"Table"}],this.eSourceType=u.gc,this.connectionTables=[],this.datalinks=[],this.selectQuery=new u.V,this.data=[],this.isLoaded=!1,this.cancelToken=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.params=t[1],e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache&&e.hubCache.status===T.j.Loaded&&(e.hubCache&&e.hubCache.isLoaded()&&(e.connectionTables=e.hubCache.getConnectionTables(),e.datalinks=e.hubCache.hub.dexihDatalinks),(!e.isLoaded||"new"!==e.action)&&(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load(),e.hubCache.isLoaded()))){if(!e.hubCache||e.hubCache.status!==T.j.Loaded||e.isLoaded)return;e.isLoaded=!0}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Api Edit")}}},{key:"load",value:function(){var e=this;if("edit"===this.action)if(this.apiKey=+this.params.apiKey,this.apiKey)if(this.hubCache.hub&&this.hubCache.hub.dexihApis){var t=this.hubCache.hub.dexihApis.find((function(t){return t.key===e.apiKey}));this.selectQuery=t.selectQuery,this.selectQuery||(this.selectQuery=new u.V),this.formsService.api(t),this.watchChanges(),this.getColumns()}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no api specified to edit.");if("new"===this.action){var a=new u.d;this.formsService.api(a),this.watchChanges(),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/api-new","/api-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}}},{key:"watchChanges",value:function(){var e=this;this._changesSubscription&&this._changesSubscription.unsubscribe(),this._changesSubscription=Object(Gi.a)(this.formsService.currentForm.controls.sourceDatalinkKey.valueChanges,this.formsService.currentForm.controls.sourceTableKey.valueChanges).subscribe((function(){e.reset(),e.selectQuery=new u.V,e.getColumns()}))}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._changesSubscription&&this._changesSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"getColumns",value:function(){var e=this.formsService.currentForm;if(e.controls.sourceType.value===u.gc.Table&&e.controls.sourceTableKey.value>0){var t=this.hubCache.getTable(e.controls.sourceTableKey.value);if(t)return this.tableColumns=t.dexihTableColumns,void(this.inputColumns=this.getInputColumns(t.dexihTableColumns));this.reset()}else this.reset();if(e.controls.sourceType.value===u.gc.Datalink&&e.controls.sourceDatalinkKey.value>0){var a=this.datalinks.find((function(t){return t.key===e.controls.sourceDatalinkKey.value}));if(a){var n=new Qi.b;n.buildInputOutput(this.hubCache,a),this.tableColumns=n.getDatalinkOutputColumns(a),this.inputColumns=this.getInputColumns(a.sourceDatalinkTable.dexihDatalinkColumns)}else this.reset()}else this.reset()}},{key:"getInputColumns",value:function(e){return e.filter((function(e){return e.isInput})).map((function(e){return{name:e.name,logicalName:e.logicalName,dataType:e.dataType,rank:e.rank,value:e.defaultValue}}))}},{key:"reset",value:function(){this.tableColumns=[],this.inputColumns=[],this.columns=null,this.data=null}},{key:"refresh",value:function(){var e=this,t=this.formsService.currentForm;t.controls.sourceType.value===u.gc.Datalink&&this.hubService.previewDatalinkKeyData(t.controls.sourceDatalinkKey.value,!1,this.selectQuery,this.inputColumns,t.controls.parameters.value,this.cancelToken).then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.data=t.data})).catch((function(){})),t.controls.sourceType.value===u.gc.Table&&this.hubService.previewTableKeyData(t.controls.sourceTableKey.value,!1,this.selectQuery,this.inputColumns,t.controls.parameters.value,this.cancelToken).then((function(t){e.columns=t.columns,e.data=t.data})).catch((function(){}))}},{key:"download",value:function(e){var t=this.formsService.currentForm.value,a=new u.M;t.sourceType===u.gc.Table&&(a.objectKey=t.sourceDatalinkKey,a.objectType=u.lb.Datalink),t.sourceType===u.gc.Table&&(a.objectKey=t.sourceTableKey,a.objectType=u.lb.Table),a.query=this.selectQuery,this.hubService.downloadData([a],!1,e,this.cancelToken)}},{key:"canDeactivate",value:function(){var e=this;return new Promise((function(t){e.formsService.hasChanged?e.authService.confirmDialog("The api has not been saved","The api changes have not been saved.  Do you want to discard the changes and exit?").then((function(e){t(e)})).catch((function(){t(!1)})):t(!0)}))}},{key:"unloadNotification",value:function(e){this.formsService.hasChanged&&(e.returnValue="The api changes have not been saved.  Do you want to discard the changes and exit?")}}]),e}()).\u0275fac=function(e){return new(e||ur)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e))},ur.\u0275cmp=b.Eb({type:ur,selectors:[["dexih-api-edit-form"]],hostBindings:function(e,t){1&e&&b.Vb("beforeunload",(function(e){return t.unloadNotification(e)}),!1,b.uc)},features:[b.xb([D.a])],decls:17,vars:16,consts:[[1,"container"],["title","Edit API","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","padding","close"],["header",""],["title","Properties",3,"showExpandButton"],[3,"formGroup",4,"ngIf"],["title","Parameters",3,"showExpandButton","padding",4,"ngIf"],["title","Data",3,"showExpandButton"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","onRefreshData"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"mr-1",3,"control","click"],[1,"mr-1",3,"download"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],[3,"formGroup"],["label","Api Name","formControlName","name","placeholder","Enter the api name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Auto Start","formControlName","autoStart","note","Re-start the API when the remote agent is restarted."],["label","Log Directory","formControlName","logDirectory","placeholder","Enter a directory to log api updates.","iconClass","fa fa-list","note","Directory to create detailed logs of API calls.  Leave blank to exclude file logging.",3,"errors"],["label","Cache Queries","formControlName","cacheQueries","note","Cache API called to improve performance"],["label","Reset Cache Interval","formControlName","cacheResetInterval","note","The interval to reset the cache (forcing a reload of new data).",3,"errors"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],["title","Parameters",3,"showExpandButton","padding"],[3,"showEdit","parameters","formsService"],[1,"d-flex","flex-wrap","pt-1"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,ar,4,3,"ng-template",null,2,b.Ec),b.Ob(4,"dexih-widget-section",3),b.Dc(5,rr,24,10,"form",4),b.Nb(),b.Dc(6,or,2,5,"dexih-widget-section",5),b.Ob(7,"dexih-widget-section",6),b.Dc(8,sr,2,1,"div",7),b.Ob(9,"section"),b.Ob(10,"h5"),b.Fc(11,"Data Configuration"),b.Nb(),b.Ob(12,"query-builder",8),b.Vb("onRefreshData",(function(){return t.refresh()})),b.Nb(),b.Nb(),b.Ob(13,"dexih-table",9),b.Dc(14,lr,1,0,"ng-template",null,10,b.Ec),b.Nb(),b.Nb(),b.Nb(),b.Lb(16,"dexih-help",11),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!1),b.yb(3),b.hc("showExpandButton",!0),b.yb(1),b.hc("ngIf",t.formsService.currentForm),b.yb(1),b.hc("ngIf",t.formsService.currentForm),b.yb(1),b.hc("showExpandButton",!0),b.yb(1),b.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),b.yb(4),b.hc("selectQuery",t.selectQuery)("columns",t.tableColumns)("inputColumns",t.inputColumns)("parameters",null==t.formsService||null==t.formsService.currentForm?null:t.formsService.currentForm.controls.parameters.value)("refreshEvent",t.refreshDataSubject.asObservable()),b.yb(1),b.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",t.columns)("data",t.data))},directives:[h.P,h.T,v.t,$i.a,d.a,$.a,K.a,Xi.a,I.a,E.a,n.I,n.t,n.l,h.D,n.s,n.j,h.H,h.A,h.I,h.E,Yi.a,Ji.a,er.a,v.s,n.v,h.s],encapsulation:2}),ur),hr=a("7q3d"),dr=a("Eg12");function fr(e,t){if(1&e&&b.Lb(0,"tags-update-button",11),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.ColumnValidation)("objects",a)}}function mr(e,t){if(1&e&&b.Lb(0,"dependent-items-button",12),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.Api)}}function vr(e,t){1&e&&b.Lb(0,"actions-api-button",13),2&e&&b.hc("apis",t.items)}function pr(e,t){if(1&e&&b.Lb(0,"api-status",14),2&e){var a=t.item;b.hc("apiKey",null==a?null:a.key)}}var gr,yr=((gr=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{name:"apiSource",title:"Api Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateApis()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"editApi",value:function(e){this.router.navigate(["api-edit",e.key],{relativeTo:this.route})}},{key:"updateApis",value:function(){var e=this;if(this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihApis.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,apiSource:e.getSourceDetails(t),updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private",tags:e.hubCache.getObjectTags(u.dc.ColumnValidation,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"getSourceDetails",value:function(e){if(e.sourceType===u.gc.Table){var t=this.hubCache.getTable(e.sourceTableKey);return t?"Table: "+t.name:"Error: Table not found"}var a=this.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e.sourceDatalinkKey}));return a?"Datalink: "+a.name:"Error: Datalink not found"}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Api&&t.changeClass!==u.dc.TagObjects||e.updateApis()}))}}]),e}()).\u0275fac=function(e){return new(e||gr)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},gr.\u0275cmp=b.Eb({type:gr,selectors:[["apis"]],inputs:{hubKey:"hubKey"},decls:12,vars:7,consts:[[1,"container-fluid"],["title","Api's","iconClass","fa fa-lg fa-fw fa-feed",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["title","Connections","path","/assets/help/reference/api.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"apis"],[3,"apiKey"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.editApi(e)})),b.Dc(3,fr,1,2,"ng-template",3,4,b.Ec),b.Dc(5,mr,1,2,"ng-template",5,6,b.Ec),b.Dc(7,vr,1,1,"ng-template",null,7,b.Ec),b.Dc(9,pr,1,1,"ng-template",8,9,b.Ec),b.Nb(),b.Nb(),b.Lb(11,"dexih-help",10),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,p.a,m.a,hr.a,dr.a],encapsulation:2}),gr),Cr=a("v6kC");function kr(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-refresh",11),b.Vb("click",(function(){return b.vc(a),b.Zb().runDatalinks()})),b.Nb(),b.Ob(1,"dexih-button-cancel",12),b.Vb("click",(function(){return b.vc(a),b.Zb().cancel()})),b.Nb()}}function wr(e,t){if(1&e&&(b.Ob(0,"div",16),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.yb(1),b.Hc(" ",a.name," ")}}function Sr(e,t){if(1&e&&(b.Ob(0,"label",13),b.Fc(1,"Run the following datalink(s):"),b.Nb(),b.Ob(2,"div",14),b.Dc(3,wr,2,1,"div",15),b.ac(4,"fieldSort"),b.Nb()),2&e){var a=b.Zb();b.yb(3),b.hc("ngForOf",b.cc(4,1,a.datalinks,"name"))}}function Or(e,t){if(1&e){var a=b.Pb();b.Ob(0,"span",20),b.Ob(1,"div",21),b.Ob(2,"div",18),b.Fc(3),b.Nb(),b.Nb(),b.Ob(4,"form-input",22),b.Vb("ngModelChange",(function(e){return b.vc(a),t.$implicit.value=e})),b.Nb(),b.Nb()}if(2&e){var n=t.$implicit,i=t.index;b.yb(3),b.Hc(" ",n.logicalName," "),b.yb(1),b.jc("name","column",i,""),b.hc("placeholder",n.logicalName)("ngModel",n.value)}}function Nr(e,t){if(1&e&&(b.Ob(0,"div",17),b.Ob(1,"div",18),b.Fc(2," Input Values "),b.Nb(),b.Dc(3,Or,5,4,"span",19),b.Nb()),2&e){var a=b.Zb();b.yb(3),b.hc("ngForOf",a.inputColumns)}}function Tr(e,t){if(1&e&&(b.Ob(0,"div"),b.Ob(1,"label",13),b.Fc(2,"Parameters:"),b.Nb(),b.Lb(3,"input-parameters-view",23),b.Nb()),2&e){var a=b.Zb();b.yb(3),b.hc("parameters",a.parameters)}}var Dr,xr,Fr=function(){return{standalone:!0}},Ir=((Dr=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.cancelToken=new F.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0],n=t[1];if(e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache.isLoaded()){var i=n.datalinkKeys;e.datalinks=new Array,i&&(e.inputColumns=[],e.parameters=[],i.split("|").map((function(e){return+e})).forEach((function(t){var a=e.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t}));e.datalinks.push(a),a.sourceDatalinkTable.dexihDatalinkColumns.filter((function(e){return e.isInput})).forEach((function(n){e.inputColumns.push({datalinkKey:t,datalinkName:a.name,name:n.name,logicalName:n.logicalName,dataType:n.dataType,rank:n.rank,value:n.defaultValue,defaultValue:n.defaultValue})})),a.parameters.forEach((function(t){e.parameters.findIndex((function(e){return e.name===t.name}))<0&&e.parameters.push(t)}))})))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datalink Preview")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"runDatalinks",value:function(){this.hubService.runDatalinks(this.datalinks.map((function(e){return e.key})),this.truncateTable,this.resetIncremental,this.resetValue,this.inputColumns,this.parameters,this.cancelToken),this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Dr)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.a))},Dr.\u0275cmp=b.Eb({type:Dr,selectors:[["datalink-run"]],decls:20,vars:13,consts:[[1,"container"],["title","Datalink Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"d-flex","flex-wrap"],["class","alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],["class","input-group",4,"ngFor","ngForOf"],[1,"input-group"],[1,"input-group-prepend"],[1,"form-control","p-0",3,"name","placeholder","ngModel","ngModelChange"],[3,"parameters"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,kr,2,0,"ng-template",null,2,b.Ec),b.Dc(4,Sr,5,4,"ng-template",null,3,b.Ec),b.Ob(6,"form"),b.Ob(7,"fieldset"),b.Ob(8,"section"),b.Ob(9,"div",4),b.Ob(10,"section",5),b.Ob(11,"form-checkbox",6),b.Vb("ngModelChange",(function(e){return t.truncateTable=e})),b.Nb(),b.Nb(),b.Nb(),b.Ob(12,"div",4),b.Ob(13,"section",5),b.Ob(14,"form-checkbox",7),b.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),b.Nb(),b.Nb(),b.Nb(),b.Ob(15,"div",4),b.Ob(16,"section",5),b.Ob(17,"form-input",8),b.Vb("ngModelChange",(function(e){return t.resetValue=e})),b.Nb(),b.Nb(),b.Nb(),b.Dc(18,Nr,4,1,"div",9),b.Dc(19,Tr,4,1,"div",10),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(10),b.hc("ngModel",t.truncateTable)("ngModelOptions",b.lc(10,Fr)),b.yb(3),b.hc("ngModel",t.resetIncremental)("ngModelOptions",b.lc(11,Fr)),b.yb(3),b.hc("ngModel",t.resetValue)("ngModelOptions",b.lc(12,Fr)),b.yb(1),b.hc("ngIf",t.inputColumns&&t.inputColumns.length>0),b.yb(1),b.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[h.P,n.I,n.t,n.u,h.A,n.s,n.v,h.D,v.t,h.s,h.b,v.s,Cr.a],pipes:[Rt.a],encapsulation:2}),Dr),Kr=a("Kj3r"),Er=a("nlsZ"),Vr=a("bRjT"),Lr=a("eOAR"),Pr=a("OO45"),Ar=a("mj3h"),Rr=a("0oH3"),jr=a("qKhg"),_r=a("OWar"),Mr=a("5Av2"),Zr=a("cSor"),Hr=a("Hd2u"),Br=a("awqr"),Ur=((xr=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e){return T.h.find((function(t){return t.key===e})).name}}]),e}()).\u0275fac=function(e){return new(e||xr)},xr.\u0275pipe=b.Jb({name:"objectTypeName",type:xr,pure:!0}),xr);function qr(e,t){if(1&e&&(b.Ob(0,"form",8),b.Ob(1,"fieldset"),b.Ob(2,"div",9),b.Ob(3,"section",10),b.Lb(4,"form-input",11),b.Nb(),b.Ob(5,"section",10),b.Lb(6,"form-select",12),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.hc("formGroup",a.searchForm),b.yb(6),b.hc("items",a.searchObjectTypes)}}function zr(e,t){1&e&&(b.Ob(0,"div",5),b.Ob(1,"h5"),b.Fc(2,"No search results available."),b.Nb(),b.Nb())}function Wr(e,t){if(1&e&&b.Lb(0,"datajob-view",27),2&e){var a=b.Zb().$implicit;b.hc("datajob",a.object)}}function Gr(e,t){if(1&e&&b.Lb(0,"datalink-view",28),2&e){var a=b.Zb().$implicit;b.hc("datalink",a.object)}}function Qr(e,t){if(1&e&&b.Lb(0,"connection-view",29),2&e){var a=b.Zb().$implicit;b.hc("connection",a.object)}}function $r(e,t){if(1&e&&b.Lb(0,"table-view",30),2&e){var a=b.Zb().$implicit;b.hc("connection",a.objectParent)("table",a.object)}}function Xr(e,t){if(1&e&&b.Lb(0,"table-column-view",31),2&e){var a=b.Zb().$implicit;b.hc("table",a.objectParent)("column",a.object)}}function Yr(e,t){if(1&e&&b.Lb(0,"columnValidation-view",32),2&e){var a=b.Zb().$implicit;b.hc("columnValidation",a.object)}}function Jr(e,t){if(1&e&&b.Lb(0,"fileFormat-view",33),2&e){var a=b.Zb().$implicit;b.hc("fileFormat",a.object)}}function eo(e,t){if(1&e&&b.Lb(0,"view-view",34),2&e){var a=b.Zb().$implicit;b.hc("view",a.object)}}function to(e,t){if(1&e&&b.Lb(0,"api-view",35),2&e){var a=b.Zb().$implicit;b.hc("api",a.object)}}function ao(e,t){if(1&e&&b.Lb(0,"dashboard-view",36),2&e){var a=b.Zb().$implicit;b.hc("dashboard",a.object)}}function no(e,t){if(1&e&&b.Lb(0,"listOfValues-view",37),2&e){var a=b.Zb().$implicit;b.hc("listOfValues",a.object)}}function io(e,t){if(1&e&&b.Lb(0,"datalinkTest-view",38),2&e){var a=b.Zb().$implicit;b.hc("datalinkTest",a.object)}}function ro(e,t){if(1&e&&(b.Ob(0,"li",13),b.Ob(1,"div"),b.Ob(2,"h5"),b.Fc(3),b.ac(4,"objectTypeName"),b.Nb(),b.Nb(),b.Ob(5,"div",14),b.Dc(6,Wr,1,1,"datajob-view",15),b.Dc(7,Gr,1,1,"datalink-view",16),b.Dc(8,Qr,1,1,"connection-view",17),b.Dc(9,$r,1,2,"table-view",18),b.Dc(10,Xr,1,2,"table-column-view",19),b.Dc(11,Yr,1,1,"columnValidation-view",20),b.Dc(12,Jr,1,1,"fileFormat-view",21),b.Dc(13,eo,1,1,"view-view",22),b.Dc(14,to,1,1,"api-view",23),b.Dc(15,ao,1,1,"dashboard-view",24),b.Dc(16,no,1,1,"listOfValues-view",25),b.Dc(17,io,1,1,"datalinkTest-view",26),b.Nb(),b.Nb()),2&e){var a=t.$implicit,n=b.Zb();b.yb(3),b.Gc(b.bc(4,14,a.objectType)),b.yb(2),b.hc("ngSwitch",a.objectType),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Datajob),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Datalink),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Connection),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Table),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.TableColumn),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.ColumnValidation),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.FileFormat),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.View),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Api),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.Dashboard),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.ListOfValues),b.yb(1),b.hc("ngSwitchCase",n.eSearchObjectType.DatalinkTest)}}var oo,co,so=((oo=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.router=i,this.fb=r,this.searchObjectTypes=T.h,this.eSearchObjectType=T.l,this.isFirst=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.hubCache=t[1],!e.isFirst){e.isFirst=!1;var n=+a.searchObject;n||(n=0),e.searchForm=e.fb.group({searchString:[a.search,[]],searchObject:[n,[]]}),e.updateSearch(),e._searchSubscription&&e._searchSubscription.unsubscribe(),e._searchSubscription=e.searchForm.valueChanges.pipe(Object(Kr.a)(500)).subscribe((function(t){e.updateSearch()}))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Search")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._searchSubscription&&this._searchSubscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"updateSearch",value:function(){if(this.hubCache.isLoaded()&&(this.searchResults=this.hubCache.search(this.searchForm.value.searchString,this.searchForm.value.searchObject),history.pushState)){var e=this.hubCache.getHubUrl()+"/search",t=this.searchForm.value.searchString,a=this.searchForm.value.searchObject;t&&(e+="/"+a+"/"+t),this.router.navigateByUrl(e)}}}]),e}()).\u0275fac=function(e){return new(e||oo)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.a),b.Kb(r.e),b.Kb(n.g))},oo.\u0275cmp=b.Eb({type:oo,selectors:[["search"]],decls:8,vars:5,consts:[[1,"container-fluid"],["title","Search Results","iconClass","fa fa-lg fa-fw fa-search",3,"showCloseButton","padding","close"],[3,"formGroup",4,"ngIf"],["role","content"],["class","well",4,"ngIf"],[1,"well"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Search Term","formControlName","searchString","placeholder","Search...","iconClass","fa fa-search"],["label","Restrict to","formControlName","searchObject","itemKey","key","itemName","name",3,"items"],[1,"list-group-item"],[1,"col-xs-9",3,"ngSwitch"],[3,"datajob",4,"ngSwitchCase"],[3,"datalink",4,"ngSwitchCase"],[3,"connection",4,"ngSwitchCase"],[3,"connection","table",4,"ngSwitchCase"],[3,"table","column",4,"ngSwitchCase"],[3,"columnValidation",4,"ngSwitchCase"],[3,"fileFormat",4,"ngSwitchCase"],[3,"view",4,"ngSwitchCase"],[3,"api",4,"ngSwitchCase"],[3,"dashboard",4,"ngSwitchCase"],[3,"listOfValues",4,"ngSwitchCase"],[3,"datalinkTest",4,"ngSwitchCase"],[3,"datajob"],[3,"datalink"],[3,"connection"],[3,"connection","table"],[3,"table","column"],[3,"columnValidation"],[3,"fileFormat"],[3,"view"],[3,"api"],[3,"dashboard"],[3,"listOfValues"],[3,"datalinkTest"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,qr,7,2,"form",2),b.Ob(3,"div",3),b.Dc(4,zr,3,0,"div",4),b.Ob(5,"div",5),b.Ob(6,"ul",6),b.Dc(7,ro,18,16,"li",7),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(1),b.hc("ngIf",t.searchForm),b.yb(2),b.hc("ngIf",!t.searchResults||0==(null==t.searchResults?null:t.searchResults.length)),b.yb(3),b.hc("ngForOf",t.searchResults))},directives:[h.P,v.t,v.s,n.I,n.t,n.l,h.D,n.s,n.j,h.E,v.x,v.y,Er.a,Vr.a,Lr.a,Pr.a,Ar.a,Rr.a,jr.a,_r.a,Mr.a,Zr.a,Hr.a,Br.a],pipes:[Ur],encapsulation:2}),oo),lo=a("RRRx"),uo=((co=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ib({type:co}),co.\u0275inj=b.Hb({factory:function(e){return new(e||co)},providers:[],imports:[[i.a,lo.a,n.C]]}),co),bo=a("SmOL");function ho(e,t){if(1&e&&b.Lb(0,"dependent-items-button",9),2&e){var a=t.item,n=b.Zb();b.hc("key",a.key)("objectType",n.eSharedObjectType.Dashboard)}}function fo(e,t){if(1&e&&b.Lb(0,"tags-update-button",10),2&e){var a=t.items,n=b.Zb();b.hc("objectType",n.eSharedObjectType.Dashboard)("objects",a)}}function mo(e,t){1&e&&b.Lb(0,"actions-dashboard-button",11),2&e&&b.hc("dashboards",t.items)}var vo,po=((vo=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateDashboards()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Dashboard Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteDashboards(e)}},{key:"updateDashboards",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihDashboards.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,tags:e.hubCache.getObjectTags(u.dc.Dashboard,t.key),updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["dashboard-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddDashboard(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Dashboard - "+e[0].name+".json":"dashboards.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.Dashboard&&t.changeClass!==u.dc.TagObjects||e.updateDashboards()}))}}]),e}()).\u0275fac=function(e){return new(e||vo)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},vo.\u0275cmp=b.Eb({type:vo,selectors:[["dashboards"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Dashboards","iconClass","fa fa-lg fa-fw fa-pie-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["title","Dashboards","path","/assets/help/reference/dashboard.md",1,"m-3"],[1,"ml-1",3,"key","objectType"],[1,"ml-1",3,"objectType","objects"],[3,"dashboards"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,ho,1,2,"ng-template",3,4,b.Ec),b.Dc(5,fo,1,2,"ng-template",5,6,b.Ec),b.Dc(7,mo,1,1,"ng-template",null,7,b.Ec),b.Nb(),b.Nb(),b.Lb(9,"dexih-help",8),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,$.a,m.a,p.a,bo.a],encapsulation:2}),vo);function go(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-refresh",10),b.Vb("click",(function(){return b.vc(a),b.Zb().run()})),b.Nb(),b.Ob(1,"dexih-button-refresh",11),b.Vb("click",(function(){return b.vc(a),b.Zb().activate()})),b.Nb(),b.Ob(2,"dexih-button-cancel",12),b.Vb("click",(function(){return b.vc(a),b.Zb().cancel()})),b.Nb()}}function yo(e,t){if(1&e&&(b.Ob(0,"span",16),b.Fc(1),b.Nb()),2&e){var a=t.$implicit;b.yb(1),b.Hc(" ",a.name," ")}}function Co(e,t){if(1&e&&(b.Ob(0,"label",13),b.Fc(1,"Run the following datajobs(s):"),b.Nb(),b.Ob(2,"div"),b.Ob(3,"div",14),b.Dc(4,yo,2,1,"span",15),b.ac(5,"fieldSort"),b.Nb(),b.Nb()),2&e){var a=b.Zb();b.yb(4),b.hc("ngForOf",b.cc(5,1,a.datajobs,"name"))}}function ko(e,t){if(1&e&&(b.Ob(0,"div",17),b.Ob(1,"div",18),b.Fc(2," Input Parameters "),b.Nb(),b.Lb(3,"input-parameters-view",19),b.Nb()),2&e){var a=b.Zb();b.yb(3),b.hc("parameters",a.parameters)}}a("LyCD"),a("NbKI");var wo,So=function(){return{standalone:!0}},Oo=((wo=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.route=n,this.cancelToken=new F.a,this.truncateTable=!1,this.resetIncremental=!1,this.resetValue="",this.isRefreshing=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[0],n=t[1];if(e.hubCache=t[2],e.action=a.action,e.pageTitle=a.pageTitle,e.hubCache.isLoaded()){var i=n.datajobKeys;e.datajobs=new Array,i&&(e.parameters=[],i.split("|").map((function(e){return+e})).forEach((function(t){var a=e.hubCache.hub.dexihDatajobs.find((function(e){return e.key===t}));e.datajobs.push(a),a.parameters.forEach((function(t){e.parameters.findIndex((function(e){return t.name===e.name}))<0&&e.parameters.push({name:t.name,value:t.value,rank:t.rank})}))})))}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Datajob Run")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"run",value:function(){this.hubService.runDatajobs(this.datajobs,this.truncateTable,this.resetIncremental,this.resetValue,this.parameters,this.cancelToken),this.authService.navigateUp()}},{key:"activate",value:function(){this.hubService.activateDatajobs(this.datajobs,this.parameters,this.cancelToken),this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||wo)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.a))},wo.\u0275cmp=b.Eb({type:wo,selectors:[["datajob-run"]],decls:19,vars:12,consts:[[1,"container"],["title","Datajob Options","iconClass","fa fa-lg fa-fw fa-exchange",3,"showCloseButton","padding","close"],["header",""],["subHeader",""],[1,"form-row"],[1,"col"],["label","Truncate all target tables before execution.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Reset the source incremental value, and load all source rows.",3,"ngModel","ngModelOptions","ngModelChange"],["label","Incremental Value","placeholder","","iconClass","fa fa-list","note","Use a specific incremental value to start loading source rows from (leave empty for null value)",3,"ngModel","ngModelOptions","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],["text","Run Now",1,"mr-1",3,"click"],["text","Activate Triggers",1,"mr-1",3,"click"],[3,"click"],[1,"label"],[1,"row"],["class","col alert alert-primary m-1",4,"ngFor","ngForOf"],[1,"col","alert","alert-primary","m-1"],[1,"d-flex","flex-wrap","pt-1"],[1,"input-group-text"],[3,"parameters"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Dc(2,go,3,0,"ng-template",null,2,b.Ec),b.Dc(4,Co,6,4,"ng-template",null,3,b.Ec),b.Ob(6,"form"),b.Ob(7,"fieldset"),b.Ob(8,"section"),b.Ob(9,"div",4),b.Ob(10,"section",5),b.Ob(11,"form-checkbox",6),b.Vb("ngModelChange",(function(e){return t.truncateTable=e})),b.Nb(),b.Nb(),b.Nb(),b.Ob(12,"div",4),b.Ob(13,"section",5),b.Ob(14,"form-checkbox",7),b.Vb("ngModelChange",(function(e){return t.resetIncremental=e})),b.Nb(),b.Nb(),b.Nb(),b.Ob(15,"div",4),b.Ob(16,"section",5),b.Ob(17,"form-input",8),b.Vb("ngModelChange",(function(e){return t.resetValue=e})),b.Nb(),b.Nb(),b.Nb(),b.Dc(18,ko,4,1,"div",9),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0)("padding",!0),b.yb(10),b.hc("ngModel",t.truncateTable)("ngModelOptions",b.lc(9,So)),b.yb(3),b.hc("ngModel",t.resetIncremental)("ngModelOptions",b.lc(10,So)),b.yb(3),b.hc("ngModel",t.resetValue)("ngModelOptions",b.lc(11,So)),b.yb(1),b.hc("ngIf",t.parameters&&t.parameters.length>0))},directives:[h.P,n.I,n.t,n.u,h.A,n.s,n.v,h.D,v.t,h.s,h.b,v.s,Cr.a],pipes:[Rt.a],encapsulation:2}),wo);function No(e,t){if(1&e&&b.Lb(0,"save-button",17),2&e){var a=b.Zb(3);b.hc("formsService",a.formsService)}}function To(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-invalid-form-details",14),b.Vb("click",(function(){return b.vc(a),b.Zb(2).formsService.showErrors()})),b.Nb(),b.Dc(1,No,1,1,"save-button",15),b.Lb(2,"cancel-button",16)}if(2&e){var n=b.Zb(2);b.hc("control",n.formsService.currentForm),b.yb(1),b.hc("ngIf",n.hubCache.canWrite),b.yb(1),b.hc("formsService",n.formsService)}}function Do(e,t){if(1&e&&(b.Ob(0,"section",8),b.Ob(1,"form-select",18),b.Lb(2,"table-edit-button",19),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("errors",null==a.errors?null:a.errors.sourceTableKey)("items",a.connectionTables),b.yb(1),b.hc("key",a.formsService.currentForm.controls.sourceTableKey.value)}}function xo(e,t){if(1&e&&(b.Ob(0,"section",8),b.Ob(1,"form-select",20),b.Lb(2,"datalink-edit-button",19),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(1),b.hc("errors",null==a.errors?null:a.errors.sourceDatalinkKey)("items",a.datalinks),b.yb(1),b.hc("key",a.formsService.currentForm.controls.sourceDatalinkKey.value)}}function Fo(e,t){if(1&e&&(b.Ob(0,"div",7),b.Ob(1,"section",21),b.Lb(2,"form-select",22),b.Nb(),b.Ob(3,"section",21),b.Lb(4,"form-select",23),b.Nb(),b.Ob(5,"section",21),b.Lb(6,"form-select",24),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(2),b.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1),b.yb(2),b.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1),b.yb(2),b.hc("items",a.tableColumns)("allowNullSelect",!0)("enableFilter",!1)}}function Io(e,t){1&e&&b.Lb(0,"form-input",29)}function Ko(e,t){if(1&e&&(b.Ob(0,"div",7),b.Ob(1,"section",25),b.Ob(2,"div",26),b.Lb(3,"form-checkbox",27),b.Dc(4,Io,1,0,"form-input",28),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.yb(3),b.hc("border",!0),b.yb(1),b.hc("ngIf",a.formsService.currentForm.controls.cache.value)}}function Eo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button",32),b.Vb("click",(function(){return b.vc(a),b.Zb(3).add(-1)})),b.Fc(1,"Insert Item"),b.Nb(),b.Ob(2,"dexih-button-delete",33),b.Vb("click",(function(){return b.vc(a),b.Zb(3).clear()})),b.Nb()}}function Vo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"form",34),b.Ob(1,"div",35),b.Ob(2,"div",36),b.Lb(3,"form-input",37),b.Nb(),b.Ob(4,"div",36),b.Lb(5,"form-input",38),b.Nb(),b.Ob(6,"div",36),b.Lb(7,"form-input",39),b.Nb(),b.Ob(8,"div",40),b.Ob(9,"button",41),b.Vb("click",(function(){b.vc(a);var e=t.index;return b.Zb(3).add(e)})),b.Lb(10,"i",42),b.Nb(),b.Ob(11,"button",43),b.Vb("click",(function(){b.vc(a);var e=t.index;return b.Zb(3).remove(e)})),b.Lb(12,"i",44),b.Nb(),b.Nb(),b.Nb(),b.Nb()}2&e&&(b.hc("formGroup",t.$implicit),b.yb(3),b.hc("border",!1),b.yb(2),b.hc("border",!1),b.yb(2),b.hc("border",!1))}function Lo(e,t){if(1&e&&(b.Ob(0,"dexih-widget-section",30),b.Dc(1,Eo,3,0,"ng-template",null,3,b.Ec),b.Dc(3,Vo,13,4,"form",31),b.Nb()),2&e){var a=b.Zb(2);b.hc("showExpandButton",!0),b.yb(3),b.hc("ngForOf",a.formsService.currentForm.controls.staticData.controls)}}function Po(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",49),b.Ob(1,"dexih-button-refresh",50),b.Vb("click",(function(){return b.vc(a),b.Zb(3).refreshData()})),b.Nb(),b.Nb()}2&e&&(b.yb(1),b.hc("autoCompact",!1))}function Ao(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-refresh",53),b.Vb("click",(function(){return b.vc(a),b.Zb(4).refreshData()})),b.Nb()}}function Ro(e,t){if(1&e&&(b.Ob(0,"dexih-table",51),b.Dc(1,Ao,1,0,"ng-template",null,52,b.Ec),b.Nb()),2&e){var a=b.Zb(3);b.hc("enableMultiSelect",!1)("enableSaveCsv",!0)("columns",a.columns)("data",a.data)}}function jo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-widget-section",45),b.Ob(1,"query-builder",46),b.Vb("hasChanged",(function(){return b.vc(a),b.Zb(2).hasChanged()}))("onRefreshData",(function(){return b.vc(a),b.Zb(2).refreshData()})),b.Nb(),b.Nb(),b.Dc(2,Po,2,1,"div",47),b.Dc(3,Ro,3,4,"dexih-table",48)}if(2&e){var n=b.Zb(2);b.hc("showExpandButton",!0),b.yb(1),b.hc("selectQuery",n.formsService.currentForm.controls.selectQuery.value)("columns",n.tableColumns)("inputColumns",n.inputColumns)("parameters",null)("refreshEvent",n.refreshDataSubject.asObservable()),b.yb(1),b.hc("ngIf",!n.data),b.yb(1),b.hc("ngIf",n.data)}}function _o(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",1),b.Ob(1,"dexih-widget",2),b.Vb("close",(function(){return b.vc(a),b.Zb().close()})),b.Dc(2,To,3,3,"ng-template",null,3,b.Ec),b.Ob(4,"form",4),b.Ob(5,"fieldset"),b.Ob(6,"section"),b.Lb(7,"form-input",5),b.Nb(),b.Ob(8,"section"),b.Lb(9,"form-textarea",6),b.Nb(),b.Ob(10,"section"),b.Ob(11,"div",7),b.Ob(12,"section",8),b.Lb(13,"form-select",9),b.Nb(),b.Dc(14,Do,3,3,"section",10),b.Dc(15,xo,3,3,"section",10),b.Nb(),b.Dc(16,Fo,7,9,"div",11),b.Dc(17,Ko,5,2,"div",11),b.Nb(),b.Nb(),b.Nb(),b.Dc(18,Lo,4,2,"dexih-widget-section",12),b.Dc(19,jo,4,8,"ng-template",13),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.yb(1),b.hc("showCloseButton",!0)("padding",!1),b.yb(3),b.hc("formGroup",n.formsService.currentForm),b.yb(3),b.hc("autocapitalize",n.on)("errors",n.formsService.formErrors.name),b.yb(2),b.hc("showMarkdown",!0),b.yb(4),b.hc("items",n.sourceTypes)("enableFilter",!1),b.yb(1),b.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Table),b.yb(1),b.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Datalink),b.yb(1),b.hc("ngIf",n.tableColumns),b.yb(1),b.hc("ngIf",n.tableColumns),b.yb(1),b.hc("ngIf",n.formsService.currentForm.value.sourceType==n.eLOVObjectType.Static),b.yb(1),b.hc("ngIf",n.formsService.currentForm.value.sourceType!==n.eLOVObjectType.Static)}}var Mo,Zo=((Mo=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.formsService=n,this.route=i,this.router=r,this.isLoaded=!1,this.refreshDataSubject=new Wi.a,this.cancelToken=new F.a,this.eLOVObjectType=u.Qb,this.connectionTables=[],this.datalinks=[],this.sourceTypes=u.Rb.filter((function(e){return e.key>0})),this.columns=[{name:"key",title:"Key"},{name:"name",title:"Name"},{name:"description",title:"Description"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(l.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];e.params=t[1],e.hubCache=t[2],e.pageTitle=a.pageTitle,e.action=a.action,e.hubCache&&e.hubCache.status===T.j.Loaded&&(e.isLoaded&&"new"===e.action||(e.isLoaded&&e.formsService.hasChanged?e.authService.confirmDialog("Synchronization warning","The hub was disconnected, meaning this edit could have been changed by another session.  Would you like to discard the current changes, and reload the latest version?").then((function(t){t&&e.load()})).catch((function(e){})):e.load()))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Edit List Of Values")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._formChangeSubscription&&this._formChangeSubscription.unsubscribe(),this._sourceChangeSubscription&&this._sourceChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"load",value:function(){var e=this;if(this.isLoaded=!0,this.connectionTables=this.hubCache.getConnectionTables(),this.datalinks=this.hubCache.hub.dexihDatalinks,"edit"===this.action)if(this.listOfValuesKey=+this.params.listOfValuesKey,this.listOfValuesKey)if(this.hubCache.hub&&this.hubCache.hub.dexihListOfValues){var t=this.hubCache.hub.dexihListOfValues.find((function(t){return t.key===e.listOfValuesKey}));t.selectQuery||(t.selectQuery=new u.V),this.formsService.listOfValues(t)}else this.hubService.addHubErrorMessage("The hub cache is not loaded.");else this.hubService.addHubErrorMessage("There was no list of values specified to edit.");if("new"===this.action){var a=new u.E;a.selectQuery=new u.V,this.formsService.listOfValues(a),this._formChangeSubscription=this.formsService.getCurrentFormObservable().subscribe((function(t){var a=t.controls.key.value;if(a&&history.pushState){var n=window.location.pathname.replace("/listOfValues-new","/listOfValues-edit/"+a);e.router.navigateByUrl(n),e._formChangeSubscription.unsubscribe()}}))}this.refreshColumns();var n=this.formsService.currentForm;this._sourceChangeSubscription=Object(Gi.a)(n.controls.sourceType.valueChanges,n.controls.sourceTableKey.valueChanges,n.controls.sourceDatalinkKey.valueChanges).subscribe((function(){e.refreshColumns()}))}},{key:"refreshColumns",value:function(){var e=this.formsService.currentForm;switch(e.controls.sourceType.value){case u.Qb.Datalink:var t=e.controls.sourceDatalinkKey.value,a=this.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t}));if(a){var n=new Qi.b;n.buildInputOutput(this.hubCache,a),this.tableColumns=n.getDatalinkOutputColumns(a)}else t>0&&this.hubService.addHubErrorMessage("The datalink with the key ".concat(t," could not be found.")),this.tableColumns=null;break;case u.Qb.Table:var i=e.controls.sourceTableKey.value,r=this.hubCache.hub.dexihTables.find((function(e){return e.key===i}));r?this.tableColumns=r.dexihTableColumns:(i>0&&this.hubService.addHubErrorMessage("The table with the key ".concat(i," could not be found.")),this.tableColumns=null)}}},{key:"refreshData",value:function(){var e=this;this.hubService.previewListOfValues(this.formsService.currentForm.value,!0,this.cancelToken).then((function(t){e.data=t,e.refreshDataSubject.next()})).catch((function(t){e.hubService.addHubMessage(t)}))}},{key:"hasChanged",value:function(){}},{key:"add",value:function(e){var t=this.formsService.currentForm,a=this.formsService.listOfValuesItem(new u.R);t.controls.staticData.insert(e+1,a)}},{key:"remove",value:function(e){this.formsService.currentForm.controls.staticData.removeAt(e)}},{key:"clear",value:function(){for(var e=this.formsService.currentForm.controls.staticData;e.controls.length>0;)e.removeAt(0)}},{key:"close",value:function(){this.authService.navigateUp()}}]),e}()).\u0275fac=function(e){return new(e||Mo)(b.Kb(o.a),b.Kb(c.a),b.Kb(D.a),b.Kb(r.a),b.Kb(r.e))},Mo.\u0275cmp=b.Eb({type:Mo,selectors:[["dexih-listOfValues-edit-form"]],features:[b.xb([D.a])],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["title","Edit List of Values","iconClass","fa fa-lg fa-list-alt",3,"showCloseButton","padding","close"],["header",""],[1,"m-3",3,"formGroup"],["label","List of Values","formControlName","name","placeholder","Enter the list of values name.","iconClass","fa fa-list",3,"autocapitalize","errors"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"form-row"],[1,"form-group","col-md-6"],["label","Data Source Type","formControlName","sourceType","itemKey","key","itemName","name","iconClass","fa fa-database","note","Specify the source type for this view",3,"items","enableFilter"],["class","form-group col-md-6",4,"ngIf"],["class","form-row",4,"ngIf"],["title","Static Values",3,"showExpandButton",4,"ngIf"],[3,"ngIf"],[1,"mr-1",3,"control","click"],["class","mr-1",3,"formsService",4,"ngIf"],[3,"formsService"],[1,"mr-1",3,"formsService"],["label","Source Table","formControlName","sourceTableKey","parentName","name","childItems","dexihTables","itemKey","key","itemName","logicalName","note","Select the source table",3,"errors","items"],[3,"key"],["label","Source Datalink","formControlName","sourceDatalinkKey","itemKey","key","itemName","name","note","Select the source datalink",3,"errors","items"],[1,"form-group","col-md-4"],["label","Key Column","formControlName","keyColumn","itemKey","name","itemName","name","iconClass","fa fa-key",3,"items","allowNullSelect","enableFilter"],["label","Name Column","formControlName","nameColumn","itemKey","name","itemName","name","iconClass","fa fa-circle-o",3,"items","allowNullSelect","enableFilter"],["label","Description Column","formControlName","descriptionColumn","itemKey","name","itemName","name","iconClass","fa fa-comment-o",3,"items","allowNullSelect","enableFilter"],[1,"form-group","col-md-12"],[1,"d-flex","flex-wrap","pt-1"],["label","Cache Lookup","formControlName","cache",1,"input-group-prepend",3,"border"],["type","number","class","pl-1","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",4,"ngIf"],["type","number","labelLeft","Cache Seconds","placeholder","seconds","title","Specify the number of seconds to cache the lookup","formControlName","cacheSeconds",1,"pl-1"],["title","Static Values",3,"showExpandButton"],["class","flex-fill",3,"formGroup",4,"ngFor","ngForOf"],["iconClass","fa fa-plus",1,"mr-1",3,"click"],["text","Clear All",3,"click"],[1,"flex-fill",3,"formGroup"],[1,"input-group"],[1,"form-control","p-0"],["formControlName","key","type","text","placeholder","Key Value",3,"border"],["formControlName","name","type","text","placeholder","Item name",3,"border"],["formControlName","key","type","text","placeholder","Description",3,"border"],[1,"input-group-append","flex-shrink-1","ml-1"],["type","button","value","Add",1,"btn","btn-light",3,"click"],[1,"fa","fa-plus-square-o"],["type","button","value","Remove",1,"btn","btn-light",3,"click"],[1,"fa","fa-minus-square-o"],["title","Query Configuration",3,"showExpandButton"],[3,"selectQuery","columns","inputColumns","parameters","refreshEvent","hasChanged","onRefreshData"],["class","m-3",4,"ngIf"],[3,"enableMultiSelect","enableSaveCsv","columns","data",4,"ngIf"],[1,"m-3"],["text","Reload",3,"autoCompact","click"],[3,"enableMultiSelect","enableSaveCsv","columns","data"],["actions",""],["text","Reload",1,"mr-1",3,"click"]],template:function(e,t){1&e&&b.Dc(0,_o,20,14,"div",0),2&e&&b.hc("ngIf",t.formsService.currentForm)},directives:[v.t,h.P,n.I,n.t,n.l,h.D,n.s,n.j,h.H,h.E,K.a,I.a,E.a,Yi.a,Ji.a,h.A,h.T,v.s,h.f,h.g,$i.a,h.s,d.a],encapsulation:2}),Mo),Ho=function(e){return["listOfValues-edit",e]};function Bo(e,t){if(1&e&&(b.Lb(0,"dexih-button-edit",8),b.Lb(1,"dependent-items-button",9)),2&e){var a=t.item,n=b.Zb();b.hc("routerLink",b.mc(3,Ho,a.key)),b.yb(1),b.hc("key",a.key)("objectType",n.eSharedObjectType.ListOfValues)}}function Uo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",10),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().delete(e)})),b.Nb()}}function qo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",10),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb(),b.Dc(1,Uo,1,0,"dexih-button-delete",11),b.Lb(2,"tags-update-button",12)}if(2&e){var n=t.items,i=b.Zb();b.yb(1),b.hc("ngIf",i.hubCache.canWrite),b.yb(1),b.hc("objectType",i.eSharedObjectType.ListOfValues)("objects",n)}}var zo=function(){return["listOfValues-new"]};function Wo(e,t){1&e&&b.Lb(0,"dexih-button-new",14),2&e&&b.hc("routerLink",b.lc(1,zo))}function Go(e,t){if(1&e&&b.Dc(0,Wo,1,2,"dexih-button-new",13),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite)}}var Qo,$o=((Qo=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=u.dc,this.columns=[{name:"name",title:"Name",format:"",tags:"tags"},{name:"sourceType",title:"Source Type",format:"Enum",enum:u.Qb},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this.watchChanges(),this._subscription=Object(l.a)(this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[0],e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Hub List of Values Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"delete",value:function(e){this.hubService.deleteListOfValues(e)}},{key:"update",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihListOfValues.filter((function(e){return e.isValid})).map((function(t){return{key:t.key,name:t.name,description:t.description,updateDate:t.updateDate,tags:e.hubCache.getObjectTags(u.dc.ListOfValues,t.key)}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"edit",value:function(e){this.router.navigate(["listOfValues-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");a.dexihListOfValues=e,e.forEach((function(e){t.getListOfValuesCache(e,a)})),this.hubService.exportHub(a,"list_of_values.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==u.dc.ListOfValues&&t.changeClass!==u.dc.TagObjects||e.update()}))}}]),e}()).\u0275fac=function(e){return new(e||Qo)(b.Kb(o.a),b.Kb(c.a),b.Kb(r.e),b.Kb(r.a))},Qo.\u0275cmp=b.Eb({type:Qo,selectors:[["listOfValues"]],decls:9,vars:7,consts:[[1,"container-fluid"],["title","List Of Values","iconClass","fa fa-lg fa-fw fa-list-alt",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["queryParamsHandling","","preserveFragment","",1,"mr-1",3,"routerLink"],[1,"ml-1",3,"key","objectType"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"mr-1",3,"objectType","objects"],["class","mr-1",3,"routerLink",4,"ngIf"],[1,"mr-1",3,"routerLink"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,Bo,2,5,"ng-template",3,4,b.Ec),b.Dc(5,qo,3,3,"ng-template",5,6,b.Ec),b.Dc(7,Go,1,1,"ng-template",null,7,b.Ec),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[h.P,d.a,h.j,r.f,m.a,h.u,v.t,p.a,h.g,h.o],encapsulation:2}),Qo),Xo=a("Xjf6"),Yo=a("R0Ic");function Jo(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-edit",12),b.Vb("click",(function(){b.vc(a);var e=b.Zb();return e.edit(e.item)})),b.Nb()}}function ec(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-delete",12),b.Vb("click",(function(){b.vc(a);var e=b.Zb().items;return b.Zb().delete(e)})),b.Nb()}}function tc(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-save-local",12),b.Vb("click",(function(){b.vc(a);var e=t.items;return b.Zb().export(e)})),b.Nb(),b.Dc(1,ec,1,0,"dexih-button-delete",13)}if(2&e){var n=b.Zb();b.yb(1),b.hc("ngIf",n.hubCache.canWrite)}}function ac(e,t){if(1&e){var a=b.Pb();b.Ob(0,"dexih-button-new",12),b.Vb("click",(function(){return b.vc(a),b.Zb(2).new()})),b.Nb()}}function nc(e,t){if(1&e&&b.Dc(0,ac,1,0,"dexih-button-new",13),2&e){var a=b.Zb();b.hc("ngIf",a.hubCache.canWrite)}}var ic=function(e){return{"background-color":e,"margin-bottom":"0"}};function rc(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",14),b.Vb("click",(function(){b.vc(a);var e=t.item;return b.Zb().edit(e)})),b.Ob(1,"span",15),b.Fc(2),b.Nb(),b.Nb()}if(2&e){var n=t.item;b.hc("ngStyle",b.mc(2,ic,n.color)),b.yb(2),b.Gc(n.name)}}function oc(e,t){if(1&e){var a=b.Pb();b.Ob(0,"button",35),b.Vb("click",(function(){b.vc(a);var e=t.$implicit;return b.Zb(3).selectColor(e)})),b.Nb()}2&e&&b.Cc("background-color",t.$implicit.color)}function cc(e,t){if(1&e&&(b.Ob(0,"form",21),b.Ob(1,"div",22),b.Ob(2,"section",23),b.Lb(3,"form-input",24),b.Nb(),b.Ob(4,"section",25),b.Ob(5,"div"),b.Ob(6,"label",26),b.Fc(7,"Color"),b.Nb(),b.Ob(8,"div",27),b.Ob(9,"label",28),b.Lb(10,"input",29),b.Nb(),b.Lb(11,"form-input",30),b.Ob(12,"div",31),b.Dc(13,oc,1,2,"button",32),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(14,"div",22),b.Ob(15,"section",33),b.Lb(16,"form-textarea",34),b.Nb(),b.Nb(),b.Nb()),2&e){var a=b.Zb(2);b.hc("formGroup",a.formsService.currentForm),b.yb(3),b.hc("autocapitalize",!0)("errors",a.formsService.formErrors.name),b.yb(6),b.Cc("background-color",a.formsService.currentForm.controls.color.value),b.yb(4),b.hc("ngForOf",a.colors),b.yb(3),b.hc("showMarkdown",!0)}}function sc(e,t){if(1&e){var a=b.Pb();b.Ob(0,"div",16),b.Ob(1,"div",17),b.Ob(2,"b"),b.Fc(3,"Add/Edit Tag"),b.Nb(),b.Nb(),b.Ob(4,"div",18),b.Dc(5,cc,17,7,"form",19),b.Nb(),b.Ob(6,"div",20),b.Ob(7,"dexih-button-save",12),b.Vb("click",(function(){return b.vc(a),b.Zb().save()})),b.Nb(),b.Ob(8,"dexih-button-cancel",12),b.Vb("click",(function(){return b.vc(a),b.Zb().cancel()})),b.Nb(),b.Nb(),b.Nb()}if(2&e){var n=b.Zb();b.hc("@slideDown",n.state),b.yb(5),b.hc("ngIf",n.formsService.currentForm)}}var lc,uc,bc={path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"Detailed Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"Child Result"}},{path:"result-view/:auditConnectionKey/:auditKey",children:[{path:"",pathMatch:"full",component:pn.b,data:{pageTitle:"GrandChild Result"}}]}]}]},hc=[{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"table-new",data:{pageTitle:"New Table",action:"new"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"table-new/:connectionKey",data:{pageTitle:"New Table",action:"new"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Qt,data:{action:"new",pageTitle:"New Datalink"}},{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}}],dc=[{path:"datalink-edit",loadChildren:function(){return Promise.all([a.e(1),a.e(14)]).then(a.bind(null,"8Hfl")).then((function(e){return e.DatalinkEditModule}))}},{path:"datalink-preview/:datalinkKey/:previewUpdates",component:Xt,data:{pageTitle:"Preview Datalink"}},{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}},{path:"datalink-run/:datalinkKeys",component:Ir,data:{pageTitle:"Run Datalink"}},bc],fc={path:"tables",data:{pageTitle:"Tables"},children:[{path:"",pathMatch:"full",component:Gn,data:{pageTitle:"Tables"}},{path:"",children:hc},{path:"",children:dc}]},mc=[{path:"connection-edit/:connectionKey",component:Ae,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Connection"}},{path:"connection-import/:connectionKey",data:{pageTitle:"Import Tables"},children:[{path:"",pathMatch:"full",component:qe,data:{pageTitle:"Import Tables"}},{path:"table-edit/:tableKey",data:{pageTitle:"Edit Table",action:"edit"},loadChildren:function(){return Promise.all([a.e(1),a.e(0)]).then(a.bind(null,"gQFH")).then((function(e){return e.TableEditModule}))}},{path:"datalink-new/:sourceTableKeys/:targetConnectionKey",component:Qt,data:{action:"new",pageTitle:"New Datalink"}}]},{path:"connection-new/:purpose",component:Ae,data:{action:"new",pageTitle:"New Connection"}},{path:"connection-copy/:connectionKey",component:Ae,data:{action:"copy",pageTitle:"New Connection"}}],vc=[{path:"",pathMatch:"full",component:sn,data:{pageTitle:"Remote Agents"}},{path:"agent-edit/:remoteAgentKey/:remoteAgentHubKey",component:vn,data:{pageTitle:"Edit Agent"}}],pc=[{path:"results",data:{pageTitle:"Execution Results"},children:[{path:"",pathMatch:"full",component:pn.a,data:{pageTitle:"Execution Results"}},bc]},bc],gc=[{path:"customFunction-edit/:customFunctionKey",component:xi,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Custom Function"}},{path:"customFunction-new",component:xi,data:{action:"new",pageTitle:"New Custom Function"}}],yc=[{path:"columnValidation-edit/:validationKey",component:G,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Validation"}},{path:"columnValidation-new",component:G,data:{action:"new",pageTitle:"New Validation"}}],Cc=[{path:"fileFormat-edit/:fileFormatKey",component:Yt.a,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit FileFormat"}},{path:"fileFormat-new",component:Yt.a,data:{action:"new",pageTitle:"New FileFormat"}}],kc=[{path:"view-edit/:viewKey",component:qi.a,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit View"}},{path:"view-new",component:qi.a,data:{action:"new",pageTitle:"New View"}}],wc=[{path:"dashboard-edit/:dashboardKey",data:{pageTitle:"Edit Dashboard",action:"edit"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}},{path:"dashboard-new",data:{pageTitle:"New Dashboard",action:"new"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}}],Sc=[{path:"listOfValues-edit/:listOfValuesKey",component:Zo,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit List Of Values"}},{path:"listOfValues-new",component:Zo,data:{action:"new",pageTitle:"New List of Values"}}],Oc=[{path:"api-edit/:apiKey",component:br,canDeactivate:[Fi.a],data:{action:"edit",pageTitle:"Edit Api"}},{path:"api-new",component:br,data:{action:"new",pageTitle:"New Api"}}],Nc=[{path:"hubVariable-edit/:hubVariableKey",component:Ha,data:{action:"edit",pageTitle:"Edit Hub Variable"}},{path:"hubVariable-new",component:Ha,data:{action:"new",pageTitle:"New Hub Variable"}}],Tc=[{path:"datalinkTest-edit/:datalinkTestKey",data:{pageTitle:"Edit Datalink Test",action:"edit"},loadChildren:function(){return a.e(6).then(a.bind(null,"3ZyD")).then((function(e){return e.DatalinkTestEditModule}))}},{path:"datalinkTest-new",data:{pageTitle:"New Datalink Test",action:"new"},loadChildren:function(){return a.e(6).then(a.bind(null,"3ZyD")).then((function(e){return e.DatalinkTestEditModule}))}},{path:"datalinkTest-new/:datalinkKeys",component:Ui,data:{pageTitle:"New Datalink Test",action:"new"}},bc],Dc=[{path:"manage",children:[{path:"",component:xa,data:{action:"edit",pageTitle:"Manage Files"}},{path:":tableKey",data:{action:"edit",pageTitle:"Manage Files"},children:[{path:"",component:xa,data:{action:"edit",pageTitle:"Manage Files"}},{path:"file-preview/:path/:fileName",component:Qn,data:{pageTitle:"Preview File"}}]}]},{path:"bulk-load",children:[{path:"",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:function(){return Promise.all([a.e(1),a.e(0),a.e(5)]).then(a.bind(null,"xgYh")).then((function(e){return e.FilesBulkLoadModule}))}},{path:":connectionKey",data:{action:"new",pageTitle:"Bulk Load Files"},loadChildren:function(){return Promise.all([a.e(1),a.e(0),a.e(5)]).then(a.bind(null,"xgYh")).then((function(e){return e.FilesBulkLoadModule}))}}]}],xc=[{path:"datajob-edit/:datajobKey",data:{pageTitle:"Edit Data Job",action:"edit"},loadChildren:function(){return a.e(4).then(a.bind(null,"geWG")).then((function(e){return e.DatajobEditModule}))}},{path:"datajob-new",data:{pageTitle:"New Data Job",action:"new"},loadChildren:function(){return a.e(4).then(a.bind(null,"geWG")).then((function(e){return e.DatajobEditModule}))}},{path:"datajob-run/:datajobKeys",component:Oo,data:{pageTitle:"Run datajobs"}}],Fc=r.i.forChild([{path:"agents",data:{pageTitle:"Remote Agents"},children:vc},{path:"connections",data:{pageTitle:"Connections"},children:[{path:"",pathMatch:"full",component:tt,data:{pageTitle:"Connections"}},{path:"",children:mc},fc]},{path:"datalinks",data:{pageTitle:"Data Links"},children:[{path:"",pathMatch:"full",data:{pageTitle:"Data Links"},component:At},{path:"",children:dc},{path:"",children:pc}]},fc,{path:"datajobs",data:{pageTitle:"Data Jobs"},children:[{path:"",pathMatch:"full",component:Nt},{path:"",children:xc},{path:"",children:pc}]},{path:"columnValidations",data:{pageTitle:"Column Validations"},children:[{path:"",pathMatch:"full",component:N},{path:"",children:yc}]},{path:"customFunctions",data:{pageTitle:"Custom Functions"},children:[{path:"",pathMatch:"full",component:ni},{path:"",children:gc}]},{path:"fileFormats",data:{pageTitle:"File Formats"},children:[{path:"",pathMatch:"full",component:Yt.b},{path:"",children:Cc}]},{path:"views",data:{pageTitle:"Views"},children:[{path:"",pathMatch:"full",component:zi.a},{path:"",children:kc}]},{path:"dashboards",data:{pageTitle:"Dashboards"},children:[{path:"",pathMatch:"full",component:po},{path:"",children:wc}]},{path:"listOfValues",data:{pageTitle:"List of Values"},children:[{path:"",pathMatch:"full",component:$o},{path:"",children:Sc}]},{path:"apis",data:{pageTitle:"Apis"},children:[{path:"",pathMatch:"full",component:yr},{path:"",children:Oc}]},{path:"hubVariables",data:{pageTitle:"Hub Variables"},children:[{path:"",pathMatch:"full",component:Ra},{path:"",children:Nc}]},{path:"manage",children:[{path:"manage-users",component:Qa,data:{pageTitle:"Manage Users"}}]},{path:"import",children:[{path:"",pathMatch:"full",component:ht,data:{pageTitle:"Import Objects"}}]},{path:"export",children:[{path:"",pathMatch:"full",component:pt,data:{pageTitle:"Export Objects"}}]},{path:"sharedData",data:{pageTitle:"Shared Data"},children:[{path:"",pathMatch:"full",component:In},{path:"",children:[{path:"table-preview/:tableKey",component:Qn,data:{pageTitle:"Preview Table"}},{path:"datalink-preview/:datalinkKey",component:Xt,data:{pageTitle:"Preview Datalink"}},{path:"dashboard-preview/:dashboardKey",data:{pageTitle:"Preview Dashboard",action:"edit"},loadChildren:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"DN8j")).then((function(e){return e.DashboardEditModule}))}},{path:"view-preview/:viewKey",component:qi.a,data:{pageTitle:"Preview View",action:"edit"}},{path:"api-preview/:apiKey",component:br,data:{pageTitle:"Preview Api",action:"edit"}}]}]},{path:"files",data:{pageTitle:"Files"},children:[{path:"",children:Dc}]},{path:"datalinkTests",data:{pageTitle:"Datalink Tests"},children:[{path:"",pathMatch:"full",component:Ai},{path:"",children:Tc},{path:"",children:pc}]},{path:"tags",component:(lc=function(){function e(t,a,n,i,r){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.formsService=i,this.route=r,this.state="hide",this.colors=[{name:"primary",color:"#3a5f8d"},{name:"secondary",color:"#89B3BF"},{name:"success",color:"#479762"},{name:"warning",color:"#c4872a"},{name:"danger",color:"#f44336"},{name:"yellow",color:"yellow"},{name:"pink",color:"pink"},{name:"purple",color:"purple"},{name:"dark",color:"#1F2624"}],this.columns=[{name:"name",title:"Name",footer:"description",format:"Md"}],this._tableData=new s.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(l.a)(this.route.queryParams,this.hubService.getHubCacheObservable()).subscribe((function(t){var a=t[0];if(e.hubCache=t[1],a.key){var n=e.hubCache.hub.dexihTags.find((function(e){return e.key===+a.key}));if(n){var i=e.hubCache.hub.dexihTags.find((function(e){return e.key===n.key}));e.formsService.tag(i),e.state="show"}}e.update()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"update",value:function(){if(this.hubCache&&this.hubCache.isLoaded()){var e=this.hubCache.hub.dexihTags.filter((function(e){return e.isValid})).map((function(e){return{key:e.key,name:e.name,description:e.description,color:e.color,updateDate:e.updateDate}}));this._tableData.next(e)}else this._tableData.next(null)}},{key:"new",value:function(){var e=new u.J;this.formsService.tag(e),this.state="show"}},{key:"edit",value:function(e){var t=this.hubCache.hub.dexihTags.find((function(t){return t.key===e.key}));this.formsService.tag(t),this.state="show",history.pushState&&this.router.navigateByUrl(window.location.pathname+"?key="+e.key),document.body.scrollTop=0,document.documentElement.scrollTop=0}},{key:"delete",value:function(e){this.hubService.deleteTags(e)}},{key:"save",value:function(){var e=this;this.formsService.save(!1).then((function(){e.hide()})).catch()}},{key:"cancel",value:function(){this.hide()}},{key:"hide",value:function(){this.state="hide",history.pushState&&window.location.search&&this.router.navigateByUrl(window.location.pathname)}},{key:"selectColor",value:function(e){this.formsService.currentForm.controls.color.setValue(e.color)}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddTag(e.key,a)})),this.hubService.exportHub(a,1===e.length?"Tag - "+e[0].name+".json":"tags.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass===u.dc.Tags&&e.update()}))}}]),e}(),lc.\u0275fac=function(e){return new(e||lc)(b.Kb(Xo.a),b.Kb(c.a),b.Kb(r.e),b.Kb(D.a),b.Kb(r.a))},lc.\u0275cmp=b.Eb({type:lc,selectors:[["tags"]],features:[b.xb([D.a])],decls:14,vars:6,consts:[[1,"container-fluid"],["title","Tags","iconClass","fa fa-lg fa-fw fa-tags",3,"showCloseButton","close"],["rowStatusHeading","Color",3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","rowClick"],["select","selectedItemAction"],["selectedItemAction",""],["select","selectedItemsAction"],["selectedItemsAction",""],["actions",""],["select","rowStatus"],["rowStatus",""],["tableHeader",""],["title","Views","path","/assets/help/reference/tag.md",1,"m-3"],[1,"mr-1",3,"click"],["class","mr-1",3,"click",4,"ngIf"],[1,"alert","p-1","text-center",3,"ngStyle","click"],[1,"blend-text","font-weight-bold"],[1,"card","mt-2",2,"width","100%"],[1,"card-header","text-white","bg-primary"],[1,"card-body"],[3,"formGroup",4,"ngIf"],[1,"card-footer"],[3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-3"],["label","Tag Name","formControlName","name","placeholder","Enter the name.","iconClass","fa fa-list",3,"autocapitalize","errors"],[1,"form-group","col-md-9"],[1,"mt-1"],[1,"input-group","m-0"],[1,"btn","mr-1",2,"height","38px","width","76px"],["formControlName","color","hidden","","type","color"],["formControlName","color","placeholder","color",1,"mr-3",2,"height","38px","width","90px"],["data-toggle","buttons",1,"btn-group-toggle"],["class","btn mr-1","style","height: '38px'; width: '38px'",3,"background-color","click",4,"ngFor","ngForOf"],[1,"col-md-12"],["label","Description","formControlName","description","placeholder","Enter the description.",3,"showMarkdown"],[1,"btn","mr-1",2,"height","38px","width","38px",3,"click"]],template:function(e,t){1&e&&(b.Ob(0,"div",0),b.Ob(1,"dexih-widget",1),b.Vb("close",(function(){return t.close()})),b.Ob(2,"dexih-table",2),b.Vb("rowClick",(function(e){return t.edit(e)})),b.Dc(3,Jo,1,0,"ng-template",3,4,b.Ec),b.Dc(5,tc,2,1,"ng-template",5,6,b.Ec),b.Dc(7,nc,1,1,"ng-template",null,7,b.Ec),b.Dc(9,rc,3,4,"ng-template",8,9,b.Ec),b.Dc(11,sc,9,2,"ng-template",null,10,b.Ec),b.Nb(),b.Nb(),b.Lb(13,"dexih-help",11),b.Nb()),2&e&&(b.yb(1),b.hc("showCloseButton",!0),b.yb(1),b.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData))},directives:[h.P,d.a,$.a,h.j,h.u,v.t,h.g,h.o,v.w,h.t,h.b,n.I,n.t,n.l,h.D,n.s,n.j,n.c,v.s,h.H],encapsulation:2,data:{animation:[Object(Yo.j)("slideDown",[Object(Yo.g)("hide",Object(Yo.h)({height:0,overflow:"hidden"})),Object(Yo.g)("show",Object(Yo.h)({height:"*",overflow:"unset"})),Object(Yo.i)("hide <=> show",Object(Yo.e)("200ms ease-in"))])]}}),lc)},{path:"search",data:{pageTitle:"Search"},children:[{path:"",pathMatch:"full",redirectTo:"0/"},{path:":searchObject/:search",pathMatch:"full",component:so},{path:":searchObject/:search",loadChildren:function(){return Promise.resolve().then(a.bind(null,"e1St")).then((function(e){return e.HubBaseModule}))}}]},{path:"",children:mc},{path:"",children:dc},{path:"",children:hc},{path:"",children:xc},{path:"",children:pc},{path:"",children:gc},{path:"",children:yc},{path:"",children:Cc},{path:"",children:kc},{path:"",children:wc},{path:"",children:Sc},{path:"",children:Oc},{path:"",children:Nc},{path:"",children:Dc},{path:"",children:vc},{path:"",children:Tc}]),Ic=a("mCXf"),Kc=((uc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[o.a,Fi.a]}}}]),e}()).\u0275mod=b.Ib({type:uc}),uc.\u0275inj=b.Hb({factory:function(e){return new(e||uc)},providers:[Fi.a],imports:[[i.a,Fc,n.C,lo.a,Ic.a,uo]]}),uc)},mCXf:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("PCNd"),i=a("RRRx"),r=a("fXoL"),o=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[n.a,i.a]]}),e}()},wTS4:function(e,t,a){"use strict";a.d(t,"a",(function(){return T})),a.d(t,"b",(function(){return we}));var n=a("4Y1E"),i=a("2Vo4"),r=a("itXk"),o=a("3WyZ"),c=a("soiQ"),s=a("fXoL"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("3Pt+"),d=a("ofXK"),f=a("Npcx");function m(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",9),s.Ob(1,"div",10),s.Ob(2,"dexih-button-refresh",11),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(3,"input",12),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().rows=e})),s.Nb(),s.Nb(),s.Ob(4,"div",13),s.Ob(5,"form-select",14),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().auditType=e})),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.yb(3),s.hc("ngModel",n.rows),s.yb(2),s.hc("ngModel",n.auditType)("border",!1)("items",n.auditTypes)("enableTextEntry",!1)("allowNullSelect",!0)}}function v(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",17),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datalinks=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datalinks)("items",n.hubCache.hub.dexihDatalinks)("enableAddAll",!0)}}function p(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",18),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datajobs=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datajobs)("items",n.hubCache.hub.dexihDatajobs)("enableAddAll",!0)}}function g(e,t){if(1&e){var a=s.Pb();s.Ob(0,"div",16),s.Ob(1,"form-tags-dropdown",19),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb(2).datalinkTests=e})),s.Nb(),s.Nb()}if(2&e){var n=s.Zb(2);s.yb(1),s.hc("ngModel",n.datalinkTests)("items",n.hubCache.hub.dexihDatalinkTests)("enableAddAll",!0)}}function y(e,t){if(1&e&&(s.Dc(0,v,2,3,"div",15),s.Dc(1,p,2,3,"div",15),s.Dc(2,g,2,3,"div",15)),2&e){var a=s.Zb();s.hc("ngIf","Datalink"===a.auditType),s.yb(1),s.hc("ngIf","Datajob"===a.auditType),s.yb(1),s.hc("ngIf","DatalinkTest"===a.auditType)}}var C=function(e,t){return[e,"datalink-edit","edit",t]},k=function(e,t){return["result-view",e,t]};function w(e,t){if(1&e&&(s.Lb(0,"dexih-button-edit",20),s.Lb(1,"dexih-button-view",21)),2&e){var a=t.item,n=s.Zb();s.hc("routerLink",s.nc(2,C,n.hubPath,a.referenceKey)),s.yb(1),s.hc("routerLink",s.nc(5,k,a.auditConnectionKey,a.auditKey))}}function S(e,t){1&e&&s.Lb(0,"datalink-status",22),2&e&&s.hc("writerResult",t.item)}var O,N,T=((O=function(){function e(t,a,n){_classCallCheck(this,e),this.hubService=t,this.router=a,this.route=n,this.rows=20,this.cancelToken=new o.a,this.showPage=!1,this.showPageMessage="Loading...",this.columns=[{name:"auditKey",title:"#",format:""},{name:"auditType",title:"Type",format:""},{name:"referenceName",title:"Name",format:""},{name:"rowsTotal",title:"Rows Total",format:""},{name:"startTime",title:"Start Date",format:"Calendar"},{name:"startTime",title:"Time",format:"Time"},{name:"endTime",title:"Finished At",format:"Time"},{name:"message",title:"Message",format:""}],this.auditTypes=["Datalink","Datajob","DatalinkTest"],this._tableData=new i.a(null),this.tableData=this._tableData.asObservable(),this.datalinks=[],this.datajobs=[],this.datalinkTests=[],this.auditType=null}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;try{this._subscription=Object(r.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(),this.hubService.getRemoteAgentObservable()).subscribe((function(t){var a=t[2];e.hubCache=t[3];var n=t[4];if(e.showPage=!1,e.showPageMessage="Waiting for an active remote agent...",e.hubCache.isLoaded()&&n){e.hubPath=e.hubCache.getHubUrl();var i=a.datalinkKeys,r=a.datajobKeys,o=a.datalinkTestKeys;i&&(e.datalinks=(i+"").split(",").map((function(e){return+e})),e.auditType="Datalink"),r&&(e.datajobs=(r+"").split(",").map((function(e){return+e})),e.auditType="Datajob"),o&&(e.datalinkTests=(o+"").split(",").map((function(e){return+e})),e.auditType="DatalinkTest"),e.refresh(),e.showPage=!0,e.showPageMessage=""}}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Results Index")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"showResult",value:function(e){this.router.navigate(["result-view",e.auditConnectionKey,e.auditKey],{relativeTo:this.route})}},{key:"refresh",value:function(){var e,t=this,a=[];switch(this.auditType){case"Datalink":e=this.datalinks,a=this.datalinks.map((function(e){return t.hubCache.hub.dexihDatalinks.find((function(t){return t.key===e})).auditConnectionKey}));break;case"Datajob":e=this.datajobs,a=this.datajobs.map((function(e){return t.hubCache.hub.dexihDatajobs.find((function(t){return t.key===e})).auditConnectionKey}));break;case"DatalinkTest":e=this.datalinkTests,a=this.datalinkTests.map((function(e){return t.hubCache.hub.dexihDatalinkTests.find((function(t){return t.key===e})).auditConnectionKey}));break;default:e=null}var n=a.filter((function(e,t,a){return a.indexOf(e)===t}));0===n.length&&(n=this.hubCache.hub.dexihConnections.filter((function(e){return e.purpose===c.jb.Managed})).map((function(e){return e.key}))),this.hubService.getAuditResults(this.auditType,n,e,!0,this.rows,this.cancelToken).then((function(e){t._tableData.next(e),t.watchChanges()}))}},{key:"watchChanges",value:function(){var e=this;this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe((function(t){var a=e._tableData.value;if(e.datalinks&&e.datalinks.findIndex((function(e){return e===t.referenceKey}))>=0){var n=a.find((function(e){return e.auditKey===t.auditKey}));n?(Object.assign(n,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}if(e.datajobs&&e.datajobs.findIndex((function(e){return e===t.referenceKey}))>=0){var i=a.find((function(e){return e.auditKey===t.auditKey}));i?(Object.assign(i,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}if(e.datalinkTests&&e.datalinkTests.findIndex((function(e){return e===t.referenceKey}))>=0){var r=a.find((function(e){return e.auditKey===t.auditKey}));r?(Object.assign(r,t),e._tableData.next(a)):e._tableData.next([t].concat(a))}}))}}]),e}()).\u0275fac=function(e){return new(e||O)(s.Kb(n.a),s.Kb(l.e),s.Kb(l.a))},O.\u0275cmp=s.Eb({type:O,selectors:[["results-index"]],decls:11,vars:6,consts:[[1,"container-fluid"],["title","Execution Results","iconClass","fa fa-lg fa-fw fa-exchange"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","enableSaveCsv","rowClick"],["actions",""],["tableHeader",""],["select","selectedItemAction"],["selectedItemAction",""],["select","rowStatus"],["rowStatus",""],[1,"d-flex","flex-wrap"],[1,"input-group"],["text","Reload",1,"input-group-prepend",3,"click"],["type","number","placeholder","Maximum rows...","title","Specify the maximum rows to return",1,"form-control",2,"width","100%","max-width","100px",3,"ngModel","ngModelChange"],[1,"flex-fill","ml-1"],["labelLeft","Type","selectNullMessage","All types",1,"form-control","p-0",3,"ngModel","border","items","enableTextEntry","allowNullSelect","ngModelChange"],["class","d-flex flex-wrap pt-1",4,"ngIf"],[1,"d-flex","flex-wrap","pt-1"],["labelLeft","Datalinks","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","Datajobs","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["labelLeft","DatalinkTests","itemKey","key","itemName","name",3,"ngModel","items","enableAddAll","ngModelChange"],["text","Edit Datalink",1,"mr-1",3,"routerLink"],["queryParamsHandling","merge",3,"routerLink"],[3,"writerResult"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"dexih-widget",1),s.Ob(2,"dexih-table",2),s.Vb("rowClick",(function(e){return t.showResult(e)})),s.Dc(3,m,6,6,"ng-template",null,3,s.Ec),s.Dc(5,y,3,3,"ng-template",null,4,s.Ec),s.Dc(7,w,2,8,"ng-template",5,6,s.Ec),s.Dc(9,S,1,1,"ng-template",7,8,s.Ec),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(2),s.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("enableSaveCsv",!0))},directives:[u.P,b.a,u.s,h.y,h.c,h.s,h.v,u.E,d.t,u.G,u.j,l.f,u.y,f.a],encapsulation:2}),O),D=a("ElCs"),x=a("zQsl"),F=function(e){return["progress-bar",e]},I=function(e){return{width:e}},K=((N=function(){function e(){_classCallCheck(this,e),this.percent="0%"}return _createClass(e,[{key:"ngOnInit",value:function(){if(0===this.value)this.percent="0%";else if(0===this.total)this.percent="100%";else{var e=100*this.value/this.total;e<0&&(e=0),e>100&&(e=100),this.percent=e.toString()+"%"}}}]),e}()).\u0275fac=function(e){return new(e||N)},N.\u0275cmp=s.Eb({type:N,selectors:[["result-progress"]],inputs:{value:"value",total:"total",caption:"caption",color:"color"},decls:8,vars:9,consts:[[1,""],[1,"text"],[1,"float-right"],[1,"progress",2,"width","100%"],[3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"span",1),s.Fc(2),s.Ob(3,"span",2),s.Fc(4),s.Nb(),s.Nb(),s.Ob(5,"div",3),s.Ob(6,"div",4),s.Fc(7,"\xa0"),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(2),s.Hc(" ",t.caption," "),s.yb(2),s.Ic("",t.value,"/",t.total,""),s.yb(2),s.hc("ngClass",s.mc(5,F,t.color))("ngStyle",s.mc(7,I,t.percent)))},directives:[d.q,d.w],encapsulation:2}),N),E=a("WrAK");function V(e,t){1&e&&(s.Ob(0,"li",27),s.Ob(1,"h5"),s.Fc(2,"Error encountered!"),s.Nb(),s.Nb())}function L(e,t){1&e&&(s.Ob(0,"li",28),s.Ob(1,"h5"),s.Fc(2,"Finished Successfully"),s.Nb(),s.Nb())}function P(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button",33),s.Vb("click",(function(){s.vc(a);var e=s.Zb(2);return e.exceptionHidden=!e.exceptionHidden})),s.Fc(1,"Details"),s.Nb()}}function A(e,t){if(1&e&&(s.Ob(0,"pre"),s.Fc(1),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.Gc(a.auditResult.exceptionDetails)}}function R(e,t){if(1&e&&(s.Ob(0,"li",5),s.Ob(1,"div",29),s.Fc(2),s.Ob(3,"div",30),s.Dc(4,P,2,0,"dexih-button",31),s.Nb(),s.Nb(),s.Ob(5,"div"),s.Dc(6,A,2,1,"pre",32),s.Nb(),s.Nb()),2&e){var a=s.Zb();s.yb(2),s.Hc(" ",a.auditResult.message," "),s.yb(2),s.hc("ngIf",a.auditResult.exceptionDetails),s.yb(2),s.hc("ngIf",!a.exceptionHidden&&a.auditResult.exceptionDetails)}}function j(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1,"Target Table"),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.Nb(),s.Lb(4,"div",10)),2&e){var a=s.Zb();s.yb(3),s.Gc(a.auditResult.targetTableName)}}function _(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1,"Scheduled Time"),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.ac(4,"calendar"),s.Nb(),s.Lb(5,"div",10)),2&e){var a=s.Zb();s.yb(3),s.Gc(s.bc(4,1,a.auditResult.scheduledTime))}}function M(e,t){1&e&&(s.Ob(0,"li",13),s.Ob(1,"h5"),s.Fc(2,"Child Results"),s.Nb(),s.Nb())}function Z(e,t){if(1&e&&(s.Ob(0,"div"),s.Ob(1,"div",35),s.Ob(2,"span",36),s.Fc(3),s.Nb(),s.Lb(4,"datalink-status",37),s.Nb(),s.Nb()),2&e){var a=t.$implicit;s.yb(3),s.Hc(" ","Table"===a.auditType?a.targetTableName:a.referenceName," "),s.yb(1),s.hc("writerResult",a)}}function H(e,t){if(1&e&&(s.Ob(0,"li",5),s.Dc(1,Z,5,2,"div",34),s.Nb()),2&e){var a=s.Zb();s.yb(1),s.hc("ngForOf",a.auditResult.childResults)}}function B(e,t){if(1&e&&s.Lb(0,"result-progress",38),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsReadPrimary)("total",a.auditResult.rowsReadPrimary+a.auditResult.rowsReadReference)}}function U(e,t){if(1&e&&s.Lb(0,"result-progress",39),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsReadReference)("total",a.auditResult.rowsReadPrimary+a.auditResult.rowsReadReference)}}function q(e,t){if(1&e&&s.Lb(0,"result-progress",40),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsCreated)("total",a.auditResult.rowsTotal)}}function z(e,t){if(1&e&&s.Lb(0,"result-progress",41),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsUpdated)("total",a.auditResult.rowsTotal)}}function W(e,t){if(1&e&&s.Lb(0,"result-progress",42),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsDeleted)("total",a.auditResult.rowsTotal)}}function G(e,t){if(1&e&&s.Lb(0,"result-progress",43),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsRejected)("total",a.auditResult.rowsTotal)}}function Q(e,t){if(1&e&&s.Lb(0,"result-progress",44),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsPreserved)("total",a.auditResult.rowsTotal)}}function $(e,t){if(1&e&&s.Lb(0,"result-progress",45),2&e){var a=s.Zb();s.hc("value",a.auditResult.rowsIgnored)("total",a.auditResult.rowsTotal)}}function X(e,t){if(1&e&&s.Lb(0,"result-progress",46),2&e){var a=s.Zb();s.hc("value",a.auditResult.passed)("total",a.auditResult.rowsTotal)}}function Y(e,t){if(1&e&&s.Lb(0,"result-progress",47),2&e){var a=s.Zb();s.hc("value",a.auditResult.failed)("total",a.auditResult.rowsTotal)}}function J(e,t){if(1&e&&(s.Ob(0,"div",9),s.Fc(1),s.Nb(),s.Ob(2,"div",9),s.Fc(3),s.ac(4,"number"),s.Nb(),s.Lb(5,"div",10)),2&e){var a=t.$implicit;s.yb(1),s.Gc(a.transformName),s.yb(2),s.Hc("",0==a.seconds?"N/A":s.cc(4,2,a.rows/a.seconds,"1.2-2")," rows/second")}}var ee,te=((ee=function(){function e(t,a){_classCallCheck(this,e),this.route=t,this.router=a,this.exceptionHidden=!0,this.fail=!1,this.success=!1,this.eRunStatus=c.Yb,this.eTriggerMethod=c.oc}return _createClass(e,[{key:"ngOnInit",value:function(){switch(this.runTime=this.auditResult.endTime?(new Date(this.auditResult.endTime).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:this.auditResult.runStatus===c.Yb.Running||this.auditResult.runStatus===c.Yb.RunningErrors||this.auditResult.runStatus===c.Yb.Started?((new Date).valueOf()-new Date(this.auditResult.startTime).valueOf())/1e3:null,this.auditResult.runStatus){case c.Yb.Abended:case c.Yb.Cancelled:case c.Yb.Failed:case c.Yb.FinishedErrors:this.fail=!0;break;case c.Yb.Finished:case c.Yb.Passed:this.success=!0}this.barChartData=[{name:"Reading",value:this.rowsPerSecond(this.auditResult.rowsReadPrimary+this.auditResult.rowsReadReference,this.auditResult.readTicks)},{name:"Processing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.processingTicks)},{name:"Writing",value:this.rowsPerSecond(this.auditResult.rowsTotal,this.auditResult.writeTicks)}]}},{key:"numberWithCommas",value:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},{key:"rowsPerSecond",value:function(e,t){return 0===t?0:e/(t/1e7)}},{key:"openResult",value:function(e){this.router.navigate(["..",e],{relativeTo:this.route})}}]),e}()).\u0275fac=function(e){return new(e||ee)(s.Kb(l.a),s.Kb(l.e))},ee.\u0275cmp=s.Eb({type:ee,selectors:[["stats"]],inputs:{auditResult:"auditResult"},decls:75,vars:44,consts:[[1,"list-group"],["class","list-group-item list-group-item-danger",4,"ngIf"],["class","list-group-item list-group-item-success",4,"ngIf"],["class","list-group-item",4,"ngIf"],[1,"list-group-item","list-group-item-info","rounded-0"],[1,"list-group-item"],[1,"container"],[1,"row","rounded","text-white","bg-secondary"],[3,"ngIf"],[1,"col","border","border-white"],[1,"w-100"],["class","list-group-item list-group-item-info",4,"ngIf"],["class","list-group-item ",4,"ngIf"],[1,"list-group-item","list-group-item-info"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total",4,"ngIf"],["caption","Created","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Updated","color","bg-color-blueDark",3,"value","total",4,"ngIf"],["caption","Deleted","color","bg-color-magenta",3,"value","total",4,"ngIf"],["caption","Rejected","color","bg-color-red",3,"value","total",4,"ngIf"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total",4,"ngIf"],["caption","Ignored","color","bg-color-grayDark",3,"value","total",4,"ngIf"],["caption","Passed","color","bg-color-greenDark",3,"value","total",4,"ngIf"],["caption","Failed","color","bg-color-magenta",3,"value","total",4,"ngIf"],["ngFor","",3,"ngForOf"],[2,"display","grid"],["scheme","natural","yAxisLabel","rows/second","xAxisLabel","operation",3,"results","gradient","xAxis","yAxis","legend","showGridLines","showXAxisLabel","showYAxisLabel"],[1,"list-group-item","list-group-item-danger"],[1,"list-group-item","list-group-item-success"],[1,"d-flex","mb-2"],[1,"ml-auto"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],[4,"ngFor","ngForOf"],[1,""],[1,"text"],[3,"writerResult"],["caption","Source Rows","color","bg-color-blueDark",3,"value","total"],["caption","Joined Rows","color","bg-color-blueLight",3,"value","total"],["caption","Created","color","bg-color-greenDark",3,"value","total"],["caption","Updated","color","bg-color-blueDark",3,"value","total"],["caption","Deleted","color","bg-color-magenta",3,"value","total"],["caption","Rejected","color","bg-color-red",3,"value","total"],["caption","Preserved","color","bg-color-pinkDark",3,"value","total"],["caption","Ignored","color","bg-color-grayDark",3,"value","total"],["caption","Passed","color","bg-color-greenDark",3,"value","total"],["caption","Failed","color","bg-color-magenta",3,"value","total"]],template:function(e,t){1&e&&(s.Ob(0,"ul",0),s.Dc(1,V,3,0,"li",1),s.Dc(2,L,3,0,"li",2),s.Dc(3,R,7,3,"li",3),s.Ob(4,"li",4),s.Ob(5,"h5"),s.Fc(6,"Running Time"),s.Nb(),s.Nb(),s.Ob(7,"li",5),s.Ob(8,"div",6),s.Ob(9,"div",7),s.Dc(10,j,5,1,"ng-template",8),s.Ob(11,"div",9),s.Fc(12,"Run Status"),s.Nb(),s.Ob(13,"div",9),s.Fc(14),s.Nb(),s.Lb(15,"div",10),s.Ob(16,"div",9),s.Fc(17,"Start Date"),s.Nb(),s.Ob(18,"div",9),s.Fc(19),s.ac(20,"calendar"),s.Nb(),s.Lb(21,"div",10),s.Dc(22,_,6,3,"ng-template",8),s.Ob(23,"div",9),s.Fc(24,"Initialized"),s.Nb(),s.Ob(25,"div",9),s.Fc(26),s.ac(27,"calendar"),s.Nb(),s.Lb(28,"div",10),s.Ob(29,"div",9),s.Fc(30,"Started"),s.Nb(),s.Ob(31,"div",9),s.Fc(32),s.ac(33,"calendar"),s.Nb(),s.Lb(34,"div",10),s.Ob(35,"div",9),s.Fc(36,"Finished"),s.Nb(),s.Ob(37,"div",9),s.Fc(38),s.ac(39,"calendar"),s.Nb(),s.Lb(40,"div",10),s.Ob(41,"div",9),s.Fc(42,"Run Time"),s.Nb(),s.Ob(43,"div",9),s.Fc(44),s.ac(45,"number"),s.Nb(),s.Lb(46,"div",10),s.Ob(47,"div",9),s.Fc(48,"Triggered By"),s.Nb(),s.Ob(49,"div",9),s.Fc(50),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Dc(51,M,3,0,"li",11),s.Dc(52,H,2,1,"li",12),s.Ob(53,"li",13),s.Ob(54,"h5"),s.Fc(55,"Row Distribution"),s.Nb(),s.Nb(),s.Ob(56,"li",5),s.Dc(57,B,1,2,"result-progress",14),s.Dc(58,U,1,2,"result-progress",15),s.Dc(59,q,1,2,"result-progress",16),s.Dc(60,z,1,2,"result-progress",17),s.Dc(61,W,1,2,"result-progress",18),s.Dc(62,G,1,2,"result-progress",19),s.Dc(63,Q,1,2,"result-progress",20),s.Dc(64,$,1,2,"result-progress",21),s.Dc(65,X,1,2,"result-progress",22),s.Dc(66,Y,1,2,"result-progress",23),s.Nb(),s.Ob(67,"li",13),s.Ob(68,"h5"),s.Fc(69,"Performance Estimates (rows/second)"),s.Nb(),s.Nb(),s.Ob(70,"li",5),s.Ob(71,"div",7),s.Dc(72,J,6,5,"ng-template",24),s.Nb(),s.Ob(73,"div",25),s.Lb(74,"ngx-charts-bar-vertical",26),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.yb(1),s.hc("ngIf",t.fail),s.yb(1),s.hc("ngIf",t.success),s.yb(1),s.hc("ngIf",null==t.auditResult?null:t.auditResult.message),s.yb(7),s.hc("ngIf",t.auditResult.targetTableName),s.yb(4),s.Gc(t.eRunStatus[t.auditResult.runStatus]),s.yb(5),s.Gc(s.bc(20,33,t.auditResult.initializeTime)),s.yb(3),s.hc("ngIf",t.auditResult.scheduledTime),s.yb(4),s.Gc(s.bc(27,35,t.auditResult.initializeTime)),s.yb(6),s.Gc(s.bc(33,37,t.auditResult.startTime)),s.yb(6),s.Gc(s.bc(39,39,t.auditResult.endTime)),s.yb(6),s.Hc("",s.cc(45,41,t.runTime,"1.2-2")," seconds"),s.yb(6),s.Gc(t.eTriggerMethod[t.auditResult.triggerMethod]),s.yb(1),s.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),s.yb(1),s.hc("ngIf",(null==t.auditResult.childResults?null:t.auditResult.childResults.length)>0),s.yb(5),s.hc("ngIf",t.auditResult.rowsReadPrimary>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsReadReference>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsCreated>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsUpdated>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsDeleted>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsRejected>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsPreserved>0),s.yb(1),s.hc("ngIf",t.auditResult.rowsIgnored>0),s.yb(1),s.hc("ngIf",t.auditResult.passed>0),s.yb(1),s.hc("ngIf",t.auditResult.failed>0),s.yb(6),s.hc("ngForOf",t.auditResult.performanceSummary),s.yb(2),s.hc("results",t.barChartData)("gradient",!0)("xAxis",!0)("yAxis",!0)("legend",!1)("showGridLines",!0)("showXAxisLabel",!0)("showYAxisLabel",!0))},directives:[d.t,d.s,x.p,u.f,f.a,K],pipes:[E.a,d.g],encapsulation:2}),ee);function ae(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-refresh",2),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(1,"dexih-button-download",3),s.Vb("click",(function(){return s.vc(a),s.Zb().download()})),s.Nb(),s.Ob(2,"div",4),s.Ob(3,"div",5),s.Ob(4,"form-checkbox",6),s.Vb("ngModelChange",(function(e){return s.vc(a),s.Zb().showDetailed=e}))("change",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.yb(4),s.hc("ngModel",n.showDetailed)("border",!0)}}var ne,ie=((ne=function(){function e(t,a){_classCallCheck(this,e),this.authService=t,this.hubService=a,this.showDetailed=!1,this.cancelToken=new o.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.refresh()}},{key:"ngOnDestroy",value:function(){this.cancelToken.cancel()}},{key:"refresh",value:function(){var e=this;this.hubService.previewProfileData(this.auditResult,!this.showDetailed,this.cancelToken).then((function(t){e.columns=t.columns,e.data=t.data})).catch((function(e){}))}},{key:"download",value:function(){this.hubService.downloadProfileData(this.auditResult,this.cancelToken)}}]),e}()).\u0275fac=function(e){return new(e||ne)(s.Kb(D.a),s.Kb(n.a))},ne.\u0275cmp=s.Eb({type:ne,selectors:[["profile-results"]],inputs:{auditResult:"auditResult"},decls:3,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[1,"d-flex","flex-wrap"],[1,"flex-fill","pl-1"],["label","Show Detailed Results",3,"ngModel","border","ngModelChange","change"]],template:function(e,t){1&e&&(s.Ob(0,"dexih-table",0),s.Dc(1,ae,5,2,"ng-template",null,1,s.Ec),s.Nb()),2&e&&s.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[b.a,u.s,u.h,u.A,h.s,h.v],encapsulation:2}),ne),re=a("XNiG"),oe=a("RXlv");function ce(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-button-refresh",3),s.Vb("click",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb(),s.Ob(1,"dexih-button-download",4),s.Vb("click",(function(){return s.vc(a),s.Zb().download()})),s.Nb()}}function se(e,t){if(1&e){var a=s.Pb();s.Ob(0,"query-builder",5),s.Vb("onRefreshData",(function(){return s.vc(a),s.Zb().refresh()})),s.Nb()}if(2&e){var n=s.Zb();s.hc("selectQuery",n.selectQuery)("columns",n.targetTable.dexihTableColumns)("inputColumns",n.inputColumns)("refreshEvent",n.refreshDataSubject.asObservable())}}var le,ue=((le=function(){function e(t){_classCallCheck(this,e),this.hubService=t,this.selectQuery=new c.V,this.refreshDataSubject=new re.a,this.cancelToken=new o.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this._hubCacheSubscription=this.hubService.getHubCacheObservable().subscribe((function(t){switch(e.cache=t,e.auditResult.auditType){case"Table":e.targetTable=e.cache.getTable(e.auditResult.referenceKey),e.refresh();break;case"Datalink":case"DatalinkStep":var a=e.cache.hub.dexihDatalinks.find((function(t){return t.key===e.auditResult.referenceKey}));if(!a)return void e.hubService.addHubErrorMessage("The datalink with the key ".concat(e.auditResult.referenceKey," cannot be found."));if(!(a.dexihDatalinkTargets.length>=1))return void e.hubService.addHubErrorMessage("There is no target table for this datalink.");e.targetTable=e.cache.getTable(a.dexihDatalinkTargets[0].tableKey),e.refresh();break;case"DatalinkTestStep":var n=e.cache.getDatalinkTestStep(e.auditResult.referenceKey);if(!n)return void e.hubService.addHubErrorMessage("The test step with the key ".concat(e.auditResult.referenceKey," cannot be found."));var i=e.cache.hub.dexihDatalinks.find((function(e){return e.key===n.datalinkKey}));if(!(i.dexihDatalinkTargets.length>=1))return void e.hubService.addHubErrorMessage("There is no target table for this datalink.");var r=e.cache.getTable(i.dexihDatalinkTargets[0].tableKey),o=JSON.parse(JSON.stringify(r));o.name=n.errorTableName,o.schema=n.errorSchema,o.connectionKey=n.errorConnectionKey;var s,l=_createForOfIteratorHelper(o.dexihTableColumns);try{for(l.s();!(s=l.n()).done;)s.value.deltaType=c.qb.NonTrackingField}catch(d){l.e(d)}finally{l.f()}var u=new c.I;u.name="error_audit_key",u.dataType=c.pc.Int64,u.deltaType=c.qb.CreateAuditKey;var b=new c.I;b.name="error_operation",b.dataType=c.pc.CharArray,b.maxLength=1,b.deltaType=c.qb.DatabaseOperation;var h=new c.I;h.name="mismatch_reason",h.dataType=c.pc.String,h.deltaType=c.qb.UpdateReason,o.dexihTableColumns.push(u),o.dexihTableColumns.push(b),o.dexihTableColumns.push(h),e.targetTable=o,e.refresh()}}))}},{key:"ngOnDestroy",value:function(){this._hubCacheSubscription&&this._hubCacheSubscription.unsubscribe(),this.runningQuery&&this.runningQuery.cancel(),this.cancelToken.cancel()}},{key:"createSelectQuery",value:function(){var e=this.targetTable.dexihTableColumns.find((function(e){return e.deltaType===c.qb.CreateAuditKey})),t=this.targetTable.dexihTableColumns.find((function(e){return e.deltaType===c.qb.UpdateAuditKey}));if(e||t){var a=JSON.parse(JSON.stringify(this.selectQuery));if(e){var n=new c.N;n.column1=new c.X,Object.assign(n.column1,e),n.operator=c.hb.IsEqual,n.value2=this.auditResult.auditKey,n.andOr=c.cb.Or,n.compareDataType=c.pc.Int64,a.filters.push(n)}if(t){var i=new c.N;i.column1=new c.X,Object.assign(i.column1,t),i.operator=c.hb.IsEqual,i.value2=this.auditResult.auditKey,i.andOr=c.cb.Or,i.compareDataType=c.pc.Int64,a.filters.push(i)}return a.rows=100,a}this.hubService.addHubErrorMessage("The table ".concat(this.targetTable.name," does not contain a create or update audit column which is required to connect to an audit."))}},{key:"refresh",value:function(){var e=this,t=this.createSelectQuery(),a=this.hubService.previewTableDataQuery(this.targetTable,!1,t,null,null,this.cancelToken);a.then((function(t){e.refreshDataSubject.next(),e.columns=t.columns,e.data=t.data})).catch((function(){})),this.runningQuery=a}},{key:"download",value:function(){var e=this.createSelectQuery(),t=new c.M;t.objectKey=this.targetTable.key,t.objectType=c.lb.Table,t.query=e,this.hubService.downloadData([t],!1,c.rb.Csv,this.cancelToken)}}]),e}()).\u0275fac=function(e){return new(e||le)(s.Kb(n.a))},le.\u0275cmp=s.Eb({type:le,selectors:[["preview-results"]],inputs:{auditResult:"auditResult"},decls:5,vars:3,consts:[[3,"enableMultiSelect","columns","data"],["actions",""],["tableHeader",""],["text","Reload",3,"click"],[1,"ml-1",3,"click"],[3,"selectQuery","columns","inputColumns","refreshEvent","onRefreshData"]],template:function(e,t){1&e&&(s.Ob(0,"dexih-table",0),s.Dc(1,ce,2,0,"ng-template",null,1,s.Ec),s.Dc(3,se,1,4,"ng-template",null,2,s.Ec),s.Nb()),2&e&&s.hc("enableMultiSelect",!1)("columns",t.columns)("data",t.data)},directives:[b.a,u.s,u.h,oe.a],encapsulation:2}),le),be=function(){return{view:"Profile"}};function he(e,t){if(1&e&&(s.Ob(0,"li",7),s.Ob(1,"a",8),s.Lb(2,"i",12),s.Ob(3,"span",10),s.Fc(4,"Profile Data"),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(3);s.yb(1),s.Cb("active","Profile"==a.view),s.hc("queryParams",s.lc(3,be))}}var de=function(){return{view:"Preview"}};function fe(e,t){if(1&e&&(s.Ob(0,"li",7),s.Ob(1,"a",8),s.Lb(2,"i",13),s.Ob(3,"span",10),s.Fc(4,"Preview"),s.Nb(),s.Nb(),s.Nb()),2&e){var a=s.Zb(3);s.yb(1),s.Cb("active","Preview"==a.view),s.hc("queryParams",s.lc(3,de))}}var me=function(){return{view:"Stats"}};function ve(e,t){if(1&e&&(s.Ob(0,"ul",6),s.Ob(1,"li",7),s.Ob(2,"a",8),s.Lb(3,"i",9),s.Ob(4,"span",10),s.Fc(5,"Execution Stats"),s.Nb(),s.Nb(),s.Nb(),s.Dc(6,he,5,4,"li",11),s.Dc(7,fe,5,4,"li",11),s.Nb()),2&e){var a=s.Zb(2);s.yb(2),s.Cb("active","Stats"==a.view),s.hc("queryParams",s.lc(5,me)),s.yb(4),s.hc("ngIf",a.auditResult.profileTableName&&("DatalinkStep"==(null==a.auditResult?null:a.auditResult.auditType)||"Datalink"==(null==a.auditResult?null:a.auditResult.auditType))),s.yb(1),s.hc("ngIf","DatalinkStep"==(null==a.auditResult?null:a.auditResult.auditType)||"Datalink"==(null==a.auditResult?null:a.auditResult.auditType)||"Table"==(null==a.auditResult?null:a.auditResult.auditType)||"DatalinkTestStep"==(null==a.auditResult?null:a.auditResult.auditType))}}function pe(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"stats",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function ge(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"profile-results",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function ye(e,t){if(1&e&&(s.Ob(0,"div"),s.Lb(1,"preview-results",14),s.Nb()),2&e){var a=s.Zb(2);s.yb(1),s.hc("auditResult",a.auditResult)}}function Ce(e,t){if(1&e){var a=s.Pb();s.Ob(0,"dexih-widget",2),s.Vb("close",(function(){return s.vc(a),s.Zb().close()})),s.Dc(1,ve,8,6,"ng-template",null,3,s.Ec),s.Ob(3,"div",4),s.Dc(4,pe,2,1,"div",5),s.Dc(5,ge,2,1,"div",5),s.Dc(6,ye,2,1,"div",5),s.Nb(),s.Nb()}if(2&e){var n=s.Zb();s.hc("title",null==n.auditResult?null:n.auditResult.referenceName)("showCloseButton",!0),s.yb(3),s.hc("ngSwitch",n.view),s.yb(1),s.hc("ngSwitchCase","Stats"),s.yb(1),s.hc("ngSwitchCase","Profile"),s.yb(1),s.hc("ngSwitchCase","Preview")}}var ke,we=((ke=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.showPage=!1,this.showPageMessage="Loading...",this.cancelToken=new o.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(r.a)(this.route.data,this.route.params,this.route.queryParams,this.hubService.getHubCacheObservable(!0),this.hubService.getRemoteAgentObservable(!0)).subscribe((function(t){var a=t[1],n=t[2];e.hubCache=t[3];var i=t[4],r=+a.auditConnectionKey,o=+a.auditKey;e.showPage=!1,e.showPageMessage="Waiting for an active remote agent...",e.view=n.view,e.view||(e.view="Stats"),i&&(e.showPage=!0,e.showPageMessage="",e.hubService.getResultDetail(r,o,e.cancelToken).then((function(t){e.auditResult=t[0]})))}))}catch(t){this.hubService.addHubClientErrorMessage(t,"Results View")}}},{key:"ngOnDestroy",value:function(){this._subscription&&this._subscription.unsubscribe(),this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this.cancelToken.cancel()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"watchChanges",value:function(){var e=this;this._transformWriterResultChangeSubscription&&this._transformWriterResultChangeSubscription.unsubscribe(),this._transformWriterResultChangeSubscription=this.hubService.getTransformWriterResultChangeObservable().subscribe((function(t){e.auditResult&&t.auditConnectionKey===e.auditResult.auditConnectionKey&&t.auditKey===e.auditResult.auditKey&&(e.auditResult=t)}))}}]),e}()).\u0275fac=function(e){return new(e||ke)(s.Kb(n.a),s.Kb(D.a),s.Kb(l.e),s.Kb(l.a))},ke.\u0275cmp=s.Eb({type:ke,selectors:[["results-view"]],decls:2,vars:1,consts:[[1,"container-fluid"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close",4,"ngIf"],["iconClass","fa fa-lg fa-fw fa-trophy",3,"title","showCloseButton","close"],["header",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"nav","nav-tabs","card-header-tabs"],[1,"nav-item"],["routerLink",".",1,"nav-link",3,"queryParams"],[1,"fa","fa-clock-o"],[1,"ml-1","d-none","d-md-inline"],["class","nav-item",4,"ngIf"],[1,"fa","fa-tachometer"],[1,"fa","fa-table"],[3,"auditResult"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Dc(1,Ce,7,6,"dexih-widget",1),s.Nb()),2&e&&(s.yb(1),s.hc("ngIf",t.auditResult))},directives:[d.t,u.P,d.x,d.y,l.h,te,ie,ue],encapsulation:2}),ke)},ynzd:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a("4Y1E"),i=a("ElCs"),r=a("2Vo4"),o=a("itXk"),c=a("soiQ"),s=a("fXoL"),l=a("tyNb"),u=a("Wumg"),b=a("H3K+"),h=a("/pur"),d=a("mWX8"),f=a("VdXI"),m=a("axB7");function v(e,t){if(1&e&&s.Lb(0,"tags-update-button",9),2&e){var a=t.items,n=s.Zb();s.hc("objectType",n.eSharedObjectType.View)("objects",a)}}function p(e,t){if(1&e&&s.Lb(0,"dependent-items-button",10),2&e){var a=t.item,n=s.Zb();s.hc("key",a.key)("objectType",n.eSharedObjectType.View)}}function g(e,t){1&e&&s.Lb(0,"actions-view-button",11),2&e&&s.hc("views",t.items)}var y=function(){var e=function(){function e(t,a,n,i){_classCallCheck(this,e),this.hubService=t,this.authService=a,this.router=n,this.route=i,this.eSharedObjectType=c.dc,this.columns=[{name:"name",title:"Name",footer:"description",format:"Md",tags:"tags"},{iconClass:"sharedIcon",tooltip:"sharedToolTip",width:"1%",align:"center"},{name:"viewType",title:"Chart/Table"},{name:"sourceName",title:"Source"},{name:"updateDate",title:"Last Modified",format:"Calendar"}],this._tableData=new r.a(null),this.tableData=this._tableData.asObservable()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watchChanges();try{this._subscription=Object(o.a)(this.route.data,this.route.params,this.hubService.getHubCacheObservable()).subscribe((function(t){e.hubCache=t[2],e.updateViews()}))}catch(t){this.hubService.addHubClientErrorMessage(t,"View Index")}}},{key:"ngOnDestroy",value:function(){this._hubCacheChangeSubscription&&this._hubCacheChangeSubscription.unsubscribe(),this._subscription&&this._subscription.unsubscribe()}},{key:"close",value:function(){this.authService.navigateUp()}},{key:"deleteViews",value:function(e){this.hubService.deleteViews(e)}},{key:"updateViews",value:function(){var e=this;if(this.hubCache&&this.hubCache.isLoaded()){var t=this.hubCache.hub.dexihViews.filter((function(e){return e.isValid})).map((function(t){var a="";switch(t.sourceType){case c.lb.Table:var n=e.hubCache.getTable(t.sourceTableKey);a=n?n.logicalName:"Error, not found";break;case c.lb.Datalink:var i=e.hubCache.hub.dexihDatalinks.find((function(e){return e.key===t.sourceDatalinkKey}));a=i?"Datalink: "+i.name:"Error, not found"}return{key:t.key,name:t.name,tags:e.hubCache.getObjectTags(c.dc.View,t.key),viewType:c.rc[t.viewType],sourceName:a,updateDate:t.updateDate,sharedIcon:t.isShared?"fa fa-group":"fa fa-user-secret",sharedToolTip:t.isShared?"Table is shared":"Table is private"}}));this._tableData.next(t)}else this._tableData.next(null)}},{key:"editView",value:function(e){this.router.navigate(["view-edit",e.key],{relativeTo:this.route})}},{key:"export",value:function(e){var t=this.hubCache,a=this.hubService.createHub(t.hub.hubKey,"");e.forEach((function(e){t.cacheAddView(e.key,a)})),this.hubService.exportHub(a,1===e.length?"View - "+e[0].name+".json":"views.json")}},{key:"watchChanges",value:function(){var e=this;this._hubCacheChangeSubscription=this.hubService.getHubCacheChangeObservable().subscribe((function(t){t.changeClass!==c.dc.View&&t.changeClass!==c.dc.TagObjects||e.updateViews()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Kb(n.a),s.Kb(i.a),s.Kb(l.e),s.Kb(l.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["views"]],inputs:{hubKey:"hubKey"},decls:10,vars:7,consts:[[1,"container-fluid"],["title","Views","iconClass","fa fa-lg fa-fw fa-bar-chart",3,"showCloseButton","close"],[3,"enableMultiSelect","enableStickyToolbar","toolbarZIndex","columns","dataObservable","tags","rowClick"],["select","selectedItemsAction"],["selectedItemsAction",""],["select","selectedItemAction"],["selectedItemAction",""],["actions",""],["title","Views","path","/assets/help/reference/view.md",1,"m-3"],[1,"ml-1",3,"objectType","objects"],[1,"ml-1",3,"key","objectType"],[3,"views"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"dexih-widget",1),s.Vb("close",(function(){return t.close()})),s.Ob(2,"dexih-table",2),s.Vb("rowClick",(function(e){return t.editView(e)})),s.Dc(3,v,1,2,"ng-template",3,4,s.Ec),s.Dc(5,p,1,2,"ng-template",5,6,s.Ec),s.Dc(7,g,1,1,"ng-template",null,7,s.Ec),s.Nb(),s.Nb(),s.Lb(9,"dexih-help",8),s.Nb()),2&e&&(s.yb(1),s.hc("showCloseButton",!0),s.yb(1),s.hc("enableMultiSelect",!0)("enableStickyToolbar",!0)("toolbarZIndex",100)("columns",t.columns)("dataObservable",t.tableData)("tags",t.hubCache.hub.dexihTags))},directives:[u.P,b.a,h.a,d.a,f.a,m.a],encapsulation:2}),e}()}}]);